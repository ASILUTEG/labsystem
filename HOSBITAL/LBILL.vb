Imports System.IO
Public Class LBILL
    Dim cmdtemp As New OleDb.OleDbCommand
    Dim cmdBILL As New OleDb.OleDbCommand
    Dim cmdeslb As New OleDb.OleDbCommand
    Dim ada As New OleDb.OleDbDataAdapter
    Dim cmdonbill As New OleDb.OleDbCommand
    Dim adonbill As New OleDb.OleDbDataAdapter
    Dim a As New DataTable
    Dim cmdGG As New OleDb.OleDbCommand
    Dim adGG As New OleDb.OleDbDataAdapter
    Dim GG As New DataTable
    Dim cmdpv1 As New OleDb.OleDbCommand
    Dim adpv1 As New OleDb.OleDbDataAdapter
    Dim pv1 As New DataTable
    Dim cma1 As New OleDb.OleDbCommand
    Dim ada1 As New OleDb.OleDbDataAdapter
    Dim a1 As New DataTable
    Dim cmdgdl As New OleDb.OleDbCommand
    Dim adgdl As New OleDb.OleDbDataAdapter
    Dim gdl As New DataTable
    Dim SSBRAN, SSBRAN1 As String
    Dim adtw As New OleDb.OleDbDataAdapter
    Dim tw As New DataTable
    Dim ader As New OleDb.OleDbDataAdapter
    Dim er As New DataTable
    Dim adMC As New OleDb.OleDbDataAdapter
    Dim MC As New DataTable
    Dim adlbn As New OleDb.OleDbDataAdapter
    Dim lbn As New DataTable
    Dim adesl As New OleDb.OleDbDataAdapter
    Dim esl As New DataTable
    Dim adPVW As New OleDb.OleDbDataAdapter
    Dim PVW As New DataTable
    Dim adsot As New OleDb.OleDbDataAdapter
    Dim sot As New DataTable
    Dim adnt1 As New OleDb.OleDbDataAdapter
    Dim nt1 As New DataTable
    Dim adsh2 As New OleDb.OleDbDataAdapter
    Dim sh2 As New DataTable
    Dim adF31 As New OleDb.OleDbDataAdapter
    Dim F31 As New DataTable
    Dim adcash1 As New OleDb.OleDbDataAdapter
    Dim cash1 As New DataTable
    Dim cmdesl As New OleDb.OleDbCommand
    Dim cmdhres As New OleDb.OleDbCommand
    Dim adhres As New OleDb.OleDbDataAdapter
    Dim hres As New DataTable
    Dim adllab As New OleDb.OleDbDataAdapter
    Dim llab As New DataTable
    Dim adnotes As New OleDb.OleDbDataAdapter
    Dim notes As New DataTable
    Dim adcomp As New OleDb.OleDbDataAdapter
    Dim comp As New DataTable
    Dim pro As New DataTable
    Dim adpro As New OleDb.OleDbDataAdapter
    Dim adCULTF As New OleDb.OleDbDataAdapter
    Dim CULTF As New DataTable
    Dim adbranch As New OleDb.OleDbDataAdapter
    Dim branch As New DataTable
    Dim adcultd As New OleDb.OleDbDataAdapter
    Dim cultd As New DataTable
    Dim add1OC As New OleDb.OleDbDataAdapter
    Dim DOC As New DataTable
    Dim adtestres As New OleDb.OleDbDataAdapter
    Dim testres As New DataTable
    Dim adtestresc As New OleDb.OleDbDataAdapter
    Dim testresc As New DataTable
    Dim adsubres As New OleDb.OleDbDataAdapter
    Dim subres As New DataTable
    Dim adcultname As New OleDb.OleDbDataAdapter
    Dim cultname As New DataTable
    Dim adBOOK As New OleDb.OleDbDataAdapter
    Dim BOOK As New DataTable
    Dim adBILL As New OleDb.OleDbDataAdapter
    Dim BILL As New DataTable
    Dim adtfinal As New OleDb.OleDbDataAdapter
    Dim tfinal As New DataTable
    Dim adGR As New OleDb.OleDbDataAdapter
    Dim GR As New DataTable
    Dim adtemp As New OleDb.OleDbDataAdapter
    Dim temp As New DataTable
    Dim adeslb As New OleDb.OleDbDataAdapter
    Dim eslb As New DataTable
    Dim adsr As New OleDb.OleDbDataAdapter
    Dim sr As New DataTable
    Dim admach As New OleDb.OleDbDataAdapter
    Dim mach As New DataTable
   
    Dim adbar As New OleDb.OleDbDataAdapter
    Dim bar As New DataTable
    Dim adscompany As New OleDb.OleDbDataAdapter
    Dim scompany As New DataTable
    Dim adlntest As New OleDb.OleDbDataAdapter
    Dim lntest As New DataTable
    Dim tm As Integer = 0
    Dim tstc As Integer = 0
    Dim b As String = ""
    Dim t As String = ""
    Dim yy As String = ""
    Dim ss As String = ""
    Dim sqlt As String = ""
    Dim SSSS As Integer = 0
    Dim nnq As Integer = 0
    Dim nnw As Integer = 0
    Dim SourceDirectory, FFIND, FFINDT, CEDIT, CTOTAL, usr11, shift11, bremail, PORV, YYR, RECEP, anewa, labtests, pap, fchk, MAX_ESL, yrn, DELT, SSFINAL, nxx, final, llname, llnamear, YYN, sname, PT, rptt, SAVEAR, SAVEEN, DELAR, DELEN, EDITAR, EDITEN, PERMEN, PERMAR, booka, TNAME, chkar, chken, lcult1, ldref, ldelgat, lpromz, ltestp, lpnum, reflang As String
    Dim doc_admin, EMP_CODE, subrrr, esla, scan1, WSITE, snew, fnd, edt, rppnt, brans, disss, tdoc, tlabtolab, trcv, fath, saven, TESTP, TESTSH, slist, FESLT, docs, ams, sbar, sscan, sbill, ffprofile, ffpack_name, resa, fftest_ar, fftest_code, fftest_name, pas, print1, pa1, prnitnn, resta, msga, companal, ali, wer, ltblg, luser, lemail, ldelg, ldis, lref, backcolor1, lbld1, UPDATE_TEST, PRNTNV, REST_PRNT, PRAA, edate, SV, ED, DEL, fast, hrcv, prntn, prntn1, prnt, rpt, hs, lres, mng, mtp, ldoc, lrcv, pa, tv, nf31, tc, dc, pah, ls, lp, lmach, fcolor, bcolor, PMMM, tblg, ref1, sprnt, FLNB, pp As Integer
    Dim dttt As Date = Now
    'Dim b As New BarcodeLib.Barcode()
    Dim adedu As New OleDb.OleDbDataAdapter
    Dim edu As New DataTable
    Dim adpr3 As New OleDb.OleDbDataAdapter
    Dim pr3 As New DataTable
    Dim adTEMP2 As New OleDb.OleDbDataAdapter
    Dim TEMP2 As New DataTable
    Dim adTEMP1 As New OleDb.OleDbDataAdapter
    Dim TEMP1 As New DataTable
    Dim adeemp As New OleDb.OleDbDataAdapter
    Dim eemp As New DataTable
    Dim adjop As New OleDb.OleDbDataAdapter
    Dim jop As New DataTable
    Dim adinsr As New OleDb.OleDbDataAdapter
    Dim insr As New DataTable
    Dim adgroup As New OleDb.OleDbDataAdapter
    Dim group As New DataTable
    Dim adpe As New OleDb.OleDbDataAdapter
    Dim pe As New DataTable
    Dim admon As New OleDb.OleDbDataAdapter
    Dim mon As New DataTable
    Dim adspa As New OleDb.OleDbDataAdapter
    Dim spa As New DataTable
    Dim adPRICE As New OleDb.OleDbDataAdapter
    Dim PRICE As New DataTable
    Dim aders As New OleDb.OleDbDataAdapter
    Dim ers As New DataTable
    Dim wee As Integer = 1
    Dim filePath As String = ""
    Dim filename As String = ""
    Dim cmdrsub As New OleDb.OleDbCommand
    Dim cmdresv As New OleDb.OleDbCommand
    Dim cmdpff As New OleDb.OleDbCommand
    Dim adpff As New OleDb.OleDbDataAdapter
    Dim cmdcultf As New OleDb.OleDbCommand
    Dim cmdpro As New OleDb.OleDbCommand
    Dim cmdress As New OleDb.OleDbCommand
    Dim adresv As New OleDb.OleDbDataAdapter
    Dim resv As New DataTable
    Dim cmdptt As New OleDb.OleDbCommand

    Dim adptt As New OleDb.OleDbDataAdapter
    Dim ptt As New DataTable
    Dim adcoomp1 As New OleDb.OleDbDataAdapter
    Dim coomp1 As New DataTable
    Dim xpname As String
    Dim barscode, ccname, rrname, DELPICTB, TB As String
    Dim ESLNN, upd1, clinic, onl, v, LABOUT, savenew, PMOB, stb1, typec, ttrest As Integer


    Private Sub pbrith_date_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles pbrith_date.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        pbrith_date.BackColor = Color.FromArgb(backcolor1)

    End Sub

    Private Sub pbrith_date_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles pbrith_date.KeyDown
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")

    End Sub

    Private Sub pbrith_date_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles pbrith_date.MouseHover
        llname = "pbrith_date"

    End Sub

    Private Sub DateTimePicker1_ValueChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pbrith_date.ValueChanged
        If pbrith_date.Focused = False Then Exit Sub
        Dim d As Date = Now
        page.Text = d.Year - pbrith_date.Value.Year
        PMMM = 0
    End Sub

    Private Sub LBILL_FormClosing(ByVal sender As Object, ByVal e As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing

    End Sub
    Public Sub changbtn()
        ACdr.Close()
        ACcmd.CommandText = "select * from gen where gso<50 and f=2 order by gso"
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            If ACdr("gso") = 1 Then Z1.Text = ACdr("name1") ': Z1.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 2 Then Z2.Text = ACdr("name1") ': Z2.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 3 Then Z3.Text = ACdr("name1") ': Z3.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 4 Then Z4.Text = ACdr("name1") ': Z4.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 5 Then Z5.Text = ACdr("name1") ': Z5.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 6 Then Z6.Text = ACdr("name1") ': Z6.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 7 Then Z7.Text = ACdr("name1") ' Z7.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 8 Then Z8.Text = ACdr("name1") ': Z8.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 9 Then Z9.Text = ACdr("name1") ': Z9.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 10 Then Z10.Text = ACdr("name1") ' Z10.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 11 Then Z11.Text = ACdr("name1") '' Z11.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 12 Then Z12.Text = ACdr("name1") ' Z12.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 13 Then Z13.Text = ACdr("name1") ' Z13.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 14 Then Z14.Text = ACdr("name1") ': Z14.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 15 Then Z15.Text = ACdr("name1") ' : Z15.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 16 Then Z16.Text = ACdr("name1") ': Z49.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 17 Then Z17.Text = ACdr("name1") ': Z17.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 18 Then Z18.Text = ACdr("name1") ': Z18.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 19 Then Z19.Text = ACdr("name1") ': Z19.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 20 Then Z20.Text = ACdr("name1") ': Z20.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 21 Then Z21.Text = ACdr("name1") ': Z21.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 22 Then Z22.Text = ACdr("name1") ': Z22.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 23 Then Z23.Text = ACdr("name1") ': Z23.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 24 Then Z24.Text = ACdr("name1") ': Z24.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 25 Then Z25.Text = ACdr("name1") ': Z25.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 26 Then Z26.Text = ACdr("name1") ': Z26.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 27 Then Z27.Text = ACdr("name1") ': Z27.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 28 Then Z28.Text = ACdr("name1") ': Z28.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 29 Then Z29.Text = ACdr("name1") ': Z29.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 30 Then Z30.Text = ACdr("name1") ': Z30.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 31 Then Z31.Text = ACdr("name1") ': Z31.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 32 Then Z32.Text = ACdr("name1") ': Z32.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 33 Then Z33.Text = ACdr("name1") ': Z33.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 34 Then Z34.Text = ACdr("name1") ': Z34.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 35 Then Z35.Text = ACdr("name1") ': Z35.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 36 Then Z36.Text = ACdr("name1") ': Z36.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 37 Then Z37.Text = ACdr("name1") ': Z37.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 38 Then Z38.Text = ACdr("name1") ': Z38.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 39 Then Z39.Text = ACdr("name1") ': Z39.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 40 Then Z40.Text = ACdr("name1") ': Z40.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 41 Then Z41.Text = ACdr("name1") ':' Z41.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 42 Then Z42.Text = ACdr("name1") ': Z42.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 43 Then Z43.Text = ACdr("name1") ': Z43.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 44 Then Z44.Text = ACdr("name1") ': Z44.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 45 Then Z45.Text = ACdr("name1") ': Z45.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 46 Then Z46.Text = ACdr("name1") ': Z46.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 47 Then Z47.Text = ACdr("name1") ': Z47.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 48 Then Z48.Text = ACdr("name1") ': Z48.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 49 Then Z49.Text = ACdr("name1") ': Z16.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 50 Then Z50.Text = ACdr("name1")
        End While
        ACdr.Close()
        ACcmd.CommandText = "select * from gen where  f=5 order by gso"
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            If ACdr("gso") = 10 Then Z70.Text = ACdr("name1") : Z60.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 1 Then Z51.Text = ACdr("name1") : Z51.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 2 Then Z52.Text = ACdr("name1") : Z52.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 3 Then Z53.Text = ACdr("name1") : Z53.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 4 Then Z54.Text = ACdr("name1") : Z54.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 5 Then Z55.Text = ACdr("name1") : Z55.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 6 Then Z56.Text = ACdr("name1") : Z56.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 7 Then Z57.Text = ACdr("name1") : Z57.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 8 Then Z58.Text = ACdr("name1") : Z58.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 8 Then Z59.Text = ACdr("name1") : Z59.BackColor = Color.FromArgb(ACdr("color"))
        End While
        ACdr.Close()
        ACcmd.CommandText = "select * from gen where   f=6 order by gso"
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            If ACdr("gso") = 10 Then Z70.Text = ACdr("name1") : Z70.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 1 Then Z61.Text = ACdr("name1") : Z61.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 2 Then Z62.Text = ACdr("name1") : Z62.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 3 Then Z63.Text = ACdr("name1") : Z63.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 4 Then Z64.Text = ACdr("name1") : Z64.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 5 Then Z65.Text = ACdr("name1") : Z65.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 6 Then Z66.Text = ACdr("name1") : Z66.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 7 Then Z67.Text = ACdr("name1") : Z67.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 8 Then Z68.Text = ACdr("name1") : Z68.BackColor = Color.FromArgb(ACdr("color"))
            If ACdr("gso") = 9 Then Z69.Text = ACdr("name1") : Z69.BackColor = Color.FromArgb(ACdr("color"))
        End While

    End Sub

    Private Sub LBILL_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        On Error Resume Next
        Dim t As Date = Now
        Form1.‘ƒÊ‰«·⁄«„·Ì‰ToolStripMenuItem.Visible = False
        Form1.«·„Œ«“‰ToolStripMenuItem.Visible = False
        Form1.»—‰«„Ã«·⁄Ì«œ…ToolStripMenuItem.Visible = False
        Form1.«·‘»ﬂ…ToolStripMenuItem.Visible = False
       

        cmdesl.Connection = CN
        cmdesl.CommandText = "pesl"
        cmdesl.CommandType = CommandType.StoredProcedure
        cmdesl.Parameters.AddWithValue("esl_no", Val(0))
        cmdesl.Parameters.AddWithValue("yearn", Val(0))
        cmdesl.Parameters.AddWithValue("bran", 0)
        adesl.SelectCommand = cmdesl
        adesl.Fill(DBS, "esl")
        dr.Close()
        cmd.CommandText = "select * from lmachine"
        dr = cmd.ExecuteReader
        mach_name.Items.Clear()
        While dr.Read
            mach_name.Items.Add(dr("name"))
        End While
        dr.Close() : cmd.CommandText = "SELECT  * from users"
        adPVW.SelectCommand = cmd
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        dr.Close() : cmd.CommandText = "SELECT  * from users"
        adpv1.SelectCommand = cmd
        adpv1.Fill(DBS, "PV1")
        pv1 = DBS.Tables("PV1")
        cmdress.Connection = CN
        cmdress.CommandText = "ptestres"
        cmdress.CommandType = CommandType.StoredProcedure
        cmdress.Parameters.AddWithValue("esl_no", Val(0))
        cmdress.Parameters.AddWithValue("yearn", Val(0))
        cmdress.Parameters.AddWithValue("bran", 0)
        adtestres.SelectCommand = cmdress
        adtestres.Fill(DBS, "testres")
        cmdpro.Connection = CN
        cmdpro.CommandText = "psub"
        cmdpro.CommandType = CommandType.StoredProcedure
        cmdpro.Parameters.AddWithValue("esl_no", Val(0))
        cmdpro.Parameters.AddWithValue("yearn", Val(0))
        cmdpro.Parameters.AddWithValue("bran", 0)
        adpro.SelectCommand = cmdpro
        adpro.Fill(DBS, "pro")
        cmdcultf.Connection = CN
        cmdcultf.CommandText = "pcult"
        cmdcultf.CommandType = CommandType.StoredProcedure
        cmdcultf.Parameters.AddWithValue("esl_no", Val(0))
        cmdcultf.Parameters.AddWithValue("yearn", Val(0))
        cmdcultf.Parameters.AddWithValue("bran", 0)
        adCULTF.SelectCommand = cmdcultf
        adCULTF.Fill(DBS, "cultf")

        cmdrsub.Connection = CN
        cmdrsub.CommandText = "SELECT * FROM lbill_testsub	WHERE ESL_NO ='0' and yearn ='0' and bran = '0'  and mtest_code='0' ORDER BY RSO"
        adsubres.SelectCommand = cmdrsub
        adsubres.Fill(DBS, "subres")
        subres = DBS.Tables("subres")

        
        Dim strHostName As String
        strHostName = System.Net.Dns.GetHostName()
        'If edt = 1 Then trl1.Text = " ÕÊÌ·" Else trl1.Text = "„—Õ·"
        'MessageBox.Show("Host Name: " & strHostName)
        Dim nnnn As Integer = 0
        YEARN.Text = Now.Year
        'On Error Resume Next
        Dim rrr As Process = Process.Start(Application.StartupPath & "\bar.exe")
        'dr.Close() : cmd.CommandText = "select * from v_total "
        'adtfinal.SelectCommand = cmd
        'adtfinal.Fill(DBS, "tfinal")
        'tfinal = DBS.Tables("tfinal")
        'DBS.Tables("tfinal").Clear()
        'adtfinal.Fill(DBS, "tfinal")
        'tfinal = DBS.Tables("tfinal")
        cmdBILL.Connection = ACcn

        wer = 1
        edate = 0
        nf31 = 0
        FLNB = 0
        SAVEAR = "Â·  —Ìœ «·Õ›Ÿ ø"
        SAVEEN = "ARE YOU WANT TO SAVE  ?"
        DELAR = "Â·  —Ìœ «·Õ–› ø"
        DELEN = "ARE YOU WANT TO DELETE ?"
        EDITAR = "Â·  —Ìœ «· ⁄œÌ· ø"
        EDITEN = "ARE YOU WANT TO EDIT ?"
        PERMEN = "You do not have permission"
        PERMAR = "·Ì”  ·œÌﬂ «·’·«ÕÌ…"
        chken = "check data of "
        PERMAR = "«·—Ã«¡ «· √ﬂœ „‰ »Ì«‰«  "
        cmdifc.Connection = CN
        cmdifc.CommandType = CommandType.Text
        cmdifc.CommandText = "select * from iface"
        adifc.SelectCommand = cmdifc
        adifc.Fill(DBS, "ifc")
        ifc = DBS.Tables("ifc")
        cmdhres.Connection = CN
        cmdhres.CommandText = "select * from lhres "
        adhres.SelectCommand = cmdhres
        adhres.Fill(DBS, "hres")
        hres = DBS.Tables("hres")
        drb.DataSource = hres
        ers.Columns.Add("oname")
        ers.Clear()
        dr.Close() : cmd.CommandText = "select * from IFACE  where sorting>1 "
        adsot.SelectCommand = cmd
        adsot.Fill(DBS, "sot")
        sot = DBS.Tables("sot")
        DBS.Tables("sot").Clear()
        adsot.Fill(DBS, "sot")
        sot = DBS.Tables("sot")
        dr.Close() : cmd.CommandText = "select * from USERS where NAME='" & USR & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            CEDIT = dr("CEDIT")
            CTOTAL = dr("CTOTAL")
            mluser = dr("luser")
            final = dr("final")
            SV = dr("LSAVE")
            DEL = dr("LDEL")
            prntn1 = dr("prntn")
            ED = dr("LEDIT")
            rpt = dr("LESLRP")
            prnt = dr("LPRNT")
            hs = dr("Lcome")
            lres = dr("lres")
            If lres = 0 Then TabControl1.TabPages.Remove(TabPage6) : TabControl1.TabPages.Remove(TabPage5) : TabControl1.TabPages.Remove(TabPage6) : QQ40.Visible = False
            mng = dr("admin")
            mtp = dr("lmtp")
            ldoc = dr("doc")
            lrcv = dr("rcv")
            pa = dr("pa")
            tv = dr("tv")
            tc = dr("tc")
            dc = dr("dc")
            pah = dr("pah")
            ls = dr("ls")
            lbld1 = dr("lbld")
            If lbld1 = 0 Then LBLD.Dispose()
            lp = dr("lp")
            If lp = 0 Then TabControl1.TabPages.Remove(TabPage12)
            UPDATE_TEST = dr("UPDATE_TEST")
            lmach = dr("lmach")
            lng = dr("lng")
            fcolor = dr("fcolor")
            bcolor = dr("bcolor")
            backcolor1 = dr("backcolor")
            ltblg = dr("ltblg")
            luser = dr("luser")
            lemail = dr("lemail")
            ldelg = dr("ldelg")
            ldis = dr("ldis")
            lref = dr("lref")
            REST_PRNT = dr("REST_PRNT")
            colu(Me, bcolor, fcolor)
            lcult1 = dr("lcult")
            ldref = dr("ldref")
            ldelgat = dr("ldelgat")
            lpromz = dr("lpromz")
            ltestp = dr("ltestp")
            lpnum = dr("lpnum")
            EMP_CODE = dr("EMP_CODE")
        End If
        dr.Close()
        cmd.CommandText = "select * from eemp"
        dr = cmd.ExecuteReader
        labd.AutoCompleteCustomSource.Clear()
        While dr.Read
            labd.AutoCompleteCustomSource.Add(dr("name"))
        End While


        dr.Close()
        cmd.CommandText = "select * from users"
        dr = cmd.ExecuteReader
        DOC_NAME.AutoCompleteCustomSource.Clear()
        While dr.Read
            DOC_NAME.AutoCompleteCustomSource.Add(dr("name"))
        End While

        dr.Close()
        cmd.CommandText = "select * from lcomment"
        dr = cmd.ExecuteReader
        comments.AutoCompleteCustomSource.Clear()
        DIRECT_FILM.AutoCompleteCustomSource.Clear()
        While dr.Read
            comments.AutoCompleteCustomSource.Add(nulls(dr("name")))
        End While
        dr.Close()
        cmd.CommandText = "select * from lVIRUS"
        dr = cmd.ExecuteReader
        While dr.Read
            SPECIMEN.AutoCompleteCustomSource.Add(nulls(dr("name")))
        End While
        Growth_of.AutoCompleteCustomSource.Clear()
        dr.Close()
        cmd.CommandText = "select * from lGrowth_of"
        dr = cmd.ExecuteReader
        While dr.Read
            Growth_of.AutoCompleteCustomSource.Add(nulls(dr("name")))
            DIRECT_FILM.AutoCompleteCustomSource.Add(nulls(dr("name")))
        End While
        dr.Close()
        SPECIMEN.Items.Clear()
        cmd.CommandText = "select * from lcultname "
        dr = cmd.ExecuteReader
        While dr.Read
            SPECIMEN.Items.Add(nulls(dr("name")))
        End While

        dr.Close()
        cmd.CommandText = "select * from lCULT"
        dr = cmd.ExecuteReader
        While dr.Read
            MEDCINE_NAME.AutoCompleteCustomSource.Add(nulls(dr("name")))
            MSHR.AutoCompleteCustomSource.Add(nulls(dr("SHR")))
        End While

        If ldref = 0 Then

        End If
        'If mng = 0 Then
        '    GlassButton55.Visible = False
        '     ﬁ—Ì—œŒ·«·„⁄„·ToolStripMenuItem.Visible = False
        '    GlassButton43.Visible = False
        'End If
      
        If lemail = 0 Then SendEmailToolStripMenuItem1.Visible = False : DDK.Visible = False
        If ldelgat = 0 Then
            GlassButton13.Visible = False
            GlassButton26.Visible = False
        End If
       
        If UPDATE_TEST = 0 Then
            GlassButton75.Visible = False
            qq221.Visible = False
            qq47.Visible = False
            qq49.Visible = False
            'GlassButton46.Visible = False
            qq91.Visible = False
            GlassButton136.Visible = False
            qq90.Visible = False
            qq92.Visible = False
            GRNAME.Visible = False
            uusr.Visible = False
            group_name.Visible = False
            tot1.Visible = False
            qq222.Visible = False
            GlassButton116.Visible = False
            qq222.Visible = False
            qq223.Visible = False
            qq221.Visible = False
            'GlassButton115.Visible = False
        Else
            dr.Close()
            cmd.CommandText = "select * from LGTEST "
            dr = cmd.ExecuteReader
            smain.Items.Clear()
            part_name.Items.Clear()
            While dr.Read
                smain.Items.Add(nulls(dr("NAME")))
                part_name.Items.Add(nulls(dr("NAME")))
            End While
            dr.Close()
            GRNAME.Items.Clear()
            cmd.CommandText = "select * from lgr order by name"
            dr = cmd.ExecuteReader
            While dr.Read
                GRNAME.Items.Add(nulls(dr("NAME")))
            End While
            dr.Close()
            group_name.Items.Clear()
            cmd.CommandText = "select * from lgroup order by name"
            dr = cmd.ExecuteReader
            While dr.Read
                group_name.Items.Add(nulls(dr("NAME")))
            End While

        End If

        dr.Close()
        save_name.Items.Clear()
        save1_name.Items.Clear()
        cmd.CommandText = "select * from lsave "
        dr = cmd.ExecuteReader
        While dr.Read
            save_name.Items.Add(nulls(dr("name")))
            save1_name.Items.Add(nulls(dr("name")))
        End While
        dr.Close()
        rcv_time.Items.Clear()
        cmd.CommandText = "select * from ltimer "
        dr = cmd.ExecuteReader
        While dr.Read
            rcv_time.Items.Add(nulls(dr("name")))
        End While
        ACdr.Close() : ACcmd.CommandText = "select *  from gen  "
        adgen.SelectCommand = ACcmd
        adgen.Fill(DBS, "gen")
        gen = DBS.Tables("gen")
        TextBox3.DataSource = gen
        TextBox3.DisplayMember = "name1"
        ACdr.Close() : ACcmd.CommandText = "select test_name  from TEST_PRICE  "
        ACdr = ACcmd.ExecuteReader
        nnnn = 0
        While ACdr.Read
            Ntest_NAME.AutoCompleteCustomSource.Add(nulls(ACdr("test_name")))
        End While

        PNIK.Items.Clear()
        dr.Close()
        KID_TYPE.Items.Clear()
        cmd.CommandText = "select * from lkid_type "
        dr = cmd.ExecuteReader
        While dr.Read
            KID_TYPE.Items.Add(nulls(dr("name")))
            KID_TYPE.Text = dr("name")
        End While

        dr.Close()
        cmd.CommandText = "select * from ltype"
        dr = cmd.ExecuteReader
        While dr.Read
            PNIK.Items.Add(nulls(dr("sname")))
        End While
        lname.Items.Clear()
        ACdr.Close()
        ACcmd.CommandText = "select * from exp"
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            lname.Items.Add(nulls(ACdr("lname")))
        End While

        rptp.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from lpath"
        dr = cmd.ExecuteReader
        While dr.Read
            rptp.Items.Add(nulls(dr("name")))
        End While
        nik.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from lcotype"
        dr = cmd.ExecuteReader
        While dr.Read
            nik.Items.Add(nulls(dr("name")))
        End While
        dr.Close() : cmd.CommandText = "select * from setting where NAME='show'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            If dr("opt") = 0 Then
                CRES.Checked = False
                CSUB.Checked = False
            End If
        End If
        dr.Close() : cmd.CommandText = "select * from setting where NAME='ref'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            ref1 = dr("opt")
        End If
        dr.Close() : cmd.CommandText = "select * from setting where NAME='PRNTN'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            PRNTNV = dr("opt")
        End If

        changbtn()
        cmdresv.Connection = CN
        cmdresv.CommandText = "select * from rpresv"
        adresv.SelectCommand = cmdresv
        adresv.Fill(DBS, "resv")
        resv = DBS.Tables("resv")
        dr.Close() : cmd.CommandText = "select * from branch"
        adbranch.SelectCommand = cmd
        adbranch.Fill(DBS, "branch")
        branch = DBS.Tables("branch")
        branch_name.DataSource = branch
        branch_name.DisplayMember = "NAME"
        dr.Close() : cmd.CommandText = "select * from lcompany where lab=1"
        adllab.SelectCommand = cmd
        adllab.Fill(DBS, "llab")
        llab = DBS.Tables("llab")
        lab_name.DataSource = llab
        lab_name.DisplayMember = "NAME"
        lab_name.Text = ""

        ACdr.Close() : ACcmd.CommandText = "select * from srv "
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        If ACdr.HasRows Then
            brans = ACdr("branch")
            sname = ACdr("sname")
            fast = ACdr("fast")
            rptp.Text = ACdr("rptp")

            branch_code.Text = ACdr("BRANCH")

            FRC = branch.Select("code='" & branch_code.Text & "'")
            If FRC.Length <= 0 Then
                branch_name.Text = ""
                branch_code.Text = ""
            Else
                RC = FRC(0)
                branch_name.Text = RC("NAME")
                branch_code.Text = RC("code")
                prntn = RC("prntn")
            End If
        End If
        Dim t1 As TimeSpan = Now - t

        user.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from users "
        dr = cmd.ExecuteReader
        While dr.Read
            user.Items.Add(nulls(dr("name")))
        End While
        dr.Close()
        lnotes.Items.Clear()
        cmd.CommandText = "select * from lnotes "
        dr = cmd.ExecuteReader
        While dr.Read
            lnotes.Items.Add(nulls(dr("name")))
        End While

        shift.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from lshift "
        dr = cmd.ExecuteReader
        While dr.Read
            shift.Items.Add(nulls(dr("name")))
        End While


        Dim x As Integer = 0
        dr.Close() : cmd.CommandText = "select * from lBOOK_PRICE"
        adBOOK.SelectCommand = cmd
        adBOOK.Fill(DBS, "BOOK")
        BOOK = DBS.Tables("BOOK")
        BOOK_name.DataSource = BOOK
        BOOK_name.DisplayMember = "NAME"
        BOOK_name.Text = ""
        tquery.BOOK_name.Items.Clear()
        Dim ass As Integer = 0
        While Not ass = BOOK.Rows.Count
            tquery.BOOK_name.Items.Add(BOOK.Rows(ass).Item("name"))
            ass = ass + 1
        End While
        fbranch(2)
        REG_name.Items.Clear()
        dr.Close()
        dr.Close() : cmd.CommandText = "select name from lCOMPANY  group by name"
        adscompany.SelectCommand = cmd
        adscompany.Fill(DBS, "scompany")
        scompany = DBS.Tables("scompany")
        COMPANY_name.DataSource = scompany
        COMPANY_name.DisplayMember = "NAME"
        tquery.COMPANY_name.Items.Clear()
        tquery.REG_name.Items.Clear()
        ass = 0
        While Not ass = scompany.Rows.Count
            tquery.COMPANY_name.Items.Add(scompany.Rows(ass).Item("name"))
            tquery.REG_name.Items.Add(scompany.Rows(ass).Item("name"))
            REG_name.Items.Add(scompany.Rows(ass).Item("name"))
            ass = ass + 1
        End While

        FRC = BOOK.Select("code='1'")

        RC = FRC(0)
        BOOK_name.Text = RC("NAME")
        BOOK_CODE.Text = 1
        benff()
        RC = DOC.Rows(0)
        DOC_CODE.Text = RC("code")
        d1.Value = "1/1/" & Now.Year
        pname.Text = 1
        pgover.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from lgover "
        dr = cmd.ExecuteReader
        pgover.AutoCompleteCustomSource.Clear()
        While dr.Read
            pgover.AutoCompleteCustomSource.Add(nulls(dr("gover_name")))
            pgover.Items.Add(nulls(dr("gover_name")))
        End While
        dr.Close()

        dr.Close()
        cmd.CommandText = "SELECT *  from SETTING where    NAME='SH'"
        dr = cmd.ExecuteReader
        While dr.Read
            hrcv = nulls(dr("OPT"))
        End While
        dr.Close()
        sub_name.Items.Clear()
        cmd.CommandText = "select * from lsub "
        dr = cmd.ExecuteReader
        While dr.Read
            sub_name.Items.Add(nulls(dr("sub_name")))
        End While

        dr.Close()
        main_name.Items.Clear()
        cmd.CommandText = "select * from lmain "
        dr = cmd.ExecuteReader
        While dr.Read
            main_name.Items.Add(nulls(dr("name")))
        End While
        PRAA = 1
        esl_date.Value = Now
        Me.Text = USR & "   " & SHF & "  " & branch_name.Text
        ifaceb(Me)
        dr.Close()
        'Dim nmsg As Integer = 0
        'cmd.CommandText = "select * from v_wall where rd=0 and usr='" & USR & "'"
        'dr = cmd.ExecuteReader
        'While dr.Read
        '    YouHaveNewNoteToolStripMenuItem.Text = "you have new messages"
        '    YouHaveNewNoteToolStripMenuItem.ForeColor = Color.Red
        '    nmsg = nmsg + 1
        'End While
        'If nmsg > 0 Then MsgBox("you have " & nmsg & "  new messages" 
        'qq150_dClick(qq150, e)
        TabControl1.TabPages.Remove(TabPage2)

        fbranch(2)

        COMPANY_CODE.Text = 1
        fcompany(2)
        PNIK.Focus()
        ACdr.Close() : ACcmd.CommandText = "select * from srv "
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        If ACdr.HasRows Then
            rptp.Text = ACdr("rptp")
            PrintDialog1.PrinterSettings.PrinterName = nulls(ACdr("prnt"))
            PrintDialog1.Document = PrintDocument1
            PrintDialog2.PrinterSettings.PrinterName = nulls(ACdr("srv"))
            PrintDialog2.Document = PrintDocument2
            If IsDate(ACdr("p1")) = False Then ftprice() Else If Now.Date <> ChangeFormat(ACdr("p1")) Then ftprice()
            ACdr.Close()
            ACcmd.CommandText = "update srv set p1='" & Now.Date & "'"
            ACcmd.ExecuteNonQuery()
        End If
        If FESLT = 0 Then
            GlassButton102.Visible = False
            esld.Visible = False
            ESLBILL.Visible = False
            urgant.Visible = False
        End If
        dr.Close()
        cmd.CommandText = "select * from lsave where code='" & saven & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            save_code.Text = dr("code")
            save_name.Text = dr("name")
            save1_code.Text = dr("code")
            save1_name.Text = dr("name")
        End While
        QQ40.Visible = True
        If edt = 0 Then
            GL33.Visible = False
            GlassButton141.Visible = False
        End If
        If scan1 = 1 Then
            qq115.Visible = False
            Column24.Visible = False
            btestd.Columns("Column19").Visible = False
            btestd.Columns("Column24").Visible = False
            TabControl1.TabPages.Remove(TabPage5)
            TabControl1.TabPages.Remove(TabPage6)
            QQ40.Visible = False
            tprest.Visible = False
            tptot.Visible = False
            tppay.Visible = False
            cprest.Visible = False
            cppay.Visible = False
            cptot.Visible = False
            Label88.Visible = False
            Label89.Visible = False
            Label87.Visible = False
            pnrest.Visible = False
            pntot.Visible = False
            pnpay.Visible = False
            lab_name.Visible = False
            clab_name.Visible = False
            GlassButton150.Visible = True
            GlassButton149.Visible = True
            GlassButton92.Visible = True
        End If
        If scan1 = 1 Then
            test.Visible = True
        End If
        sbran = ""

        Dim n As Integer = 0
        While Not n = branch.Rows.Count
            If nulls(branch.Rows(n).Item("prov")) <> "" Then sbran = sbran & "+" & branch.Rows(n).Item("bran")
            n = n + 1
        End While
        If PORV <> "" Then qq152.Visible = True
        dr.Close()
        If clinic = 1 Then
            dr.Close()
            ENAME.Items.Clear()
            cmd.CommandText = "select * from ENAME "
            dr = cmd.ExecuteReader
            While dr.Read
                ENAME.Items.Add(dr("NAME"))
            End While
            dr.Close()
            EDOCNAME.Items.Clear()
            cmd.CommandText = "select * from EDOC WHERE ENAME='" & ENAME.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                EDOCNAME.Items.Add(dr("NAME"))
            End While

        End If
        RRVV = ""
        dr.Close()
        cmd.CommandText = "select * from BRANCH "
        dr = cmd.ExecuteReader
        While dr.Read
            If bran.Text <> dr("BRAN") Then RRVV = RRVV + "+" + dr("BRAN")
        End While
        'cmd.CommandText = "SELECT * FROM LTC"
        'dr = cmd.ExecuteReader
        'While dr.Read
        '    CheckedListBox1.Items.Add(dr("NAME"))
        'End While
        dr.Close()
        cmd.CommandText = "select * from eemp "
        dr = cmd.ExecuteReader
        emp_name.AutoCompleteCustomSource.Clear()
        While dr.Read

            emp_name.AutoCompleteCustomSource.Add(dr("name"))
        End While
        DOC_NAME.Text = Nothing
        If Form1.»—‰«„Ã«·⁄Ì«œ…ToolStripMenuItem.Visible = True Then
            dr.Close()
            cmd.CommandText = "select NAME from CSERV "
            dr = cmd.ExecuteReader
            While dr.Read
                SERVF.AutoCompleteCustomSource.Add(dr(0))
            End While
            dr.Close()
            ENAME.Items.Clear()
            eyada_name.Items.Clear()
            cmd.CommandText = "select * from ceyada"
            dr = cmd.ExecuteReader
            While dr.Read
                eyada_name.Items.Add(dr("NAME"))
                ENAME.Items.Add(dr("NAME"))
            End While
            dr.Close()
            EDOCNAME.Items.Clear()
            doc_namec.Items.Clear()
            cmd.CommandText = "select NAME from cDOC"
            dr = cmd.ExecuteReader
            While dr.Read
                doc_namec.Items.Add(dr("NAME"))
                EDOCNAME.Items.Add(dr("NAME"))
            End While

            dr.Close()
            type_name.Items.Clear()
            cmd.CommandText = "select NAME from cTYPE"
            dr = cmd.ExecuteReader
            While dr.Read
                type_name.Items.Add(dr("NAME"))
            End While

        End If
        dr.Close()
        cmd.CommandText = "select * from lsave where code='" & saven & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            save_code.Text = dr("code")
            save_name.Text = dr("name")
            SSBRAN = dr("BRAN")
            save1_code.Text = dr("code")
            SSBRAN1 = nulls(dr("BRAN"))
            save1_name.Text = dr("name")
        End While
        ACdr.Close() : ACcmd.CommandText = "select * from srv "
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        If ACdr("prnt") = "1" Then
            'Dim ssss As String = MsgBox("Â·  —Ìœ  Õ„Ì· «”„«¡ «·„—÷Ï ø", MsgBoxStyle.YesNo)
            'If ssss = vbYes Then qq150_Click(qq150, e)
            rrr.Kill()
        Else
            dr.Close() : cmd.CommandText = "select   pname from LPATIEN  group by pname ORDER BY PNAME DESC"
            adspa.SelectCommand = cmd
            adspa.Fill(DBS, "spa")
            spa = DBS.Tables("spa")
            pname.DataSource = spa
            pname.DisplayMember = "pNAME"
            nname.DataSource = spa
            nname.DisplayMember = "pNAME"
            tquery.pname.DataSource = spa
            tquery.pname.DisplayMember = "pNAME"
            pname.Text = Nothing
            nname.Text = Nothing
            rrr.Kill()
        End If
        dr.Close()
        cmd.CommandText = "select * from lhres"
        dr = cmd.ExecuteReader
        pictext.AutoCompleteCustomSource.Clear()
        While dr.Read
            pictext.AutoCompleteCustomSource.Add(dr("name"))
        End While
        SDAY.Value = Now

        dr.Close() : cmd.CommandText = "SELECT  * from V_LIMAGE where ESL_NO=0  and yearn=2019 and bran='" & bran.Text & "'"
        ada1.SelectCommand = cmd
        adPVW.Fill(DBS, "a1")
        a1 = DBS.Tables("a1")
5:
    End Sub
    Public Sub fbranch(ByVal ss As Int16)
        On Error Resume Next
        If ss = 1 Then FRC = branch.Select("NAME='" & branch_name.Text & "'") Else FRC = branch.Select("code='" & brans & "'")
        If FRC.Length > 0 Then
mm:
            RC = FRC(0)
            PMOB = nulls(RC("PMOBILE"))
            subrrr = nulls(RC("subres"))
            savenew = nulls(RC("savenew"))
            ESLNN = nulls(RC("ESLN"))
            bremail = RC("email")
            PORV = RC("PROV")
            scan1 = RC("scan")
            branch_name.Text = RC("NAME")
            branch_code.Text = RC("code")
            If RC("CLINIC") = 1 Then
                ENAME.Visible = True
                EDOCNAME.Visible = True
                QQQ180.Visible = True
                QQQ181.Visible = True
                cename.Visible = True
                cdoc.Visible = True
                clinic = 1
            Else
                clinic = 0
            End If
            RECEP = RC("RECEP")
            onl = RC("online")
            MAX_ESL = RC("ESL_SUM")
            bran.Text = RC("bran")
            RPAY.Text = RC("PAY")
            pap = RC("pap")
            disss = RC("dis")
            PT = RC("PT")
            reflang = RC("ref")
            companal = RC("companal")
            resta = RC("resta")
            fath = RC("fath")
            trcv = 0
            trcv = RC("rcv")
            LABOUT = RC("LABOUT")
            tdoc = RC("doc")
            edt = RC("edt")
            tlabtolab = RC("labtolab")
            saven = nulls(RC("saven"))
            If RC("panal") = "res" Then SEP.Checked = True
            If RC("panal") = "resp" Then PANEL.Checked = True
            If RC("panal") = "resg" Then GROP.Checked = True
            'If RC("pv") = "print" Then PR.Checked = True Else PV.Checked = True
            If RC("printn") = 1 Then prnitnn = 1 Else prnitnn = 0
            If RC("print1") = 1 Then print1 = 1 Else print1 = 0
            If RC("pas") = 1 Then pas = 1 Else pas = 0
            If RC("test_name") = 1 Then fftest_name = 1 Else fftest_name = 0
            If RC("test_code") = 1 Then fftest_code = 1 Else fftest_code = 0
            If RC("test_ar") = 1 Then fftest_ar = 1 Else fftest_ar = 0
            If RC("pack_name") = 1 Then ffpack_name = 1 Else ffpack_name = 0
            If RC("sbar") = 1 Then sbar = 1 Else sbar = 0
            If RC("sscan") = 1 Then sscan = 1 Else sscan = 0
            If RC("sbill") = 1 Then sbill = 1 Else sbill = 0
            If RC("profile") = 1 Then ffprofile = 1 Else ffprofile = 0
            If RC("slist") = 1 Then slist = 1 Else slist = 0
            If RC("FESLT") = 1 Then FESLT = 1 Else FESLT = 0
            If RC("FINAL") = 1 Then SSFINAL = 1 Else SSFINAL = 0
            DELT = 1
            If RC("yearn") = 1 Then
                yrn = "="
            Else
                yrn = ">"
                YEARN.Items.Clear()
                YEARN.Text = 2014
            End If
            TESTP = RC("TESTP")
            TESTSH = RC("TESTSH")
            WSITE = RC("WSITE")
        Else
            RC = branch.Rows(0)
            GoTo mm
        End If
        If PORV.Length < 5 Then
            QQQWQQW.Visible = False
            qq152.Visible = False
            qqq1.Visible = False
            gb25.Visible = False
            GroupBox5.Visible = False
            YYYYYYYYY.Visible = False
        End If
    End Sub
    Private Sub REG_name_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles REG_name.GotFocus
        flng(reflang)
        colu(Me, Val(bcolor), Val(fcolor))
        REG_name.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "REG_name")
        FFIND = "REG_name"
        FFINDT = REG_name.Text
    End Sub

    Private Sub REG_name_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles REG_name.KeyDown

        If e.KeyCode = Keys.Enter Then
            If REG_name.Text = "" Then Exit Sub
            Dim ass As String = ""
            If IsNumeric(REG_name.Text) = False Then ass = " NAME='" & REG_name.Text & "'" Else ass = "  code='" & REG_name.Text & "'"
            dr.Close()
            cmd.CommandText = "SELECT * FROM lcompany WHERE " & ass
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then
                REG_name.Text = dr("NAME")
                REG_CODE.Text = dr("CODE")
                If Val("diss") > 0 Then dissn.Text = dr("diss")
            Else
                fcompany(3)
            End If


        End If
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")

    End Sub

    Private Sub REG_name_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles REG_name.KeyPress

    End Sub

    Private Sub REG_name_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles REG_name.KeyUp
        If e.KeyCode = Keys.F6 Then
            fufind()
        End If
        rrname = COMPANY_name.Text
        
    End Sub

    Private Sub REG_name_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles REG_name.LostFocus
        dr.Close()
        cmd.CommandText = "SELECT * FROM lcompany WHERE code='" & REG_CODE.Text & "' and NAME='" & REG_name.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = False Then
            REG_name.Focus()
            REG_name.BackColor = Color.Red
            Exit Sub
        End If
    End Sub

    Private Sub REG_name_MouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles REG_name.MouseClick

    End Sub

    Private Sub REG_name_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles REG_name.MouseHover

    End Sub

    Private Sub REG_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles REG_name.SelectedIndexChanged

    End Sub

    Private Sub DOC_name_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs)
        PMMM = 0
        flng("AR")
        colu(Me, Val(bcolor), Val(fcolor))
        DOC_NAME.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "DOC_name")
    End Sub


    Private Sub DOC_name_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)
        If DOC_NAME.Text = "" Then Exit Sub
        If PMMM = 0 Then PMMM = 1 : Exit Sub
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub DOC_name_Layout(ByVal sender As Object, ByVal e As System.Windows.Forms.LayoutEventArgs)

    End Sub

    Private Sub DOC_name_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "DOC_name"
    End Sub


    Private Sub DOC_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If DOC_NAME.Focused = False Then Exit Sub
        If DOC_NAME.Text = "" Then Exit Sub

        FRC = DOC.Select("NAME='" & DOC_NAME.Text & "'")
        If FRC.Length <= 0 Then
            DOC_NAME.Text = ""
            DOC_CODE.Text = ""
            Exit Sub
        Else
            RC = FRC(0)
            DOC_CODE.Text = RC("code")
            tell.Text = RC("tell")
            eml.Text = RC("email")
        End If
    End Sub

    Private Sub group_name_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles group_name.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))
        group_name.BackColor = Color.FromArgb(backcolor1)
        ams = 2
    End Sub

    Private Sub group_name_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles group_name.KeyDown
        If e.KeyCode = Keys.Enter Then
            Dim XYY As String = ""
            If CGG.CheckState = CheckState.Checked Then XYY = "WHERE gname='" & group_name.Text & "'"
            cmdGG.Connection = CN
            cmdGG.CommandType = CommandType.Text
            cmdGG.CommandText = "select * FROM lgroup_test " & XYY
            adGG.SelectCommand = cmdGG
            adGG.Fill(DBS, "gg")
            GG = DBS.Tables("gg")
            DBS.Tables("gg").Clear()
            adGG.Fill(DBS, "gg")
            GG = DBS.Tables("gg")
            DataGridView4.DataSource = GG
            dr.Close()
            Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
            oj.Load(Application.StartupPath & "\group test.rpt")
            oj.Database.Tables(0).SetDataSource(GG)
            rp.CrystalReportViewer1.ReportSource = oj
            rp.Show() : rp.Focus()
        End If



    End Sub

    Private Sub group_name_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles group_name.MouseHover
        llname = "group_name"

    End Sub



    Private Sub group_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles group_name.SelectedIndexChanged
        If group_name.Focused = False Then Exit Sub
        If group_name.Text = "" Then Exit Sub




        dr.Close()
        cmd.CommandText = "SELECT * FROM lgroup_price WHERE Gname='" & group_name.Text & "' and  book_price_CODE='" & BOOK_CODE.Text & "' "
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then tot1.Text = 0 Else tot1.Text = dr("tot")


    End Sub


    Public Sub benff()
        dr.Close()
        cmd.CommandText = "select * from lcompany where name='" & COMPANY_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then Exit Sub
        Select Case depn.Text
            Case "‰›”Â"
                crd_per.Text = dr("ch")
                cash_per.Text = dr("ph")
            Case "«·«»‰«¡"
                crd_per.Text = dr("cs")
                cash_per.Text = dr("ps")
            Case "«·«» Ê «·«„"
                crd_per.Text = dr("cp")
                cash_per.Text = dr("pp")
            Case "«·“ÊÃ Ê «·“ÊÃ…"
                crd_per.Text = dr("cw")
                cash_per.Text = dr("pw")
        End Select

    End Sub


    Public Sub TPRICE()

        FRC = llab.Select("NAME='" & lab_name.Text & "'")
        ACdr.Close()
        If FRC.Length > 0 Then
            RC = FRC(0)
            ACcmd.CommandText = "update test_price set  tot=price" & BOOK_CODE.Text & ", labprice=price" & RC("BOOK_PRICE_CODE") & ""
            ACcmd.ExecuteNonQuery()
        Else
            ACcmd.CommandText = "update test_price set  tot=price" & BOOK_CODE.Text & ""
            ACcmd.ExecuteNonQuery()
        End If

        ACdr.Close()
        ACcmd.CommandText = "update test_price set  tot=price1 where lck=1"
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = "update test_price set  tot=0, labprice=0 where tot is null"
        ACcmd.ExecuteNonQuery()
        'companydis()
        fprice(0)
        booka = BOOK_name.Text
        tstc = BILL.Rows.Count
        TextBox3.Text = ""
        test_name.Text = ""
        If Val(pcrd.Text) = 1 Then
            ACdr.Close()
            dr.Close()
            cmd.CommandText = "select * from ltest_price where book_price_code='" & BOOK_CODE.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                ACcmd.CommandText = "update test_price set pricep='" & nulls(dr("p1")) & "',priceV='" & nulls(dr("V1")) & "' where test_code=" & dr("test_code")
                ACcmd.ExecuteNonQuery()
            End While
        End If
    End Sub
    Private Sub GlassButton36_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq72.Click
        FNEWV()
        pname.Text = ""
        ptype.Text = ""
        page.Text = "0"
        pmobile.Text = "0"
        PNIK.Text = ""
        PNIK.Focus()

    End Sub
    Public Sub FNEWV()
        Try
            If pname.Text = "" Then pname.Text = "lab"
            uchk(Me)
            esln()
            pa1 = 0
            fbranch(2)
            wer = 1
            anew(1, 1)
            tm = 4
            TabControl2.SelectTab(0)
            If pcode.Text <> "0" Then
                dr.Close() : cmd.CommandText = "select * from Lbill WHERE  pname='" & pname.Text & "'"
                adtemp.SelectCommand = cmd
                adtemp.Fill(DBS, "temp")
                temp = DBS.Tables("temp")
                DBS.Tables("temp").Clear()
                adtemp.Fill(DBS, "temp")
                temp = DBS.Tables("temp")
                F31D.DataSource = temp
            Else
                Dim tas As String = ""
                If CBRAN.Checked = True Then tas = " and bran='" & bran.Text & "'"
                dr.Close() : cmd.CommandText = "select * from Lbill WHERE ESL_DATE='" & ChangeFormat(Now.Date) & "' and bdel=0 " & tas
                adtemp.SelectCommand = cmd
                adtemp.Fill(DBS, "temp")
                temp = DBS.Tables("temp")
                DBS.Tables("temp").Clear()
                adtemp.Fill(DBS, "temp")
                temp = DBS.Tables("temp")
                F31D.DataSource = temp
            End If
            tm = 4
            F31DTG()
            dr.Close()
            PMMM = 0
            esl_no.Text = 0
            fesl_no()
            sotr(1, "")
            TPRICE()
            If pa1 = 1 Then TextBox3.Focus()
        Catch ex As Exception
            Dim st1 As String = "NEW VISIT"
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
    Public Sub fesl_no()
        If ESLNN = 0 Then
            dr.Close()
            cmd.CommandText = "select MAX(ESL_NO) from lbill where bran='" & bran.Text & "' and yearn='" & YEARN.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            esl_no.Text = nulls(dr(0)) + 1
        Else
            ACdr.Close()
            ACcmd.CommandText = "select * from srv  "
            ACdr = ACcmd.ExecuteReader
            ACdr.Read()
            esl_no.Text = ACdr("esln")
mmm:
            dr.Close()
            cmd.CommandText = "select * from lbill where esl_no='" & Val(esl_no.Text) & "' and bran='" & bran.Text & "' and yearn='" & YEARN.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Or Val(esl_no.Text) = 0 Then
                dr.Close()
                cmd.CommandText = "select * from Branch where code='" & branch_code.Text & "'"
                dr = cmd.ExecuteReader
                dr.Read()
                If dr.HasRows = True Then
                    esl_no.Text = nulls(dr("esln"))
                    dr.Close()
                    cmd.CommandText = "update Branch set esln='" & Val(esl_no.Text) + 1 & "' where code='" & branch_code.Text & "'"
                    cmd.ExecuteNonQuery()
                    ACdr.Close()
                    ACcmd.CommandText = "update srv set esln='" & Val(esl_no.Text) & "' "
                    ACcmd.ExecuteNonQuery()
                    GoTo mmm
                End If
            End If
        End If
    End Sub
    Public Sub esln()

    End Sub
    Public Sub fpa()
mmm:
        dr.Close()
        cmd.CommandText = "select * from LPATIEN where pcode='" & Val(pcode.Text) & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Or Val(pcode.Text) = 0 Then
            dr.Close()
            cmd.CommandText = "select * from Branch where code='" & branch_code.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then
                pcode.Text = dr("pa")
                dr.Close()
                cmd.CommandText = "update Branch set pa='" & Val(pcode.Text) + 1 & "' where code='" & branch_code.Text & "'"
                cmd.ExecuteNonQuery()
                ACdr.Close()
                ACcmd.CommandText = "update srv set pa='" & Val(pcode.Text) & "' "
                ACcmd.ExecuteNonQuery()
                GoTo mmm
            End If
        End If


    End Sub
    Public Sub FCASH1()
        ACdr.Close()
        ACcmd.CommandText = "select * from srv "
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        If ACdr("CASH") > 0 Then
            id.Text = ACdr("CASH")
        End If

mmm:
        dr.Close()
        cmd.CommandText = "select * from lCASH where ID='" & id.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Or id.Text = 0 Then
            dr.Close()
            cmd.CommandText = "select * from Branch where code='" & branch_code.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then
                id.Text = dr("CASH")
                dr.Close()
                cmd.CommandText = "update Branch set CASH='" & Val(id.Text) + 1 & "' where code='" & branch_code.Text & "'"
                cmd.ExecuteNonQuery()
                ACdr.Close()
                ACcmd.CommandText = "update srv set CASH='" & Val(id.Text) & "' "
                ACcmd.ExecuteNonQuery()
                GoTo mmm
            End If
        End If
    End Sub
    Public Sub anew(ByVal asss As Integer, ByVal axxx As Integer)
        'On Error Resume Next
        bon.BackColor = Color.White
        REST.BackColor = Color.White
        ch.CheckState = CheckState.Unchecked
        NCRD.CheckState = CheckState.Unchecked
        esl_no.Text = 0
        BANK.Text = 0
        NDOC.Text = 0
        wuser.Text = 0
        wpass.Text = 0
        WEB.Text = 0
        wid.Text = 0
        fprice1(0)
        cash_per.Text = 100
        YEARN.Text = Now.Year
        tblg = 0
        bnew.Text = 0
        DOC_NAME.Text = 0
        SAMPLUSR.Text = ""
        labd.Text = ""
        SAMPL.CheckState = CheckState.Unchecked
        utc.CheckState = CheckState.Unchecked
        utn.CheckState = CheckState.Unchecked
        ucash.CheckState = CheckState.Unchecked
        SAMPLDATE.Text = ""
        sprnt1.Text = 0
        lnotes.Text = ""
        fs.Checked = False
        finals.Checked = False
        urgant.Checked = False
        pbrith_date.Value = Now
        esl_date.Value = Now
        trl1.Checked = False
        page.Text = 0
        cfast.CheckState = CheckState.Checked
        chrcv.CheckState = CheckState.Checked
        cfast.CheckState = CheckState.Unchecked
        chrcv.CheckState = CheckState.Unchecked
        rcvn.Text = "‘Œ’Ï"
        rcvv.Text = 0
        TextBox5.Text = 0
        dissn.Text = 0
        bon.Text = 0
        DISS.Text = 0
        pdiss.Text = 0
        pphone.Text = ""
        pmobile.Text = ""
        pgover.Text = ""
        pcity.Text = ""
        pstreet.Text = ""
        pemail.Text = ""
        pid.Text = ""
        rcv.Checked = 0
        PYEAR.Text = "year"
        If pname.Text = "" Then
            MsgBox("«·—Ã«¡ ﬂ «»… «”„ «·„—Ì÷", MsgBoxStyle.Information)
            Exit Sub
        End If
        If axxx = 1 And pname.Text <> "1" Then
            dr1.Close()
            cmd1.CommandText = "select * from lpatien where pcode='" & Val(pcode.Text) & "'"
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            If dr1.HasRows = True Then
mmm:
                PNIK.Text = dr1("PNIK")
                pcode.Text = dr1("pcode")
                pname.Text = dr1("pname")
                ptype.Text = dr1("ptype")
                pbrith_date.Value = dr1("pbrith_date")
                page.Text = dr1("page")
                pphone.Text = nulls(dr1("pphone"))
                pmobile.Text = nulls(dr1("pmobile"))
                pgover.Text = dr1("pgover")
                pcity.Text = dr1("pcity")
                pstreet.Text = dr1("pstreet")
                pemail.Text = dr1("pemail")
                pid.Text = dr1("pid")
                BOOK_CODE.Text = dr1("book_code")
                BOOK_name.Text = dr1("book_name")
                COMPANY_CODE.Text = dr1("company_code")
                COMPANY_name.Text = dr1("company_name")
                REG_CODE.Text = dr1("REG_code")
                REG_name.Text = dr1("REG_name")
                dr1.Close()
                cmd1.CommandText = "select * from lbill where rest<>0 and pcode='" & pcode.Text & "'"
                dr1 = cmd1.ExecuteReader
                If dr1.HasRows And msga = 1 Then
                    Dim xxaa As String = "«·»Ê«ﬁÏ «·ﬁœÌ„… ⁄·Ï «·„—Ì÷ øøøø"
                    xxaa = xxaa & Environment.NewLine
                    While dr1.Read
                        xxaa = xxaa & Environment.NewLine & dr1("esl_date") & " ------>  " & dr1("rest")
                    End While
                    MsgBox(xxaa, MsgBoxStyle.Critical)
                End If
                pa1 = 1
            Else
                dr1.Close()
                cmd1.CommandText = "select * from lpatien where pname='" & pname.Text & "'"
                dr1 = cmd1.ExecuteReader
                dr1.Read()
                If dr1.HasRows Then
                    Dim asx As String = ""
                    asx = MsgBox("Â–« «·«”„ „”Ã· „‰ ﬁ»· Â·  —Ìœ «·«” œ⁄«¡" & Environment.NewLine & "        " & pname.Text, MsgBoxStyle.YesNo)
                    If asx = vbYes Then
                        GoTo mmm

                    End If
                End If
                page.Text = 0
            End If
        End If
        typec = 1
        openblock()



        ACdr.Close()
        ACcmd.CommandText = "delete * from esl"
        ACcmd.ExecuteNonQuery()
        cmdeslb.Connection = ACcn : cmdeslb.CommandText = "select * from esl "
        adeslb.SelectCommand = cmdeslb
        adeslb.Fill(DBS, "eslb")
        eslb = DBS.Tables("eslb")
        DBS.Tables("eslb").Clear()
        adeslb.Fill(DBS, "eslb")
        eslb = DBS.Tables("eslb")
        esld.DataSource = eslb

        TOT.Text = 0

        ACdr.Close()
        If asss = 1 Then
            testpro.Text = ""
            ACcmd.CommandText = "delete * from cult"
            ACcmd.ExecuteNonQuery()
            ACcmd.CommandText = "update test_sub set qun=0,res=res1,RST=0"
            ACcmd.ExecuteNonQuery()
            ACcmd.CommandText = "update test_price set TOT2=0,tdel=0,anew=0,tot1=0,qun=0,lab=0,comment='',dis=0,dis_n=0,take=1,bar=shortname,PRNTN=0,homs=0"
            ACcmd.ExecuteNonQuery()
            ACcmd.CommandText = "update test_price set LAB=LAB2 ,RST=0"
            ACcmd.ExecuteNonQuery()
        End If

        TPRICE()

        pntot.Text = 0
        pnpay.Text = 0
        fesl_no()
        rcv_date.Value = Now

        PYEAR.Focus()
        PMMM = 0
    End Sub
    Public Sub openblock()

        'dr.Close()
        'Dim xxxblock As String
        'If typec = 1 Then xxxblock = pname.Text Else xxxblock = COMPANY_name.Text
        'xxxblock = xxxblock.Replace("Ï", "%")
        'xxxblock = xxxblock.Replace("Ì", "%")
        'xxxblock = xxxblock.Replace("√", "%")
        'xxxblock = xxxblock.Replace("«", "%")
        'xxxblock = xxxblock.Replace("Â", "%")
        'xxxblock = xxxblock.Replace("·¬", "%")
        'xxxblock = xxxblock.Replace("…", "%")
        'xxxblock = xxxblock.Replace(" ", "%")
        'dr.Close()
        'cmd.CommandText = "select * from lblock where pname like '%" & xxxblock & "%' and type='" & typec & "'"
        'dr = cmd.ExecuteReader
        'If dr.HasRows = True Then
        '    bblocck.tname.Text = xxxblock
        '    bblocck.ShowDialog()
        'End If

    End Sub
    Private Sub btestd_CellContentClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles btestd.CellContentClick
        'MsgBox(btestd.Columns("Column19").Width)

    End Sub
    Public Sub SUMT()
        If Val(dissn.Text) > 0 Then DISS.Text = 0
        Dim ss As Integer = 0
        'ACdr.Close()
        'ACcmd.CommandText = "update test_price set dis_n='" & Val(dissn.Text) & "'"
        'ACcmd.ExecuteNonQuery()
        'fprice(1)
        ACdr.Close()
        ACcmd.CommandText = "update test_price set dis=0"
        ACcmd.ExecuteNonQuery()
        ACdr.Close()
        ACcmd.CommandText = "update test_price set dis=dis_n*tot*.01 where tot2=0"
        ACcmd.ExecuteNonQuery()
        ACdr.Close()
        ACcmd.CommandText = "update test_price set dis=dis_n*tot1*.01 where tot2=1"
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = "SELECT SUM (TOT),max(ResultAfter),sum(dis),SUM(qun),sum(pricep),sum(priceV) FROM TEST_PRICE WHERE QUN=1 and tot1=0"
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        If nulls(ACdr(4)) > 0 Then
            bon.Text = nulls(ACdr(5))
            TOT.Text = nulls(ACdr(0))
            DISS.Text = TOT.Text - nulls(ACdr(4)) - nulls(ACdr(5))
        Else
            TOT.Text = nulls(ACdr(0))
            If nulls(ACdr(2)) > 0 Then DISS.Text = nulls(ACdr(2))

        End If
        ss = nulls(ACdr(1))

        tnum.Text = "test num " & nulls(ACdr(3))
        tnum1.Text = nulls(ACdr(3))
        ACdr.Close()
        ACcmd.CommandText = "SELECT sum(TOT1) FROM TEST_PRICE WHERE tot2=1 and qun>0 "
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            TOT.Text = ACdr(0) + TOT.Text
        End While
        Dim eee As Int16 = 0
        TOT.Text = Val(hrcvv.Text) + Val(fastv.Text) + Val(rcvv.Text) + TOT.Text + Val(dev.Text)
        ACdr.Close()
        ACcmd.CommandText = "SELECT test_name,lab FROM TEST_PRICE WHERE qun>0 order by bar"
        ACdr = ACcmd.ExecuteReader
        test.Text = ""
        ptest.Text = ""
        While ACdr.Read
            eee = eee + 1
            If test.Text = "" Then test.Text = ACdr("test_name") Else test.Text = test.Text & "+" & ACdr("test_name")
            If nulls(ACdr("lab")) = 1 Then ptest.Text = ptest.Text & "+" & ACdr("test_name")
        End While
        qqq5.Text = "⁄œœ «· Õ«·Ì· :" & eee
        ACdr.Close()
        ACcmd.CommandText = "SELECT bar FROM TEST_PRICE WHERE qun>0 group by bar "
        ACdr = ACcmd.ExecuteReader
        testpro.Text = ""
        While ACdr.Read
            If IsDBNull(ACdr("bar")) = False Then
                If testpro.Text = "" Then testpro.Text = ACdr("bar") Else testpro.Text = testpro.Text & "+" & ACdr("bar")
            End If
        End While
        If trcv = 1 Then
            Dim t As Integer = 0
            FRC = BILL.Select("qun='1'")
            While Not t = FRC.Length
                RC = FRC(t)
                RC.BeginEdit()
                RC.Item("rcv_date") = esl_date.Value.AddDays(ss)
                RC.EndEdit()
                t = t + 1
            End While
            rcv_date.Value = esl_date.Value.AddDays(ss)
        End If
        REST.Text = 0
        'DISS.Text = Val(dissn.Text) * Val(TOT.Text) * 0.01
        ACdr.Close()
        ACdr.Close()
        ACcmd.CommandText = "SELECT SUM (labprice) FROM TEST_PRICE WHERE lab=1 and qun=1 "
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        pntot.Text = nulls(ACdr(0))
        ACdr.Close()
        ACcmd.CommandText = "SELECT sum(dis) FROM TEST_PRICE WHERE QUN=1 and tot2=1"
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        DISS.Text = Math.Round(Val(DISS.Text) + nulls(ACdr(0)), 0)
        ' ccc.Text = Val(TOT.Text) - Val(bon.Text)
        FUND()

    End Sub
    Private Sub btestd_CellMouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles btestd.CellMouseClick
        On Error Resume Next
        'cmdb.DataAdapter = adBILL
        'adBILL.Update(DBS, "BILL")
        'SUMT()
        Ntest_CODE.Text = btestd(("Column4"), e.RowIndex).Value
        Ntest_NAME.Text = btestd(("Column8"), e.RowIndex).Value
    End Sub

    Private Sub TOT_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles TOT.MouseHover
        llname = "TOT"
    End Sub

    Private Sub TOT_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TOT.TextChanged


        FUND()

    End Sub

    Private Sub PAY_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles PAY.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))
        PAY.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "PAY")
    End Sub

    Private Sub PAY_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles PAY.KeyDown
        If e.KeyCode = Keys.Enter Then
            PAY.Text = -1 * Val(REST.Text)
        End If
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub PAY_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles PAY.MouseHover
        llname = "PAY"
    End Sub

    Private Sub PAY_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PAY.TextChanged
        REST.Text = Val(PAY.Text) - (Val(cash_v.Text) - Val(DISS.Text) - Val(bon.Text) - Val(BANK.Text))
    End Sub
    Public Sub FUND()

        cash_v.Text = Val(TOT.Text) * Val(cash_per.Text) * 0.01
        PAY.Text = Val(cash_v.Text) - Val(DISS.Text) - Val(bon.Text) - Val(BANK.Text)
        crd_v.Text = Val(TOT.Text) * Val(crd_per.Text) * 0.01
        ptot.Text = TOT.Text
        ppay.Text = PAY.Text
        pnpay.Text = pntot.Text
        pnrest.Text = 0
        If Val(ESLBILL.Text) < Val(TOT.Text) Then ESLBILL.BackColor = Color.Red Else ESLBILL.BackColor = Color.Green

    End Sub

    Private Sub DISS_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles DISS.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        DISS.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "DISS")
    End Sub

    Private Sub DISS_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles DISS.KeyPress
        If edt = 0 And finals.Checked = True And mng = 0 Then MsgBox("·« Ì„ﬂ‰  ⁄œÌ· «·Œ’„") : e.Handled = True
        If edt = 0 And ChangeFormat(Now.Date) <> ChangeFormat(esl_date.Value) And mng = 0 Then MsgBox("·« Ì„ﬂ‰  ⁄œÌ· «·Œ’„") : e.Handled = True

        If ldis = 0 Then e.Handled = True

    End Sub

    Private Sub DISS_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles DISS.KeyUp
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
        If e.KeyCode = Keys.ControlKey Then
            dissn.Text = Math.Round((Val(DISS.Text) / Val(TOT.Text)) * 100, 0)
            ACdr.Close()
            ACcmd.CommandText = "update test_price set dis_n='" & Val(dissn.Text) & "'"
            ACcmd.ExecuteNonQuery()
            fprice(1)
            SUMT()
        End If
    End Sub

    Private Sub DISS_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles DISS.MouseHover
        llname = "DISS"
    End Sub
    Private Sub DISS_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DISS.TextChanged
        If Val(DISS.Text) > Val(TOT.Text) Then DISS.Text = 0

        FUND()
    End Sub

    Private Sub GRNAME_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles GRNAME.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))
        GRNAME.BackColor = Color.FromArgb(backcolor1)
        ams = 3
    End Sub

    Private Sub GRNAME_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles GRNAME.KeyDown
        If e.KeyCode = Keys.Enter Then
            GlassButton5_Click_1(GlassButton5, e)
        ElseIf e.KeyCode = Keys.Delete Then
            ACdr.Close()
            acdr1.Close()
            accmd1.CommandText = "select * from TEST_PRICE where GR_NAME='" & GRNAME.Text & "'"
            acdr1 = accmd1.ExecuteReader
            While acdr1.Read
                ACcmd.CommandText = "update test_price set  qun=0 where test_code=" & acdr1("test_code")
                ACcmd.ExecuteNonQuery()
            End While
            fprice(1)
            SUMT()
        End If
    End Sub

    Private Sub GRNAME_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GRNAME.MouseHover
        llname = "GRNAME"

    End Sub

    Private Sub GRNAME_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GRNAME.SelectedIndexChanged
        If GRNAME.Focus = False Then Exit Sub
        If GRNAME.Text = "" Then Exit Sub
        cmdBILL.CommandText = "select * from TEST_PRICE WHERE GR_NAME='" & GRNAME.Text & "' order by so"
        adBILL.SelectCommand = cmdBILL
        adBILL.Fill(DBS, "BILL")
        BILL = DBS.Tables("BILL")
        DBS.Tables("BILL").Clear()
        adBILL.Fill(DBS, "BILL")
        BILL = DBS.Tables("BILL")
        btestd.DataSource = BILL

    End Sub

    Private Sub test_ar_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles test_ar.GotFocus
        flng("AR")
        colu(Me, Val(bcolor), Val(fcolor))

        test_ar.BackColor = Color.FromArgb(backcolor1)

    End Sub

    Private Sub test_ar_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles test_ar.MouseHover
        llname = "test_ar"
    End Sub

    Private Sub TextBox9_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles test_ar.TextChanged
        cmdBILL.CommandText = "select * from TEST_PRICE WHERE TEST_AR LIKE '%" & test_ar.Text & "%' order by so"
        adBILL.SelectCommand = cmdBILL
        adBILL.Fill(DBS, "BILL")
        BILL = DBS.Tables("BILL")
        DBS.Tables("BILL").Clear()
        adBILL.Fill(DBS, "BILL")
        BILL = DBS.Tables("BILL")
        btestd.DataSource = BILL
    End Sub

    Private Sub pname_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs)
        flng("AR")

        colu(Me, Val(bcolor), Val(fcolor))
        'PYEAR.BackColor = Color.Silver
        pname.BackColor = Color.FromArgb(backcolor1)
        'pname.ForeColor = Color.Blue
    End Sub

    Private Sub pname_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)
        If e.KeyCode = Keys.Enter Then
            FNEWV()
        End If
    End Sub

    Private Sub pname_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs)
        'If Not Char.IsLetter(e.KeyChar) AndAlso e.KeyChar <> ControlChars.Back AndAlso Not Char.IsYellowSpace(e.KeyChar) Then
        '    e.Handled = True
        'End If
    End Sub

    Private Sub gname_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)
        If e.KeyCode = Keys.F2 Then
            If pname.Text = "" Then Exit Sub
            Dim x As String = ""
            If cCOMPANY_CODE.CheckState = CheckState.Checked Then x = " and company_code='" & COMPANY_CODE.Text & "'"
            dr.Close() : cmd.CommandText = "select * from LPATIEN WHERE pname LIKE '%" & pname.Text & "%' " & x & " ORDER BY PNAME"
            adtemp.SelectCommand = cmd
            adtemp.Fill(DBS, "temp")
            temp = DBS.Tables("temp")
            DBS.Tables("temp").Clear()
            adtemp.Fill(DBS, "temp")
            temp = DBS.Tables("temp")
            brpd.DataSource = temp
            Dim v As Integer = 0
            While Not v = brpd.Columns.Count
                brpd.Columns(v).Visible = False
                v = v + 1
            End While
            brpd.Columns("pNAME").Visible = True
            If lng = "AR" Then brpd.Columns("pNAME").HeaderText = "«·„—Ì÷" Else brpd.Columns("pNAME").HeaderText = "Patient"
            brpd.Columns("pNAME").Width = 200
            brpd.Columns("pcode").Visible = True
            If lng = "AR" Then brpd.Columns("pcode").HeaderText = "«·ﬂÊœ" Else brpd.Columns("pcode").HeaderText = "CODE"
            brpd.Columns("pcode").Width = 70
            brpd.Columns("company_name").Visible = True
            If lng = "AR" Then brpd.Columns("company_name").HeaderText = "«·ÃÂ…" Else brpd.Columns("company_name").HeaderText = "Contact"
            brpd.Columns("company_name").Width = 150
            tm = 1
            pcode.Text = ""

        End If
        If e.KeyCode = Keys.Left Then PNIK.Focus()
        If e.KeyCode = Keys.Delete Then pname.Text = ""
    End Sub

    Private Sub pname_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "pname"

    End Sub

    Private Sub gname_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

        pcode.Text = ""
    End Sub
    Public Sub sotr(ByVal awer As Integer, ByVal ast As String)


        If awer = 2 Then
            FRC = sot.Select("name='" & ast & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                wer = RC("SORTING")
            End If

            Exit Sub
        End If
        wer = wer + awer
        If wer < 1 Then wer = 1
        FRC = sot.Select("SORTING='" & wer & "'")
        If FRC.Length > 0 Then
            RC = FRC(0)
        Else
            Exit Sub
        End If
        If RC("name") = "pid" Then
            pid.Focus()
        ElseIf RC("name") = "cash_per" Then
            cash_per.Focus()
        ElseIf RC("name") = "esl_date" Then
            esl_date.Focus()
        ElseIf RC("name") = "esld" Then
            esld.Focus()
        ElseIf RC("name") = "ptype" Then
            ptype.Focus()
        ElseIf RC("name") = "pemail" Then
            pemail.Focus()
        ElseIf RC("name") = "COMPANY_CODE" Then
            COMPANY_CODE.Focus()
        ElseIf RC("name") = "pmobile" Then
            pmobile.Focus()
        ElseIf RC("name") = "dissn" Then
            dissn.Focus()
        ElseIf RC("name") = "TextBox3" Then
            TextBox3.Focus()
        ElseIf RC("name") = "rcv_date" Then
            rcv_date.Focus()
        ElseIf RC("name") = "PAY" Then
            PAY.Focus()
        ElseIf RC("name") = "DISS" Then
            DISS.Focus()
        ElseIf RC("name") = "pbrith_date" Then
            pbrith_date.Focus()
        ElseIf RC("name") = "page" Then
            page.Focus()
        ElseIf RC("name") = "bon" Then
            bon.Focus()
        ElseIf RC("name") = "lnotes" Then
            lnotes.Focus()
        ElseIf RC("name") = "COMPANY_name" Then
            COMPANY_name.Focus()
        ElseIf RC("name") = "DOC_name" Then
            DOC_NAME.Focus()
        ElseIf RC("name") = "REG_name" Then
            REG_name.Focus()
        ElseIf RC("name") = "pgover" Then
            pgover.Focus()
        ElseIf RC("name") = "depn" Then
            depn.Focus()
        ElseIf RC("name") = "PYEAR" Then
            PYEAR.Focus()
        ElseIf RC("name") = "esl_no" Then
            esl_no.Focus()
        End If

    End Sub
    Public Sub fprice(ByVal s As Integer)
        Dim yy As String = ""
        If s = 1 Then yy = "where qun=1"
        cmdBILL.CommandText = "select * from TEST_PRICE " & yy & "  order by so"
        adBILL.SelectCommand = cmdBILL
        adBILL.Fill(DBS, "BILL")
        BILL = DBS.Tables("BILL")
        DBS.Tables("BILL").Clear()
        adBILL.Fill(DBS, "BILL")
        BILL = DBS.Tables("BILL")
        btestd.DataSource = BILL
        Dim n As Integer = 0
        While Not n = btestd.RowCount
            If nulls(btestd(("prntn"), n).Value) > 0 Then
                btestd.Rows(n).DefaultCellStyle.BackColor = Color.Red
            ElseIf finals.Checked = True Then
                btestd.Rows(n).DefaultCellStyle.BackColor = Color.LightGreen
            ElseIf fs.Checked = True Then
                btestd.Rows(n).DefaultCellStyle.BackColor = Color.Gray
            Else
                btestd.Rows(n).DefaultCellStyle.BackColor = Color.White
            End If
            n = n + 1
        End While
    End Sub

    Private Sub GlassButton1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton1.Click


    End Sub

    Private Sub REST_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles REST.MouseHover
        llname = "REST"
    End Sub



    Private Sub REST_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles REST.TextChanged
        prest.Text = REST.Text
    End Sub


    Private Sub crd_per_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles crd_per.TextChanged
        FUND()

    End Sub

    Private Sub page_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles page.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))
        'DOC_name.BackColor = Color.Silver
        page.BackColor = Color.FromArgb(backcolor1)
        'page.ForeColor = Color.Blue
        sotr(2, "page")
    End Sub

    Private Sub page_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles page.KeyDown
        PMMM = 1
        If e.KeyCode = Keys.F2 Then
            FIND.NFLD.Text = " PAGE "
            FIND.SNAME.Text = page.Text
            FIND.ShowDialog()
        End If
    End Sub

    Private Sub page_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles page.KeyUp
        If PMMM = 0 Then Exit Sub
        'On Error Resume Next
        pbrith_date.Value = Now
        Dim d As Date = Now
        If PYEAR.Text = "YEAR" Then

            d = d.AddYears(-Val(page.Text))
        ElseIf PYEAR.Text = "MONTH" Then
            d = d.AddMonths(-Val(page.Text))
        ElseIf PYEAR.Text = "DAY" Then
            d = d.AddDays(-Val(page.Text))
        End If
        pbrith_date.Value = d
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub page_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles page.MouseHover
        llname = "page"

    End Sub

    Private Sub page_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles page.TextChanged

    End Sub

    Private Sub ComboBox1_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles PNIK.DropDown


    End Sub

    Private Sub PNIK_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles PNIK.GotFocus
        flng("AR")
        colu(Me, Val(bcolor), Val(fcolor))

        PNIK.BackColor = Color.FromArgb(backcolor1)


    End Sub

    Private Sub PNIK_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles PNIK.KeyDown

        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "SELECT * FROM ltype where    sname='" & PNIK.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows Then
                PNIK.Text = dr("SNAME")
                ptype.Text = dr("NAME")
            End If
            pname.Text = ""
            pname.Focus()
        End If
    End Sub

    Private Sub PNIK_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles PNIK.LostFocus
        dr.Close()
        cmd.CommandText = "SELECT * FROM ltype where    sname='" & PNIK.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            PNIK.Text = dr("SNAME")
            ptype.Text = dr("NAME")
        End If
        pname.Focus()
    End Sub

    Private Sub PNIK_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles PNIK.MouseHover
        llname = "PNIK"

    End Sub

    Private Sub ComboBox1_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PNIK.SelectedIndexChanged
        'If PNIK.Focus = False Then Exit Sub
        'dr.Close()
        'cmd.CommandText = "SELECT * FROM ltype where    sname='" & PNIK.Text & "'"
        'dr = cmd.ExecuteReader
        'dr.Read()
        'If dr.HasRows Then
        '    PNIK.Text = dr("SNAME")
        '    ptype.Text = dr("NAME")
        'End If
        'pname.Focus()
    End Sub
    Public Sub PSAVE()
        dr.Close()
        If pcode.Text = "" Then
            ACdr.Close()
            ACcmd.CommandText = "select * from srv "
            ACdr = ACcmd.ExecuteReader
            ACdr.Read()
            If ACdr("esl") > 0 Then
                pcode.Text = ACdr("pa")
                fpa()
            End If
        End If
        dr.Close()
        cmd.CommandText = "select * from lpatien where pcode='" & Val(pcode.Text) & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            dr.Close()
            cmd.CommandText = "delete from lpatien where pcode='" & Val(pcode.Text) & "'"
            cmd.ExecuteNonQuery()
            GoTo mm
        Else
            If Val(pcode.Text) = 0 Then
                fpa()
            End If

            spa.Rows.Add(xpname)

        End If
mm:
        If Val(pcode.Text) = 0 Then
            fpa()
        End If
        dr.Close()
        cmd.CommandText = "INSERT INTO LPATIEN([pcode],[pname],[ptype],[pbrith_date],[page],[pphone] ,[pmobile],[pgover],[pcity],[pstreet] ,[pemail] ,[pid],[book_code],[book_name],[company_code],[company_name] ,[Pnik],PYEAR,REG_NAME,REG_CODE) VALUES ('" & pcode.Text & " ','" & Trim(xpname) & "','" & ptype.Text & "','" & ChangeFormat(pbrith_date.Value) & "','" & page.Text & "','" & pphone.Text & "','" & pmobile.Text & "','" & pgover.Text & "','" & pcity.Text & "','" & pstreet.Text & "','" & pemail.Text & "','" & pid.Text & "','" & BOOK_CODE.Text & "','" & BOOK_name.Text & "','" & COMPANY_CODE.Text & "','" & COMPANY_name.Text & "','" & PNIK.Text & "','" & PYEAR.Text & "','" & REG_name.Text & "','" & REG_CODE.Text & "')"
        cmd.ExecuteNonQuery()
        dr.Close()
        pname.Text = xpname
    End Sub
    Public Sub UPBILL()

    End Sub

    Private Sub GlassButton35_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq73.Click
        FSAVEV()
    End Sub
    Public Sub esl_cash(ByVal type As Integer)
        If type = 1 Or type = 3 Then
            ACdr.Close()
            cmdb.DataAdapter = adeslb
            adeslb.Update(DBS, "eslb")
            ACcmd.CommandText = "delete * FROM esl where tot < 0 and erbank < 0"
            ACcmd.ExecuteNonQuery()
            ACcmd.CommandText = "SELECT * FROM esl  "
            ACdr = ACcmd.ExecuteReader
            If ACdr.HasRows = False Then MsgBox("«·—Ã«¡ ﬂ «»… «·«Ì’«· Ê ﬁÌ„ Â") : esld.Focus() : Exit Sub
            ACdr.Close()
            ACcmd.CommandText = "SELECT sum(tot),sum(erbank) FROM esl  "
            ACdr = ACcmd.ExecuteReader
            While ACdr.Read
                BANK.Text = nulls(ACdr(1))
                PAY.Text = nulls(ACdr(0))
                If Val(PAY.Text) > Val(TOT.Text) And edt = 1 Then
                    Dim aaaa As String = MsgBox("„»·€ «·«Ì’«· «ﬂ»— „‰ «Ã„«·Ï «· Õ«·Ì·" & Environment.NewLine & "        " & TOT.Text, MsgBoxStyle.YesNo)
                    If aaaa = vbNo Then Exit Sub
                ElseIf Val(PAY.Text) > Val(TOT.Text) And edt = 0 Then
                    MsgBox("„»·€ «·«Ì’«· «ﬂ»— „‰ «Ã„«·Ï «· Õ«·Ì·" & Environment.NewLine & "        " & TOT.Text)
                    Exit Sub
                End If
            End While
        End If
        If type = 2 Or type = 3 Then
            dr.Close()
            If FESLT = 1 Then
                If ChangeFormat(Now) = ChangeFormat(esl_date.Value) Or mng = 1 Then
                    cmd.CommandText = "update lbill_esl set qun=0 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    ACdr.Close()
                    ESLBILL.Text = ""
                    ACcmd.CommandText = "SELECT * FROM esl  "
                    ACdr = ACcmd.ExecuteReader
                    While ACdr.Read
                        Dim BILL1 As Integer = 0
                        If IsDBNull(ACdr("bill")) = True Then
                            dr.Close()
                            cmd.CommandText = "select MAX(BILL) from lbill_esl where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                            dr = cmd.ExecuteReader
                            dr.Read()
                            If dr.HasRows = True Then BILL1 = nulls(dr(0)) + 1 Else BILL1 = 1
                        Else
                            BILL1 = nulls(ACdr("bill"))
                        End If

                        If BILL1 = 0 Then BILL1 = 1
                        dr.Close()
                        cmd.CommandText = "select * from lbill_esl where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and bill='" & nulls(ACdr("bill")) & "'"
                        dr = cmd.ExecuteReader
                        dr.Read()
                        If dr.HasRows = True Then
                            dr.Close()
                            cmd.CommandText = "update lbill_esl set qun=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' and bill='" & nulls(ACdr("bill")) & "'"
                            cmd.ExecuteNonQuery()
                        Else
                            If BILL1 = 0 Then
                                dr.Close()
                                cmd.CommandText = "select MAX(BILL) from lbill_esl where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                                dr = cmd.ExecuteReader
                                dr.Read()
                                If dr.HasRows = True Then
                                    BILL1 = nulls(dr(0)) + 1
                                Else
                                    BILL1 = 1
                                End If
                            End If
                            dr.Close()
                            cmd.CommandText = "delete from lbill_esl where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' and bill ='" & BILL1 & "'"
                            cmd.ExecuteNonQuery()
                            cmd.CommandText = "INSERT INTO  [lbill_esl]([esl_no],[bill],[tot],YEARN,qun,bran,usr,shift,erbank) VALUES ('" & Val(esl_no.Text) & "','" & BILL1 & "','" & nulls(ACdr("tot")) & "','" & esl_date.Value.Year & "','1','" & bran.Text & "','" & USR & "','" & SHF & "','" & nulls(ACdr("erbank")) & "')"
                            cmd.ExecuteNonQuery()
                        End If
                        If ESLBILL.Text <> "" Then ESLBILL.Text = ESLBILL.Text & " - " & ACdr("BILL") & "(" & ACdr("TOT") & ")" Else ESLBILL.Text = ACdr("BILL") & "(" & ACdr("TOT") & ")"
                    End While
                    dr.Close()
                    If dc = 1 Then
                        cmd.CommandText = "delete from lbill_esl where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' and qun ='0'"
                        cmd.ExecuteNonQuery()
                    End If
                End If

            End If
            dr1.Close()
            dr.Close()
            cmd.CommandText = "SELECT sum(tot) FROM lbill_esl  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            PAY.Text = nulls(dr(0))
            dr.Close()
        End If


    End Sub
    Public Sub FSAVEV()
        Try
            LLOG("test save", esl_no.Text, pname.Text, 1, bran.Text)
            xpname = pname.Text
            If xpname = "" Then
                If lng = "AR" Then MsgBox(chkar & "  «”„ «·„—Ì÷") Else MsgBox(chken & " name")
                Exit Sub
            End If

            Dim XLOG As String = " «·«”„ " & xpname & "-" & " «·”‰ " & page.Text & "-" & " «· ·Ì›Ê‰ " & pmobile.Text & "-" & " «·ÿ»Ì» " & REG_name.Text & COMPANY_name.Text & "-" & " «·‘—ﬂ… " & "-" & "«·„œ›Ê⁄ " & PAY.Text & "-" & " «·Œ’„ " & DISS.Text & "-" & qqq5.Text
            fillTextBox(Me)
            pname.Text = xpname
            If SV = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG("Õ›Ÿ “Ì«—…", esl_no.Text, XLOG, 0, bran.Text)
                Exit Sub
            End If
mms:
            fchk = 0

            If esl_no.Text = "" Then
                If lng = "AR" Then MsgBox("«÷€ÿ ÃœÌœ") Else MsgBox("«÷€ÿ ÃœÌœ")
                Exit Sub
            End If
            page.Text = Math.Round(Val(page.Text))
            If esl_no.Text < 0 And mng = 0 Then MsgBox("·«  ÊÃœ ·œÌﬂ ’·«ÕÌ…") : Exit Sub
            If PYEAR.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— ‰Ê⁄ «· «—ÌŒ") : Exit Sub
            If Val(page.Text) > 120 Or Val(page.Text) = 0 Then MsgBox("«·—Ã«¡ «· √ﬂœ „‰ «·”‰") : Exit Sub
            If Val(page.Text) > 12 And PYEAR.Text = "Month" Then MsgBox("·« Ì„ﬂ‰  ﬂ «»… «ﬂÀ— „‰ 12 ‘Â—") : Exit Sub
            If Val(page.Text) > 30 And PYEAR.Text = "Day" Then MsgBox("·« Ì„ﬂ‰  ﬂ «»… «ﬂÀ— „‰ 30 ÌÊ„") : Exit Sub
            If ptype.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— ‰Ê⁄ «·„—Ì÷") : Exit Sub
            If pmobile.Text = "0" And PMOB = 1 Then MsgBox("«·—Ã«¡ ﬂ «»… «·„Ê»Ì·") : Exit Sub
            If yrn = "=" Then YEARN.Text = esl_date.Value.Year

            '***************************** save add1ress***********************************************************************
            If pgover.Text <> "" Then
                dr.Close()
                cmd.CommandText = "select * from lgover where gover_name='" & Trim(pgover.Text) & "'"
                dr = cmd.ExecuteReader
                dr.Read()
                If dr.HasRows = False Then
                    dr.Close()
                    cmd.CommandText = "insert into lgover (gover_name) values ('" & Trim(pgover.Text) & "')"
                    cmd.ExecuteNonQuery()
                End If
                If pcity.Text <> "" Then
                    dr.Close()
                    cmd.CommandText = "select * from lcity where gover_name='" & pgover.Text & "' and city_name='" & pcity.Text & "'"
                    dr = cmd.ExecuteReader
                    dr.Read()
                    If dr.HasRows = False Then
                        dr.Close()
                        cmd.CommandText = "insert into lcity (gover_name,city_name) values ('" & Trim(pgover.Text) & "','" & Trim(pcity.Text) & "')"
                        cmd.ExecuteNonQuery()
                    End If
                    If pstreet.Text <> "" Then
                        dr.Close()
                        cmd.CommandText = "select * from lstreet where gover_name='" & pgover.Text & "' and city_name='" & pcity.Text & "' and street_name='" & pstreet.Text & "'"
                        dr = cmd.ExecuteReader
                        dr.Read()
                        If dr.HasRows = False Then
                            dr.Close()
                            cmd.CommandText = "insert into lstreet (gover_name,city_name,street_name) values ('" & Trim(pgover.Text) & "','" & Trim(pcity.Text) & "','" & Trim(pstreet.Text) & "')"
                            cmd.ExecuteNonQuery()
                        End If
                    End If
                End If
            End If
            '=========================claculate cash and bank=====================
            If FESLT = 1 Then
                esl_cash(1)
            End If
            '******************************************************************************************************
            '*******************************************save patien data************************************************

            PSAVE()
            '****************************************************************************************************

            Dim esl_time As String = Now.Hour & ":" & Now.Minute & ":" & Now.Second

            dr.Close()
            ACdr.Close()
            ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun>0  order by so"
            ACdr = ACcmd.ExecuteReader
            While ACdr.Read
                cmd.CommandText = "update lbill_test set rcv_date='" & ChangeFormat(rcv_date.Value) & "', TAKE='" & ACdr("TAKE") & "'  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and test_code='" & ACdr("test_code") & "'"
                cmd.ExecuteNonQuery()
            End While
            dr.Close()
            ACdr.Close()
            ACcmd.CommandText = "update test_sub INNER JOIN TEST_PRICE ON test_sub.mtest_name = TEST_PRICE.TEST_NAME set test_sub.qun=1 WHERE TEST_PRICE.QUN=1 and TEST_PRICE.anew=0 "
            ACcmd.ExecuteNonQuery()
            ACcmd.CommandText = "update test_sub INNER JOIN TEST_PRICE ON test_sub.mtest_name = TEST_PRICE.TEST_NAME set test_sub.RST=1 WHERE TEST_PRICE.QUN=1 and TEST_PRICE.anew=0 AND TEST_PRICE.RST=1 "
            ACcmd.ExecuteNonQuery()
            cmd.CommandText = "select * from lbill where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then
                esl_time = dr("esl_time")
                usr11 = dr("usr")
                shift11 = dr("shift")
                If (ChangeFormat(Now) <> ChangeFormat(esl_date.Value) Or ChangeFormat(esl_date.Value) <> ChangeFormat(dr("esl_date"))) And CTOTAL = 0 Then
                    MsgBox("·« Ì„ﬂ‰ﬂ  ⁄œÌ· «·“Ì«—… «·—Ã«¡ «·—ÃÊ⁄ «·Ï «·„œÌ—", MsgBoxStyle.Critical)
                    LLOG(" ⁄œÌ· “Ì«—…", esl_no.Text, " „Õ«Ê·…  ⁄œÌ· «·«Ì’«· ›Ï «·ÌÊ„ «· «·Ï   ⁄œÌ· «·«Ì’«·" & xpname, 0, bran.Text)
                    Exit Sub
                End If
                If mng = 0 And ChangeFormat(esl_date.Value) <> ChangeFormat(dr("esl_date")) And edt = 0 Then MsgBox("·« Ì„ﬂ‰  ⁄œÌ· «· «—ÌŒ", MsgBoxStyle.Critical) : Exit Sub
                If ED = 0 Then
                    LLOG(" ⁄œÌ· “Ì«—…", esl_no.Text, "  ⁄œÌ· «·«Ì’«·" & xpname, 0, bran.Text)
                    MsgBox("·« Ì„ﬂ‰ «· ⁄œÌ·")
                    FNEWV()
                    Exit Sub
                End If

                'Dim IDS As Integer = InputBox("«œŒ· —ﬁ„ «·«Ì’«·", "«·—Ã«¡  √ﬂÌœ —ﬁ„ «·«Ì’«· ·⁄œ„ «·Œÿ√")
                'If IDS <> Val(esl_no.Text) Then MsgBox("—ﬁ„ «·«Ì’«· €Ì— ’ÕÌÕ «⁄œ «·„Õ«Ê·…") : Exit Sub
                Dim x As String
                If msga = 1 Then
                    If lng = "AR" Then x = MsgBox(EDITAR & Environment.NewLine & "        " & xpname, MsgBoxStyle.YesNo) Else x = MsgBox(EDITEN & Environment.NewLine & "        " & xpname, MsgBoxStyle.YesNo)
                    If x = vbNo Then Exit Sub
                End If
                dr.Close()
                fnd = 1
                LLOG(" ⁄œÌ· “Ì«—…", esl_no.Text, XLOG, 1, bran.Text)
            Else
                LLOG("Õ›Ÿ “Ì«—…", esl_no.Text, XLOG, 1, bran.Text)
                Dim ss As Integer = 0
                If TOT.Text = 0 And DISS.Text = 0 Then  Else ss = Math.Round((Val(DISS.Text) / Val(TOT.Text)) * 100, 0)
                If ss > disss And ltblg = 0 Then MsgBox("ﬁÌ„… «·Œ’„ «ﬂ»— „‰ «·’·«ÕÌ…") : Exit Sub
                fnd = 0
                usr11 = USR
                shift11 = SHF
                If esl_no.Text = 0 Then fesl_no()
            End If
            Dim s As String = ""
            Dim nore As String = ""
            Dim norb As String = ""
            Dim unit As String = ""
            Dim re2 As String = ""
            Dim re1 As String = ""
            Dim sres As Integer = 0
            dr.Close()
            ACdr.Close()
            ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun>0   order by so"
            ACdr = ACcmd.ExecuteReader
            If ACdr.HasRows = False Then
                If lng = "AR" Then MsgBox("«·—Ã«¡ «Œ Ì«—  Õ·Ì· Ê«Õœ ⁄·Ï «·«ﬁ·") Else MsgBox("choose one test to complete")
                Exit Sub
            End If
            ACdr.Close()
            ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun>0 AND RST=0  order by so"
            ACdr = ACcmd.ExecuteReader
            If finals.Checked = True And edt = 0 Then
            Else
                Dim nprice As Double = 0
                While ACdr.Read
                    If ACdr("anew") = 0 Then
                        nore = 0
                        unit = " "
                        norb = 0
                        s = ""
                        sres = 0
                        dr2.Close()
                        cmd.CommandText = "INSERT INTO [lbill_test]([test_code],[test_name],[test_ar],[test_price],[tot1] ,[esl_no],[esl_date],[pname],[pcode],[page],[ptype],ref,res,SUB,CULT,rcv_date,RCV,DS,NOTE,NOTEN,norb,nore,take,gr_name,gr_code,s,p,GCODE,GNAME,tblg,tblgusr,tblgtime,prntn,lab,labprice,so,unit,RSO,HOMS,bar,dis_n,sres,uadd,uadddate,YEARN,TOT2,comment,bran,trl,pricep) VALUES ('" & ACdr("test_code") & "' ,'" & ACdr("test_name") & "' ,'" & ACdr("test_ar") & "' ,'" & ACdr("tot") & "' ,'" & ACdr("tot1") & "' ,'" & esl_no.Text & "','" & ChangeFormat(esl_date.Value) & "','" & xpname & "','" & pcode.Text & "','" & page.Text & "','" & ptype.Text & "','" & s & "','" & ACdr("res") & "','" & ACdr("SUB") & "' ,'" & ACdr("CULT") & "' ,'" & ChangeFormat(ACdr("rcv_date")) & "' ,'" & ACdr("RCV") & "','" & ACdr("DS") & "' ,'" & ACdr("NOTES") & "' ,'" & ACdr("NOTEN") & "' ,'" & norb & "' ,'" & nore & "','" & ACdr("take") & "','" & ACdr("gr_name") & "','" & ACdr("gr_code") & "' ,'" & ACdr("s") & "' ,'" & ACdr("p") & "' ,'" & ACdr("GCODE") & "','" & ACdr("GNAME") & "','" & ACdr("tblg") & "','" & ACdr("tblgusr") & "','" & ACdr("tblgtime") & "','" & ACdr("prntn") & "','" & ACdr("lab") & "' ,'" & ACdr("labprice") & "','" & ACdr("so") & "','" & unit & "','" & ACdr("Rso") & "' ,'" & ACdr("HOMS") & "' ,'" & ACdr("bar") & "','" & ACdr("dis_n") & "','" & sres & "','" & USR & "','" & ChangeFormatall(Now) & "','" & esl_date.Value.Year & "','" & ACdr("TOT2") & "','" & ACdr("NOTES") & "','" & bran.Text & "','" & Val(trl1.CheckState) & "','" & ACdr("pricep") & "' )"
                        cmd.ExecuteNonQuery()
                        If ACdr("cult") = 1 Then
                            cmd.CommandText = "INSERT INTO  [LBILL_CULT_DET]([test_name],[test_code],[esl_no],[NOTE],[SPECIMEN],[DIRECT_ FILM],[PUS_CELLS],[RBCs],[OTHERS],[CULTURE_CONDITIONS],[GROWTH_OF],[VAIBLE_COUNT],[COUNT_IS],[epithelial],[num],bran) VALUES  ('" & ACdr("test_name") & "','" & ACdr("test_code") & "','" & esl_no.Text & "',0,0,0,0,0,0,0,0,0,0,0,0,'" & bran.Text & "') "
                            cmd.ExecuteNonQuery()
                        End If
                    Else
                        cmd.CommandText = "update lbill_test set TOT2='" & ACdr("TOT2") & "',test_price='" & ACdr("tot") & "', tot1='" & ACdr("tot1") & "', pname='" & xpname & "', pcode='" & pcode.Text & "', page='" & page.Text & "', ptype='" & ptype.Text & "', lab='" & ACdr("lab") & "', TAKE='" & ACdr("TAKE") & "', labprice='" & ACdr("labprice") & "', homs='" & ACdr("homs") & "', bar='" & ACdr("bar") & "', dis_n='" & ACdr("dis_n") & "', tdel=0 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and test_code='" & ACdr("test_code") & "'"
                        cmd.ExecuteNonQuery()
                    End If
                    If scan1 = 1 Then If ACdr("LAB") = 2 Then urgant.Checked = False Else urgant.Checked = True
                End While
                dr.Close()
                ACdr.Close()
                ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun is null and anew=1 order by so"
                ACdr = ACcmd.ExecuteReader

                While ACdr.Read
                    cmd.CommandText = "update lbill_test set urem='" & USR & "',uremdate='" & ChangeFormatall(Now) & "',tdel=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and test_code='" & ACdr("test_code") & "'"
                    cmd.ExecuteNonQuery()
                End While
                dr.Close()
                ACdr.Close()
                ACcmd.CommandText = "SELECT * FROM TEST_sub where qun=1 AND RST=0 "
                ACdr = ACcmd.ExecuteReader
                While ACdr.Read
                    Dim ref1 As String = ""
                    unit = " "
                    s = ""
                    nore = 0
                    norb = 0
                    re1 = 0
                    re2 = 0
                    ref1 = ""
                    Dim seer As String = ACdr("res")
                    If subrrr = 1 Then seer = "-"
                    cmd.CommandText = "INSERT INTO [lbill_testsub]([test_code],[test_name] ,[esl_no],ref,res,[mtest_code],[mtest_name],RCV,DS,NOTE,NOTEN,norb,nore,ref1,q ,so,p,unit,rso,YEARN,re1,re2,bran) VALUES ('" & ACdr("test_code") & "' ,'" & ACdr("test_name") & "','" & esl_no.Text & "','" & s & "','" & seer & "','" & ACdr("mtest_code") & "' ,'" & ACdr("mtest_name") & "' ,'" & ACdr("RCV") & "' ,'" & ACdr("DS") & "','" & ACdr("NOTES") & "','" & ACdr("NOTEN") & "','" & norb & "','" & nore & "','" & ref1 & "','" & ACdr("q") & "','" & ACdr("so") & "','" & ACdr("p") & "','" & unit & "','" & ACdr("rso") & "','" & esl_date.Value.Year & "','" & re1 & "','" & re2 & "','" & bran.Text & "' )"
                    cmd.ExecuteNonQuery()

                End While
                '===========================UPDATE EXIT TEST=====================================
                ACdr.Close()
                ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun>0 AND RST=1  order by so"
                ACdr = ACcmd.ExecuteReader
                If finals.Checked = True And edt = 0 Then
                Else
                    nprice = 0
                    While ACdr.Read
                        If ACdr("anew") <> 0 Then
                            cmd.CommandText = "update lbill_test set TOT2='" & ACdr("TOT2") & "',test_price='" & ACdr("tot") & "', tot1='" & ACdr("tot1") & "', pname='" & xpname & "', pcode='" & pcode.Text & "', page='" & page.Text & "', ptype='" & ptype.Text & "', lab='" & ACdr("lab") & "', TAKE='" & ACdr("TAKE") & "', labprice='" & ACdr("labprice") & "', homs='" & ACdr("homs") & "', bar='" & ACdr("bar") & "', dis_n='" & ACdr("dis_n") & "', tdel=0 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and test_code='" & ACdr("test_code") & "'"
                            cmd.ExecuteNonQuery()
                        End If
                        If scan1 = 1 Then If ACdr("LAB") = 2 Then urgant.Checked = False Else urgant.Checked = True
                    End While
                End If

                '==============================================END EXIT TEST

                ACdr.Close()
                ACcmd.CommandText = "SELECT test_name,lab FROM TEST_PRICE WHERE qun>0 "
                ACdr = ACcmd.ExecuteReader
                test.Text = ""
                ptest.Text = ""
                While ACdr.Read
                    If test.Text = "" Then test.Text = ACdr("test_name") Else test.Text = test.Text & " +  " & ACdr("test_name")
                    If nulls(ACdr("lab")) = 1 Then ptest.Text = ptest.Text & " +  " & ACdr("test_name")
                End While
            End If




            '===================================save esl========
            esl_cash(2)

            '==================================end save else====
            If fnd = 1 Then
                cmd.CommandText = "DELETE from lbill where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
            Else
                If WSITE = 1 Then
                    guser()
                End If
            End If
            cmd.CommandText = "INSERT INTO lbill ([book_code],[book_name],[company_code],[company_name] ,[doc_code] ,[doc_name],[pcode],[pname],[ptype] ,[page],[pid],[depn],[esl_no],[esl_date],[reg_code],[reg_name],[esl_time],[crd_per] ,[crd_v],[cash_per],[cash_v],[bon],[pay] ,[rest],[tot],[nik],[test],diss,usr,shift,rcv_date,rcv,rcvv,rcvn,fastv,fastn,hrcvv,cfast,chrcv,branch_name,branch_code,pemail,dissn,notes,doc_per,PYEAR,ptot,ppay,prest,lab_code,lab_name,labtest,tnum,nnik,testpro,sprnt,rcv_time,ESLBILL,urgant,final,pinc,pcrd,pcanc,YEARN,bran,brans,SAMPL,SAMPLUSR,trl,pmobile,ucash,utc,utn,fs,labd,wuser,wpass,wid,WEB,BANK,NDOC,NCRD,dev) VALUES ('" & BOOK_CODE.Text & " ','" & BOOK_name.Text & "','" & COMPANY_CODE.Text & "','" & COMPANY_name.Text & "','" & DOC_CODE.Text & "','" & DOC_NAME.Text & "','" & pcode.Text & "','" & Trim(xpname) & "','" & ptype.Text & "','" & page.Text & "','" & pid.Text & "','" & depn.Text & "','" & esl_no.Text & "','" & ChangeFormat(esl_date.Value) & "','" & REG_CODE.Text & "','" & REG_name.Text & "','" & esl_time & "','" & crd_per.Text & "','" & crd_v.Text & "','" & cash_per.Text & "','" & cash_v.Text & "','" & bon.Text & "','" & PAY.Text & "','" & REST.Text & "','" & TOT.Text & "','" & PNIK.Text & "','" & test.Text & "','" & DISS.Text & "','" & usr11 & "','" & shift11 & "','" & ChangeFormat(rcv_date.Value) & "','" & Val(rcv.CheckState) & "','" & rcvv.Text & "','" & rcvn.Text & "','" & fastv.Text & "','" & TextBox5.Text & "','" & hrcvv.Text & "','" & Val(cfast.CheckState) & "','" & Val(chrcv.CheckState) & "','" & branch_name.Text & "','" & branch_code.Text & "','" & pemail.Text & "','" & dissn.Text & "','" & lnotes.Text & "','" & doc_per.Text & "','" & PYEAR.Text & "','" & pntot.Text & "','" & pnpay.Text & "','" & pnrest.Text & "','" & lab_code.Text & "','" & lab_name.Text & "','" & ptest.Text & "','" & tnum1.Text & "','" & nik.Text & "','" & testpro.Text & "','" & Val(sprnt1.Text) & "','" & rcv_time.Text & "','" & Val(ESLBILL.Text) & "','" & Val(urgant.CheckState) & "','" & Val(finals.CheckState) & "','" & pinc.Text & "','" & pcrd.Text & "','" & pcanc.Text & "','" & esl_date.Value.Year & "','" & bran.Text & "','" & bran.Text & esl_no.Text & "','" & Val(SAMPL.CheckState) & "','" & SAMPLUSR.Text & "','" & Val(trl1.CheckState) & "','" & pmobile.Text & "','" & Val(ucash.CheckState) & "','" & Val(utc.CheckState) & "','" & Val(utn.CheckState) & "','" & Val(fs.CheckState) & "','" & labd.Text & "','" & wuser.Text & "','" & wpass.Text & "','" & wid.Text & "','" & WEB.Text & "','" & BANK.Text & "','" & NDOC.Text & "','" & Val(NCRD.CheckState) & "','" & Val(dev.Text) & "') "
            cmd.ExecuteNonQuery()
            If clinic = 1 Then
                dr.Close()
                cmd.CommandText = "update lbill set ename='" & ENAME.Text & "', ecode='" & ECODE.Text & "',edocname='" & EDOCNAME.Text & "', edoccode='" & EDOCCODE.Text & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
            End If
            dr.Close()
            ''If fnd = 0 Then
            If IO.File.Exists(Application.StartupPath & "\esl\" & esl_no.Text) = False Then
                Dim W As Integer = Convert.ToInt32("150")
                Dim H As Integer = Convert.ToInt32("37")
                bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
                Dim type As BarcodeLib.TYPE = BarcodeLib.TYPE.UNSPECIFIED
                type = BarcodeLib.TYPE.CODE128
                bar1.IncludeLabel = True
                barco.Image = bar1.Encode(type, Me.bran.Text.Trim + Me.esl_no.Text.Trim(), W, H)
                IO.File.Delete(Application.StartupPath & "\esl\" & esl_no.Text)
                barco.Image.Save(Application.StartupPath & "\esl\" & esl_no.Text, System.Drawing.Imaging.ImageFormat.Jpeg)
            End If
            Dim oer As System.IO.FileStream
            Dim rer As IO.StreamReader
            oer = New IO.FileStream(Application.StartupPath & "\esl\" & esl_no.Text, IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
            rer = New IO.StreamReader(oer)
            Dim FileByteArrayr(oer.Length - 1) As Byte
            oer.Read(FileByteArrayr, 0, oer.Length)
            dr.Close()
            Dim AAAAA As String = ""
            dr.Close()
            dr.Close()
            cmd.CommandText = "delete from lbillemage where  ESL_NO='" & Val(esl_no.Text) & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "insert into lbillemage(esl_no,bran,yearn) values ('" & esl_no.Text & "','" & bran.Text & "','" & YEARN.Text & "')"
            cmd.ExecuteNonQuery()
            Dim Sql As String = "update  lbillemage set image = ? " & AAAAA & "  where  ESL_NO='" & Val(esl_no.Text) & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.CommandText = Sql
            cmd.Parameters.Clear()
            cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
            cmd.ExecuteNonQuery()
            'End If
            Dim aaa As Integer = 0
            aaa = esl_no.Text
            esl_no.Text = aaa
            If msga = 1 Then
                If lng = "AR" Then MsgBox(" „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" & " " & xpname) Else MsgBox("IT'S SAVED" & " " & xpname)
            End If
            fchk = 1
            ACdr.Close()
            ACcmd.CommandText = "UPDATE  TEST_PRICE SET RST=1"
            ACcmd.ExecuteNonQuery()
            NORBb()
            PNIK.Focus()
            LLOG("test save", esl_no.Text, pname.Text, 1, bran.Text)
            If onl = 1 Then pau()
        Catch ex As Exception
            Dim st1 As String = "SAVE NEW VISITE"
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
    Private Sub pphone_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs)
        If Not Char.IsNumber(e.KeyChar) AndAlso e.KeyChar <> ControlChars.Back Then
            e.Handled = True
        End If
    End Sub

    Private Sub GlassButton34_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq74.Click
        FDELV()
        


    End Sub


    Public Sub yy1()
        yy = "where " & b & ".esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        YYN = ""
        If RadioButton3.Checked = True Then
            yy = yy & "  " & " and  " & b & ".bdel=1"
            YYN = "bdel"
        Else
            yy = yy & "  " & " and  " & b & ".bdel=0"
            YYN = "bdel"

        End If

        If CTRL.Checked = True Then
            If trl1.Checked = True Then yy = yy & "  " & " and  " & b & ".trl='" & Val(trl1.CheckState) & "'" Else yy = yy & "  " & " and  " & b & ".trl='0'"
            YYN = "trl"
        End If
        YYN = "eslb"
        If cpnik.Checked = True Then
            yy = yy & "  " & " and lpatien.pnik='" & PNIK.Text & "'"
            YYR = YYR & " and pnik='" & PNIK.Text & "'"
            YYN = "pnik"
        End If
        If ch.Checked = True Then
            yy = yy & "  " & " and " & b & ".hrcvv>0"
            yy = yy & "  " & " and " & b & ".doc_name<>'0'"
            YYN = "hrcvv"
            YYR = YYR & " and hrcvv>0'"
        End If
        If clabd.Checked = True Then
            Dim DDF As String
            If labd.Text = "" Then DDF = ".labd<>'0'" Else DDF = ".labd LIKE'%" & labd.Text & "%'"
            yy = yy & "  " & " and " & b & DDF
            YYN = "hrcvv"
            YYR = YYR & DDF
        End If
        If ComboBox5.Text = "print" Then
            yy = yy & "  " & " and " & b & ".sprnt>0"
            YYR = YYR & " and sprnt>0'"
        End If

        If ComboBox5.Text = "not print" Then
            yy = yy & "  " & " and " & b & ".sprnt=0"
            YYR = YYR & " and sprnt=0'"
        End If
        If ADCODE.Items.Count > 0 Then
            yy = yy & "  " & " and " & b & ".QUN=1"
        End If
        If ffinal.Checked = True Then
            yy = yy & "  " & " and " & b & ".final=1"
            YYR = YYR & " and final=1'"
        End If
        If nfinal.Checked = True Then
            yy = yy & "  " & " and " & b & ".final=0"
        End If
        If ccc1.Checked = True Then
            yy = yy & "  " & " and " & b & ".rcv=1"
        End If
        If ccc3.Checked = True Then
            yy = yy & "  " & " and " & b & ".rcv=0"
        End If
        If cpcode.Checked = True Then
            yy = yy & "  " & " and lpatien.PNAME LIKE '%" & pname.Text & "%'"
            YYN = "pNAME"
            YYR = YYR & " and PNAME LIKE '%" & pname.Text & "%'"
        End If

        If CTESTCODE.Checked = True Then
            test.Text = test.Text.Replace("+", "%")
            yy = yy & "  " & " and " & b & ".TEST LIKE '%" & test.Text & "%'"
            YYN = "TEST"
        End If
        If utc.Checked = True Then
            yy = yy & "  " & " and utc='1'"
            YYN = "utc"
        End If
        If utn.Checked = True Then
            yy = yy & "  " & " and utn='" & Val(utn.CheckState) & "'"
            YYN = "utn"
        End If
        If NCRD.Checked = True Then
            yy = yy & "  " & " and NCRD='" & Val(NCRD.CheckState) & "'"
            YYN = "NCRD"
        End If
        If CBRAN.Checked = True Then
            yy = yy & "  " & " and " & b & ".bran ='" & bran.Text & "'"
            YYN = "bran"
        End If
        If cptype.Checked = True Then
            yy = yy & "  " & " and lpatien.ptype='" & ptype.Text & "'"
            YYN = "ptype"
            YYR = YYR & " and ptype='" & ptype.Text & "'"
        End If
        If cpbrith_date.Checked = True Then
            yy = yy & "  " & " and lpatien.pbrith_date='" & ChangeFormat(pbrith_date.Value) & "'"
            YYN = "pbrith_date"
            YYR = YYR & " and ptype='" & ptype.Text & "'"
        End If
        If cpage.Checked = True Then
            yy = yy & "  " & " and lpatien.page='" & page.Text & "'"
            YYN = "page"
            YYR = YYR & " and page='" & page.Text & "'"
        End If
        If cpphone.Checked = True Then
            yy = yy & "  " & " and lpatien.pphone='" & pphone.Text & "'"
            YYN = "pphone"
        End If
        If cpmobile.Checked = True Then
            yy = yy & "  " & " and lbill.pmobile like'%" & pmobile.Text & "%'"
            YYN = "pmobile"
        End If
        If cpgover.Checked = True Then
            yy = yy & "  " & " and lpatien.pgover='" & pgover.Text & "'"
            YYN = "pgover"
        End If
        If cpcity.Checked = True Then
            yy = yy & "  " & " and lpatien.pcity='" & pcity.Text & "'"
            YYN = "pcity"
        End If
        If cpstreet.Checked = True Then
            yy = yy & "  " & " and lpatien.pstreet='" & pstreet.Text & "'"
            YYN = "pstreet"
        End If
        If cpemail.Checked = True Then
            yy = yy & "  " & " and lpatien.pemail='" & pemail.Text & "'"
            YYN = "pemail"
        End If
        If cpid.Checked = True Then
            yy = yy & "  " & " and lpatien.pid like '%" & pid.Text & "%'"
            YYN = "pid"
            YYR = YYR & " and pid like '%" & pid.Text & "%'"
        End If

        If cppay.Checked = True Then
            yy = yy & "  " & " and " & b & ".ppay" & tppay.Text & "'" & pnpay.Text & "'"
            YYN = "ppay"
            YYR = YYR & " and ppay" & tppay.Text & "'" & pnpay.Text & "'"
        End If
        If cprest.Checked = True Then
            yy = yy & "  " & " and " & b & ".prest" & tprest.Text & "'" & pnrest.Text & "'"
            YYN = "prest"

        End If
        If clab_name.Checked = True Then
            yy = yy & "  " & " and " & b & ".lab_name='" & lab_name.Text & "'"
            YYN = "lab_name"
        End If

        If cbook_code.Checked = True Then
            yy = yy & "  " & " and " & b & ".BOOK_CODE='" & BOOK_CODE.Text & "'"
            YYN = "BOOK_NAME"
            YYR = YYR & " and BOOK_CODE='" & BOOK_CODE.Text & "'"
        End If

        If cf.Checked = True Then
            yy = yy & "  " & " and " & b & ".cfast='" & Val(cfast.CheckState) & "'"
            YYN = "cfast"
        End If
        If chrcv.Checked = True Then
            yy = yy & "  " & " and " & b & ".cfast='" & Val(chrcv.CheckState) & "'"
            YYN = "cfast"
        End If
        If crcv.Checked = True Then
            yy = yy & "  " & " and " & b & ".rcv='" & Val(rcv.CheckState) & "'"
            YYN = "rcv"
            YYR = YYR & " and rcv='" & Val(rcv.CheckState) & "'"
        End If
        If crcv_date.Checked = True Then
            yy = yy & "  " & " and " & b & ".rcv_date='" & ChangeFormat(rcv_date.Value) & "'"
            YYN = "rcv_date"
            YYR = YYR & " and rcv_date='" & ChangeFormat(rcv_date.Value) & "'"
        End If
        If CheckBox4.Checked = True Then
            yy = yy & "  " & " and " & b & ".rcvn='" & rcvn.Text & "'"
            YYN = "rcvn"
            YYR = YYR & "  and rcv_date='" & ChangeFormat(rcv_date.Value) & "'"
        End If
        If cCOMPANY_CODE.Checked = True Then
            yy = yy & "  " & " and " & b & ".COMPANY_CODE='" & COMPANY_CODE.Text & "'  and " & b & ".COMPANY_name='" & COMPANY_name.Text & "'"
            YYN = "COMPANY_NAME"
            YYR = YYR & "  and COMPANY_CODE='" & COMPANY_CODE.Text & "'"
        End If
        If CNDOC.Checked = True Then
            If NDOC.Text = "" Then yy = yy & "  " & " and " & b & ".NDOC<>'0'" Else yy = yy & "  " & " and " & b & ".NDOC LIKE'%" & NDOC.Text & "%'"
            YYN = "NDOC"
            YYR = YYR & "  and NDOC='" & NDOC.Text & "'"
        End If
        If cdoc_name.Checked = True Then
            If doc_admin = 1 Then yy = yy & "  " & " and " & b & ".DOC_NAME<>'0'" Else yy = yy & "  " & " and " & b & ".DOC_NAME='" & suser & "'"
            YYN = "DOC_NAME"
            If doc_admin = 1 Then YYR = YYR & "  and DOC_NAME<>'0'" Else YYR = YYR & "  and DOC_NAME='" & suser & "'"
        End If
        If cdepn.Checked = True Then
            yy = yy & "  " & " and " & b & ".depn='" & depn.Text & "'"
            YYN = "depn"
            YYR = YYR & "  and depn='" & depn.Text & "'"
        End If
        If cesl_no.Checked = True Then
            yy = yy & "  " & " and " & b & ".ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            YYN = "esl_no"
            YYR = YYR & "  and ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"

        End If
        If cesl_date.Checked = True Then
            yy = yy & "  " & " and " & b & ".esl_date='" & ChangeFormat(esl_date.Value) & "'"
            YYN = "esl_date"
            nxx = " and rest=0"
        End If
        If creg_code.Checked = True Then
            yy = yy & "  " & " and " & b & ".REG_name='" & REG_name.Text & "' and " & b & ".REG_code='" & REG_CODE.Text & "'"
            YYN = "REG_NAME"
            YYR = YYR & "  and REG_name='" & REG_name.Text & "'"
        End If
        If ccrd_per.Checked = True Then
            yy = yy & "  " & " and " & b & ".crd_per='" & crd_per.Text & "'"
            YYN = "crd_per"
            YYR = YYR & "  and crd_per='" & crd_per.Text & "'"
        End If
        If ccash_per.Checked = True Then
            yy = yy & "  " & " and " & b & ".cash_per" & dcash_per.Text & "'" & cash_per.Text & "'"
            YYN = "cash_per"
            YYR = YYR & "  and cash_per" & dcash_per.Text & "'" & cash_per.Text & "'"

        End If
        If cuser.Checked = True Then
            yy = yy & "  " & " and " & b & ".usr='" & user.Text & "'"
            YYN = "user"
            YYR = YYR & "  and usr='" & user.Text & "'"
        End If
        If cshift.Checked = True Then
            yy = yy & "  " & " and " & b & ".shift='" & shift.Text & "'"
            YYN = "shift"
            YYR = YYR & "  and shift='" & shift.Text & "'"

        End If
        If ccash_v.Checked = True Then
            yy = yy & "  " & " and " & b & ".cash_v='" & cash_v.Text & "'"
            YYN = "cash_v"
            YYR = YYR & "  and cash_v='" & cash_v.Text & "'"

        End If
        If ccrd_v.Checked = True Then
            yy = yy & "  " & " and " & b & ".crd_v='" & crd_v.Text & "'"
            YYN = "crd_v"
        End If
        If cbon.Checked = True Then
            yy = yy & "  " & " and " & b & ".bon>'0'"
            YYN = "bon"
            YYR = YYR & "  and bon>'0'"
        End If
        If CCODE.Checked = True Then
            yy = yy & "  " & " and " & b & ".esl_no>= '" & CODEB.Text & "' and  " & b & ".esl_no<='" & CODEE.Text & "'"
            YYR = YYR & "  and esl_no>= '" & CODEB.Text & "' and  " & b & "esl_no<='" & CODEE.Text & "'"

        End If

        If cpay.Checked = True Then
            yy = yy & "  " & " and " & b & ".PAY" & tpay.Text & "'" & PAY.Text & "'"
            YYN = "PAY"
            YYR = YYR & "  and PAY" & tpay.Text & "'" & PAY.Text & "'"

        End If
        If crest.Checked = True Then
            yy = yy & "  " & " and " & b & ".REST<>'0'"
            YYN = "REST"
            YYR = YYR & "  and REST<>'0'"
        End If
        If CBANK.Checked = True Then
            yy = yy & "  " & " and " & b & ".BANK<>'0'"
            YYN = "BANK"
            YYR = YYR & "  and BANK<>'0'"
        End If
        If ctot.Checked = True Then
            yy = yy & "  " & " and " & b & ".TOT" & dtot.Text & "'" & TOT.Text & "'"
            YYN = "TOT"
            YYR = YYR & "  and TOT" & dtot.Text & "'" & TOT.Text & "'"

        End If
        If ctest.Checked = True Then
            yy = yy & "  " & " and " & b & ".test like '%" & test.Text & "%'"
            YYN = "test"
            YYR = YYR & "  and test like '%" & test.Text & "%'"

        End If
        If ctest_name.Checked = True Then
            yy = yy & "  " & " and " & t & ".test_name='" & test_name.Text & "'"
            YYN = "test_name"
        End If
        If ctest_ar.Checked = True Then
            yy = yy & "  " & " and " & t & ".test_ar='" & test_ar.Text & "'"
            YYN = "test_ar"

        End If
        If cdiss.Checked = True Then
            yy = yy & "  " & " and " & b & ".diss='" & DISS.Text & "'"
            YYN = "DISS"
            YYR = YYR & "  and diss='" & DISS.Text & "'"

        End If

    End Sub


    Private Sub tell_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)
        SUMT()
    End Sub



    Private Sub DataGridView1_CellBeginEdit(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellCancelEventArgs) Handles DataGridView1.CellBeginEdit
        flng("EN")
        If tblg = 1 Then Exit Sub
        ref.Text = DataGridView1(("ref"), e.RowIndex).Value
        On Error Resume Next
        lrr.Text = DataGridView1(("DataGridViewTextBoxColumn2"), e.RowIndex).Value
        ppp.Text = DataGridView1(("DataGridViewTextBoxColumn1"), e.RowIndex).Value
        TextBox4.Text = 1

    End Sub

    Private Sub DataGridView1_CellEndEdit(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView1.CellEndEdit
        On Error Resume Next

        lrr.Text = DataGridView1(("DataGridViewTextBoxColumn2"), e.RowIndex).Value
        ppp.Text = DataGridView1(("DataGridViewTextBoxColumn1"), e.RowIndex).Value
        TextBox4.Text = 1
        dr.Close()
        cmd.CommandText = "select * from lhres where sh='" & lrr.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            FRC = testres.Select("TEST_NAME='" & ppp.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("RES") = dr("name")
                RC.EndEdit()
            End If
        End While
        fnor(1)

    End Sub

    Private Sub DataGridView1_CellMouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles DataGridView1.CellMouseClick
        On Error Resume Next
        funit.Text = DataGridView1(("unit"), e.RowIndex).Value
        ref.Text = DataGridView1(("ref"), e.RowIndex).Value
        rnore.Text = DataGridView1(("nore"), e.RowIndex).Value
        rnorb.Text = DataGridView1(("norb"), e.RowIndex).Value
        grc.Text = DataGridView1(("gr_name"), e.RowIndex).Value
        ntp.Text = DataGridView1(("gr_name"), e.RowIndex).Value
        ntg.Text = DataGridView1(("gname"), e.RowIndex).Value
        comment1.Text = DataGridView1(("COMMENT"), e.RowIndex).Value
        lrr.Text = DataGridView1(("DataGridViewTextBoxColumn2"), e.RowIndex).Value
        ppp.Text = DataGridView1(("DataGridViewTextBoxColumn1"), e.RowIndex).Value
        Ntest_CODE.Text = DataGridView1(("Column9"), e.RowIndex).Value
        Ntest_NAME.Text = DataGridView1(("DataGridViewTextBoxColumn1"), e.RowIndex).Value
        TextBox4.Text = 1
        If e.Button = Windows.Forms.MouseButtons.Right Then
            ress.Top = DataGridView1.GetCellDisplayRectangle(e.ColumnIndex, e.RowIndex, False).Bottom
            ress.Left = DataGridView1.GetCellDisplayRectangle(e.ColumnIndex, e.RowIndex, False).Left + DataGridView1.Left
            LRESS()
        End If
        fnor(1)
    End Sub

    Private Sub DataGridView1_CellMouseDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles DataGridView1.CellMouseDoubleClick
        'On Error Resume Next

        If e.RowIndex < 0 Or e.RowIndex = DataGridView1.RowCount Then Exit Sub
        If DataGridView1("sub", e.RowIndex).Value = 1 Then
            SAVERES(0, 1)
            subres.Clear()
            dr.Close()
            'cmd.CommandText = "update  lbill_testsub set st=0	WHERE ESL_NO ='" & esl_no.Text & "' and yearn ='" & YEARN.Text & "' and bran = '" & bran.Text & "'"
            'cmd.ExecuteNonQuery()
            cmdrsub.CommandType = CommandType.Text
            cmdrsub.CommandText = "SELECT * FROM lbill_testsub	WHERE ESL_NO ='" & esl_no.Text & "' and yearn ='" & YEARN.Text & "' and bran = '" & bran.Text & "'  and mtest_code='" & Ntest_CODE.Text & "' ORDER BY RSO"
            adsubres.SelectCommand = cmdrsub
            adsubres.Fill(DBS, "subres")
            subres = DBS.Tables("subres")
            DTEST_SUB.DataSource = subres
        End If
        If DataGridView1("cult", e.RowIndex).Value = 1 Then TabControl1.SelectTab(3)
    End Sub

    Private Sub DTEST_SUB_CellBeginEdit(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellCancelEventArgs) Handles DTEST_SUB.CellBeginEdit
        On Error Resume Next
        flng("EN")
        If tblg = 1 Then Exit Sub
        res1.Text = DTEST_SUB(("Column20"), e.RowIndex).Value
        ref.Text = DTEST_SUB(("ref"), e.RowIndex).Value
        ppp.Text = DTEST_SUB(("DataGridViewTextBoxColumn3"), e.RowIndex).Value
        lrr.Text = nulls(DTEST_SUB(("DataGridViewTextBoxColumn4"), e.RowIndex).Value)
        TextBox4.Text = 2
        mtest.Text = DTEST_SUB(("mtest_name"), e.RowIndex).Value
        mcode.Text = DTEST_SUB(("mtest_code"), e.RowIndex).Value
        FRC = testres.Select("test_code='" & mcode.Text & "'")
        If FRC.Length > 0 Then
            RC = FRC(0)
            RC.BeginEdit()
            RC("res") = 1
            RC.EndEdit()
        End If
        FRC = subres.Select("test_code='" & Val(Ntest_CODE.Text) & "'")
        If FRC.Length > 0 Then
            RC = FRC(0)
            RC.BeginEdit()
            If e.ColumnIndex = 4 Or e.ColumnIndex = 5 Then RC("RSV") = "--"
            RC.EndEdit()
        End If

    End Sub

    Private Sub DTEST_SUB_CellContentClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DTEST_SUB.CellContentClick
        On Error Resume Next
        res1.Text = DTEST_SUB(("Column20"), e.RowIndex).Value
        Ntest_CODE.Text = DTEST_SUB(("Column10"), e.RowIndex).Value
        Ntest_NAME.Text = DTEST_SUB(("DataGridViewTextBoxColumn3"), e.RowIndex).Value
        ppp.Text = DTEST_SUB(("DataGridViewTextBoxColumn3"), e.RowIndex).Value
        lrr.Text = DTEST_SUB(("DataGridViewTextBoxColumn4"), e.RowIndex).Value
        TextBox4.Text = 2
        mtest.Text = DTEST_SUB(("mtest_name"), e.RowIndex).Value
        mcode.Text = DTEST_SUB(("mtest_code"), e.RowIndex).Value

    End Sub

    Private Sub DTEST_SUB_CellDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DTEST_SUB.CellDoubleClick

    End Sub

    Private Sub DTEST_SUB_CellEndEdit(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DTEST_SUB.CellEndEdit
        On Error Resume Next
        res1.Text = DTEST_SUB(("Column20"), e.RowIndex).Value
        ppp.Text = DTEST_SUB(("DataGridViewTextBoxColumn3"), e.RowIndex).Value
        lrr.Text = nulls(DTEST_SUB(("DataGridViewTextBoxColumn4"), e.RowIndex).Value)

        TextBox4.Text = 2
        mtest.Text = DTEST_SUB(("mtest_name"), e.RowIndex).Value
        mcode.Text = DTEST_SUB(("mtest_code"), e.RowIndex).Value
        Dim nq As Integer = 0
        QQQ.Text = 0
        If subres.Rows(nq).Item("mtest_code") = "228" Then
            Dim ww As Double = 0
            FRC = subres.Select("test_code='150'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                QQQ.Text = nulls(Val(RC("res")))
            End If
            FRC = subres.Select("test_code='151'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                QQQ.Text = Val(QQQ.Text) + Val(RC("res"))
            End If
            FRC = subres.Select("test_code='153'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                QQQ.Text = Val(QQQ.Text) + Val(RC("res"))
            End If
            FRC = subres.Select("test_code='154'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                QQQ.Text = Val(QQQ.Text) + Val(RC("res"))
            End If
            FRC = subres.Select("test_code='155'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                QQQ.Text = Val(QQQ.Text) + Val(RC("res"))
            End If
            FRC = subres.Select("test_code='156'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                QQQ.Text = Val(QQQ.Text) + Val(RC("res"))
            End If
            cbc100.Text = " cbc  " & QQQ.Text & "  % "
            cbc100.ForeColor = Color.Black
            If QQQ.Text > 100 Then cbc100.BackColor = Color.Red : MsgBox("cbc out of 100%", MsgBoxStyle.Information)
            If QQQ.Text < 100 Then cbc100.BackColor = Color.FromArgb(backcolor1)
            If QQQ.Text = 100 Then cbc100.BackColor = Color.Green
            cbc100.Visible = True
        End If
        dr.Close()
        cmd.CommandText = "select * from lhres where sh='" & lrr.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            FRC = subres.Select("TEST_NAME='" & ppp.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("RES") = dr("name")
                RC.EndEdit()
            End If
        End While

        dr.Close()
        cmd.CommandText = "select * from lhres where sh='" & res1.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            FRC = subres.Select("TEST_NAME='" & ppp.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("RES1") = dr("name")
                RC.EndEdit()
            End If
        End While

        fnor(2)
    End Sub

    Private Sub DTEST_SUB_CellLeave(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DTEST_SUB.CellLeave

    End Sub

    Private Sub DTEST_SUB_CellMouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles DTEST_SUB.CellMouseClick
        On Error Resume Next
        res1.Text = DTEST_SUB(("Column20"), e.RowIndex).Value
        ref.Text = DTEST_SUB(("ref"), e.RowIndex).Value
        ppp.Text = DTEST_SUB(("DataGridViewTextBoxColumn3"), e.RowIndex).Value
        lrr.Text = nulls(DTEST_SUB(("DataGridViewTextBoxColumn4"), e.RowIndex).Value)
        Ntest_CODE.Text = DTEST_SUB(("Column10"), e.RowIndex).Value
        Ntest_NAME.Text = DTEST_SUB(("DataGridViewTextBoxColumn3"), e.RowIndex).Value
        comment1.Text = DTEST_SUB(("NOTE"), e.RowIndex).Value
        TextBox4.Text = 2
        mtest.Text = DTEST_SUB(("mtest_name"), e.RowIndex).Value
        mcode.Text = DTEST_SUB(("mtest_code"), e.RowIndex).Value
        If e.Button = Windows.Forms.MouseButtons.Right Then
            ress.Top = DTEST_SUB.GetCellDisplayRectangle(e.ColumnIndex, e.RowIndex, False).Bottom
            ress.Left = DTEST_SUB.GetCellDisplayRectangle(e.ColumnIndex, e.RowIndex, False).Left
            LRESS()
        End If
        Ntest_CODE.Text = DTEST_SUB(("Column10"), e.RowIndex).Value
        Ntest_NAME.Text = DTEST_SUB(("DataGridViewTextBoxColumn3"), e.RowIndex).Value
        ppp.Text = DTEST_SUB(("DataGridViewTextBoxColumn3"), e.RowIndex).Value
        lrr.Text = nulls(DTEST_SUB(("DataGridViewTextBoxColumn4"), e.RowIndex).Value)
        TextBox4.Text = 2
        mtest.Text = DTEST_SUB(("mtest_name"), e.RowIndex).Value
        mcode.Text = DTEST_SUB(("mtest_code"), e.RowIndex).Value
        ref.Text = DTEST_SUB(("ref"), e.RowIndex).Value
        rnore.Text = DTEST_SUB(("nore"), e.RowIndex).Value
        rnorb.Text = DTEST_SUB(("norb"), e.RowIndex).Value
        'MsgBox(mcode.Text)
    End Sub

    Private Sub DTEST_SUB_CellMouseDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles DTEST_SUB.CellMouseDoubleClick
        On Error Resume Next
        res1.Text = DTEST_SUB(("Column20"), e.RowIndex).Value
        ppp.Text = DTEST_SUB(("DataGridViewTextBoxColumn3"), e.RowIndex).Value
        lrr.Text = DTEST_SUB(("DataGridViewTextBoxColumn4"), e.RowIndex).Value
        TextBox4.Text = 2
        mtest.Text = DTEST_SUB(("mtest_name"), e.RowIndex).Value
        mcode.Text = DTEST_SUB(("mtest_code"), e.RowIndex).Value
        Ntest_CODE.Text = DTEST_SUB(("Column10"), e.RowIndex).Value
        Ntest_NAME.Text = DTEST_SUB(("DataGridViewTextBoxColumn3"), e.RowIndex).Value


    End Sub



    Private Sub TextBox2_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles MEDCINE_NAME.GotFocus
        flng("EN")
    End Sub

    Private Sub TextBox2_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles MEDCINE_NAME.KeyUp
        If tblg = 1 Then Exit Sub
        dr.Close() : cmd.CommandText = "select * from Lcult WHERE name LIKE '%" & MEDCINE_NAME.Text & "%'"
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        Dim v As Integer = 0
        While Not v = brpd.Columns.Count
            brpd.Columns(v).Visible = False
            v = v + 1
        End While
        brpd.Columns("NAME").Visible = True
        If lng = "AR" Then brpd.Columns("NAME").HeaderText = "«·œÊ«¡" Else brpd.Columns("NAME").HeaderText = "Drug"
        brpd.Columns("NAME").Width = 300
        tm = 5
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "select * from Lcult WHERE name ='" & MEDCINE_NAME.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = False Then Exit Sub
            MSHR.Text = dr("shr")
        End If
    End Sub

    Private Sub MEDCINE_NAME_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles MEDCINE_NAME.MouseHover
        llname = "MEDCINE_NAME"

    End Sub

    Private Sub TextBox2_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MEDCINE_NAME.TextChanged

    End Sub

    Private Sub TextBox3_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles MSHR.GotFocus
        flng("EN")
    End Sub

    Private Sub MSHR_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles MSHR.KeyDown
        If e.KeyCode = Keys.NumPad1 Then
            GlassButton9_Click(GlassButton9, e)
            MSHR.Text = ""
            MSHR.Focus()
        ElseIf e.KeyCode = Keys.NumPad2 Then
            GlassButton10_Click(GlassButton10, e)
            MSHR.Text = ""
            MSHR.Focus()
        ElseIf e.KeyCode = Keys.NumPad3 Then
            GlassButton11_Click(GlassButton11, e)
            MSHR.Text = ""
            MSHR.Focus()
        End If
    End Sub

    Private Sub MSHR_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles MSHR.KeyPress

    End Sub

    Private Sub TextBox3_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles MSHR.KeyUp
        If tblg = 1 Then Exit Sub
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "select * from Lcult WHERE shr ='" & MSHR.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = False Then Exit Sub
            MEDCINE_NAME.Text = dr("name")
        End If
        dr.Close() : cmd.CommandText = "select * from Lcult WHERE shr LIKE '%" & MSHR.Text & "%'"
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()

        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        Dim v As Integer = 0
        While Not v = brpd.Columns.Count
            brpd.Columns(v).Visible = False
            v = v + 1
        End While
        brpd.Columns("shr").Visible = True
        If lng = "AR" Then brpd.Columns("shr").HeaderText = "«·«”„ «·„Œ ’—" Else brpd.Columns("shr").HeaderText = "Shortcut NAME"
        brpd.Columns("shr").Width = 300
        tm = 6
    End Sub



    Private Sub GlassButton11_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton11.Click
        On Error Resume Next

        If cultd.Rows.Count <= 0 Then
            RC = cultd.NewRow
            RC("name3") = MEDCINE_NAME.Text
            cultd.Rows.Add(RC)
        Else
            FRC = cultd.Select("NAME1='" & MEDCINE_NAME.Text & "'")
            If FRC.Length > 0 Then MsgBox("Â–« «·œÊ«¡ „”Ã· „”»ﬁ«") : Exit Sub
            FRC = cultd.Select("NAME3='" & MEDCINE_NAME.Text & "'")
            If FRC.Length > 0 Then MsgBox("Â–« «·œÊ«¡ „”Ã· „”»ﬁ«") : Exit Sub
            FRC = cultd.Select("NAME2='" & MEDCINE_NAME.Text & "'")
            If FRC.Length > 0 Then MsgBox("Â–« «·œÊ«¡ „”Ã· „”»ﬁ«") : Exit Sub
            Dim n As Integer = 0
            While Not n = cultd.Rows.Count
                If cultd.Rows(n).RowState = DataRowState.Deleted Then GoTo mm
                If IsDBNull(cultd.Rows(n).Item("name3")) = True Then
                    cultd.Rows(n).BeginEdit()
                    cultd.Rows(n).Item("name3") = MEDCINE_NAME.Text
                    cultd.Rows(n).EndEdit()
                    Exit Sub
                ElseIf cultd.Rows(n).Item("name3") = "" Then
                    cultd.Rows(n).BeginEdit()
                    cultd.Rows(n).Item("name3") = MEDCINE_NAME.Text
                    cultd.Rows(n).EndEdit()
                End If
mm:
                n = n + 1
            End While
            RC = cultd.NewRow
            RC("name3") = MEDCINE_NAME.Text
            cultd.Rows.Add(RC)
        End If
    End Sub

    Private Sub GlassButton10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton10.Click
        On Error Resume Next

        If cultd.Rows.Count <= 0 Then
            RC = cultd.NewRow
            RC("name2") = MEDCINE_NAME.Text
            cultd.Rows.Add(RC)
        Else
            FRC = cultd.Select("NAME1='" & MEDCINE_NAME.Text & "'")
            If FRC.Length > 0 Then Me.Text = "Â–« «·œÊ«¡ „”Ã· „”»ﬁ«" : Exit Sub
            FRC = cultd.Select("NAME3='" & MEDCINE_NAME.Text & "'")
            If FRC.Length > 0 Then Me.Text = "Â–« «·œÊ«¡ „”Ã· „”»ﬁ«" : Exit Sub
            FRC = cultd.Select("NAME2='" & MEDCINE_NAME.Text & "'")
            If FRC.Length > 0 Then Me.Text = "Â–« «·œÊ«¡ „”Ã· „”»ﬁ«" : Exit Sub
            Dim n As Integer = 0
            While Not n = cultd.Rows.Count
                If IsDBNull(cultd.Rows(n).Item("name2")) = True Then
                    cultd.Rows(n).BeginEdit()
                    cultd.Rows(n).Item("name2") = MEDCINE_NAME.Text
                    cultd.Rows(n).EndEdit()
                    Exit Sub
                ElseIf cultd.Rows(n).Item("name2") = "" Then
                    cultd.Rows(n).BeginEdit()
                    cultd.Rows(n).Item("name2") = MEDCINE_NAME.Text
                    cultd.Rows(n).EndEdit()
                    Exit Sub
                End If
                n = n + 1
            End While
            RC = cultd.NewRow
            RC("name2") = MEDCINE_NAME.Text
            cultd.Rows.Add(RC)
        End If

    End Sub

    Private Sub GlassButton9_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton9.Click
        On Error Resume Next
        If cultd.Rows.Count <= 0 Then
            RC = cultd.NewRow
            RC("name1") = MEDCINE_NAME.Text
            cultd.Rows.Add(RC)
        Else
            FRC = cultd.Select("NAME1='" & MEDCINE_NAME.Text & "'")
            If FRC.Length > 0 Then MsgBox("Â–« «·œÊ«¡ „”Ã· „”»ﬁ«") : Exit Sub
            FRC = cultd.Select("NAME3='" & MEDCINE_NAME.Text & "'")
            If FRC.Length > 0 Then MsgBox("Â–« «·œÊ«¡ „”Ã· „”»ﬁ«") : Exit Sub
            FRC = cultd.Select("NAME2='" & MEDCINE_NAME.Text & "'")
            If FRC.Length > 0 Then MsgBox("Â–« «·œÊ«¡ „”Ã· „”»ﬁ«") : Exit Sub
            Dim n As Integer = 0
            While Not n = cultd.Rows.Count
                If cultd.Rows(n).RowState = DataRowState.Deleted Then GoTo mm

                If IsDBNull(cultd.Rows(n).Item("name1")) = True Then
                    cultd.Rows(n).BeginEdit()
                    cultd.Rows(n).Item("name1") = MEDCINE_NAME.Text
                    cultd.Rows(n).EndEdit()
                    Exit Sub
                ElseIf cultd.Rows(n).Item("name1") = "" Then
                    cultd.Rows(n).BeginEdit()
                    cultd.Rows(n).Item("name1") = MEDCINE_NAME.Text
                    cultd.Rows(n).EndEdit()
                End If
mm:
                n = n + 1
            End While
            RC = cultd.NewRow
            RC("name1") = MEDCINE_NAME.Text
            cultd.Rows.Add(RC)
        End If
    End Sub



    Private Sub DataGridView2_CellEndEdit(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView2.CellEndEdit

    End Sub



    Private Sub rtell_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)
        SUMT()
    End Sub

    Private Sub DataGridView4_CellMouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs)
        cmdb.DataAdapter = adsr
        adsr.Update(DBS, "sr")
    End Sub

    Private Sub TextBox5_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles rcvv.TextChanged
        SUMT()
    End Sub

    Private Sub ComboBox1_DropDown1(ByVal sender As Object, ByVal e As System.EventArgs) Handles rcvn.DropDown
        rcvn.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from lrcv "
        dr = cmd.ExecuteReader
        While dr.Read
            rcvn.Items.Add(dr("name"))
        End While
    End Sub

    Private Sub ComboBox1_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles rcvn.KeyDown
        Dim n As String
        If e.KeyCode = Keys.Enter Then
            n = ""
            If lng = "AR" Then n = MsgBox(SAVEAR, MsgBoxStyle.YesNo) Else n = MsgBox(SAVEEN, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
            dr.Close() : cmd.CommandText = "select MAx(tot) from lrcv "
            dr = cmd.ExecuteReader
            dr.Read()
            rcvv.Text = 1 + nulls(dr(0))

            If rcvn.Text = "" Then MsgBox("«·—Ã«¡ «· √ﬂœ „‰ «·»Ì«‰") : Exit Sub
            dr.Close()
            cmd.CommandText = "select * from lrcv where  name='" & rcvn.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows Then
                n = ""
                If lng = "AR" Then n = MsgBox(EDITAR, MsgBoxStyle.YesNo) Else n = MsgBox(EDITEN, MsgBoxStyle.YesNo)
                If n = vbNo Then Exit Sub
                dr.Close()
                cmd.CommandText = "delete from lrcv where  name='" & rcvn.Text & "'"
                cmd.ExecuteNonQuery()

            End If
            dr.Close()
            cmd.CommandText = "INSERT INTO   lrcv (NAME,tot) VALUES ('" & rcvn.Text & "','" & rcvv.Text & "')"
            cmd.ExecuteNonQuery()
        End If
        If e.KeyCode = Keys.Delete Then
            If lng = "AR" Then n = MsgBox(DELAR, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN, MsgBoxStyle.YesNo)
            If IsNumeric(rcvv.Text) = False Then MsgBox("«·—Ã«¡ «· √ﬂœ „‰ «·ﬂÊœ") : Exit Sub
            If rcvn.Text = "" Then MsgBox("«·—Ã«¡ «· √ﬂœ „‰ «·»Ì«‰") : Exit Sub
            dr.Close()
            cmd.CommandText = "select * from lrcv where  name='" & rcvn.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows Then
                dr.Close()
                cmd.CommandText = "delete from lrcv where  name='" & rcvn.Text & "'"
                cmd.ExecuteNonQuery()

            End If

        End If
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles rcvn.SelectedIndexChanged
        dr.Close()
        cmd.CommandText = "select * from lrcv  where name='" & rcvn.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        rcvv.Text = dr("tot")
    End Sub

    Private Sub cfast_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cfast.CheckedChanged
        If cfast.CheckState = CheckState.Checked Then
            fastv.Text = fast
        Else
            fastv.Text = 0
        End If
    End Sub


    Private Sub chrcv_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chrcv.CheckedChanged
        If chrcv.CheckState = CheckState.Checked Then
            hrcvv.Text = hrcv
        Else
            hrcvv.Text = 0
        End If
    End Sub

    Private Sub fastv_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles fastv.TextChanged
        SUMT()
    End Sub

    Private Sub hrcvv_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles hrcvv.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        hrcvv.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "hrcvv")
    End Sub

    Private Sub hrcvv_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles hrcvv.MouseHover
        llname = "hrcvv"

    End Sub

    Private Sub hrcvv_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles hrcvv.TextChanged
        SUMT()
    End Sub



    Private Sub TextBox5_TextChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox5.TextChanged
        fastv.Text = Val(TextBox5.Text) * Val(TOT.Text) * 0.01
    End Sub

    Private Sub CustomizeToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CustomizeToolStripMenuItem.Click
        FNEWV()
    End Sub

    

   

   
    Public Sub prntesl()
        If prnt = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("ÿ»«⁄…", esl_no.Text, " ÿ»«⁄…  «·«Ì’«· " & pname.Text, 0, bran.Text)
            Exit Sub
        End If
        Dim x As String = MsgBox("Â·  —Ìœ «·ÿ»«⁄… „»«‘—…", MsgBoxStyle.YesNo)
        If esl_no.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— «·«Ì’«·") : Exit Sub
        dr.Close() : cmd.CommandText = "SELECT  * from v_lab where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'and tdel=0"
        adesl.SelectCommand = cmd
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        DBS.Tables("esl").Clear()
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        brpd.DataSource = esl
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & rptp.Text & "\esl.rpt")
        oj.Database.Tables(0).SetDataSource(esl)
        oj.SetParameterValue("a", esla)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        If x = vbNo Then rp.Show() : rp.Focus() Else oj.PrintToPrinter(1, False, 0, 0)
        LLOG("ÿ»«⁄…", esl_no.Text, " ÿ»«⁄…  «·«Ì’«·" & pname.Text, 1, bran.Text)

    End Sub
    Public Sub f3(ByVal asm As String)
        Try
            If branch_code.Text <> brans And lrcv = 0 Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·›—⁄" : Exit Sub
            If rpt = 0 Then MsgBox("·«  ÊÃœ ’·«ÕÌ…") : Exit Sub
            If ADCODE.Items.Count > 0 Then
                dr.Close()
                cmd.CommandText = "UPDATE LBILL SET QUN='0' WHERE QUN='1'"
                cmd.ExecuteNonQuery()
                Dim NC As Integer = 0
                While Not NC = ADCODE.Items.Count
                    cmd.CommandText = "UPDATE LBILL SET QUN=1 WHERE ESL_NO='" & ADCODE.Items(NC) & "' AND BRAN='" & bran.Text & "' AND YEARN='" & YEARN.Text & "'"
                    cmd.ExecuteNonQuery()
                    NC += 1
                End While
            End If
            dr.Close()
            cmd.CommandText = "UPDATE lbill SET lbill.COMS = lcompany.COMS FROM lbill INNER JOIN lcompany ON lbill.COMPANY_CODE = lcompany.code AND lbill.COMPANY_NAME = lcompany.NAME WHERE  LBILL.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'   "
            cmd.ExecuteNonQuery()

            YYR = ""
            b = ""
            t = ""
            nxx = ""
            b = "lbill"
            t = "" & t & ""
            dr.Close()
            cmd.CommandText = "select * from lcompany where inc>0"
            dr = cmd.ExecuteReader
            While dr.Read
                dr1.Close()
                cmd1.CommandText = "update lbill set pinc=1 where company_code='" & dr("code") & "'"
                cmd1.ExecuteNonQuery()
            End While
            dr.Close()
            If rpt = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—", 0, bran.Text)
                Exit Sub
            End If
            Dim rrr As Process = Process.Start(Application.StartupPath & "\bar.exe")
            yy1()
            Dim n As Integer = 0
            ss = ""
            ACdr.Close()
            ACcmd.CommandText = "select * from srh where sort>0 order by sort"
            ACdr = ACcmd.ExecuteReader
            While ACdr.Read
                If ss = "" Then ss = " order by " & ACdr("fld") & " " Else ss = ss & " , " & ACdr("fld") & " "
            End While
            If ctest_name.Checked = True Or ctest_ar.Checked = True Then
                dr.Close() : cmd.CommandText = "SELECT     " & b & ".* FROM " & b & " INNER JOIN  LPATIEN ON " & b & ".pcode = LPATIEN.pcode INNER JOIN  " & t & " ON " & b & ".esl_no = " & t & ".esl_no " & yy & ss
            Else
                dr.Close() : cmd.CommandText = "SELECT     " & b & ".* FROM " & b & " INNER JOIN  LPATIEN ON " & b & ".pcode = LPATIEN.pcode  " & yy & ss
            End If
            Dim xaa As String = ""
            If trl1.Checked = True Then xaa = "and  trl='1'" Else xaa = " and  trl='0'"

            adF31.SelectCommand = cmd
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            DBS.Tables("F31").Clear()
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            dr.Close()
            cmd.CommandText = "select * from branch where name='" & branch_name.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read()
                If dr("trl") > 0 And trl1.Checked = False And asm = 1 Then
                    RC = F31.NewRow
                    RC("usr") = "  "
                    RC("test") = "----------"
                    RC("eslb") = dr("trl")
                    RC("bon") = 0
                    RC("esl_no") = 0
                    RC("pname") = "»«ﬁÏ „‰ ﬁ»·"
                    RC("pay") = 0
                    RC("rest") = 0
                    RC("ptot") = 0
                    RC("company_name") = 0
                    F31.Rows.Add(RC)
                End If
            End While
            If RadioButton2.Checked = True Then
                b = "lbill"
                t = "lbill_test"
                yy1()
                If ctest_name.Checked = True Or ctest_ar.Checked = True Then
                    dr.Close() : cmd.CommandText = "SELECT     " & b & ".* FROM " & b & " INNER JOIN  LPATIEN ON " & b & ".pcode = LPATIEN.pcode INNER JOIN  " & t & " ON " & b & ".esl_no = " & t & ".esl_no " & yy & ss
                Else
                    dr.Close() : cmd.CommandText = "SELECT     " & b & ".* FROM " & b & " INNER JOIN  LPATIEN ON " & b & ".pcode = LPATIEN.pcode  " & yy & ss
                End If
                adF31.SelectCommand = cmd
                adF31.Fill(DBS, "F31")
                F31 = DBS.Tables("F31")
            End If
            F31D.DataSource = F31
            tm = 4

            v = 0
            If FESLT = 1 Then
                While Not v = F31.Rows.Count
                    dr.Close()
                    cmd.CommandText = "select sum(tot) from lbill_esl where yearn='" & YEARN.Text & "' and esl_no='" & F31.Rows(v).Item("esl_no") & "' and rest=0 and bran='" & F31.Rows(v).Item("bran") & "'"
                    dr = cmd.ExecuteReader
                    dr.Read()
                    If dr.HasRows Then
                        If IsDBNull(dr(0)) = False Then
                            RC = F31.Rows(v)
                            RC.BeginEdit()
                            RC("eslb") = dr(0)
                            RC.EndEdit()
                        End If
                    End If
                    v = v + 1
                End While
                If ComboBox5.Text = "rest" Then
                    dr.Close()
                    Dim tas As String = ""
                    Dim co As String = ""
                    If CBRAN.Checked = True Then tas = " and bran='" & bran.Text & "'"
                    If cCOMPANY_CODE.Checked = True Then co = " and company_code='" & COMPANY_CODE.Text & "'"
                    If creg_code.Checked = True Then co = co & " and reg_code='" & REG_CODE.Text & "'"
                    If cshift.Checked = True Then co = co & " and shift='" & shift.Text & "'"
                    Dim aa2 As String = ""
                    If cesl_date.Checked = True Then aa2 = " and sdate='" & ChangeFormat(esl_date.Value) & "'" Else aa2 = "and  sdate between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
                    cmd.CommandText = "select * from v_esl where rest=1 " & co & xaa & aa2 & tas & " order by sdate "
                    dr = cmd.ExecuteReader
                    While dr.Read()
                        RC = F31.NewRow
                        RC("usr") = dr("restusr")
                        If IsDBNull(dr("restdate")) = False Then RC("esl_time") = ChangeFormatall(dr("restdate"))
                        RC("sprnt") = dr("sprnt")
                        RC("test") = dr("test")
                        If dr("tot1") > 0 Then RC("eslb") = dr("tot1") Else RC("eslb") = 0
                        If dr("erbank") > 0 Then RC("bank") = dr("erbank") Else RC("bank") = 0
                        RC("bon") = 0
                        RC("esl_no") = dr("esl_no")
                        RC("COMS") = dr("COMS")
                        RC("esl_date") = dr("sdate")
                        RC("pname") = "»«ﬁÏ  " & dr("pname")
                        RC("pay") = dr("tot1")
                        RC("rest") = 0
                        RC("ptot") = 0
                        RC("company_name") = dr("company_name")
                        RC("reg_name") = dr("reg_name")
                        F31.Rows.Add(RC)
                    End While
                End If
            End If
            Dim yys As String = ""
            If cesl_date.Checked = False Then yys = " date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" Else yys = " date1 ='" & ChangeFormat(esl_date.Value) & "'"
            If EXPENS.Checked = True And FESLT = 1 And asm = 1 Then
                dr.Close()
                cmd.CommandText = "select * from lcash where sub_code=4 and save_code='" & saven & "' and " & yys & "   " & xaa & " and branch_name='" & branch_name.Text & "'"
                dr = cmd.ExecuteReader
                While dr.Read()
                    RC = F31.NewRow
                    RC("usr") = dr("usr")
                    RC("test") = "----------"
                    RC("eslb") = -dr("cash")
                    RC("bon") = 0
                    RC("esl_no") = 0
                    RC("esl_date") = dr("date1")
                    RC("pname") = dr("notse")
                    RC("pay") = -dr("cash")
                    RC("rest") = 0
                    RC("ptot") = 0
                    RC("company_name") = dr("sub_name")
                    F31.Rows.Add(RC)
                End While

                dr.Close()
                cmd.CommandText = "select * from lcash where sub_code=9 and save_code='" & saven & "' and  " & yys & "   " & xaa & " and branch_name='" & branch_name.Text & "'"
                dr = cmd.ExecuteReader
                While dr.Read()
                    RC = F31.NewRow
                    RC("usr") = dr("usr")
                    RC("test") = "----------"
                    RC("eslb") = -dr("cash")
                    RC("bon") = 0
                    RC("esl_no") = 0
                    RC("esl_date") = dr("date1")
                    RC("pname") = dr("notse")
                    RC("pay") = -dr("cash")
                    RC("rest") = 0
                    RC("ptot") = 0
                    RC("company_name") = dr("sub_name")
                    F31.Rows.Add(RC)
                End While
                dr.Close()
                cmd.CommandText = "select * from lcash where sub_code=11 and " & yys & "   " & xaa & " and branch_name='" & branch_name.Text & "' and save_code='" & saven & "'"
                dr = cmd.ExecuteReader
                While dr.Read()
                    RC = F31.NewRow
                    RC("usr") = dr("usr")
                    RC("test") = "----------"
                    RC("eslb") = -dr("cash")
                    RC("bon") = 0
                    RC("esl_no") = 0
                    RC("esl_date") = dr("date1")
                    RC("pname") = dr("notse")
                    RC("pay") = -dr("cash")
                    RC("rest") = 0
                    RC("ptot") = 0
                    RC("company_name") = dr("sub_name")
                    F31.Rows.Add(RC)
                End While
                RC = F31.NewRow
                RC("usr") = ""
                RC("test") = "----------"
                RC("eslb") = 0
                RC("bon") = 0
                RC("esl_no") = 1
                'RC("esl_date") = ""
                RC("pname") = ""
                RC("pay") = 0
                RC("rest") = 0
                RC("ptot") = 0
                RC("company_name") = ""
                F31.Rows.Add(RC)
            End If
            TabControl2.SelectTab(1)
            Dim x As Integer = 0
            Dim asdm As Double = 0
            While Not x = F31.Rows.Count
                asdm = asdm + Val(nulls(F31.Rows(x).Item("eslb")) - nulls(F31.Rows(x).Item("ptot")))
                x = x + 1
            End While
            RSD.Text = asdm
            'MsgBox(asdm)

            If RP1.Checked = True Then
                Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
                If asm = 1 Then
                    If rpt = 0 Then MsgBox("·«  ÊÃœ ’·«ÕÌ…") : Exit Sub
                    If RadioButton2.Checked = True Then oj.Load(Application.StartupPath & "\bill edit.rpt") Else oj.Load(Application.StartupPath & "\bill.rpt")
                ElseIf asm = 0 Then
                    dr.Close()
                    cmd.CommandText = "select * from lcompany where code='" & REG_CODE.Text & "'"
                    dr = cmd.ExecuteReader
                    dr.Read()
                    x = 0
                    While Not x = F31.Rows.Count
                        RC = F31.Rows(x)
                        RC.BeginEdit()
                        RC("doc_per") = dr("add1")
                        RC.EndEdit()
                        x = x + 1
                    End While
                    oj.Load(Application.StartupPath & "\doc pers.rpt")
                ElseIf asm = 4 Then
                    If lcult1 = 0 Then oj.SetParameterValue("5", 0) Else oj.SetParameterValue("5", 0)
                    oj.Load(Application.StartupPath & "\bill.rpt")
                ElseIf asm = 6 Then
                    oj.Load(Application.StartupPath & "\doc1.rpt")
                ElseIf asm = 9 Then
                    oj.Load(Application.StartupPath & "\docS.rpt")
                ElseIf asm = 10 Then
                    oj.Load(Application.StartupPath & "\labd.rpt")
                ElseIf asm = 14 Then
                    oj.Load(Application.StartupPath & "\labd1.rpt")
                ElseIf asm = 7 Then
                    oj.Load(Application.StartupPath & "\doc.rpt")
                ElseIf asm = 5 Then
                    oj.Load(Application.StartupPath & "\billm.rpt")
                ElseIf asm = 11 Then
                    oj.Load(Application.StartupPath & "\billy.rpt")
                ElseIf asm = 12 Then
                    oj.Load(Application.StartupPath & "\rcv.rpt")
                ElseIf asm = 13 Then
                    oj.Load(Application.StartupPath & "\doc2.rpt")
                End If
                oj.Database.Tables(0).SetDataSource(F31)
                oj.SetParameterValue("1", " ﬁ—Ì— «· ›’Ì·Ï Œ·«· › —… „‰ ")
                oj.SetParameterValue("2", d1.Value)
                oj.SetParameterValue("3", d2.Value)
                If ls = 0 Then oj.SetParameterValue("5", "0") Else oj.SetParameterValue("5", "1")
                If mng = 1 Or (cesl_date.Checked = True And lp = 1) Then oj.SetParameterValue("118", 1) Else oj.SetParameterValue("118", 0)
                If asm = 4 Then
                    IO.File.Delete(Application.StartupPath & "\test\day.pdf")
                    oj.ExportToDisk(CrystalDecisions.[Shared].ExportFormatType.PortableDocFormat, Application.StartupPath & "\test\day.pdf")
                    ACdr.Close()
                    ACcmd.CommandText = "insert into email(name) values ('\test\day.pdf')"
                    ACcmd.ExecuteNonQuery()
                Else
                    rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
                    rp.Show()
                    rp.Focus()
                End If
            End If
            fnor(3)
            F31DTG()
            rrr.Kill()
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—", 1, bran.Text)
        Catch ex As Exception

            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','f3','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try

    End Sub
    Public Sub F31DTG()
        Dim v As Integer = 0
        While Not v = F31D.Columns.Count
            F31D.Columns(v).Visible = False
            v = v + 1
        End While
        F31D.Columns("choice").Visible = True
        F31D.Columns("esl_date").Visible = True
        F31D.Columns("esl_date").Width = 50
        If lng = "AR" Then F31D.Columns("esl_date").HeaderText = "«· «—ÌŒ" Else F31D.Columns("esl_date").HeaderText = "DATE"
        F31D.Columns("esl_no").Visible = True
        F31D.Columns("branch_name").DisplayIndex = 1
        F31D.Columns("branch_name").Width = 70
        F31D.Columns("branch_name").HeaderText = "branch"
        F31D.Columns("branch_name").Visible = True
        If lng = "AR" Then F31D.Columns("esl_no").HeaderText = "«·«Ì’«·" Else F31D.Columns("esl_no").HeaderText = "BILL NO"
        F31D.Columns("esl_no").Width = 50
        F31D.Columns("pname").Visible = True
        If lng = "AR" Then F31D.Columns("pname").HeaderText = "«·Õ«·…" Else F31D.Columns("pname").HeaderText = "Patient"
        F31D.Columns("tot").Visible = True
        F31D.Columns("tot").Width = 50
        If lng = "AR" Then F31D.Columns("tot").HeaderText = "«·«Ã„«·Ï" Else F31D.Columns("tot").HeaderText = "TOTAL"
        F31D.Columns("test").Visible = True
        If lng = "AR" Then F31D.Columns("test").HeaderText = "«· Õ·Ì·" Else F31D.Columns("test").HeaderText = "TEST"
        F31D.Columns("company_name").Visible = True
        If lng = "AR" Then F31D.Columns("company_name").HeaderText = "ref doc" Else F31D.Columns("company_name").HeaderText = "ref doc"
        TabControl2.SelectTab(1)
    End Sub


    Private Sub »‰«¡«·‰Ÿ«„ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles »‰«¡«·‰Ÿ«„ToolStripMenuItem.Click
        If lbld1 = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("› Õ", 0, "› Õ »‰«¡ «·‰Ÿ«„", 0, bran.Text)
            Exit Sub
        End If
        LBLD.fcolor.Text = fcolor
        LBLD.bColor.Text = bcolor
        LBLD.backcolor1.Text = backcolor1
        LBLD.MdiParent = Form1
        LBLD.Show()
        LLOG("› Õ", 0, "› Õ »‰«¡ «·‰Ÿ«„", 1, bran.Text)

    End Sub

    Private Sub rcv_date_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles rcv_date.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        rcv_date.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "rcv_date")
    End Sub


    Private Sub rcv_date_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles rcv_date.KeyUp
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub rcv_date_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles rcv_date.MouseHover
        llname = "rcv_date"

    End Sub



    Private Sub rcv_date_ValueChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles rcv_date.ValueChanged
        ACdr.Close()
        ACcmd.CommandText = "update test_price set rcv_date='" & ChangeFormat(rcv_date.Value) & "'"
        ACcmd.ExecuteNonQuery()
        fprice(0)
    End Sub



    Private Sub GlassButton22_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton22.Click
        dr.Close()
        cmd.CommandText = "update lbill_test set qun=1 WHERE ESL_NO='" & Val(esl_no.Text) & "'"
        cmd.ExecuteNonQuery()

        dr.Close()
        cmd.CommandText = "update Lbill_TESTSUB set qun=1 WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND MTEST_NAME='" & ppp.Text & "'  "
        cmd.ExecuteNonQuery()
        fres()
    End Sub

    Private Sub GlassButton23_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton23.Click
        SAVERES(0, 0)
        dr.Close()
        cmd.CommandText = "update lbill_test set qun=10 WHERE ESL_NO='" & Val(esl_no.Text) & "' and qun=0"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill_test set qun=10 WHERE ESL_NO='" & Val(esl_no.Text) & "' and qun IS NULL "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill_test set qun=0 WHERE ESL_NO='" & Val(esl_no.Text) & "' and qun=1"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill_test set qun=1 WHERE ESL_NO='" & Val(esl_no.Text) & "' and qun=10"
        cmd.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "update Lbill_TESTSUB set qun=10 WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND MTEST_NAME='" & ppp.Text & "' and qun=0"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update Lbill_TESTSUB set qun=10 WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND MTEST_NAME='" & ppp.Text & "' and qun IS NULL "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update Lbill_TESTSUB set qun=0 WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND MTEST_NAME='" & ppp.Text & "' and qun=1"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update Lbill_TESTSUB set qun=1 WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND MTEST_NAME='" & ppp.Text & "' and qun=10"
        cmd.ExecuteNonQuery()
        fres()
    End Sub

    Private Sub brpd_CellMouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles brpd.CellMouseClick

    End Sub


    Private Sub brpd_CellMouseDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles brpd.CellMouseDoubleClick
        On Error Resume Next
        If e.RowIndex < 0 Then Exit Sub
        If tm = 1 Then
            PNIK.Text = brpd(("PNIK"), e.RowIndex).Value
            pname.Text = brpd(("pname"), e.RowIndex).Value
            pcode.Text = brpd(("pcode"), e.RowIndex).Value
            ptype.Text = brpd(("ptype"), e.RowIndex).Value
            pbrith_date.Value = brpd(("pbrith_date"), e.RowIndex).Value
            Dim d As Date = Now
            page.Text = d.Year - pbrith_date.Value.Year
            pphone.Text = brpd(("pphone"), e.RowIndex).Value
            pmobile.Text = brpd(("pmobile"), e.RowIndex).Value
            pgover.Text = brpd(("pgover"), e.RowIndex).Value
            pcity.Text = brpd(("pcity"), e.RowIndex).Value
            pstreet.Text = brpd(("pstreet"), e.RowIndex).Value
            pemail.Text = brpd(("pemail"), e.RowIndex).Value
            pid.Text = brpd(("pid"), e.RowIndex).Value
            BOOK_CODE.Text = brpd(("book_code"), e.RowIndex).Value
            BOOK_name.Text = brpd(("book_name"), e.RowIndex).Value
            COMPANY_CODE.Text = brpd(("company_code"), e.RowIndex).Value
            COMPANY_name.Text = brpd(("company_name"), e.RowIndex).Value
            REG_CODE.Text = brpd(("reg_code"), e.RowIndex).Value
            REG_name.Text = brpd(("reg_name"), e.RowIndex).Value
        ElseIf tm = 2 Then
            REG_CODE.Text = brpd(("CODE"), e.RowIndex).Value
            REG_name.Text = brpd(("name"), e.RowIndex).Value
        ElseIf tm = 3 Then
            COMPANY_name.Text = brpd(("name"), e.RowIndex).Value
            fcompany(1)
        ElseIf tm = 4 Then
            dr.Close()
            YEARN.Text = brpd(("yearn"), e.RowIndex).Value
            bran.Text = brpd(("bran"), e.RowIndex).Value
            esl_no.Text = brpd(("esl_no"), e.RowIndex).Value
            esl_no.Text = brpd(("esl_no"), e.RowIndex).Value
            fesl(0, 0)
        ElseIf tm = 5 Then
            MEDCINE_NAME.Text = brpd(("name"), e.RowIndex).Value
        ElseIf tm = 6 Then
            MEDCINE_NAME.Text = brpd(("name"), e.RowIndex).Value
        ElseIf tm = 7 Then
            SPECIMEN.Text = brpd(("name"), e.RowIndex).Value
        ElseIf tm = 8 Then
            Growth_of.Text = brpd(("name"), e.RowIndex).Value
        ElseIf tm = 9 Then
            Ntest_CODE.Text = brpd(("test_CODE"), e.RowIndex).Value
            Ntest_NAME.Text = brpd(("test_NAME"), e.RowIndex).Value
            cmdb.DataAdapter = adtemp
            adtemp.Update(DBS, "temp")
            LLOG(" ⁄œÌ·", 0, "edit normal test " & Ntest_NAME.Text, 1, bran.Text)
        ElseIf tm = 15 Then
            COMPANY_name.Text = brpd(("COMPANY_name"), e.RowIndex).Value
        ElseIf tm = 10 Then
            main_name.Text = brpd(("main_name"), e.RowIndex).Value
            main_code.Text = brpd(("main_code"), e.RowIndex).Value
            sub_code.Text = brpd(("sub_code"), e.RowIndex).Value
            sub_name.Text = brpd(("sub_name"), e.RowIndex).Value
            branch_code.Text = brpd(("branch_code"), e.RowIndex).Value
            branch_name.Text = brpd(("branch_name"), e.RowIndex).Value
            cash.Text = brpd(("cash"), e.RowIndex).Value
            crd.Text = brpd(("crd"), e.RowIndex).Value
            time1.Text = brpd(("time1"), e.RowIndex).Value
            date1.Text = brpd(("date1"), e.RowIndex).Value
            id.Text = brpd(("id"), e.RowIndex).Value
            notse.Text = brpd(("notse"), e.RowIndex).Value
            save_name.Text = brpd(("save_name"), e.RowIndex).Value
            save_code.Text = brpd(("save_code"), e.RowIndex).Value
            emp_name.Text = nulls(brpd(("emp_name"), e.RowIndex).Value)
            empcode.Text = nulls(brpd(("emp_code"), e.RowIndex).Value)
            PRM.CheckState = nulls(brpd(("PRM"), e.RowIndex).Value)

        ElseIf tm = 16 Then
            MEDCINE_NAME.Text = brpd(("name"), e.RowIndex).Value
            GlassButton9_Click(GlassButton9, e)
        ElseIf tm = 17 Then
            MEDCINE_NAME.Text = brpd(("name"), e.RowIndex).Value
            GlassButton11_Click(GlassButton11, e)
        ElseIf tm = 18 Then
            MEDCINE_NAME.Text = brpd(("name"), e.RowIndex).Value
            GlassButton10_Click(GlassButton10, e)
        ElseIf tm = 20 Then
            dr.Close() : cmd.Connection = CN
            If YYN = "test_name" Then
                dr.Close() : cmd.CommandText = "select * from lbill where TEST LIKE '%" & brpd((YYN), e.RowIndex).Value & "%' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
            Else
                dr.Close() : cmd.CommandText = "select * from lbill where " & YYN & "='" & brpd((YYN), e.RowIndex).Value & "' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
            End If
            adF31.SelectCommand = cmd
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            DBS.Tables("F31").Clear()
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            F31D.DataSource = F31
            F31DTG()
            LLOG("⁄—÷", 0, " ⁄—÷  ﬁ—Ì—  " & pname.Text, 1, bran.Text)

            fnor(3)
        ElseIf tm = 22 Then
            cmdb.DataAdapter = adtemp
            adtemp.Update(DBS, "temp")
        ElseIf tm = 23 Then
            pname.Text = brpd(("Pname"), e.RowIndex).Value
            pcode.Text = brpd(("PCODE"), e.RowIndex).Value
            dr1.Close()
            cmd1.CommandText = "select * from lpatien where pcode='" & Val(pcode.Text) & "'"
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            If dr1.HasRows = True Then
                PNIK.Text = dr1("PNIK")
                pcode.Text = dr1("pcode")
                pname.Text = dr1("pname")
                ptype.Text = dr1("ptype")
                pbrith_date.Value = dr1("pbrith_date")
                page.Text = dr1("page")
                pphone.Text = nulls(dr1("pphone"))
                pmobile.Text = nulls(dr1("pmobile"))
                pgover.Text = dr1("pgover")
                pcity.Text = dr1("pcity")
                pstreet.Text = dr1("pstreet")
                pemail.Text = dr1("pemail")
                pid.Text = dr1("pid")
                BOOK_CODE.Text = dr1("book_code")
                BOOK_name.Text = dr1("book_name")
                COMPANY_CODE.Text = dr1("company_code")
                COMPANY_name.Text = dr1("company_name")
                REG_CODE.Text = dr1("REG_code")
                REG_name.Text = dr1("REG_name")
            End If
            End If

    End Sub



    Private Sub LAB_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles LAB.DropDown
        'cmdCOMPANY.Connection = CN
        'cmdCOMPANY.CommandType = CommandType.Text
        'cmdCOMPANY.CommandText = "select * from lCOMPANY WHERE BOOK_PRICE_CODE='" & BOOK_CODE.Text & "'"
        'adCOMPANY.SelectCommand = cmdCOMPANY
        'adCOMPANY.Fill(DBS, "COMPANY")
        'COMPANY = DBS.Tables("COMPANY")
        'DBS.Tables("COMPANY").Clear()
        'adCOMPANY.Fill(DBS, "COMPANY")
        'COMPANY = DBS.Tables("COMPANY")
        'LAB.DataSource = COMPANY
        'LAB.DisplayMember = "NAME"
        'LAB.Text = ""
        'FRC = BOOK.Select("code='1'")
    End Sub

    Private Sub LAB_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles LAB.SelectedIndexChanged
        'If LAB.Focused = False Then Exit Sub
        'If LAB.Text = "" Then Exit Sub

        'FRC = COMPANY.Select("NAME='" & LAB.Text & "'")
        'If FRC.Length <= 0 Then
        '    LAB.Text = ""
        '    TextBox6.Text = ""
        '    Exit Sub
        'Else
        '    RC = FRC(0)
        '    TextBox6.Text = RC("code")
        '    pname.Text = 1
        '    GlassButton36_Click(GlassButton36, e)
        '    dr.Close()
        '    cmd.CommandText = "SELECT * FROM LlaBprice WHERE COMPANY_NAME='" & LAB.Text & "'"
        '    dr = cmd.ExecuteReader
        '    While dr.Read
        '        FRC = BILL.Select("test_NAME='" & dr("test_name") & "'")
        '        RC = FRC(0)
        '        RC.BeginEdit()
        '        RC("qun") = 1
        '        RC("tot") = dr("price")
        '        RC.EndEdit()
        '    End While
        '    cmdb.DataAdapter = adBILL
        '    adBILL.Update(DBS, "BILL")
        'End If
    End Sub



    Private Sub pcode_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles pcode.KeyDown
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "select * from LPATIEN WHERE pcode ='" & pcode.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows Then

                PNIK.Text = dr("PNIK")
                pname.Text = dr("pname")
                pcode.Text = dr("pcode")
                ptype.Text = dr("ptype")
                pbrith_date.Value = dr("pbrith_date")
                Dim d As Date = Now
                page.Text = d.Year - pbrith_date.Value.Year
                pphone.Text = dr("pphone")
                pmobile.Text = dr("pmobile")
                pgover.Text = dr("pgover")
                pcity.Text = dr("pcity")
                pstreet.Text = dr("pstreet")
                pemail.Text = dr("pemail")
                pid.Text = dr("pid")
                BOOK_CODE.Text = dr("book_code")
                BOOK_name.Text = dr("book_name")
                COMPANY_CODE.Text = dr("company_code")
                COMPANY_name.Text = dr("company_name")
                pname.Focus()
            End If
        End If
    End Sub

    Private Sub pcode_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles pcode.MouseHover
        llname = "pcode"
    End Sub

    Private Sub pcode_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pcode.TextChanged

    End Sub

    Private Sub esl_no_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles esl_no.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))
        esl_no.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "esl_no")
    End Sub

    Private Sub esl_no_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles esl_no.KeyDown
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub esl_no_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles esl_no.MouseHover
        llname = "esl_no"
    End Sub

    Private Sub esl_no_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles esl_no.TextChanged

    End Sub
    Public Sub fesl(ByVal A As Integer, ByVal asssss As Integer)

mali:
        Dim t As Date = Now
        ' '''''''brpd.BackgroundColor = Color.White
        '''''''''''ers.Rows.Clear()
        Dim AAA As Integer = Val(YEARN.Text)
        On Error Resume Next
        If branch_code.Text <> brans And lrcv = 0 Then MsgBox("«·—Ã«¡ «Œ Ì«— «·›—⁄") : Exit Sub
        If esl_no.Text < 0 And mng = 0 Then MsgBox("·«  ÊÃœ ·œÌﬂ ’·«ÕÌ…") : Exit Sub

        dr.Close()
        cmd.CommandText = "select sprnt from  lbill where ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and bdel=0"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            MsgBox("Â–« «·«Ì’«· €Ì— „”Ã·", MsgBoxStyle.Critical)
            esl_no.Text = 0
            Exit Sub
        End If
        Dim rrr As Process = Process.Start(Application.StartupPath & "\bar.exe")
        dr1.Close()
        dr.Close()
        If asssss = 0 Then
            SAVERES(1, 0)
        End If
        SPECIMEN.Text = 0
        DIRECT_FILM.Text = 0
        Pus_cells.Text = 0
        RBCs.Text = 0
        Others.Text = 0
        Culture_conditions.Text = 0
        Growth_of.Text = 0
        VAIBLE_COUNT.Text = 0
        Count_is.Text = 0
        Epithelial.Text = 0
        Dim SSSS As Integer = Val(esl_no.Text)
        pname.Text = 1
        comments.Text = ""
        YEARN.Text = AAA
        esl_no.Text = SSSS
        sprnt = 0
        dr.Close()
        Dim rsss As Double = 0
        Dim rsss1 As Double = 0

        '========================================================
        anew(1, 0)
        YEARN.Text = AAA
        dr1.Close()
        cmd1.CommandText = "select * from lbill where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr1 = cmd1.ExecuteReader
        dr1.Read()
        If dr1.HasRows = True Then
            pname.Text = dr1("pname")
            pcode.Text = dr1("pCODE")
            ncode.Text = "code :- " & dr1("esl_no") & " visit :- " & dr1("esl_date")
            nname.Text = dr1("pname")
            nreff.Text = "ref    :- " & dr1("COMPANY_name")
            chrcv.Checked = dr1("chrcv")
            cfast.Checked = dr1("cfast")
            rcv_date.Value = dr1("rcv_date")
            rcvv.Text = dr1("rcvv")
            rcvn.Text = dr1("rcvn")
            fastv.Text = dr1("fastv")
            TextBox5.Text = dr1("fastn")
            hrcvv.Text = dr1("hrcvv")
            dev.Text = dr1("dev")
            DISS.Text = dr1("diss")
            esl_time.Text = dr1("esl_time")
            COMPANY_CODE.Text = dr1("COMPANY_CODE")
            COMPANY_name.Text = dr1("COMPANY_name")
            wuser.Text = dr1("wuser")
            wpass.Text = dr1("wpass")
            WEB.Text = dr1("WEB")
            wid.Text = dr1("wid")
            DOC_CODE.Text = dr1("DOC_CODE")
            DOC_NAME.Text = dr1("DOC_name")
            PYEAR.Text = dr1("pyear")
            page.Text = dr1("page")
            depn.Text = dr1("depn")
            esl_no.Text = dr1("esl_no")
            esl_date.Value = dr1("esl_date")
            REG_CODE.Text = dr1("REG_CODE")
            REG_name.Text = dr1("REG_name")
            crd_per.Text = dr1("crd_per")
            crd_v.Text = dr1("crd_v")
            cash_per.Text = dr1("cash_per")
            cash_v.Text = dr1("cash_v")
            bon.Text = dr1("bon")
            PAY.Text = dr1("PAY")
            labd.Text = dr1("labd")
            rsss = dr1("PAY")
            rcv.Checked = dr1("rcv")
            TOT.Text = dr1("TOT")
            PNIK.Text = dr1("NIK")
            test.Text = dr1("test")
            dissn.Text = dr1("dissn")
            lnotes.Text = dr1("notes")
            pntot.Text = dr1("ptot")
            pnpay.Text = dr1("ppay")
            rsss1 = dr1("ppay")
            sprnt1.Text = dr1("sprnt")
            pnrest.Text = dr1("prest")
            lab_name.Text = dr1("lab_name")
            lab_code.Text = dr1("lab_code")
            tnum1.Text = dr1("tnum")
            nik.Text = dr1("nnik")
            shiftoo.Text = dr1("shift")
            rcv_time.Text = dr1("rcv_time")
            urgant.CheckState = dr1("urgant")
            finals.CheckState = dr1("final")
            NCRD.CheckState = dr1("NCRD")
            fs.CheckState = nulls(dr1("fs"))
            pcode.Text = dr1("pcode")
            ptype.Text = dr1("ptype")
            page.Text = dr1("page")
            pid.Text = dr1("pid")
            PYEAR.Text = dr1("pyear")
            BANK.Text = dr1("BANK")
            NDOC.Text = dr1("NDOC")
            NCRD.CheckState = dr1("NCRD")
            SAMPLUSR.Text = nulls(dr1("SAMPLUSR"))
            SAMPL.CheckState = nulls(dr1("SAMPL"))
            SAMPLDATE.Text = nulls(dr1("SAMPLDATE"))
            Dim x As String = ""
            If dr1("rcv") > 0 Then x = "received - " Else x = "not received - "
            If dr1("sprnt") > 0 Then
                PrintedToolStripMenuItem.BackColor = Color.Red
                x = x & "printed " & "( " & dr1("sprnt") & " )"
            Else
                PrintedToolStripMenuItem.BackColor = Color.Green
                x = x & " NOT printed"
            End If
            PrintedToolStripMenuItem.Text = x
            REST.Text = dr1("REST")
            ucash.Checked = nulls(dr1("ucash"))
            utc.Checked = nulls(dr1("utc"))
            utn.Checked = nulls(dr1("utn"))
            BOOK_CODE.Text = dr1("BOOK_CODE")
            BOOK_name.Text = dr1("BOOK_name")
        End If
        '        If lres = 0 Then GoTo mm
        '        If lcult1 = 0 Then GoTo mm
        '        If TabControl1.TabPages("TabPage5").Focus = False And TabControl1.TabPages("TabPage6").Focus = False Then
        'mm:

       
        dr.Close()
        cmd.CommandText = "select count(esl_no) from lbill where pcode='" & pcode.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            If dr(0) > 1 Then PHToolStripMenuItem.BackColor = Color.Cyan Else PHToolStripMenuItem.BackColor = Color.Yellow
        End If
        ppp.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from lbill_test where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr = cmd.ExecuteReader
        While dr.Read
            FRC = BILL.Select("test_CODE='" & dr("test_CODE") & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                If dr("tdel") = 0 Then RC("qun") = 1
                RC("RST") = 1
                RC("tot1") = dr("tot1")
                RC("rcv_date") = dr("rcv_date")
                RC("rcv") = dr("rcv")
                RC("take") = dr("take")
                RC("s") = dr("s")
                RC("p") = dr("p")
                RC("homs") = dr("homs")
                RC("lab") = dr("lab")
                RC("bar") = dr("bar")
                RC("dis_n") = dr("dis_n")
                RC("tdel") = dr("tdel")
                RC("TOT2") = dr("TOT2")
                RC("prntn") = dr("prntn")
                RC("tot") = dr("test_price")
                RC("anew") = 1
                RC.EndEdit()
            End If
        End While
        If FESLT = 1 Then
            dr.Close()
            ACdr.Close()
            cmd.CommandText = "SELECT * FROM lbill_esl where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            dr = cmd.ExecuteReader
            While dr.Read
                ACcmd.CommandText = "INSERT INTO esl([bill],[tot],erbank) VALUES ('" & dr("bill") & "','" & dr("tot") & "','" & dr("erbank") & "')"
                ACcmd.ExecuteNonQuery()
            End While
            cmdeslb.Connection = ACcn : cmdeslb.CommandText = "select * from esl "
            adeslb.SelectCommand = cmdeslb
            adeslb.Fill(DBS, "eslb")
            eslb = DBS.Tables("eslb")
            DBS.Tables("eslb").Clear()
            adeslb.Fill(DBS, "eslb")
            eslb = DBS.Tables("eslb")
            esld.DataSource = eslb
        End If
        cmdb.DataAdapter = adBILL
        adBILL.Update(DBS, "BILL")
        SUMT()
        PAY.Text = rsss
        If SSFINAL = 0 Then finals.Checked = True
        bnew.Text = 1
        dr.Close()
        pnpay.Text = rsss1
        fres()
        FLNB = SSSS
        CODEB.Text = FLNB
        CODEE.Text = FLNB
        dr.Close()
        cmd.CommandText = "select * from lbill where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            DISS.Text = dr("diss")
            dissn.Text = dr("dissn")
            PAY.Text = dr("PAY")
            REST.Text = dr("REST")
            rcv.Checked = dr("rcv")
            rcv_date.Value = dr("rcv_date")
            esl_date.Value = dr("esl_date")
            page.Text = dr("page")
            trl1.Checked = Val(dr("trl"))
            finals.CheckState = dr("final")
            fs.CheckState = nulls(dr("fs"))
            pcode.Text = dr("pcode")
        End If
       
        esl_no.Text = SSSS
        rrr.Kill()
        If lnotes.Text <> "0" And msga = 1 Then MsgBox(lnotes.Text)
        If resta = 1 Then
            If REST.Text <> 0 Then
                If REST.Text < 0 Then MsgBox("«·—Ã«¡ «·«Â „«„ »«·»«ﬁÏ  " & REST.Text, MsgBoxStyle.Critical) Else MsgBox("«·„—Ì÷ ·Â »«ﬁÏ ⁄‰œ‰«   " & REST.Text, MsgBoxStyle.Information)
                sprnt = 1
            End If
        End If
        IMAGE_CODE.Items.Clear()
        ''dr.Close()
        ''cmd.CommandText = "select code from lbillimage WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        ''dr = cmd.ExecuteReader
        ''While dr.Read()
        ''    IMAGE_CODE.Items.Add(nulls(dr(0)))
        ''End While
        If SSFINAL = 0 Then finals.Checked = True
        fprice(1)
        fnd = 1
        Dim t1 As TimeSpan = Now - t
        dr1.Close()
        cmd1.CommandText = "select * from lbill where rest<>0 and pcode='" & pcode.Text & "'"
        dr1 = cmd1.ExecuteReader
        If dr1.HasRows And msga = 1 Then
            Dim xxaa As String = "«·»Ê«ﬁÏ «·ﬁœÌ„… ⁄·Ï «·„—Ì÷ øøøø"
            xxaa = xxaa & Environment.NewLine
            While dr1.Read
                xxaa = xxaa & Environment.NewLine & dr1("esl_date") & " ------>  " & dr1("rest")
            End While

            MsgBox(xxaa, MsgBoxStyle.Critical)
        End If
        LLOG("«” œ⁄«¡", esl_no.Text, "  «” œ⁄«¡ «”„ " & pname.Text, 1, bran.Text)
        dr.Close()
        cmd.CommandText = "select * from lpatien where pcode='" & pcode.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            PNIK.Text = dr("PNIK")
            pcode.Text = dr("pcode")
            ptype.Text = dr("ptype")
            pbrith_date.Value = dr("pbrith_date")
            page.Text = dr("page")
            pphone.Text = nulls(dr("pphone"))
            pmobile.Text = nulls(dr("pmobile"))
            pgover.Text = dr("pgover")
            pcity.Text = dr("pcity")
            pstreet.Text = dr("pstreet")
            pemail.Text = dr("pemail")
            pid.Text = dr("pid")
        End If
        TextBox3.Focus()
    End Sub

    Public Sub fres()
        If lres = 1 Then
            DBS.Tables("subres").Clear()
            comment1.Text = ""
            dr.Close()
            cmd.CommandText = "update  Lbill_TEST set dsn=ds,tsq1=tsq, qun1=qun,rsv=res,pth='',rsvp=pthn WHERE ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and tdel=0"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update  Lbill_TEST set res='not sample' WHERE ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and tdel=0 and take=0"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update  Lbill_TEST set res='-' WHERE ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and tdel=0 and take=1 and res='not sample'"
            cmd.ExecuteNonQuery()
            dr.Close()
            cmd.CommandText = "update  Lbill_TESTSUB set dsn=ds,rds=ds,qun1=qun,rsv=res,rsv1=absu,pth='',rsvp=pthn WHERE ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " "
            cmd.ExecuteNonQuery()
            dr1.Close()
            dr.Close()
            DBS.Tables("testres").Clear()
            cmdress.Parameters.Clear()
            cmdress.CommandType = CommandType.Text
            cmdress.CommandText = "SELECT *  FROM lbill_test WHERE ESL_NO ='" & esl_no.Text & "' and yearn ='" & YEARN.Text & "' and bran = '" & bran.Text & "' and tdel = 0 order by cult,sub,RSO"
            adtestres.SelectCommand = cmdress
            adtestres.Fill(DBS, "testres")
            testres = DBS.Tables("testres")
            FRC = testres.Select("sub=1")
            DataGridView1.DataSource = testres
            If FRC.Length > 0 Then
                RC = FRC(0)
                subres.Clear()
                cmdrsub.CommandType = CommandType.Text
                cmdrsub.CommandText = "SELECT * FROM lbill_testsub	WHERE ESL_NO ='" & esl_no.Text & "' and yearn ='" & YEARN.Text & "' and bran = '" & bran.Text & "'  and mtest_code='" & RC("test_code") & "' ORDER BY RSO"
                adsubres.Fill(DBS, "subres")
                subres = DBS.Tables("subres")
                DTEST_SUB.DataSource = subres
            End If
            cultd.Rows.Clear()
            FRC = testres.Select("cult=1")
            If FRC.Length > 0 Then
                dr.Close() : cmd.CommandText = "select * from Lbill_TEST WHERE ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and cult=1  and tdel=0"
                adtestresc.SelectCommand = cmd
                adtestresc.Fill(DBS, "testresc")
                testresc = DBS.Tables("testresc")
                DBS.Tables("testresc").Clear()
                adtestresc.Fill(DBS, "testresc")
                testresc = DBS.Tables("testresc")
                DataGridView2.DataSource = testresc
                If testresc.Rows.Count > 0 Then
                    culttestn.Text = testresc.Rows(0).Item("test_name")
                    culttestc.Text = testresc.Rows(0).Item("test_code")
                    dr.Close() : cmd.CommandText = "select * from Lbill_cult WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_NAME='" & culttestn.Text & "'"
                    adcultd.SelectCommand = cmd
                    adcultd.Fill(DBS, "cultd")
                    cultd = DBS.Tables("cultd")
                    DBS.Tables("cultd").Clear()
                    adcultd.Fill(DBS, "cultd")
                    cultd = DBS.Tables("cultd")
                    DataGridView3.DataSource = cultd
                    dr.Close()
                    cmd.CommandText = "select * from Lbill_cult_det WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_NAME='" & culttestn.Text & "'"
                    dr = cmd.ExecuteReader
                    dr.Read()
                    If dr.HasRows Then
                        SPECIMEN.Text = dr("SPECIMEN")
                        DIRECT_FILM.Text = dr("DIRECT_ FILM")
                        Pus_cells.Text = dr("Pus_cells")
                        RBCs.Text = dr("RBCs")
                        Others.Text = dr("Others")
                        Culture_conditions.Text = dr("Culture_conditions")
                        Growth_of.Text = dr("Growth_of")
                        VAIBLE_COUNT.Text = dr("VAIBLE_COUNT")
                        Count_is.Text = dr("Count_is")
                        Epithelial.Text = dr("Epithelial")
                    End If
                End If
            End If
            Dim v As Integer = 0
            While Not v = DataGridView2.Columns.Count
                DataGridView2.Columns(v).Visible = False
                v = v + 1
            End While
            DataGridView2.Columns("DataGridViewTextBoxColumn6").Visible = True
            DataGridView2.Columns("DataGridViewTextBoxColumn6").HeaderText = "«· Õ·Ì·"
            DataGridView2.Columns("DataGridViewTextBoxColumn6").Width = 300
            DataGridView2.Columns("«·«Œ Ì«—").Visible = True
            DataGridView2.Columns("«·«Œ Ì«—").HeaderText = "«·«Œ Ì«—"
            DataGridView2.Columns("«·«Œ Ì«—").Width = 40
            dr.Close()
            Dim n As Integer = 0
            While Not n = DataGridView1.RowCount
                If DataGridView1(("DataGridViewTextBoxColumn2"), n).Value = "-" Then
                    DataGridView1.Rows(n).DefaultCellStyle.BackColor = Color.Pink
                Else
                    DataGridView1.Rows(n).DefaultCellStyle.BackColor = Color.White
                End If
                n = n + 1
            End While
            dr.Close()
        End If
    End Sub

    Private Sub test_code_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles test_code.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        test_code.BackColor = Color.FromArgb(backcolor1)

    End Sub

    Private Sub test_code_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles test_code.KeyDown
        If e.KeyCode = Keys.Enter Then
            FRC = BILL.Select("test_code='" & test_code.Text & "'")
            If FRC.Length <= 0 Then

                Exit Sub
            Else
                RC = FRC(0)
                RC.BeginEdit()
                RC("qun") = 1
                RC.EndEdit()
                cmdb.DataAdapter = adBILL
                adBILL.Update(DBS, "BILL")
                SUMT()
                test_name.Text = ""
                test_name.Focus()
            End If
        End If
    End Sub



    Private Sub mach_name_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles mach_name.KeyDown

    End Sub

    Private Sub mach_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles mach_name.SelectedIndexChanged
        If mach_name.Focused = False Then Exit Sub
        If mach_name.Text = "" Then Exit Sub
        dr.Close()
        cmd.CommandText = "select * from Lmachine where NAME='" & mach_name.Text & "'"
        dr = cmd.ExecuteReader
        If dr.Read Then
            mach_code.Text = dr("code")
            pname.Text = 1
            ACdr.Close()
            ACcmd.CommandText = "update test_price set qun=0"
            ACcmd.ExecuteNonQuery()
            fprice(0)
            dr.Close()
            cmd.CommandText = "SELECT * FROM Lmachine_test WHERE NAME='" & mach_name.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                FRC = BILL.Select("test_NAME='" & dr("test_name") & "'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("qun") = 1
                    RC.EndEdit()
                End If
            End While
            cmdb.DataAdapter = adBILL
            adBILL.Update(DBS, "BILL")
            fprice(1)
        End If
    End Sub



    Private Sub  ›’Ì·ÏToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        FMTP(1)

    End Sub

    Private Sub «Ã„«·ÏToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        FMTP(2)
    End Sub

    

    Private Sub «” ·„ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)


    End Sub

    Public Sub FRCV()
        If lrcv = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, " ﬁ—Ì— «· Õ«·Ì·  „ «” ·«„Â«", 0, bran.Text)
            Exit Sub
        End If
        Dim w As String = ""
        If nyes.Checked = True Then w = " and rcv=1"
        If nno.Checked = True Then w = " and rcv=0"

        dr.Close() : cmd.CommandText = "SELECT     * FROM  lbill_test    where RCV_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" & w
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, " ﬁ—Ì— «· Õ«·Ì·  „ «” ·«„Â«", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\test RCV.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub



    Private Sub  ﬁ—Ì—»Ì«‰« «·„—÷ÏToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub  ﬁ—Ì—„—«ﬁ»…«·„” Œœ„Ì‰ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub  ﬁ—Ì—«Õ’«∆Ì« «· Õ«·Ì·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub «Õ’«∆Ì« «Ì—«œ«· Õ«·Ì·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub


    Private Sub «Õ’«∆Ì« «·ÌÊ„ÏToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Public Sub FMACH()
        If lrcv = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— ", 0, bran.Text)
            Exit Sub
        End If
        Dim w As String = ""

        If nyes.Checked = True Then w = " and rcv=1"
        If nno.Checked = True Then w = " and rcv=0"
        If CheckBox6.Checked = True Then w = w & " and NAME='" & mach_name.Text & "'"

        dr.Close() : cmd.CommandText = "SELECT     * FROM  v_mach    where RCV_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" & w
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")

        Dim v As Integer = 0
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— ", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\mach rcv.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)

        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj

        rp.Show() : rp.Focus()
    End Sub


    Private Sub TestToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub
    Public Sub TESTS(ByVal typ As String)
        'Try
        If lres = 0 And typ <> "prnt" And typ <> "email" Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷ ‰ ÌÃ…", esl_no.Text, " ⁄—÷ ‰ ÌÃ… " & pname.Text, 0, bran.Text)
            Exit Sub
        End If
        dr.Close()
        Dim NN As Integer = 0
        Dim NT As Integer = 0
        rp.CrystalReportViewer1.ShowPrintButton = True
        rp.CrystalReportViewer1.ShowExportButton = True

        dr.Close()
        cmd.CommandText = "select count(test_name),MAX(PRNTN) from  lbill_test where ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1 and sub<>1 AND CULT=0"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            Dim cc As Integer = 0
            cc = dr(0)
            NN = nulls(dr(1))
            dr.Close()
            cmd.CommandText = "update lbill set tnum='" & cc & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()
        End If
        If lres = 1 Then
            NORE(1, 0)
        End If
        If CRES.Checked = False Then
            Dim nss As Integer
            nss = 0
            While Not nss = testres.Rows.Count
                testres.Rows(nss).BeginEdit()
                If testres.Rows(nss).Item("res") = "-" Or testres.Rows(nss).Item("res") = " " Or testres.Rows(nss).Item("res") = "" Then
                    If testres.Rows(nss).Item("sub") = 0 And testres.Rows(nss).Item("cult") = 0 Then
                        testres.Rows(nss).Item("qun") = "0"
                    End If
                Else
                    testres.Rows(nss).Item("qun") = "1"
                End If

                testres.Rows(nss).EndEdit()
                nss += 1
            End While
        End If

        SAVERES(0, 0)

        dr.Close()
        DBS.Tables("esl").Clear()
        cmdesl.Parameters.Clear()
        cmdesl.CommandText = "pres"
        cmdesl.CommandType = CommandType.StoredProcedure
        cmdesl.Parameters.AddWithValue("esl_no", Val(esl_no.Text))
        cmdesl.Parameters.AddWithValue("yearn", Val(YEARN.Text))
        cmdesl.Parameters.AddWithValue("bran", bran.Text)
        adesl.SelectCommand = cmdesl
        adesl.Fill(DBS, "esl")
        '====================HISTORY===========================
        Dim NB As Integer = 0
        While Not NB = DBS.Tables("esl").Rows.Count
            If nulls(DBS.Tables("esl").Rows(NB).Item("PTHN")) = 1 Then
                dr.Close()
                cmd.CommandText = "SELECT * FROM LBILL_TEST WHERE ESL_NO<>'" & DBS.Tables("esl").Rows(0).Item("ESL_NO") & "' " & " and TDEL=0  and bran='" & bran.Text & "'" & " AND TEST_CODE='" & DBS.Tables("esl").Rows(NB).Item("TEST_CODE") & "' AND PCODE='" & DBS.Tables("esl").Rows(NB).Item("PCODE") & "' ORDER BY  ESL_DATE DESC"
                dr = cmd.ExecuteReader
                While dr.Read()
                    DBS.Tables("esl").Rows(NB).BeginEdit()
                    DBS.Tables("esl").Rows(NB).Item("PTH") = DBS.Tables("esl").Rows(NB).Item("PTH") & " (" & dr("ESL_DATE") & ">>" & dr("RES") & " )"
                    DBS.Tables("esl").Rows(NB).EndEdit()
                End While
            End If
            If nulls(DBS.Tables("esl").Rows(NB).Item("res")) = "0" Then
                ers.Rows.Add(nulls(DBS.Tables("esl").Rows(NB).Item("test_name")))
                brpd.BackgroundColor = Color.Red
            End If
            NB = NB + 1
        End While
        brpd.DataSource = ers
        '====================END===============================
        If sprnt = 1 Then Me.Text = "«·—Ã«¡  ”œÌœ «·»«ﬁÏ"
        If sprnt = 0 Then NT = 0
        If sprnt = 1 And REST_PRNT = 1 Then NT = 0
        If sprnt = 1 And REST_PRNT = 0 Then NT = 1
        If DBS.Tables("esl").Rows.Count > 0 Then
            Dim qqqq As String = ""
            If typ = "email" Then
                qqqq = ""
            End If

            Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
            If SEP.Checked = True Then
                oj.Load(Application.StartupPath & rptp.Text & qqqq & "\res.rpt")
            ElseIf PANEL.Checked = True Then
                oj.Load(Application.StartupPath & rptp.Text & qqqq & "\resP.rpt")
            ElseIf GROP.Checked = True Then

                oj.Load(Application.StartupPath & rptp.Text & qqqq & "\resg.rpt")
            End If
            oj.Database.Tables(0).SetDataSource(DBS.Tables("esl"))
            oj.SetParameterValue("REF", ref1)
            oj.SetParameterValue("11", 0)
            If typ = "rpt" Then
                ''If PV.Checked = True Then NT = 1
                rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
                If NT = 0 Then
                    rp.CrystalReportViewer1.ShowPrintButton = True
                    rp.CrystalReportViewer1.ShowExportButton = True
                    dr.Close()
                    If prnitnn = 1 Then
                        cmd.CommandText = "update lbill set sprnt=sprnt+1 ,printtime='" & ChangeFormatall(Now) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                        cmd.ExecuteNonQuery()
                    End If
                    LLOG("ÿ»«⁄…", esl_no.Text, " ÿ»«⁄… ‰ ÌÃ…   " & pname.Text, 1, bran.Text)
                Else
                    'rp.CrystalReportViewer1.ShowPrintButton = False
                    'rp.CrystalReportViewer1.ShowExportButton = False
                    LLOG("⁄—÷", esl_no.Text, " ⁄—÷ ‰ ÌÃ… " & pname.Text, 1, bran.Text)

                End If
                If finals.Checked = False And NT = 0 And fath = 0 Then
                    rp.CrystalReportViewer1.ShowPrintButton = False
                    rp.CrystalReportViewer1.ShowExportButton = False
                End If
                If edt = 0 Or REST_PRNT = 0 And fath = 0 Then
                    rp.CrystalReportViewer1.ShowPrintButton = False
                    rp.CrystalReportViewer1.ShowExportButton = False
                End If
                rp.Show()

            ElseIf typ = "prnt" And DBS.Tables("esl").Rows.Count > 0 And lpnum = 1 Then
                rppnt = 1
                rp.CrystalReportViewer1.ShowPrintButton = True
                rp.CrystalReportViewer1.ShowExportButton = True
                oj.PrintToPrinter(1, False, 0, 0)
                dr.Close()
                cmd.CommandText = "update lbill_test set prnttime='" & ChangeFormatall(Now) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1 and sub<>1 and CULT<>1"
                cmd.ExecuteNonQuery()
                LLOG("ÿ»«⁄… ‰ ÌÃ…", esl_no.Text, " ÿ»«⁄… ‰ ÌÃ… " & pname.Text, 1, bran.Text)

            ElseIf typ = "email" Then
                oj.SetParameterValue("11", 1)
                oj.ExportToDisk(CrystalDecisions.[Shared].ExportFormatType.PortableDocFormat, SourceDirectory & "1.pdf")
            End If
        Else
        End If
        'Catch ex As Exception
        '    Dim st As String = ex.Message
        '    st = st.Replace("'", "-")
        '    dr.Close()
        '    cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','print all','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
        '    cmd.ExecuteNonQuery()
        '    MsgBox(st) : If ex.Message = "Load report failed." Then End
        'End Try
    End Sub
    Public Sub NORE(ByVal SMSS As Integer, ByVal asss As Integer)
        On Error Resume Next
        If SMSS = 1 Or SMSS = 0 Then
            Dim SOX As Integer = 0
            Dim bss, bss1, bldn, hdl, ldl, si, sii, tri, chol, tdr, DIRCT, urea, PAST, PASF, glob, alb, tprot, CAINOZ, S1, S2, S3 As Double
            tdr = 0
            'FRC = testres.Select("test_code='681'")
            'If FRC.Length > 0 Then
            '    FRC = testres.Select("test_code='400'")
            '    If FRC.Length > 0 Then
            '        RC = FRC(0)
            '        bss = RC("res")
            '    End If
            '    FRC = testres.Select("test_code='680'")
            '    If FRC.Length > 0 Then
            '        RC = FRC(0)
            '        bss1 = RC("res")
            '    End If
            '    RC = FRC(0)
            '    If Val(RC("res")) = 0 Then
            '        RC.BeginEdit()
            '        RC("res") = Math.Round(bss / bss1, 2)
            '        RC.EndEdit()
            '    End If
            'End If

            Dim TIMECON, CONTT As Double
            FRC = testres.Select("test_code='681'")
            If FRC.Length > 0 Then
                FRC = testres.Select("test_code='440'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    S1 = Val(RC("res"))
                End If
                FRC = testres.Select("test_code='680'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    S2 = Val(RC("res"))
                End If
                FRC = testres.Select("test_code='681'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If Val(RC("RES")) = 0 Then
                        RC.BeginEdit()
                        RC("RES") = Math.Round(S1 / S2, 1)
                        RC.EndEdit()
                    End If
                End If
            End If


            FRC = testres.Select("test_code='510'")
            If FRC.Length > 0 Then
                Dim ww As Double = 0
                FRC = testres.Select("test_CODE='510'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    TIMECON = Val(RC("res"))
                End If
                FRC = testres.Select("test_CODE='648'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    CONTT = Val(RC("res"))
                End If

                FRC = testres.Select("test_CODE='650'")
                If FRC.Length > 0 Then
                    'Dim S, Y, per, yy, inr, inr1, per1 As Double
                    'dr.Close()
                    'cmd.CommandText = "SELECT MAX(" & PT & "),PER,inr FROM LPTCON WHERE   " & PT & " <='" & TIMECON & "' GROUP BY PER , inr order by inr desc"
                    'dr = cmd.ExecuteReader
                    'dr.Read()
                    'If dr.HasRows = True Then
                    '    S = dr(0)
                    '    per = dr("per")
                    '    inr = dr("inr")
                    'End If

                    'dr.Close()
                    'cmd.CommandText = "SELECT MIN(" & PT & "),PER,inr FROM LPTCON WHERE   " & PT & " >='" & TIMECON & "' GROUP BY PER,inr order by inr "
                    'dr = cmd.ExecuteReader
                    'dr.Read()
                    'If dr.HasRows = True Then
                    '    Y = dr(0)
                    '    per1 = dr("per")
                    '    inr1 = dr("inr")
                    'End If
                    'yy = 0
                    'Dim asm As Double = 0
                    'asm = Math.Round(Y - S, 2)
                    'If TIMECON - S = 0 Then yy = 0 Else yy = Math.Round((TIMECON - S) / asm, 2)
                    'per1 = per1 - per
                    'inr1 = inr1 - inr
                    Dim conc As Double = 0
                    If FRC.Length > 0 Then
                        RC = FRC(0)
                        If Val(RC("res")) = 0 Then
                            RC.BeginEdit()
                            conc = Math.Round((CONTT - 6.7) / (TIMECON - 6.7), 2)
                            conc = conc * 100
                            RC("res") = conc
                            RC.EndEdit()
                        End If
                    End If
                    'FRC = testres.Select("test_CODE='649'")
                    'If FRC.Length > 0 Then
                    '    RC = FRC(0)
                    '    If Val(RC("res")) = 0 Then

                    '        RC.BeginEdit()
                    '        RC("res") = Math.Round((inr1 * yy) + inr, 2)
                    '        RC.EndEdit()
                    '    End If
                    'End If

                    FRC = testres.Select("test_CODE='649'")
                    If FRC.Length > 0 Then
                        RC = FRC(0)
                        If Val(RC("res")) = 0 Then
                            RC.BeginEdit()
                            RC("res") = Math.Round((TIMECON / CONTT) ^ 1.5, 2)
                            RC.EndEdit()
                        End If
                    End If

                    'If FESLT = 1 Then
                    '    FRC = testres.Select("test_CODE='183'")
                    '    If FRC.Length = 1 Then
                    '        RC = FRC(0)
                    '        RC.BeginEdit()
                    '        RC("res") = Math.Round(100 / Val((inr1 * yy) + inr), 0)
                    '        RC.EndEdit()
                    '    End If
                    'End If
                End If
            End If
            FRC = testres.Select("test_code='135'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                urea = Val(RC("res"))
            End If
            FRC = testres.Select("test_code='135'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                bldn = Val(RC("res"))
            End If
            FRC = testres.Select("test_code='617'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                If Val(RC("res")) = 0 Then
                    RC.BeginEdit()
                    RC("res") = Math.Round(bldn / 2.14, 1)
                    RC.EndEdit()
                End If
            End If
            FRC = testres.Select("test_code='161'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                CAINOZ = Val(RC("res"))
                FRC = testres.Select("test_code='156'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If Val(RC("res")) = 0 Then
                        RC.BeginEdit()
                        RC("res") = Math.Round(Val(CAINOZ / 8) * 3.5, 1)
                        RC.EndEdit()
                    End If
                End If
            End If

            FRC = testres.Select("test_code='503'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                tprot = Val(RC("res"))
            End If
            FRC = testres.Select("test_code='27'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                alb = Val(RC("res"))
            End If
            FRC = testres.Select("test_code='612'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                glob = tprot - alb
                If Val(RC("res")) = 0 Then
                    RC.BeginEdit()
                    RC("res") = glob
                    RC.EndEdit()
                End If
            End If
            FRC = testres.Select("test_code='29'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                If Val(RC("res")) = 0 Then
                    RC.BeginEdit()
                    RC("res") = Math.Round(alb / glob, 2)
                    RC.EndEdit()
                End If
            End If
            FRC = testres.Select("test_code='508'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                PAST = Val(RC("res"))
            End If
            FRC = testres.Select("test_code='509'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                PASF = Val(RC("res"))
            End If
            FRC = testres.Select("TEST_CODE='633'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                If Val(RC("RES")) = 0 Then
                    RC.BeginEdit()
                    RC("RES") = Math.Round(PASF / PAST, 2) * 100
                    RC.EndEdit()
                End If

            End If
            FRC = testres.Select("test_code='576'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                tri = Val(RC("res"))
            End If
            FRC = testres.Select("TEST_CODE='125'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                tdr = Val(RC("res"))
            End If
            FRC = testres.Select("TEST_CODE='124'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                tdr = tdr - Val(RC("res"))
            End If
            FRC = testres.Select("TEST_CODE='611'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                If Val(RC("RES")) = 0 Then
                    RC.BeginEdit()
                    RC("RES") = tdr
                    RC.EndEdit()
                End If
            End If
            FRC = testres.Select("TEST_CODE='316'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                If Val(RC("RES")) = 0 Then
                    RC.BeginEdit()
                    RC("RES") = Math.Round(urea / 2.14, 2)
                    RC.EndEdit()
                End If
            End If
            FRC = testres.Select("test_code='208'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                si = Val(RC("res"))
                chol = Val(RC("res"))
            End If
            FRC = testres.Select("test_code='337'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                hdl = Val(RC("res"))
                si = Math.Round(si / Val(RC("res")), 2)
                sii = Math.Round(sii / Val(RC("res")), 2)
            End If
            FRC = testres.Select("test_code='443'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                ldl = Val(RC("res"))
                If Val(RC("res")) = 0 Then
                    RC.BeginEdit()
                    If tri <= 200 Then RC("res") = Math.Round(chol - ((tri / 5) + hdl), 0) Else RC("res") = Math.Round(chol - 40 - hdl, 0)
                    If tri <= 200 Then ldl = Math.Round(chol - ((tri / 5) + hdl), 0) Else ldl = Math.Round(chol - 40 - hdl, 0)
                    RC.EndEdit()
                End If
                sii = sii / Val(RC("res"))
                sii = Val(RC("res"))
            End If
            FRC = testres.Select("test_code='546'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                If Val(RC("res")) = 0 Then
                    RC.BeginEdit()
                    RC("res") = (tri / 5)
                    RC.EndEdit()
                End If
            End If
            FRC = testres.Select("test_code='565'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                If Val(RC("res")) = 0 Then
                    RC.BeginEdit()
                    RC("res") = chol + tri + hdl + ldl + 100
                    RC.EndEdit()
                End If
            End If

            FRC = testres.Select("test_code='613'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                If Val(RC("res")) = 0 Then
                    RC.BeginEdit()
                    RC("res") = Math.Round(chol / hdl, 1)
                    RC.EndEdit()
                End If
            End If
            FRC = testres.Select("test_code='614'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                If Val(RC("res")) = 0 Then
                    RC.BeginEdit()
                    RC("res") = Math.Round(ldl / hdl, 1)
                    RC.EndEdit()
                End If
            End If
            fnor(1)

        End If
        If SMSS = 2 Or SMSS = 0 Then

            If asss = 1 Then
                dr.Close() : cmd.CommandText = "select * from Lbill_TESTSUB WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " ORDER BY rSO"
                adsubres.SelectCommand = cmd
                adsubres.Fill(DBS, "subres")
                subres = DBS.Tables("subres")
                DBS.Tables("subres").Clear()
                adsubres.Fill(DBS, "subres")
                subres = DBS.Tables("subres")
                DTEST_SUB.DataSource = subres
            End If
            Dim sec, sev As Double
            FRC = subres.Select("test_code='716'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                sec = Val(RC("res"))
            Else
                sec = 0
            End If
            FRC = subres.Select("test_code='724'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                sev = Val(RC("res"))
            Else
                sev = 0
            End If
            FRC = subres.Select("test_code='725'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                If Val(RC("res")) = 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("res") = sev * sec
                    RC.EndEdit()
                End If
            End If
            Dim RBC, DD, hb, spv, spc As Double
            FRC = subres.Select("Mtest_code='602'")
            If FRC.Length > 0 And fath = 1 Then
                FRC = subres.Select("test_code='638'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    spv = Val(RC("res"))
                Else
                    spv = 0
                End If
                FRC = subres.Select("test_code='645'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    spc = Val(RC("res"))
                Else
                    spc = 0
                End If
                FRC = subres.Select("test_code='696'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("res") = spc * spv
                    RC.EndEdit()
                End If

            End If
            FRC = subres.Select("Mtest_code='228'")
            If FRC.Length > 0 Then
                FRC = subres.Select("test_code='141'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RBC = Val(RC("res"))
                Else
                    RBC = 0
                End If

                FRC = subres.Select("test_code='142'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    ss = Val(RC("res"))
                Else
                    ss = 0
                End If
                FRC = subres.Select("test_code='144'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If Val(RC("res")) = 0 Then
                        RC = FRC(0)
                        RC.BeginEdit()
                        DD = (ss * 3) + 0.8
                        RC("res") = DD
                        RC.EndEdit()
                    Else
                        RC = FRC(0)
                        DD = RC("res")
                    End If
                Else
                    DD = 0
                End If
                FRC = subres.Select("test_code='143'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    If Val(RC("res")) = 0 Then
                        RC("res") = ss * 6.6
                    End If
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='145'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    If Val(RC("res")) = 0 Then
                        RC("res") = Math.Round((DD * 10) / RBC, 1)
                    End If
                End If

                RC.EndEdit()
                FRC = subres.Select("test_code='146'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    If Val(RC("res")) = 0 Then
                        RC("res") = Math.Round((ss * 10) / RBC, 1)
                    End If
                    RC.EndEdit()
                End If

                FRC = subres.Select("test_code='161'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    If Val(RC("res")) = 0 Then
                        RC("res") = Math.Round((ss * 100) / DD, 1)
                    End If
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='153'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    If Val(RC("res")) = 0 Then
                        RC("res") = Math.Round((ss * 100) / DD, 1)
                    End If
                    RC.EndEdit()
                End If
            End If

            Dim TIMECON, CONTT As Double
            FRC = subres.Select("Mtest_code='510'")

            If FRC.Length > 0 Then
                Dim ww As Double = 0
                FRC = subres.Select("test_CODE='181'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    TIMECON = Val(RC("res"))
                End If
                FRC = subres.Select("test_CODE='182'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    CONTT = Val(RC("res"))
                End If
                FRC = subres.Select("test_CODE='183'")
                If FRC.Length > 0 Then
                    Dim conc As Double = 0
                    If FRC.Length > 0 Then
                        RC = FRC(0)
                        If Val(RC("res")) = 0 Then
                            RC.BeginEdit()
                            conc = Math.Round((CONTT - 6.7) / (TIMECON - 6.7), 2)
                            conc = conc * 100
                            RC("res") = conc
                            RC.EndEdit()
                        End If
                    End If
                End If

                FRC = subres.Select("test_CODE='184'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If Val(RC("res")) = 0 Then
                        RC.BeginEdit()
                        RC("res") = Math.Round((TIMECON / CONTT) ^ 1.5, 2)
                        RC.EndEdit()
                    End If
                End If

            End If
            FRC = subres.Select("Mtest_code='228'")

            If FRC.Length > 0 Then
                Dim ww As Double = 0
                FRC = subres.Select("test_code='150'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    ww = Val(RC("res"))
                End If
                FRC = subres.Select("test_code='151'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    ww = ww + Val(RC("res"))
                End If
                FRC = subres.Select("test_code='152'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("res") = ww
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='148'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    ss = Val(RC("res"))

                End If
                FRC = subres.Select("test_code='150'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='151'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='152'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='153'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='154'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='155'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='156'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='158'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='159'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
                FRC = subres.Select("test_code='160'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
            End If
            FRC = subres.Select("Mtest_code='30'")

            If FRC.Length > 0 Then
                Dim qqqwww As Double = 0
                FRC = subres.Select("test_code='669'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    qqqwww = Val(RC("res"))
                End If
                FRC = subres.Select("test_code='670'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    qqqwww = Math.Round((qqqwww / Val(RC("res"))) * 100, 2)
                End If
                FRC = subres.Select("test_code='668'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("res") = qqqwww
                    RC.EndEdit()
                End If
            End If
            FRC = subres.Select("Mtest_code='602'")

            If FRC.Length > 0 Then
                Dim vlo As Double = 0
                Dim consnt As Double = 0
                FRC = subres.Select("test_code='642'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    vlo = Val(RC("res"))
                End If
                FRC = subres.Select("test_code='646'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    consnt = Val(RC("res"))
                End If
                FRC = subres.Select("test_code='647'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("res") = consnt * vlo
                    RC.EndEdit()
                End If
            End If
            fnor(2)
        End If


    End Sub
    Private Sub ProfilesToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)


    End Sub
    Public Sub prof(ByVal esln As String, ByVal typ As String, ByVal PRN As Integer)

        'On Error Resume Next
        Try

            If lres = 0 And typ <> "prnt" And typ <> "email" Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG("⁄—÷ ‰ ÌÃ…", esl_no.Text, " ⁄—÷ ‰ ÌÃ… " & pname.Text, 0, bran.Text)
                Exit Sub
            End If
            If finals.Checked = False Then
                rp.CrystalReportViewer1.ShowPrintButton = False
                rp.CrystalReportViewer1.ShowExportButton = False
            End If
            dr.Close()


            Dim NT As Int16 = 0
            Dim NN As Integer = 0
            If sprnt = 1 Then Me.Text = "«·—Ã«¡  ”œÌœ «·»«ﬁÏ"
            dr.Close()
            cmd.CommandText = "select MAX(PRNTN) from  lbill_test where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1 and sub=1 AND CULT=0"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows Then
                NN = nulls(dr(0))
            Else
                Exit Sub
            End If

            If sprnt = 0 Then NT = 0
            If sprnt = 1 And REST_PRNT = 1 Then NT = 0
            If sprnt = 1 And REST_PRNT = 0 Then NT = 1
            If lres = 1 Then
                NORE(2, 1)
            End If
            If CSUB.Checked = False Then
                Dim nss As Integer
                nss = 0
                While Not nss = subres.Rows.Count
                    subres.Rows(nss).BeginEdit()
                    If subres.Rows(nss).Item("res") = "-" Or subres.Rows(nss).Item("res") = " " Or subres.Rows(nss).Item("res") = "" Then subres.Rows(nss).Item("qun") = "0" Else subres.Rows(nss).Item("qun") = "1"
                    subres.Rows(nss).EndEdit()
                    nss += 1
                End While
            End If
            SAVERES(0, 0)
            Dim t As Date = Now
            DBS.Tables("pro").Clear()
            cmdpro.Parameters.Clear()
            cmdpro.CommandText = "psub"
            cmdpro.CommandType = CommandType.StoredProcedure
            cmdpro.Parameters.AddWithValue("esl_no", Val(esl_no.Text))
            cmdpro.Parameters.AddWithValue("yearn", Val(YEARN.Text))
            cmdpro.Parameters.AddWithValue("bran", bran.Text)
            adpro.SelectCommand = cmdpro
            adpro.Fill(DBS, "pro")

            Dim t1 As TimeSpan = Now - t

            dr.Close()
            Dim AA As String = ""
            cmd.CommandText = "update lbill_test set rcv=1,take=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1 AND TEST_NAME='" & ppp.Text & "'"
            cmd.ExecuteNonQuery()
            If PRN = 2 Then
                cmd.CommandText = "SELECT  * from v_lab where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1 and sub=0 and  cult=0 ORDER BY GR_NAME"
                dr = cmd.ExecuteReader
                Dim www As Integer = 100
                While dr.Read
                    AA = dr("GR_NAME")
                    RC = Nothing
                    RC = DBS.Tables("pro").NewRow
                    RC("mtest_name") = DBS.Tables("pro").Rows(0).Item("mtest_name")
                    RC("test_name") = dr("test_name")
                    RC("res") = dr("res")
                    RC("ref") = dr("ref")
                    RC("NORE") = dr("NORE")
                    RC("NORB") = dr("NORB")
                    RC("ds") = dr("ds")
                    RC("usr") = dr("usr")
                    RC("nik") = dr("nik")
                    RC("pname") = dr("pname")
                    RC("ptype") = dr("ptype")
                    RC("page") = dr("page")
                    RC("reg_name") = dr("reg_name")
                    RC("esl_date") = dr("esl_date")
                    RC("esl_no") = dr("esl_no")
                    RC("NOTE") = dr("NOTE")
                    RC("NOTEN") = dr("NOTEN")
                    RC("unit") = dr("unit")
                    RC("q") = 10
                    RC("p") = 1
                    RC("so") = www
                    RC("note") = DBS.Tables("pro").Rows(0).Item("note")
                    DBS.Tables("pro").Rows.Add(RC)
                    www = www + 1
                End While
            End If
            '====================HISTORY===========================
            Dim NB As Integer = 0
            While Not NB = DBS.Tables("pro").Rows.Count
                If nulls(DBS.Tables("pro").Rows(NB).Item("PTHN")) = 1 Then
                    dr.Close()
                    cmd.CommandText = "SELECT * FROM v_sub WHERE ESL_NO<>'" & DBS.Tables("pro").Rows(0).Item("ESL_NO") & "' " & " and TDEL=0  and bran='" & bran.Text & "'" & " AND TEST_CODE='" & DBS.Tables("pro").Rows(NB).Item("TEST_CODE") & "' AND PCODE='" & DBS.Tables("pro").Rows(NB).Item("PCODE") & "' ORDER BY  ESL_DATE "
                    dr = cmd.ExecuteReader
                    While dr.Read()
                        DBS.Tables("PRO").Rows(NB).BeginEdit()
                        DBS.Tables("PRO").Rows(NB).Item("PTH") = DBS.Tables("PRO").Rows(NB).Item("PTH") & Environment.NewLine & " " & dr("ESL_DATE") & "                         " & dr("RES") & "    " & dr("UNIT")
                        DBS.Tables("PRO").Rows(NB).EndEdit()
                    End While
                End If
                If nulls(DBS.Tables("pro").Rows(NB).Item("res")) = "0" Then
                    ers.Rows.Add(nulls(DBS.Tables("pro").Rows(NB).Item("test_name")))
                    brpd.BackgroundColor = Color.Red
                End If
                NB = NB + 1
            End While
            '====================END===============================
            rp.CrystalReportViewer1.ShowPrintButton = True
            rp.CrystalReportViewer1.ShowExportButton = True
            If DBS.Tables("pro").Rows.Count > 0 Then
                Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
                oj.Load(Application.StartupPath & rptp.Text & "\res_sub.rpt")
                oj.Database.Tables(0).SetDataSource(DBS.Tables("pro"))
                oj.SetParameterValue("REF", ref1)
                oj.SetParameterValue("11", 0)
                If DBS.Tables("pro").Rows.Count > 0 Then
                    If typ = "rpt" Then
                        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
                        If NT = 0 Then
                            rp.CrystalReportViewer1.ShowPrintButton = True
                            rp.CrystalReportViewer1.ShowExportButton = True
                            dr.Close()
                            dr.Close()
                            If prnitnn = 1 Then
                                cmd.CommandText = "update lbill set sprnt=sprnt+1,printtime='" & ChangeFormatall(Now) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                                cmd.ExecuteNonQuery()
                            End If
                            LLOG("ÿ»«⁄…", esl_no.Text, " ÿ»«⁄… ‰ ÌÃ… " & pname.Text, 1, bran.Text)

                        Else
                            'rp.CrystalReportViewer1.ShowPrintButton = False
                            'rp.CrystalReportViewer1.ShowExportButton = False
                            dr.Close()
                            LLOG("⁄—÷", esl_no.Text, "⁄—÷ ‰ ÌÃ…  " & pname.Text, 1, bran.Text)

                        End If
                        If finals.Checked = False And NT = 0 And fath = 0 Then
                            rp.CrystalReportViewer1.ShowPrintButton = False
                            rp.CrystalReportViewer1.ShowExportButton = False
                        End If
                        If edt = 0 Or REST_PRNT = 0 And fath = 0 Then
                            rp.CrystalReportViewer1.ShowPrintButton = False
                            rp.CrystalReportViewer1.ShowExportButton = False
                        End If
                        rp.Show()
                    ElseIf typ = "prnt" And DBS.Tables("pro").Rows.Count > 0 And lpnum = 1 Then
                        rppnt = 1
                        rp.CrystalReportViewer1.ShowPrintButton = True
                        rp.CrystalReportViewer1.ShowExportButton = True
                        oj.PrintToPrinter(1, False, 0, 0)
                        dr.Close()
                        cmd.CommandText = "update lbill_test set prnttime='" & ChangeFormatall(Now) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1 and sub=1 "
                        cmd.ExecuteNonQuery()

                    ElseIf typ = "email" And DBS.Tables("pro").Rows.Count > 0 Then
                        oj.Load(Application.StartupPath & rptp.Text & "\res_sub.rpt")
                        oj.Database.Tables(0).SetDataSource(DBS.Tables("pro"))
                        oj.SetParameterValue("REF", ref1)
                        oj.SetParameterValue("11", 1)
                        oj.ExportToDisk(CrystalDecisions.[Shared].ExportFormatType.PortableDocFormat, SourceDirectory & "2.pdf")
                    End If

                End If
            End If
        Catch ex As Exception
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','print all','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

   

   
    Public Sub pthg()
        On Error Resume Next
        If pcode.Text = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·„—÷" : Exit Sub
        If pah = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «· «—ÌŒ «·„—÷Ï" & pname.Text, 0, bran.Text)
            Exit Sub
        End If
        Dim yy As String = ""
        If ctest_name.Checked = True Then
            yy = yy & "  " & " and test_name='" & test_name.Text & "'"
        End If
        dr.Close() : cmd.CommandText = "SELECT  * from v_lab where  sub<>1 and bdel=0  and cult<>1  and pcode='" & pcode.Text & "' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' " & yy
        adesl.SelectCommand = cmd
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        DBS.Tables("esl").Clear()
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        brpd.DataSource = esl
        dr.Close()
        cmd.CommandText = "SELECT  * from v_lab where  sub<>1 and bdel=0 and cult<>1 and pcode='" & pcode.Text & "' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' " & yy
        dr = cmd.ExecuteReader
        Dim n As Double = 0
        dr1.Close()
        While dr.Read
            n = 0
            If IsNumeric(dr("res")) = True Then n = dr("res") Else n = 0
            FRC = esl.Select("esl_no='" & dr("esl_no") & "' and test_name='" & dr("test_name") & "' and yearn='" & dr("yearn") & "' and bran='" & dr("bran") & "' ")
            If FRC.Length <= 0 Then
                branch_name.Text = ""
                branch_code.Text = ""
            Else
                RC = FRC(0)
                RC.BeginEdit()
                RC("fres") = n
                RC.EndEdit()
            End If
        End While
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument

        oj.Load(Application.StartupPath & "\hresg.rpt")
        oj.Database.Tables(0).SetDataSource(esl)
        oj.SetParameterValue("1", " ﬁ—Ì—  «—ÌŒ «·Õ«·Ì· Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()

        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «· «—ÌŒ «·„—÷Ï" & pname.Text, 1, bran.Text)
    End Sub
    Public Sub LABTO()
        Try
            If branch_code.Text <> brans And lrcv = 0 Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·›—⁄" : Exit Sub

            b = ""
            t = ""
            If RadioButton1.Checked = True Then
                b = "lbill"
                t = "" & t & ""
            ElseIf RadioButton2.Checked = True Then
                b = "lbilledit"
                t = "lbill_testedit"
            ElseIf RadioButton3.Checked = True Then
                b = "lbilldel"
                t = "lbill_testdel"
            End If
            If rpt = 0 Then

                LLOG("⁄—÷", 0, " ﬁ—Ì—  ›’Ì·Ï ", 0, bran.Text)
                Exit Sub
            End If
            yy1()
            If cptot.Checked = True Then
                yy = yy & "  " & " and " & b & ".ptot" & tptot.Text & "'" & pntot.Text & "'"
            Else
                yy = yy & "  " & " and " & b & ".ptot>0"
            End If
            Dim n As Integer = 0
            ss = ""
            ACdr.Close()
            ACcmd.CommandText = "select * from srh where sort>0 order by sort"
            ACdr = ACcmd.ExecuteReader
            While ACdr.Read
                If ss = "" Then ss = " order by " & ACdr("fld") & " " Else ss = ss & " , " & ACdr("fld") & " "
            End While
            If ctest_name.Checked = True Or ctest_ar.Checked = True Then
                dr.Close() : cmd.CommandText = "SELECT     " & b & ".* FROM " & b & " INNER JOIN  LPATIEN ON " & b & ".pcode = LPATIEN.pcode INNER JOIN  " & t & " ON " & b & ".esl_no = " & t & ".esl_no " & yy & ss
            Else
                dr.Close() : cmd.CommandText = "SELECT     " & b & ".* FROM " & b & " INNER JOIN  LPATIEN ON " & b & ".pcode = LPATIEN.pcode  " & yy & ss
            End If
            adtemp.SelectCommand = cmd
            adtemp.Fill(DBS, "temp")
            temp = DBS.Tables("temp")
            DBS.Tables("temp").Clear()
            adtemp.Fill(DBS, "temp")
            temp = DBS.Tables("temp")
            If RadioButton2.Checked = True Then
                b = "lbill"
                t = "lbill_test"
                yy1()
                If ctest_name.Checked = True Or ctest_ar.Checked = True Then
                    dr.Close() : cmd.CommandText = "SELECT     " & b & ".* FROM " & b & " INNER JOIN  LPATIEN ON " & b & ".pcode = LPATIEN.pcode INNER JOIN  " & t & " ON " & b & ".esl_no = " & t & ".esl_no " & yy & ss
                Else
                    dr.Close() : cmd.CommandText = "SELECT     " & b & ".* FROM " & b & " INNER JOIN  LPATIEN ON " & b & ".pcode = LPATIEN.pcode  " & yy & ss
                End If
                adtemp.SelectCommand = cmd
                adtemp.Fill(DBS, "temp")
                temp = DBS.Tables("temp")
            End If
            F31D.DataSource = temp
            tm = 4
            F31DTG()
            LLOG("⁄—÷", 0, " ﬁ—Ì—  ›’Ì·Ï", 1, bran.Text)
            If RP1.Checked = True Then
                Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
                oj.Load(Application.StartupPath & "\bill lab.rpt")
                oj.Database.Tables(0).SetDataSource(temp)
                oj.SetParameterValue("1", " ﬁ—Ì— «· ›’Ì·Ï Œ·«· › —… „‰ ")
                oj.SetParameterValue("2", d1.Value)
                oj.SetParameterValue("3", d2.Value)
                rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
                rp.Show()
                rp.Focus()
            End If
        Catch ex As Exception
            ' Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','lab report','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

   

    Private Sub Õ›Ÿ Õ«·Ì·«·ÃÂ«“ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If lmach = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, " ﬁ—Ì— «·ÃÂ«“", 0, bran.Text)
            Exit Sub
        End If
        dr.Close()
        cmd.CommandText = " SELECT * FROM lmachine_test WHERE NAME='" & LAB.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            Dim X As String = ""
            X = MsgBox("Â·  —Ìœ «· ⁄œÌ·ø", MsgBoxStyle.YesNo)
            If X = vbNo Then Exit Sub
            dr.Close()
            cmd.CommandText = " DELETE FROM lmachine_test WHERE NAME='" & mach_name.Text & "'"
            cmd.ExecuteNonQuery()
        End If
        ACdr.Close()
        ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun>0 "
        ACdr = ACcmd.ExecuteReader
        If ACdr.HasRows = False Then Me.Text = "«·—Ã«¡ «Œ Ì«—  Õ·Ì· Ê«Õœ ⁄·Ï «·«ﬁ·" : Exit Sub
        dr.Close()
        While ACdr.Read
            cmd.CommandText = "INSERT INTO [lmachine_test]([test_code],[test_name],NAME,CODE) VALUES ('" & ACdr("test_code") & "' ,'" & ACdr("test_name") & "' ,'" & mach_name.Text & "' ,'" & mach_code.Text & "' )"
            cmd.ExecuteNonQuery()
        End While
        LLOG("⁄—÷", 0, " ﬁ—Ì—  Õ«·Ì· «·ÃÂ«“", 1, bran.Text)

    End Sub

    Private Sub ⁄—÷ Õ«·Ì·«·ÃÂ«“ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim x As String = ""
        If CheckBox6.Checked = True Then x = "WHERE NAME='" & mach_name.Text & "'"
        dr.Close() : cmd.CommandText = "SELECT * FROM lmachine_test " & x
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\machine test.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub



    

    Private Sub notes_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles comments.GotFocus
        flng("EN")
    End Sub

    Private Sub comments_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles comments.KeyDown
        If e.KeyCode = Keys.Enter Then
            'GlassButton69_Click(GlassButton69, e)
            comment1.Text = comments.Text
            GlassButton69_Click(GlassButton69, e)
        End If
    End Sub

    Private Sub comments_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles comments.MouseHover
        llname = "comments"
    End Sub

    Private Sub notes_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles comments.TextChanged
        comment1.Text = comments.Text
    End Sub

    Private Sub TextBox4_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles DIRECT_FILM.GotFocus
        flng("EN")
    End Sub

    Private Sub DIRECT_FILM_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles DIRECT_FILM.KeyDown
        If e.KeyCode = Keys.Enter Then
            ires.Focus()

        End If
    End Sub

    Private Sub DIRECT_FILM_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles DIRECT_FILM.MouseHover
        llname = "DIRECT_FILM"
    End Sub



    Private Sub FontColorToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        ColorDialog1.ShowDialog()
        fcolor = ColorDialog1.Color.ToArgb
        colu(Me, Val(bcolor), Val(fcolor))
        dr.Close() : cmd.CommandText = "update USERS set fcolor=" & Val(fcolor) & "  where NAME='" & USR & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub BackColorToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        ColorDialog1.ShowDialog()
        bcolor = ColorDialog1.Color.ToArgb
        colu(Me, Val(bcolor), Val(fcolor))
        dr.Close() : cmd.CommandText = "update USERS set bcolor=" & Val(bcolor) & "  where NAME='" & USR & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub DataGridView2_CellMouseDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles DataGridView2.CellMouseDoubleClick
        On Error Resume Next
        culttestn.Text = DataGridView2(("DataGridViewTextBoxColumn6"), e.RowIndex).Value
        culttestc.Text = DataGridView2(("DataGridViewTextBoxColumn5"), e.RowIndex).Value

        dr.Close() : cmd.CommandText = "select * from Lbill_cult WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_NAME='" & DataGridView2(("DataGridViewTextBoxColumn6"), e.RowIndex).Value & "'"
        adcultd.SelectCommand = cmd
        adcultd.Fill(DBS, "cultd")
        cultd = DBS.Tables("cultd")
        DBS.Tables("cultd").Clear()
        adcultd.Fill(DBS, "cultd")
        cultd = DBS.Tables("cultd")

        DataGridView3.DataSource = cultd

        dr.Close()
        cmd.CommandText = "select * from Lbill_cult_det WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_NAME='" & DataGridView2(("DataGridViewTextBoxColumn6"), e.RowIndex).Value & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            SPECIMEN.Text = dr("SPECIMEN")
            DIRECT_FILM.Text = dr("DIRECT_ FILM")
            Pus_cells.Text = dr("Pus_cells")
            RBCs.Text = dr("RBCs")
            Others.Text = dr("Others")
            Culture_conditions.Text = dr("Culture_conditions")
            Growth_of.Text = dr("Growth_of")
            VAIBLE_COUNT.Text = dr("VAIBLE_COUNT")
            Count_is.Text = dr("Count_is")
            Epithelial.Text = nulls(dr("Epithelial"))
        End If
    End Sub

 

    Public Sub FMTP(ByVal C As Integer)
        If mtp = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "„ÿ«·»… ‘—ﬂ… " & BOOK_name.Text, 0, bran.Text)
            Exit Sub
        End If
        Dim X As String = ""

        If nyes.Checked = True Then X = "and crd_v=0 "
        If nno.Checked = True Then X = "and CASH_v=0 "

        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandType = CommandType.Text
        If C = 1 Then
            dr.Close() : cmd.CommandText = "SELECT     * FROM  lbill where  esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' and   book_name='" & BOOK_name.Text & "' and bdel=0 " & X
        Else
            dr.Close() : cmd.CommandText = "SELECT     sum(crd_v) as tot ,company_name,book_name FROM  lbill where esl_date between '" & ChangeFormat(d1.Value) & "' and  '" & ChangeFormat(d2.Value) & "' and bdel=0 and  book_name='" & BOOK_name.Text & "' " & X & " group by company_name,book_name "
        End If
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, "„ÿ«·»… ‘—ﬂ… " & BOOK_name.Text, 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        If C = 1 Then oj.Load(Application.StartupPath & "\company.rpt") Else oj.Load(Application.StartupPath & "\company all.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("1", " ﬁ—Ì— «·‘—ﬂ… ")
        oj.SetParameterValue("4", BOOK_name.Text)
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub





    Public Sub FTAKE()
        If lrcv = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, " ﬁ—Ì— «” ·«„ «· Õ«·Ì· ", 0, bran.Text)
            Exit Sub
        End If
        Dim X As String = ""
        If nyes.Checked = True Then X = "and take=1"
        If nno.Checked = True Then X = "and take=0"

        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandType = CommandType.Text
        dr.Close() : cmd.CommandText = "SELECT     * FROM  lbill_test    where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' " & X
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, " ﬁ—Ì— «” ·«„ «· Õ«·Ì· ", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\taken.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)

        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj

        rp.Show() : rp.Focus()
    End Sub

    Private Sub Growth_of_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles Growth_of.GotFocus
        flng("EN")
    End Sub

    Private Sub Growth_of_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Growth_of.KeyDown

    End Sub

    Private Sub Growth_of_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Growth_of.KeyUp
        If tblg = 1 Then Exit Sub
        If Growth_of.Text = "" Then Exit Sub
        dr.Close() : cmd.CommandText = "select * from lGrowth_of WHERE name LIKE '%" & Growth_of.Text & "%'"
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        Dim v As Integer = 0
        While Not v = brpd.Columns.Count
            brpd.Columns(v).Visible = False
            v = v + 1
        End While
        brpd.Columns("NAME").Visible = True
        brpd.Columns("NAME").HeaderText = "Growth of"
        brpd.Columns("NAME").Width = 300
        tm = 8

    End Sub

    Private Sub Growth_of_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Growth_of.MouseHover
        llname = "Growth_of"
    End Sub



    Public Sub FCULT(ByVal MM As String)
        Try
            If lres = 0 And MM <> "prnt" And MM <> "email" Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG("⁄—÷ ‰ ÌÃ…", esl_no.Text, "⁄—÷ ‰ ÌÃ… " & pname.Text, 0, bran.Text)
                Exit Sub
            End If
            rp.CrystalReportViewer1.ShowPrintButton = True
            rp.CrystalReportViewer1.ShowExportButton = True

            Dim NT As Int16 = 0
            Dim NN As Integer = 0
            If sprnt = 1 Then Me.Text = "«·—Ã«¡  ”œÌœ «·»«ﬁÏ"
            dr.Close()
            cmd.CommandText = "select MAX(PRNTN) from  lbill_test where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1 and sub=0 AND CULT=1"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows Then
                NN = nulls(dr(0))
            Else
                Exit Sub
            End If

            If sprnt = 0 Then NT = 0
            If sprnt = 1 And REST_PRNT = 1 Then NT = 0
            If sprnt = 1 And REST_PRNT = 0 Then NT = 1

            DBS.Tables("cultf").Clear()
            cmdcultf.Parameters.Clear()
            cmdcultf.CommandText = "pcult"
            cmdcultf.CommandType = CommandType.StoredProcedure
            cmdcultf.Parameters.AddWithValue("esl_no", Val(esl_no.Text))
            cmdcultf.Parameters.AddWithValue("yearn", Val(YEARN.Text))
            cmdcultf.Parameters.AddWithValue("bran", bran.Text)
            adCULTF.SelectCommand = cmdcultf
            adCULTF.Fill(DBS, "cultf")
            Threading.Thread.Sleep(2)
            If DBS.Tables("cultf").Rows.Count > 0 Then
                Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
                oj.Load(Application.StartupPath & rptp.Text & "\res cult.rpt")
                oj.Database.Tables(0).SetDataSource(DBS.Tables("cultf"))
                oj.SetParameterValue("REF", ref1)
                oj.SetParameterValue("11", 0)
                If MM = "PRNT" And lpnum = 1 Then
                    rppnt = 1
                    rp.CrystalReportViewer1.ShowPrintButton = True
                    rp.CrystalReportViewer1.ShowExportButton = True
                    oj.PrintToPrinter(1, False, 0, 0)
                    dr.Close()
                    cmd.CommandText = "update lbill_test set prnttime='" & ChangeFormatall(Now) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1 and  CULT=1"
                    cmd.ExecuteNonQuery()

                ElseIf MM = "RPT" Then
                    rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
                    If NT = 0 Then
                        rp.CrystalReportViewer1.ShowPrintButton = True
                        rp.CrystalReportViewer1.ShowExportButton = True
                        dr.Close()
                        dr.Close()
                        If prnitnn = 1 Then
                            cmd.CommandText = "update lbill set sprnt=sprnt+1 ,printtime='" & ChangeFormatall(Now) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                            cmd.ExecuteNonQuery()

                        End If
                        LLOG(" ‰ ÌÃ… ÿ»«⁄…", esl_no.Text, " ÿ»«⁄… ‰ ÌÃ… " & pname.Text, 1, bran.Text)
                    Else
                        'rp.CrystalReportViewer1.ShowPrintButton = False
                        'rp.CrystalReportViewer1.ShowExportButton = False
                        dr.Close()
                        LLOG("‰ ÌÃ… ⁄—÷ ", esl_no.Text, "⁄—÷ ‰ ÌÃ… " & pname.Text, 1, bran.Text)
                    End If
                    If finals.Checked = False And NT = 0 And fath = 0 Then
                        rp.CrystalReportViewer1.ShowPrintButton = False
                        rp.CrystalReportViewer1.ShowExportButton = False
                    End If
                    If edt = 0 Or REST_PRNT = 0 And fath = 0 Then
                        rp.CrystalReportViewer1.ShowPrintButton = False
                        rp.CrystalReportViewer1.ShowExportButton = False
                    End If
                    rp.ShowDialog()
                ElseIf UCase(MM) = "EMAIL" Then
                    oj.Load(Application.StartupPath & rptp.Text & "\res cult.rpt")
                    oj.Database.Tables(0).SetDataSource(DBS.Tables("cultf"))
                    oj.SetParameterValue("REF", ref1)
                    oj.SetParameterValue("11", 1)
                    oj.ExportToDisk(CrystalDecisions.[Shared].ExportFormatType.PortableDocFormat, SourceDirectory & "3.pdf")
                End If
            End If
        Catch ex As Exception
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','print all','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
    Private Sub «Ì—«œ«· Õ·Ì·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub ⁄œœ Õ«·Ì·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)


    End Sub

    Private Sub DataGridView1_CellStyleContentChanged(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellStyleContentChangedEventArgs) Handles DataGridView1.CellStyleContentChanged

    End Sub

    Private Sub DataGridView1_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles DataGridView1.KeyDown
        If e.KeyCode = Keys.ShiftKey Then
            dr.Close()
            cmd.CommandText = "select * from lhres where sh='" & lrr.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                FRC = testres.Select("TEST_NAME='" & ppp.Text & "'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("RES") = dr("name")
                    RC.EndEdit()
                End If
            End While
        End If
        If e.KeyCode = Keys.Enter Then

        End If

    End Sub

    Private Sub dissn_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles dissn.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        dissn.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "dissn")
    End Sub

    Private Sub dissn_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles dissn.KeyDown

    End Sub

    Private Sub dissn_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles dissn.KeyPress
        If edt = 0 And finals.Checked = True And mng = 0 Then MsgBox("·« Ì„ﬂ‰  ⁄œÌ· «·Œ’„") : e.Handled = True
        If edt = 0 And ChangeFormat(Now.Date) <> ChangeFormat(esl_date.Value) And mng = 0 Then MsgBox("·« Ì„ﬂ‰  ⁄œÌ· «·Œ’„") : e.Handled = True

        If ldis = 0 Then e.Handled = True


    End Sub

    Private Sub dissn_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles dissn.KeyUp
        If e.KeyCode = Keys.Enter Then
            DISS.Text = 0
            ACdr.Close()
            ACcmd.CommandText = "update test_price set dis_n='" & Val(dissn.Text) & "'"
            ACcmd.ExecuteNonQuery()
            fprice(1)
            SUMT()
        End If
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub dissn_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles dissn.MouseHover
        llname = "dissn"

    End Sub

    Private Sub dissn_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles dissn.TextChanged
        If Val(dissn.Text) > 100 Then dissn.Text = 0


    End Sub

    Private Sub NoteCollectionsToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub COMPANY_name_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles COMPANY_name.GotFocus
        flng(reflang)
        colu(Me, Val(bcolor), Val(fcolor))
        'test_name.BackColor = Color.Silver
        COMPANY_name.BackColor = Color.FromArgb(backcolor1)
        'COMPANY_name.ForeColor = Color.Blue
        sotr(2, "COMPANY_name")
        FFIND = "COMPANY_name"
        FFINDT = COMPANY_name.Text
    End Sub

    Private Sub COMPANY_name_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles COMPANY_name.KeyDown

    End Sub

    Private Sub COMPANY_name_KeyUp1(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles COMPANY_name.KeyUp
        If COMPANY_name.Text = "" Then Exit Sub
        ccname = COMPANY_name.Text
        If e.KeyCode = Keys.B AndAlso e.Control Then
            typec = 2
            blockitem()
        End If
        'dr.Close()
        'cmd.Connection = CN
        'cmd.CommandType = CommandType.Text
        'cmd.CommandText = "select * from Lcompany WHERE name LIKE '%" & COMPANY_name.Text & "%'"
        'adtemp.SelectCommand = cmd
        'adtemp.Fill(DBS, "temp")
        'temp = DBS.Tables("temp")
        'DBS.Tables("temp").Clear()
        'adtemp.Fill(DBS, "temp")
        'temp = DBS.Tables("temp")
        'brpd.DataSource = temp
        'Dim v As Integer = 0
        'While Not v = brpd.Columns.Count
        '    brpd.Columns(v).Visible = False
        '    v = v + 1
        'End While
        'brpd.Columns("code").Visible = True
        'brpd.Columns("name").Visible = True
        'brpd.Columns("name").Width = 300

        tm = 3
        If e.KeyCode = Keys.Enter Then
            typec = 2
            openblock()

            fcompany(1)
        End If
        If e.KeyCode = Keys.F6 Then
            fufind()
        End If
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub
    Public Sub fcompany(ByVal asx As Integer)
       
        On Error GoTo mmm
mmm:
        dr.Close()
        If asx = 1 Then
            If COMPANY_name.Text = "" Then Me.Text = "«ﬂ » «”„ «·ÃÂ…" : Exit Sub
            cmd.CommandText = "select * from Lcompany where name='" & COMPANY_name.Text & "'"
        ElseIf asx = 2 Then
            If COMPANY_CODE.Text <> "" Then cmd.CommandText = "select * from Lcompany where code='" & COMPANY_CODE.Text & "'" Else GoTo smm
        End If
        If IsNumeric(COMPANY_name.Text) = True Then
            COMPANY_CODE.Text = COMPANY_name.Text
            cmd.CommandText = "select * from Lcompany where code='" & COMPANY_CODE.Text & "'"
        End If
        If asx = 3 Then
            If REG_name.Text = "" Then Me.Text = "«ﬂ » «”„ «·ÃÂ…" : Exit Sub
            cmd.CommandText = "select * from Lcompany where name='" & REG_name.Text & "'"
            If IsNumeric(REG_name.Text) = True Then
                REG_CODE.Text = REG_name.Text
                cmd.CommandText = "select * from Lcompany where code='" & REG_CODE.Text & "'"
            End If
        End If

        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            If asx <> 3 Then
                COMPANY_name.Text = dr("name")
                COMPANY_CODE.Text = dr("code")
                BOOK_name.Text = dr("BOOK_PRICE_NAME")
                BOOK_CODE.Text = dr("BOOK_PRICE_CODE")
                dissn.Text = dr("diss")
                tell.Text = dr("tel")
                doc_per.Text = dr("add1")
                eml.Text = dr("email")
                nik.Text = dr("nik")
                pinc.Text = dr("inc")
                pcrd.Text = dr("crd")
                pcanc.Text = dr("canc")
                REG_name.Text = dr("name")
                REG_CODE.Text = dr("code")
                If LABOUT = 1 Then labd.Text = nulls(dr("NAME1"))
                benff()
                TPRICE()
            Else
                REG_name.Text = dr("name")
                REG_CODE.Text = dr("code")
            End If

        Else
            If IsNumeric(COMPANY_name.Text) = True Then Exit Sub
            If IsNumeric(REG_name.Text) = True Then Exit Sub
            If ldref = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG("Õ›Ÿ ÃœÌœ", 0, "ÃÂ… " & COMPANY_name.Text, 0, bran.Text)
                Exit Sub
            End If
            Dim comp As String
            Dim compc As Integer = 0
            If asx = 3 Then comp = REG_name.Text Else comp = COMPANY_name.Text
            If asx = 2 Then Exit Sub
            dr.Close()
            Dim n As String = 0
            n = ""
            If msga = 1 Then
                If lng = "AR" And asx <> 3 Then n = MsgBox(SAVEAR & " " & comp, MsgBoxStyle.YesNo) Else n = MsgBox(SAVEEN & " " & comp, MsgBoxStyle.YesNo)
                If n = vbNo Then Exit Sub
            End If
            n = 0
            Dim ASK1 As String = comp
            ASK1 = ASK1.Replace("Ï", "%")
            ASK1 = ASK1.Replace("Ì", "%")
            ASK1 = ASK1.Replace("√", "%")
            ASK1 = ASK1.Replace("«", "%")
            ASK1 = ASK1.Replace("Â", "%")
            ASK1 = ASK1.Replace("·¬", "%")
            ASK1 = ASK1.Replace("…", "%")
            ASK1 = ASK1.Replace(" ", "%")
            dr1.Close()
            cmd1.CommandText = "select CODE , NAME from lcompany where  NAME LIKE '%" & ASK1 & "%'"
            dr1 = cmd1.ExecuteReader
            If dr1.HasRows Then
                Dim xxaa As String = ""
                xxaa = xxaa & Environment.NewLine
                While dr1.Read
                    xxaa = xxaa & Environment.NewLine & dr1(0) & "     " & dr1(1)
                End While
                MsgBox(xxaa, MsgBoxStyle.Information)
            End If
            Dim ASK As String = MsgBox("Â·  —Ìœ Õ›Ÿ «·ÃÂ…", MsgBoxStyle.YesNo)
            If ASK = vbNo Then Exit Sub
            Dim xxx As String = 0
            xxx = InputBox("«œŒ· «· ·Ì›Ê‰ ")
            Dim xx As Integer = 0
            FRC = BOOK.Select("code='1'")
            If FRC.Length <= 0 Then
            Else
                RC = FRC(0)
                BOOK_name.Text = RC("name")
                BOOK_CODE.Text = 1
            End If
            dr.Close()
            cmd.CommandText = "select max(code) from lcompany "
            dr = cmd.ExecuteReader
            dr.Read()
            compc = nulls(dr(0)) + 1
            If n = "" Then n = 0
            If xxx = "" Then xxx = "-"
            dr.Close()
            cmd.CommandText = "SELECT * FROM Lcompany WHERE NAME='" & comp & "'"
            dr = cmd.ExecuteReader
            If dr.HasRows = False Then
                dr.Close()
                cmd.CommandText = "insert into Lcompany (code,name,[book_price_code],[book_price_name],[ph],[ch] ,[pp],[cp],[ps],[cs],[pw],[cw],diss,[add1],email,tel,nik,BRAN)  values ('" & compc & "','" & Trim(comp) & "','" & BOOK_CODE.Text & " ','" & BOOK_name.Text & "','100','0' ,'100','0','100','0','100','0','" & n & "','0','-','" & xxx & "','" & nik.Text & "','" & RRVV & "')"
                cmd.ExecuteNonQuery()
            End If
            RC = scompany.NewRow
            RC("name") = comp
            scompany.Rows.Add(RC)
            REG_name.Items.Add(comp)
            If asx = 3 Then REG_name.Text = comp Else COMPANY_name.Text = comp
            If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" & " " & comp Else Me.Text = "IT'S SAVED" & " " & comp
            LLOG("Õ›Ÿ ÃœÌœ", 0, "ÃÂ… " & comp, 1, bran.Text)
            GoTo mmm

        End If
smm:
        sotr(1, "")



    End Sub
    Private Sub COMPANY_name_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles COMPANY_name.LostFocus
        'fcompany(1)
        dr.Close()
        cmd.CommandText = "SELECT * FROM lcompany WHERE code='" & COMPANY_CODE.Text & "' and NAME='" & COMPANY_name.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = False Then
            COMPANY_name.Focus()
            COMPANY_name.BackColor = Color.Red
            Exit Sub
        End If
    End Sub

    Private Sub COMPANY_name_MouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles COMPANY_name.MouseClick


    End Sub

    Private Sub COMPANY_name_MouseDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles COMPANY_name.MouseDoubleClick


    End Sub

    Private Sub COMPANY_name_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles COMPANY_name.MouseHover
        llname = "COMPANY_name"
        nyes.Text = "‰ﬁœÏ"
        nno.Text = "«Ã· "
        nall.Text = "œ«Œ·Ï"
    End Sub



    Private Sub COMPANY_name_SelectedIndexChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles COMPANY_name.SelectedIndexChanged

        If COMPANY_name.Focused = False Then Exit Sub
        If COMPANY_name.Text = "" Then Exit Sub
        ccname = COMPANY_name.Text
       

    End Sub
    Public Sub companydis()
        ACdr.Close()
        ACcmd.CommandText = "update test_price set dis=0"
        ACcmd.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "select * from ldiss  where company_code='" & COMPANY_CODE.Text & "'"
        dr = cmd.ExecuteReader
        ACdr.Close()
        While dr.Read
            ACcmd.CommandText = "update test_price set dis='" & dr("price") & "'  where  test_code=" & dr("test_code")
            ACcmd.ExecuteNonQuery()
        End While
    End Sub
    Private Sub pmobile_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles pmobile.GotFocus
        PMMM = 0
        colu(Me, Val(bcolor), Val(fcolor))
        pmobile.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "pmobile")
        FFIND = "pmobile"
        FFINDT = pmobile.Text
    End Sub

    Private Sub pmobile_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles pmobile.KeyDown
        If e.KeyCode = Keys.F2 Then
            FIND.NFLD.Text = " pmobile "
            FIND.SNAME.Text = pmobile.Text
            FIND.ShowDialog()
        End If
    End Sub

    Private Sub pmobile_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles pmobile.KeyUp
        If PMMM = 0 Then PMMM = 1 : Exit Sub
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
        If e.KeyCode = Keys.F6 Then
             fufind()
        End If
    End Sub

    Private Sub pmobile_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles pmobile.MouseHover
        llname = "pmobile"

    End Sub

    Private Sub pmobile_TextAlignChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles pmobile.TextAlignChanged

    End Sub

    Private Sub pmobile_TextChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pmobile.TextChanged

    End Sub

    Private Sub COMPANY_CODE_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles COMPANY_CODE.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        COMPANY_CODE.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "COMPANY_CODE")

    End Sub

    Private Sub COMPANY_CODE_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles COMPANY_CODE.KeyUp
        If e.KeyCode = Keys.Enter Then
            fcompany(2)
        End If
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub lnotes_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles lnotes.GotFocus
        flng("AR")
        colu(Me, Val(bcolor), Val(fcolor))
        lnotes.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "lnotes")
        FFIND = "lnotes"
        FFINDT = lnotes.Text
    End Sub

    Private Sub lnotes_HandleCreated(ByVal sender As Object, ByVal e As System.EventArgs) Handles lnotes.HandleCreated

    End Sub

    Private Sub notes_Invalidated(ByVal sender As Object, ByVal e As System.Windows.Forms.InvalidateEventArgs) Handles lnotes.Invalidated

    End Sub

    Private Sub notes_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles lnotes.KeyDown
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
        If e.KeyCode = Keys.Control Then
            If lnotes.Text = "" Then Exit Sub
            If DEL = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG("Õ–›", 0, "„·«ÕŸ… " & lnotes.Text, 0, bran.Text)
                Exit Sub
            End If
            Dim n As String
            If msga = 1 Then
                If lng = "AR" Then n = MsgBox(DELAR & " " & lnotes.Text, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN & " " & lnotes.Text, MsgBoxStyle.YesNo)
                If n = vbNo Then Exit Sub
            End If
            If lnotes.Text = "" Then Me.Text = "«·—Ã«¡ «· √ﬂœ „‰ «·„·«ÃŸ…" : Exit Sub
            dr.Close()
            cmd.CommandText = "select * from lnotes where   name='" & lnotes.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows Then
                dr.Close()
                cmd.CommandText = "delete from lnotes where    name='" & lnotes.Text & "'"
                cmd.ExecuteNonQuery()
            End If
            dr.Close()
            lnotes.Items.Clear()
            cmd.CommandText = "select * from lnotes "
            dr = cmd.ExecuteReader
            While dr.Read
                lnotes.Items.Add(dr("name"))
            End While
            LLOG("Õ–›", 0, "„·«ÕŸ… " & lnotes.Text, 1, bran.Text)
        End If
    End Sub




    Private Sub DTEST_SUB_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles DTEST_SUB.KeyDown

        If e.KeyCode = Keys.ShiftKey Then
            dr.Close()
            cmd.CommandText = "select * from lhres where sh='" & lrr.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                FRC = subres.Select("TEST_NAME='" & ppp.Text & "'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("RES") = dr("name")
                    RC.EndEdit()
                End If
            End While
        End If
        If e.KeyCode = Keys.Enter Then

        End If

    End Sub

    Private Sub PNTEST_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)


    End Sub
    Private Sub TabPage6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TabPage6.Click

    End Sub

    Private Sub DataGridView3_CellBeginEdit(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellCancelEventArgs) Handles DataGridView3.CellBeginEdit
        On Error Resume Next
        cures.Text = DataGridView3(e.ColumnIndex, e.RowIndex).Value
    End Sub

    Private Sub DataGridView3_CellClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView3.CellClick
        On Error Resume Next
        cures.Text = DataGridView3(e.ColumnIndex, e.RowIndex).Value
    End Sub

    Private Sub DataGridView3_CellContentClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView3.CellContentClick

        On Error Resume Next
        cures.Text = DataGridView3(e.ColumnIndex, e.RowIndex).Value
    End Sub

    Private Sub DataGridView3_CellEndEdit(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView3.CellEndEdit
        On Error Resume Next
        cures.Text = DataGridView3(e.ColumnIndex, e.RowIndex).Value
        'On Error Resume Next
        'cures.Text = DataGridView3(e.ColumnIndex, e.RowIndex).Value
        'Dim tt As String = ""
        'DataGridView3.Refresh()
        'dr.Close()
        'cmd.CommandText = "select * from Lcult WHERE shr ='" & cures.Text & "'"
        'dr = cmd.ExecuteReader
        'dr.Read()
        'If dr.HasRows = False Then Exit Sub
        'tt = dr("name")
        'FRC = cultd.Select("NAME1='" & tt & "'")
        'If FRC.Length > 0 Then Me.text = "Â–« «·œÊ«¡ „”Ã· „”»ﬁ«" : Exit Sub
        'FRC = cultd.Select("NAME3='" & tt & "'")
        'If FRC.Length > 0 Then Me.text = "Â–« «·œÊ«¡ „”Ã· „”»ﬁ«" : Exit Sub
        'FRC = cultd.Select("NAME2='" & tt & "'")
        'If FRC.Length > 0 Then Me.text = "Â–« «·œÊ«¡ „”Ã· „”»ﬁ«" : Exit Sub
        'FRC = cultd.Select("NAME1='" & cures.Text & "'")
        'If FRC.Length > 0 Then
        '    RC = FRC(0)
        '    RC.BeginEdit()
        '    RC("name1") = tt
        '    RC.EndEdit()
        'End If
        'FRC = cultd.Select("NAME3='" & cures.Text & "'")
        'If FRC.Length > 0 Then
        '    RC = FRC(0)
        '    RC.BeginEdit()
        '    RC("name3") = tt
        '    RC.EndEdit()
        'End If

        'FRC = cultd.Select("NAME2='" & cures.Text & "'")
        'If FRC.Length > 0 Then
        '    RC = FRC(0)
        '    RC.BeginEdit()
        '    RC("name2") = tt
        '    RC.EndEdit()
        'End If

    End Sub

    Private Sub DataGridView3_CellMouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles DataGridView3.CellMouseClick
        On Error Resume Next
        If e.ColumnIndex = 4 Then
            tm = 16
        ElseIf e.ColumnIndex = 6 Then
            tm = 17
        ElseIf e.ColumnIndex = 5 Then
            tm = 18

        End If
        On Error Resume Next
        cures.Text = DataGridView3(e.ColumnIndex, e.RowIndex).Value
    End Sub

    Private Sub DataGridView3_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles DataGridView3.KeyDown

        Dim tt As String = ""
        If e.KeyCode = Keys.ShiftKey Then
            'On Error Resume Next
            'cures.Text = DataGridView3(e.ColumnIndex, e.RowIndex).Value
            tt = ""
            DataGridView3.Refresh()
            dr.Close()
            cmd.CommandText = "select * from Lcult WHERE shr ='" & cures.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = False Then Exit Sub
            tt = dr("name")
            FRC = cultd.Select("NAME1='" & tt & "'")
            If FRC.Length > 0 Then Me.Text = "Â–« «·œÊ«¡ „”Ã· „”»ﬁ«" : Exit Sub
            FRC = cultd.Select("NAME3='" & tt & "'")
            If FRC.Length > 0 Then Me.Text = "Â–« «·œÊ«¡ „”Ã· „”»ﬁ«" : Exit Sub
            FRC = cultd.Select("NAME2='" & tt & "'")
            If FRC.Length > 0 Then Me.Text = "Â–« «·œÊ«¡ „”Ã· „”»ﬁ«" : Exit Sub
            FRC = cultd.Select("NAME1='" & cures.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("name1") = tt
                RC.EndEdit()
            End If
            FRC = cultd.Select("NAME3='" & cures.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("name3") = tt
                RC.EndEdit()
            End If
            FRC = cultd.Select("NAME2='" & cures.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("name2") = tt
                RC.EndEdit()
            End If
        End If

    End Sub

    Private Sub brpd_CellMouseDown(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles brpd.CellMouseDown

    End Sub
    Public Sub FEMAIL()
        Try
            If lemail = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG("«—”«·", esl_no.Text, "«—”«· »—Ìœ «·«·ﬂ —Ê‰Ï" & pname.Text, 0, bran.Text)
                Exit Sub
            End If
            dr.Close()
            If esl_no.Text = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·" : Exit Sub
            ACdr.Close()
            ACcmd.CommandText = "delete * from email "
            ACcmd.ExecuteNonQuery()
            TESTS("email")
            prof(esl_no.Text, "email", 1)
            FCULT("EMAIL")

            If pemail.Text = "" Or pemail.Text = "0" Then
                Dim v As String
                flng("EN")
                v = InputBox("«·—Ã«¡ «œŒ«·  «·»—Ìœ «·«·ﬂ —Ê‰Ï")
                If v = "" Then Exit Sub
                dr.Close()
                cmd.CommandText = "update LPATIEN set pemail='" & v & "' where pcode='" & pcode.Text & "'"
                cmd.ExecuteNonQuery()
                pemail.Text = v
            End If
            Dim rrr As Process = Process.Start(Application.StartupPath & "\bar.exe")

            SEMAIL(pemail.Text, pname.Text, "print report date " & esl_date.Value, 1, 0)
            rrr.Kill()
            If emlprg = 1 Then MessageBox.Show(" success send  to ", "  Successful?", MessageBoxButtons.OK, MessageBoxIcon.Information)

            LLOG("«—”«·", esl_no.Text, "«—”«· »—Ìœ «·«·ﬂ —Ê‰Ï" & pname.Text, 1, bran.Text)
        Catch ex As Exception

            Dim st1 As String = "SEND EMAIL"
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
    Private Sub OneToolStripMenuItem_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub ToolStripMenuItem4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub  ﬁ—Ì—«·«” ·«„ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub



    Private Sub GlassButton2_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ45.Click
        If UPDATE_TEST = 0 Then MsgBox("·«  ÊÃœ ’·«ÕÌ…") : Exit Sub
        GroupBox1.Visible = Not GroupBox1.Visible
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandType = CommandType.Text
        If Val(TextBox4.Text) = 1 Then
            dr.Close() : cmd.CommandText = "select * from lntest WHERE test_name = '" & ppp.Text & "'"
        ElseIf Val(TextBox4.Text) = 2 Then
            dr.Close() : cmd.CommandText = "select * from lnstest WHERE test_code = '" & Ntest_CODE.Text & "'"
        Else
            dr.Close() : cmd.CommandText = "select * from lntest WHERE test_name = '" & ppp.Text & "'"
        End If
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 9
        Dim v As Integer = 0
        While Not v = brpd.Columns.Count
            brpd.Columns(v).Visible = False
            v = v + 1
        End While
        brpd.Columns("ref").Visible = True
        brpd.Columns("ref").HeaderText = "ref"
        brpd.Columns("ref").Width = 100
        brpd.Columns("type").Visible = True
        brpd.Columns("type").Width = 50
        brpd.Columns("ageb").Visible = True
        brpd.Columns("ageb").Width = 50
        brpd.Columns("agee").Visible = True
        brpd.Columns("agee").Width = 50
        brpd.Columns("norb").Visible = True
        brpd.Columns("norb").Width = 50
        brpd.Columns("norb").HeaderText = "from"
        brpd.Columns("nore").Visible = True
        brpd.Columns("nore").Width = 50
        brpd.Columns("nore").HeaderText = "to"
        brpd.Columns("unit").Visible = True
        brpd.Columns("unit").Width = 50
        brpd.Columns("unit").Visible = True
        brpd.Columns("year").HeaderText = "year"
        brpd.Columns("year").Visible = True
        brpd.Columns("year").Width = 50
        TabControl2.SelectTab(0)
    End Sub





    Private Sub GroupBox1_Enter(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GroupBox1.Enter

    End Sub

    Private Sub GroupBox1_MouseDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles GroupBox1.MouseDoubleClick
        GroupBox1.Visible = False
    End Sub



    Private Sub pemail_GotFocus1(ByVal sender As Object, ByVal e As System.EventArgs) Handles pemail.GotFocus
        flng("EN")
        colu(Me, Val(bcolor), Val(fcolor))

        pemail.BackColor = Color.FromArgb(backcolor1)

    End Sub

    Private Sub pemail_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles pemail.KeyDown
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub pemail_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles pemail.MouseHover
        llname = "pemail"

    End Sub

    Private Sub pemail_TextChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pemail.TextChanged

    End Sub

    Private Sub BOOK_name_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "BOOK_name"

    End Sub

    Private Sub BOOK_name_SelectedIndexChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs)
        'On Error Resume Next
        If BOOK_name.Focused = False Then Exit Sub
        If BOOK_name.Text = "" Then Exit Sub

        FRC = BOOK.Select("NAME='" & BOOK_name.Text & "'")
        If FRC.Length <= 0 Then
            BOOK_name.Text = ""
            BOOK_CODE.Text = ""
            Exit Sub
        Else
            RC = FRC(0)
            BOOK_CODE.Text = RC("code")
            eml.Text = RC("EMAIL")
            tell.Text = RC("tell")
        End If
    End Sub

    Private Sub btestd_CellMouseDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles btestd.CellMouseDoubleClick

    End Sub

    Private Sub btestd_CurrentCellChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles btestd.CurrentCellChanged
        ''cmdb.DataAdapter = adBILL
        ''adBILL.Update(DBS, "BILL")
        ''SUMT()

    End Sub

    Private Sub btestd_CurrentCellDirtyStateChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles btestd.CurrentCellDirtyStateChanged

    End Sub

    Private Sub btestd_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles btestd.LostFocus
        'cmdb.DataAdapter = adBILL
        'adBILL.Update(DBS, "BILL")
        'SUMT()

    End Sub

    Private Sub btestd_MouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles btestd.MouseClick
        'BILL = DBS.Tables("BILL")
        'btestd.DataSource = BILL
    End Sub

    Private Sub ComboBox2_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)

    End Sub

    Private Sub ComboBox2_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "ComboBox2"

    End Sub



    Private Sub TOEVERYONEToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If lres = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("ÿ»«⁄…", esl_no.Text, "ÿ»«⁄… «·«Ì’«·  ", 1, bran.Text)
            Exit Sub
        End If
        If esl_no.Text = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·" : Exit Sub

        Dim xx As Integer = 0
        If F31.Rows.Count <= 0 Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·« " : Exit Sub
        While Not xx = F31.Rows.Count
            If F31.Rows(xx).RowState = DataRowState.Deleted Then GoTo mmm
            esl_no.Text = F31.Rows(xx).Item("esl_no")
            pname.Text = F31.Rows(xx).Item("pname")
            pemail.Text = F31.Rows(xx).Item("pemail")
            FEMAIL()
mmm:
            xx = xx + 1
        End While
    End Sub

    Private Sub TOONEToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub ComboBox1_DropDown2(ByVal sender As Object, ByVal e As System.EventArgs) Handles ComboBox1.DropDown
        If ptype.Text = "" Then Exit Sub
        ComboBox1.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from ltest "
        dr = cmd.ExecuteReader
        While dr.Read
            ComboBox1.Items.Add(dr("test_name"))
        End While
    End Sub

    Private Sub ComboBox1_KeyDown1(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles ComboBox1.KeyDown
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "select * from ltest where test_code='" & TextBox2.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows Then
                Dim n As String
                n = MsgBox(dr("test_name") & "Â·  —Ìœ  ⁄œÌ· «· Õ·Ì·", MsgBoxStyle.YesNo)
                If n = vbNo Then Exit Sub
                dr.Close()
                cmd.CommandText = "update ltest set test_name='" & ComboBox1.Text & "' where test_code='" & TextBox2.Text & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "update lnstest set test_name='" & ComboBox1.Text & "' where test_code='" & TextBox2.Text & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "update lgroup_test set test_name='" & ComboBox1.Text & "' where test_code='" & TextBox2.Text & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "update ltest_price set test_name='" & ComboBox1.Text & "' where test_code='" & TextBox2.Text & "'"
                cmd.ExecuteNonQuery()
                Me.text = " „  ⁄„·Ì…  ⁄œÌ·"
            End If
        End If
    End Sub

    Private Sub ComboBox1_SelectedIndexChanged_2(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ComboBox1.SelectedIndexChanged
        If ComboBox1.Focus = False Then Exit Sub
        dr.Close()
        cmd.CommandText = "select * from ltest where test_name='" & ComboBox1.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then Exit Sub
        TextBox2.Text = dr("test_code")

    End Sub


    Private Sub «” ·«„«· Õ«·Ì·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub



    Private Sub TabPage5_DoubleClick(ByVal sender As Object, ByVal e As System.EventArgs) Handles TabPage5.DoubleClick

    End Sub

    Private Sub  ﬁ—Ì—«·„»·€ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

        '============================
    End Sub
    Public Sub ftblg()
        If ltblg = 0 Then
            If lng = "AR" Then msgbox(PERMAR) Else msgbox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «· »·Ì€", 0, bran.Text)
            Exit Sub
        End If
        Dim x As String = ""
        If cCOMPANY_CODE.Checked = True Then x = x & " and  COMPANY_code='" & COMPANY_CODE.Text & "'"
        If cuser.Checked = True Then x = x & " and  tblgusr='" & user.Text & "'"
        If ctest_name.Checked = True Then x = x & " and  test_name='" & test_name.Text & "'"
        If nyes.Checked = True Then x = x & " and  tblg='1'"
        If nno.Checked = True Then x = x & " and  tblg='0'"
        If cesl_no.Checked = True Then x = x & " and  ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandType = CommandType.Text
        dr.Close() : cmd.CommandText = "SELECT * from v_lab where  ESL_DATE between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" & x
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\tblg.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «· »·Ì€", 1, bran.Text)

    End Sub

    Private Sub GlassButton7_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq80.Click
        Try
            If lres = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG("ÿ»«⁄…", esl_no.Text, "ÿ»«⁄… ‰ ÌÃ…", 0, bran.Text)
                Exit Sub
            End If
            If esl_no.Text = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·" : Exit Sub

            If sprnt = 1 Then
                Me.Text = "«·—Ã«¡  ”œÌœ «·»«ﬁÏ"
                rp.CrystalReportViewer1.ShowPrintButton = False
                rp.CrystalReportViewer1.ShowExportButton = False

            Else
                rp.CrystalReportViewer1.ShowPrintButton = True
                rp.CrystalReportViewer1.ShowExportButton = True
            End If
            prof(esl_no.Text, "rpt", 2)


            fesl(0, 0)

        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub





    Private Sub pcity_DropDown1(ByVal sender As Object, ByVal e As System.EventArgs) Handles pcity.DropDown
        If pgover.Text = "" Then Exit Sub
        pcity.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from lcity where gover_name='" & pgover.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            pcity.Items.Add(dr("city_name"))
        End While
    End Sub

    Private Sub pcity_SelectedIndexChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pcity.SelectedIndexChanged

    End Sub

    Private Sub pstreet_DropDown1(ByVal sender As Object, ByVal e As System.EventArgs) Handles pstreet.DropDown
        If pgover.Text = "" Then Exit Sub
        If pcity.Text = "" Then Exit Sub
        pstreet.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from lstreet where gover_name='" & pgover.Text & "' and  city_name='" & pcity.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            pstreet.Items.Add(dr("street_name"))
        End While
    End Sub

    Private Sub pstreet_SelectedIndexChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pstreet.SelectedIndexChanged

    End Sub

    Private Sub GlassButton8_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton8.Click
        Dim aa As Integer = 0
        aa = InputBox("enter code ")

        dr.Close()
        cmd.CommandText = "update Branch set esl='" & Val(aa) + 1 & "' where code='" & branch_code.Text & "'"
        cmd.ExecuteNonQuery()
        ACdr.Close()
        ACcmd.CommandText = "update srv set esl='" & Val(aa) & "' "
        ACcmd.ExecuteNonQuery()

    End Sub

    Private Sub cash_per_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles cash_per.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        cash_per.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "cash_per")
    End Sub

    Private Sub cash_per_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles cash_per.KeyUp
        If e.KeyCode = Keys.Enter Then
            crd_per.Text = 100 - Val(cash_per.Text)
        End If
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")

    End Sub

    Private Sub cash_per_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cash_per.MouseHover
        llname = "cash_per"

    End Sub

    Private Sub cash_per_TextChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cash_per.TextChanged
        crd_per.Text = 100 - Val(cash_per.Text)
        FUND()

    End Sub


    Private Sub brpd_CellContentClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles brpd.CellContentClick

    End Sub

    Private Sub  ⁄œÌ·‰”»…«·ÿ»Ì»›Ï«·«Ì’«·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub MSHR_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles MSHR.MouseHover
        llname = "MSHR"
    End Sub

    Private Sub MSHR_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MSHR.TextChanged

    End Sub

    Private Sub  ﬁ—Ì—«·«” ·«„ToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)

        If lng = "AR" Then
            nyes.Text = "«” ·«„"
            nno.Text = "·„ Ì” ·„ "
            nall.Text = "«·ﬂ·"
        Else
            nyes.Text = "Received"
            nno.Text = "not Received"
            nall.Text = "all"
        End If

    End Sub

    Private Sub  ﬁ—Ì—«·ÃÂ«“ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        FMACH()
    End Sub

    Private Sub  ﬁ—Ì—«·«” ·«„ToolStripMenuItem_MouseLeave(ByVal sender As Object, ByVal e As System.EventArgs)



    End Sub

    Private Sub «” ·„ToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        If lng = "AR" Then
            nyes.Text = "«” ·«„"
            nno.Text = "·„ Ì” ·„ "
            nall.Text = "«·ﬂ·"
        Else
            nyes.Text = "Received"
            nno.Text = "not Received"
            nall.Text = "all"
        End If
    End Sub

    Private Sub «” ·„ToolStripMenuItem_MouseLeave(ByVal sender As Object, ByVal e As System.EventArgs)



    End Sub

    Private Sub  ﬁ—Ì—«·ÃÂ«“ToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        If lng = "AR" Then
            nyes.Text = "«” ·«„"
            nno.Text = "·„ Ì” ·„ "
            nall.Text = "«·ﬂ·"
        Else
            nyes.Text = "Received"
            nno.Text = "not Received"
            nall.Text = "all"
        End If
    End Sub

    Private Sub  ﬁ—Ì—«·ÃÂ«“ToolStripMenuItem_MouseLeave(ByVal sender As Object, ByVal e As System.EventArgs)



    End Sub

    Private Sub  ﬁ—Ì—”Õ»«·⁄Ì‰ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        FTAKE()
    End Sub

    Private Sub  ﬁ—Ì—”Õ»«·⁄Ì‰ToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        If lng = "AR" Then
            nyes.Text = "”Õ» "
            nno.Text = "·„  ”Õ» "
            nall.Text = "«·ﬂ·"
        Else
            nyes.Text = "sampll"
            nno.Text = "not sampll"
            nall.Text = "all"
        End If
    End Sub

    Private Sub  ﬁ—Ì—”Õ»«·⁄Ì‰ToolStripMenuItem_MouseLeave(ByVal sender As Object, ByVal e As System.EventArgs)



    End Sub

    Private Sub «Ã„«·ÏToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        If lng = "AR" Then
            nyes.Text = "‰ﬁœÏ"
            nno.Text = "«Ã· "
            nall.Text = "‰ﬁœÏ Ê «Ã·"
        Else
            nyes.Text = "cash"
            nno.Text = "term"
            nall.Text = "all"
        End If
    End Sub

    Private Sub «Ã„«·ÏToolStripMenuItem_MouseLeave(ByVal sender As Object, ByVal e As System.EventArgs)



    End Sub

    Private Sub  ›’Ì·ÏToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        If lng = "AR" Then
            nyes.Text = "‰ﬁœÏ"
            nno.Text = "«Ã· "
            nall.Text = "‰ﬁœÏ Ê «Ã·"
        Else
            nyes.Text = "cash"
            nno.Text = "term"
            nall.Text = "all"
        End If
    End Sub

    Private Sub  ›’Ì·ÏToolStripMenuItem_MouseLeave(ByVal sender As Object, ByVal e As System.EventArgs)



    End Sub

    Private Sub  ﬁ—Ì—«·„»·€ToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        If lng = "AR" Then
            nyes.Text = " „ «· »·Ì€"
            nno.Text = "·„ Ì»·€ "
            nall.Text = "«·ﬂ·"
        Else
            nyes.Text = "intimation"
            nno.Text = "NOT intimation"
            nall.Text = "all"
        End If
    End Sub

    Private Sub  ﬁ—Ì—«·„»·€ToolStripMenuItem_MouseLeave(ByVal sender As Object, ByVal e As System.EventArgs)



    End Sub

    Private Sub «” ·«„«· Õ«·Ì·ToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        If lng = "AR" Then
            nyes.Text = "«” ·«„"
            nno.Text = "·„ Ì” ·„ "
            nall.Text = "«·ﬂ·"
        Else
            nyes.Text = "Received"
            nno.Text = "not Received"
            nall.Text = "all"
        End If
    End Sub

    Private Sub «” ·«„«· Õ«·Ì·ToolStripMenuItem_MouseLeave(ByVal sender As Object, ByVal e As System.EventArgs)



    End Sub

    Private Sub  ”·Ì„«· Õ«·Ì···„⁄„·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub  ”·Ì„«· Õ«·Ì···„⁄„·ToolStripMenuItem_DoubleClick(ByVal sender As Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub  ”·Ì„«· Õ«·Ì···„⁄„·ToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        If lng = "AR" Then
            nyes.Text = "«” ·«„"
            nno.Text = "·„ Ì” ·„ "
            nall.Text = "«·ﬂ·"
        Else
            nyes.Text = "SEND"
            nno.Text = "not SEND"
            nall.Text = "all"
        End If
    End Sub

    Private Sub  ”·Ì„«· Õ«·Ì···„⁄„·ToolStripMenuItem_MouseLeave(ByVal sender As Object, ByVal e As System.EventArgs)



    End Sub


    Private Sub YEAR1_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles PYEAR.GotFocus
        flng("EN")
        colu(Me, Val(bcolor), Val(fcolor))
        PYEAR.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "YEAR1")
    End Sub

    Private Sub YEAR1_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles PYEAR.KeyDown
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub PYEAR_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles PYEAR.MouseHover
        llname = "PYEAR"

    End Sub


    Private Sub YEAR1_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PYEAR.SelectedIndexChanged

    End Sub

    Private Sub GlassButton15_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton13_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton13.Click
        If DOC_name.Text = "" Then Me.text = "«·—Ã«¡ «œŒ«· «”„ «·„‰œÊ»" : Exit Sub

        If ldelgat = 0 Then
            If lng = "AR" Then msgbox(PERMAR) Else msgbox(PERMEN)
            LLOG("Õ›Ÿ ÃœÌœ", 0, "„‰œÊ» " & DOC_name.Text, 0, bran.Text)
            Exit Sub
        End If
        Dim N1 As String
        N1 = ""
        If msga = 1 Then
            If lng = "AR" Then N1 = MsgBox(SAVEAR & " " & DOC_name.Text, MsgBoxStyle.YesNo) Else N1 = MsgBox(SAVEEN & " " & DOC_name.Text, MsgBoxStyle.YesNo)
            If N1 = vbNo Then Exit Sub
        End If
        dr.Close()
        cmd.CommandText = "select * from ldoc where name='" & DOC_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            dr.Close()
            Dim n As String = 0
            n = InputBox("«œŒ· —ﬁ„ «·Â« ›")
            Dim xxx As String = 0
            xxx = InputBox("enter email  ")
            Dim xx As Integer = 0
            dr.Close()
            cmd.CommandText = "select max(code) from ldoc "
            dr = cmd.ExecuteReader
            dr.Read()
            DOC_CODE.Text = 1 + nulls(dr(0))
            dr.Close()
            dr.Close() : cmd.CommandText = "insert into ldoc (code,name,tell,tell1,email)  values ('" & DOC_CODE.Text & "','" & Trim(DOC_name.Text) & "','" & n & "','','" & xxx & "')"
            cmd.ExecuteNonQuery()
            LLOG("Õ›Ÿ ÃœÌœ", 0, "„‰œÊ» " & DOC_name.Text, 1, bran.Text)

            Dim x As Integer = 0
            While Not x = DOC.Rows.Count
                DOC_name.AutoCompleteCustomSource.Add(DOC.Rows(x).Item("name"))
                x = x + 1
            End While
            If msga = 1 Then
                If lng = "AR" Then Me.text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" & " " & DOC_name.Text Else Me.text = "IT'S SAVED" & " " & DOC_name.Text
            End If
        End If

    End Sub

    Private Sub GlassButton18_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)



    End Sub

    Private Sub GlassButton20_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub
    Public Sub FLNBF(ByVal S As Integer, ByVal XX As Integer)
        Dim SM As String = ""
        dr.Close()
        Dim SS As String = ""
        Dim N As Integer = 0
        If CheckBox11.Checked = True Then
            SS = "WHERE esl_date='" & ChangeFormat(Now.Date) & "'"
            If CBRAN.Checked = True Then SS = SS & " AND branch_name='" & branch_name.Text & "'"
        Else
            If CBRAN.Checked = True Then SS = " WHERE branch_name='" & branch_name.Text & "'"
        End If
        If S = 0 Then SM = "MIN"
        If S = 1 Then SM = "MAX"
        dr.Close()
        If XX = 0 Then

            cmd.CommandText = "SELECT " & SM & " (ESL_NO) FROM LBILL " & SS
            dr = cmd.ExecuteReader
            dr.Read()
            If IsDBNull(dr(0)) = False Then esl_no.Text = dr(0) Else Me.text = "·„ Ì „  ”ÃÌ· «Ï «Ì’«· «·ÌÊ„"
        ElseIf XX = 1 Then
            cmd.CommandText = "SELECT  ESL_NO FROM LBILL " & SS & " ORDER BY  ESL_NO "
            dr = cmd.ExecuteReader
            While dr.Read
                If N = FLNB Then esl_no.Text = dr(0) : Exit While
                esl_no.Text = dr(0)
                N = N + 1
            End While
        ElseIf XX = 2 Then
            If FLNB = -1 Then
                dr.Close()
                cmd.CommandText = "SELECT COUNT(ESL_NO) FROM LBILL " & SS
                dr = cmd.ExecuteReader
                dr.Read()
                FLNB = dr(0) - 2
            End If
            dr.Close()
            cmd.CommandText = "SELECT  ESL_NO FROM LBILL " & SS & " ORDER BY  ESL_NO "
            dr = cmd.ExecuteReader
            While dr.Read
                If N = FLNB Then esl_no.Text = dr(0) : Exit While
                esl_no.Text = dr(0)
                N = N + 1
            End While
        End If
        fesl(0, 0)

    End Sub

    Private Sub GlassButton19_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton21_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

        'FLNBF(1, 2)
    End Sub

    Private Sub GlassButton24_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

        'FLNBF(1, 1)
    End Sub

    Private Sub GlassButton26_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton26.Click
        If ldelgat = 0 Then
            If lng = "AR" Then msgbox(PERMAR) Else msgbox(PERMEN)
            LLOG("Õ–›", 0, "„‰œÊ» " & DOC_name.Text, 0, bran.Text)
            Exit Sub
        End If
        Dim N1 As String
        N1 = ""
        If msga = 1 Then
            If lng = "AR" Then N1 = MsgBox(SAVEAR & " " & DOC_name.Text, MsgBoxStyle.YesNo) Else N1 = MsgBox(SAVEEN & " " & DOC_name.Text, MsgBoxStyle.YesNo)
            If N1 = vbNo Then Exit Sub
        End If
        If DOC_name.Text = "" Then Me.text = "«Œ «— «·„‰œÊ»" : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from ldoc where name='" & DOC_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            dr.Close()
            Dim n As String = 0
            If tell.Text = "" Then Me.text = "«œŒ· —ﬁ„ «·Â« ›"
            dr.Close() : cmd.CommandText = "delete ldoc   where name='" & DOC_name.Text & "'"
            cmd.ExecuteNonQuery()
            LLOG("Õ–›", 0, "„‰œÊ» " & DOC_name.Text, 1, bran.Text)

            If msga = 1 Then
                If lng = "AR" Then Me.text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" & " " & DOC_name.Text Else Me.text = "IT'S SAVED" & " " & DOC_name.Text
            End If
        End If

    End Sub


    Private Sub GlassButton25_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim N1 As String
        N1 = ""
        If msga = 1 Then
            If lng = "AR" Then N1 = MsgBox(SAVEAR, MsgBoxStyle.YesNo) Else N1 = MsgBox(SAVEEN, MsgBoxStyle.YesNo)
            If N1 = vbNo Then Exit Sub
        End If
        If COMPANY_name.Text = "" Then Exit Sub
        If ldref = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG(" ⁄œÌ·", 0, "ÃÂ… " & COMPANY_name.Text, 0, bran.Text)
            Exit Sub
        End If

        dr.Close()
        cmd.CommandText = "select * from lcompany where code='" & COMPANY_CODE.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            dr.Close()
            If msga = 1 Then
                Dim nn As String
                nn = MsgBox(EDITEN, MsgBoxStyle.YesNo)
                If nn = vbNo Then Exit Sub
            End If
            Dim n As String = 0
            If tell.Text = "" Then Me.Text = "«œŒ· —ﬁ„ «·Â« ›"
            dr.Close()
            cmd.CommandText = "update lcompany set tel='" & tell.Text & "',diss='" & dissn.Text & "', email='" & eml.Text & "',NIK='" & nik.Text & "',name='" & COMPANY_name.Text & "'  where code='" & COMPANY_CODE.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update lbill set company_name='" & COMPANY_name.Text & "',NIK='" & nik.Text & "' where COMPANY_code='" & COMPANY_CODE.Text & "'"
            cmd.ExecuteNonQuery()
            If msga = 1 Then
                If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" Else Me.Text = "IT'S SAVED"
            End If
            LLOG(" ⁄œÌ·", 0, "ÃÂ… " & COMPANY_name.Text, 0, bran.Text)

        End If
    End Sub





    Private Sub GlassButton17_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton17.Click
        cmdBILL.CommandText = "select * from TEST_PRICE WHERE sub =1 order by so"
        adBILL.SelectCommand = cmdBILL
        adBILL.Fill(DBS, "BILL")
        BILL = DBS.Tables("BILL")
        DBS.Tables("BILL").Clear()
        adBILL.Fill(DBS, "BILL")
        BILL = DBS.Tables("BILL")
        btestd.DataSource = BILL
    End Sub

    Private Sub drb_CellContentClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles drb.CellContentClick

    End Sub

    Private Sub drb_CellEndEdit(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles drb.CellEndEdit
        cmdb.DataAdapter = adhres
        adhres.Update(DBS, "hres")
    End Sub

    Private Sub drb_CellMouseDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles drb.CellMouseDoubleClick
        If Val(TextBox4.Text) = 1 Then
            FRC = testres.Select("TEST_NAME='" & ppp.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("RES") = drb("name", e.RowIndex).Value
                RC.EndEdit()
            End If
        ElseIf Val(TextBox4.Text) = 2 Then
            FRC = subres.Select("TEST_NAME='" & ppp.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("RES") = drb("name", e.RowIndex).Value
                RC.EndEdit()

            End If
        End If

    End Sub

    Private Sub drb_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles drb.KeyDown
        If e.KeyCode = Keys.Escape Then
            drb.Visible = False
        End If
    End Sub

    Private Sub pgover_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles pgover.DropDown

    End Sub

    Private Sub pgover_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles pgover.GotFocus
        flng("AR")
        colu(Me, Val(bcolor), Val(fcolor))
        'pmobile.BackColor = Color.Silver
        pgover.BackColor = Color.FromArgb(backcolor1)
        'pgover.ForeColor = Color.Blue
        sotr(2, "pgover")
        FFIND = "pgover"
        FFINDT = pgover.Text
    End Sub

    Private Sub pgover_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles pgover.KeyUp
        If e.KeyCode = Keys.Enter Then
            If pgover.Text = "" Then pmobile.Focus()
            dr.Close()
            cmd.CommandText = "select * from lgover where gover_name='" & pgover.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = False Then
                dr.Close() : cmd.CommandText = "insert into lgover  (gover_name)  values ('" & pgover.Text & "')"
                cmd.ExecuteNonQuery()
                pgover.Items.Add(pgover.Text)
                pgover.AutoCompleteCustomSource.Add(pgover.Text)


            End If
        End If
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub pgover_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles pgover.MouseHover
        llname = "pgover"
    End Sub

    Private Sub lnotes_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles lnotes.MouseHover
        llname = "lnotes"
    End Sub


    Private Sub GlassButton29_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ30.Click
        fesl(0, 0)
        NORBb()
    End Sub
    Public Sub NORBb()
        'Try
        Dim aww As String = ""
        If PORV <> "" Then aww = " st=1, "
        Dim NORE, NORB, unit, re1, re2 As String
        Dim S As String
        dr.Close()
        ACdr.Close()
        ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun>0 "
        ACdr = ACcmd.ExecuteReader
        If ACdr.HasRows = False Then
            If lng = "AR" Then Me.Text = "«·—Ã«¡ «Œ Ì«—  Õ·Ì· Ê«Õœ ⁄·Ï «·«ﬁ·" Else Me.Text = "choose one test to complete"
            Exit Sub
        End If

        While ACdr.Read
            dr1.Close()
            cmd1.CommandText = "select * from lntest where type='" & ptype.Text & "' and ageb<='" & page.Text & "' and  agee>='" & page.Text & "' and  test_code='" & ACdr("test_code") & "' and year='" & PYEAR.Text & "' "
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            S = " "
            NORE = 0
            NORB = 0
            unit = " "
            If dr1.HasRows = True Then
                If IsDBNull(dr1("ref")) = False Then S = dr1("ref")
                If IsDBNull(dr1("nore")) = False Then NORE = dr1("nore")
                If IsDBNull(dr1("norb")) = False Then NORB = dr1("norb")
                If IsDBNull(dr1("unit")) = False Then unit = dr1("unit")
            End If
            Dim sres As Integer = 0
            If dr1.HasRows = True Then sres = dr1("sres")
            cmd.CommandText = "UPDATE [lbill_test] SET " & aww & " ref='" & S & "',norb='" & NORB & "',sres='" & sres & "',nore='" & NORE & "',unit='" & unit & "' WHERE TEST_CODE='" & ACdr("test_code") & "' and  ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()
        End While
        dr.Close()
        ACdr.Close()
        cmd.CommandText = "select * from lbill_test where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and sub=1"
        dr = cmd.ExecuteReader
        While dr.Read
            ACcmd.CommandText = "update TEST_sub set qun=1 where mtest_name ='" & dr("test_name") & "'"
            ACcmd.ExecuteNonQuery()
        End While
        dr.Close()

        ACcmd.CommandText = "SELECT * FROM TEST_sub where qun=1 "
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            dr1.Close()
            cmd1.CommandText = "select * from lnstest where type='" & ptype.Text & "' and ageb<='" & page.Text & "' and  agee>='" & page.Text & "' and  test_CODE='" & ACdr("test_CODE") & "' and year='" & PYEAR.Text & "' "
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            Dim ref1 As String = ""
            S = " "
            NORE = 0
            NORB = 0
            unit = " "
            re1 = 0
            re2 = 0
            If dr1.HasRows = True Then

                If IsDBNull(dr1("ref")) = False Then S = dr1("ref")
                If IsDBNull(dr1("nore")) = False Then NORE = dr1("nore")
                If IsDBNull(dr1("norb")) = False Then NORB = dr1("norb")
                If IsDBNull(dr1("unit")) = False Then unit = dr1("unit")
                If IsDBNull(dr1("ref1")) = False Then ref1 = dr1("ref1")
                If IsDBNull(dr1("re1")) = False Then re1 = dr1("re1")
                If IsDBNull(dr1("re2")) = False Then re2 = dr1("re2")
            End If

            If IsDBNull(ACdr("ref")) = False Then S = ACdr("ref")

            cmd.CommandText = "UPDATE [lbill_testsub] SET " & aww & " unit ='" & unit & "', ref='" & S & "',norb='" & NORB & "',nore='" & NORE & "',re1='" & re1 & "',re2='" & re2 & "',ref1='" & ref1 & "'  WHERE TEST_CODE='" & ACdr("test_code") & "' and  ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()

        End While
        If PORV <> "" Then
            dr.Close()
            cmd.CommandText = " update lbill set st=1 where st=0 and ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
        End If

        If fnd = 1 Or edt = 0 Then fesl(1, 1)
        'Catch ex As Exception
        '    '  Dim st1 As String = sender.ToString.Replace("'", "-")
        '    Dim st As String = ex.Message
        '    st = st.Replace("'", "-")
        '    dr.Close()
        '    cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','norbb','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
        '    cmd.ExecuteNonQuery()
        '    MsgBox(st) : If ex.Message = "Load report failed." Then End
        'End Try
    End Sub

    Private Sub lab_name_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles lab_name.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        lab_name.BackColor = Color.FromArgb(backcolor1)

    End Sub

    Private Sub lab_name_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles lab_name.MouseHover
        llname = "lab_name"

    End Sub
    Private Sub lab_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles lab_name.SelectedIndexChanged
        If lab_name.Focused = False Then Exit Sub
        If lab_name.Text = "" Then Exit Sub

        FRC = llab.Select("NAME='" & lab_name.Text & "'")
        If FRC.Length <= 0 Then
            lab_name.Text = ""
            lab_code.Text = ""
            Exit Sub
        Else
            RC = FRC(0)

            ACdr.Close()
            ACcmd.CommandText = "update test_price set rcv_date='" & ChangeFormat(rcv_date.Value) & "', labprice=price" & RC("BOOK_PRICE_CODE") & ",tblgtime='1/1/2011' "
            ACcmd.ExecuteNonQuery()
            fprice(0)

        End If

    End Sub

    Private Sub pnpay_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles pnpay.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        pnpay.BackColor = Color.FromArgb(backcolor1)

    End Sub

    Private Sub pnpay_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles pnpay.MouseHover
        llname = "pnpay"

    End Sub

    Private Sub pnpay_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pnpay.TextChanged
        pnrest.Text = Val(pnpay.Text) - Val(pntot.Text)
    End Sub

    Private Sub GlassButton5_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton5.Click
        'ACdr.Close()
        'acdr1.Close()
        'accmd1.CommandText = "select * from TEST_PRICE where GR_NAME='" & GRNAME.Text & "'"
        'acdr1 = accmd1.ExecuteReader
        'While acdr1.Read
        '    ACcmd.CommandText = "update test_price set  qun=1 where test_code=" & acdr1("test_code")
        '    ACcmd.ExecuteNonQuery()
        'End While
        'fprice(1)
        'SUMT()
        dr.Close()
        cmd.CommandText = "update lbill_test set t=0"
        cmd.ExecuteNonQuery()
        FRC = BILL.Select("qun='1'")
        Dim t As String = 0
        While Not t = FRC.Length
            RC = FRC(t)
            cmd.CommandText = "update lbill_test set t=1 where test_name='" & RC("test_name") & "'"
            cmd.ExecuteNonQuery()
            t = t + 1
        End While
        dr.Close() : cmd.CommandText = "SELECT     test_name,count(test_name)as qun FROM  lbill_test    where t=1 and  esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'  " & yy & " group by test_name"
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì·", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\test up.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("1", " ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì· Œ·«· › —… „‰ ")
        oj.SetParameterValue("1", " ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì· Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub DataGridView6_CellBeginEdit(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellCancelEventArgs) Handles F31D.CellBeginEdit

    End Sub

    Private Sub DataGridView6_CellContentClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles F31D.CellContentClick

    End Sub

    Private Sub DataGridView6_CellMouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles F31D.CellMouseClick
        
    End Sub

    Private Sub DataGridView6_CellMouseDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles F31D.CellMouseDoubleClick
        On Error Resume Next
        If e.RowIndex < 0 Then Exit Sub
        If e.ColumnIndex = 59 Then Exit Sub
        Dim x As Integer = 0
        While Not x = F31.Rows.Count
            If F31.Rows(x).Item("esl_no") = F31D(("esl_no"), e.RowIndex).Value Then
                nf31 = x
                Exit While
            End If
            x = x + 1
        End While
        dr.Close()
        Dim d As Date = F31D(("esl_date"), e.RowIndex).Value
        YEARN.Text = d.Year
        bran.Text = F31D(("bran"), e.RowIndex).Value
        esl_no.Text = F31D(("esl_no"), e.RowIndex).Value
        fesl(0, 0)

    End Sub

    Private Sub PRA_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "pra"

    End Sub



    Private Sub PRE_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "pre"

    End Sub



    Private Sub GlassButton30_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        dr.Close() : cmd.CommandText = "SELECT  * from v_sub where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1 and mqun=1 and so>0"
        adesl.SelectCommand = cmd
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        esl.Clear()
        DBS.Tables("esl").Clear()


        Dim ss, dd, rbc, ESL1 As Integer
        ESL1 = 0
        While Not ESL1 = F31.Rows.Count
            If F31.Rows(ESL1).RowState = DataRowState.Deleted Then GoTo KKK
            dr.Close() : cmd.CommandText = "SELECT  * from v_sub where esl_no='" & F31.Rows(ESL1).Item("ESL_NO") & "'and qun=1 and mqun=1 and so>0"
            adesl.SelectCommand = cmd
            adesl.Fill(DBS, "esl")
            esl = DBS.Tables("esl")
            Dim na As Integer = 0
            While Not na = esl.Rows.Count
                If esl.Rows(na).Item("mtest_name") = "COMPLETE BLOOD COUNT " And cbcf = 1 Then
                    FRC = esl.Select("test_name='Red cell count'")
                    RC = FRC(0)
                    rbc = Val(RC("res"))
                    FRC = esl.Select("test_name='Heamoglobin'")
                    RC = FRC(0)
                    ss = Val(RC("res"))
                    FRC = esl.Select("test_name='Heamatocrit(PCV)'")
                    RC = FRC(0)
                    RC.BeginEdit()
                    dd = Val(RC("res"))
                    RC.EndEdit()
                    FRC = esl.Select("test_name='MCV'")
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("res") = Math.Round((dd * 10) / rbc, 1)
                    RC.EndEdit()
                    FRC = esl.Select("test_name='MCH'")
                    RC = FRC(0)
                    RC.BeginEdit()

                    RC("res") = Math.Round((ss * 10) / rbc, 1)
                    RC.EndEdit()
                    FRC = esl.Select("test_name='Mchc'")
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("res") = Math.Round((ss * 100) / dd, 1)
                    RC.EndEdit()

                End If
                If esl.Rows(na).Item("mtest_name") = "COMPLETE BLOOD COUNT " And cbcd = 1 Then
                    FRC = esl.Select("test_name='Yellow cell count'")
                    RC = FRC(0)
                    ss = Val(RC("res"))
                    FRC = esl.Select("test_name='Neutrophils'")
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                    FRC = esl.Select("test_name='Lymphocytes'")
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                    FRC = esl.Select("test_name='Monocytes'")
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                    FRC = esl.Select("test_name='Eosinophils'")
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                    FRC = esl.Select("test_name='Basophils'")
                    RC = FRC(0)
                    RC.BeginEdit()
                    RC("absu") = Math.Round(Val(RC("res")) * ss * 1000 * 0.01, 1)
                    RC.EndEdit()
                End If
                If IsNumeric(esl.Rows(na).Item("res")) = True Then
                    If IsNumeric(esl.Rows(na).Item("nore")) = True And IsNumeric(esl.Rows(na).Item("norb")) = True Then
                        esl.Rows(na).BeginEdit()
                        If esl.Rows(na).Item("res") > esl.Rows(na).Item("nore") And esl.Rows(na).Item("nore") > 0 Then
                            esl.Rows(na).Item("ds") = 1
                        ElseIf esl.Rows(na).Item("res") < esl.Rows(na).Item("norb") And esl.Rows(na).Item("nore") > 0 Then
                            esl.Rows(na).Item("ds") = -1
                        End If
                        ACdr.Close()
                    End If
                    esl.Rows(na).EndEdit()
                End If
                na = na + 1
            End While

            dr.Close()
            If sprnt = 1 Then
                Me.Text = "«·—Ã«¡  ”œÌœ «·»«ﬁÏ"
                rp.CrystalReportViewer1.ShowPrintButton = False
                rp.CrystalReportViewer1.ShowExportButton = False
            Else
                rp.CrystalReportViewer1.ShowPrintButton = True
                rp.CrystalReportViewer1.ShowExportButton = True
            End If
            dr.Close()
            Dim AA As String = ""
            Dim AB As String = ""
            If esl.Rows.Count > 0 Then AB = esl.Rows(0).Item("mtest_name") Else AB = "***********"
            cmd.CommandText = "SELECT  * from v_lab where esl_no='" & F31.Rows(ESL1).Item("ESL_NO") & "'and qun=1 and sub=0 and  cult=0 ORDER BY GR_NAME"
            dr = cmd.ExecuteReader
            Dim www As Integer = 100
            While dr.Read
                If AA <> dr("GR_NAME") Then
                    RC = Nothing
                    RC = esl.NewRow
                    RC("mtest_name") = AB
                    RC("test_name") = "*****" & dr("GR_NAME")
                    RC("q") = 10
                    RC("p") = 0
                    RC("so") = www
                    RC("COMPANY_NAME") = dr("COMPANY_NAME")
                    RC("pname") = dr("pname")
                    RC("ptype") = dr("ptype")
                    RC("page") = dr("page")
                    RC("reg_name") = dr("reg_name")
                    RC("esl_date") = dr("esl_date")
                    RC("esl_no") = dr("esl_no")
                    RC("NOTE") = dr("NOTE")
                    RC("NOTEN") = dr("NOTEN")
                    esl.Rows.Add(RC)
                    www = www + 1
                End If
                AA = dr("GR_NAME")
                RC = Nothing
                RC = esl.NewRow
                RC("mtest_name") = AB
                RC("test_name") = dr("test_name")
                RC("res") = dr("res")
                RC("ref") = dr("ref")
                RC("NORE") = dr("NORE")
                RC("NORB") = dr("NORB")
                RC("ds") = dr("ds")
                RC("usr") = dr("usr")
                RC("nik") = dr("nik")
                RC("pname") = dr("pname")
                RC("COMPANY_NAME") = dr("COMPANY_NAME")
                RC("ptype") = dr("ptype")
                RC("page") = dr("page")
                RC("reg_name") = dr("reg_name")
                RC("esl_date") = dr("esl_date")
                RC("esl_no") = dr("esl_no")
                RC("NOTE") = dr("NOTE")
                RC("NOTEN") = dr("NOTEN")
                RC("q") = 10
                RC("p") = 1
                RC("so") = www
                esl.Rows.Add(RC)
                www = www + 1
            End While
KKK:
            ESL1 = ESL1 + 1
        End While

        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & rptp.Text & "\resTB.rpt")
        oj.Database.Tables(0).SetDataSource(esl)
        oj.SetParameterValue("REF", ref1)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show()
        rp.Focus()
    End Sub

    Private Sub main_name_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles main_name.KeyUp

    End Sub

    Private Sub main_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles main_name.SelectedIndexChanged
        dr.Close()
        cmd.CommandText = "select * from lmain where name='" & main_name.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            main_code.Text = dr("code")
        End While
    End Sub

    Private Sub sub_name_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles sub_name.KeyPress

    End Sub

    Private Sub sub_name_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles sub_name.KeyUp
        If main_name.Text = "" Then Exit Sub
        If sub_name.Text = "" Then Exit Sub

        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "select * from lsub where main_name='" & main_name.Text & "' and sub_name='" & sub_name.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = False Then
                dr.Close()
                cmd.CommandText = "select max(sub_code) from lsub "
                dr = cmd.ExecuteReader
                dr.Read()
                Dim n As Integer = 0
                sub_code.Text = 1 + nulls(dr(0))
                If flg.Checked = True Then n = 1 Else n = -1
                dr.Close() : cmd.CommandText = "insert into lsub (main_code,main_name,sub_code,sub_name,flg)  values ('" & main_code.Text & "','" & main_name.Text & "','" & sub_code.Text & "','" & sub_name.Text & "','" & n & "')"
                cmd.ExecuteNonQuery()
                dr.Close()
                sub_name.Items.Clear()
                cmd.CommandText = "select * from lsub "
                dr = cmd.ExecuteReader
                While dr.Read
                    sub_name.Items.Add(dr("sub_name"))
                End While
            Else
                cash.Focus()
            End If

        End If
        If e.KeyCode = Keys.Delete Then
            dr.Close()
            cmd.CommandText = "select * from lsub where  sub_name='" & sub_name.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then
                Dim aas As String = MsgBox("Â·  —Ìœ «·Õ–›", MsgBoxStyle.YesNo)
                If aas = vbNo Then Exit Sub
                dr.Close()
                cmd.CommandText = "delete from lsub where  sub_name='" & sub_name.Text & "'"
                cmd.ExecuteNonQuery()
            End If
        End If

    End Sub

    Private Sub sub_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles sub_name.SelectedIndexChanged
        dr1.Close()
        cmd1.CommandText = "select * from lsub where sub_name='" & sub_name.Text & "'"
        dr1 = cmd1.ExecuteReader
        While dr1.Read
            PRM.CheckState = dr1("PRM")
            If dr1("flg") = 1 Then flg.Checked = True Else flg.Checked = False
            sub_code.Text = dr1("sub_code")
            main_code.Text = dr1("main_code")
            main_name.Text = dr1("main_name")

        End While
    End Sub
    Private Sub GlassButton33_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL20.Click


        tm = 10
        RSD.Text = 0
        
        FCASH1()
        dr.Close()
        Dim D As Date = Now
        time1.Text = D.Hour.ToString & " : " & D.Minute.ToString
        date1.Text = D.Date.ToShortDateString
        If csave.Checked = True Then yy = " AND save_code='" & save_code.Text & "'"
        If pa = 0 Then yy = " AND save_code='" & saven & "'"
        cash1.Clear()
        dr.Close() : cmd.CommandText = "select * FROM lCASH WHERE DATE1='" & ChangeFormat(Now.Date) & "'" & yy
        adcash1.SelectCommand = cmd
        adcash1.Fill(DBS, "cash1")
        cash1 = DBS.Tables("cash1")
        DBS.Tables("cash1").Clear()
        adcash1.Fill(DBS, "cash1")
        cash1 = DBS.Tables("cash1")

        brpd.DataSource = ""
        brpd.DataSource = cash1
        brpd.Columns("flg").Visible = False
        brpd.Columns("TIME1").Visible = False
        brpd.Columns("sub_code").Visible = False
        brpd.Columns("sub_name").HeaderText = "‰Ê⁄ «·⁄„·Ì…"
        brpd.Columns("sub_name").Width = 70
        brpd.Columns("main_code").Visible = False
        brpd.Columns("main_name").HeaderText = "ﬂ Ì» «·«”⁄«—"
        brpd.Columns("main_name").Width = 70
        '===================================================

        cash.Text = 0
        crd.Text = 0
        dr.Close()
        sub_name.Focus()

        dr.Close()
        cmd.CommandText = "select * from lsave where code='" & saven & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            save_code.Text = dr("code")
            save_name.Text = dr("name")
        End While
        dr.Close()
        dr1.Close()
        If saven = Val(save_code.Text) Then
            cmd1.CommandText = "SELECT SUM(CASH*FLG) FROM LCASH WHERE SAVE_NAME='" & save_name.Text & "'"
            dr1 = cmd1.ExecuteReader
            While dr1.Read
                RSD.Text = nulls(dr1(0))
            End While
        End If
        If ls = 0 And Val(sub_code.Text) <> 4 Then MsgBox("«·—Ã«¡ «Œ Ì«— »‰œ «·„’—Ê›«  «·Ã«—Ì…", MsgBoxStyle.Critical) : Exit Sub
        If Val(sub_code.Text) = 101 Then
            f3(1)
        End If
        If edt = 0 Then
            If Val(sub_code.Text) = 4 Then
                dr.Close()
                cmd.CommandText = "select * from lsave where code='" & saven & "'"
                dr = cmd.ExecuteReader
                While dr.Read
                    save_code.Text = dr("code")
                    save_name.Text = dr("name")
                End While
            Else
                dr.Close()
                cmd.CommandText = "select * from lsave where code='3'"
                dr = cmd.ExecuteReader
                While dr.Read
                    save_code.Text = dr("code")
                    save_name.Text = dr("name")
                End While
            End If
        End If
    End Sub

    Private Sub GlassButton32_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL21.Click
        If Trim(sub_name.Text) = "" Or Trim(sub_code.Text) = "" Then Me.text = "«·—Ã«¡ «· √ﬂœ ‰Ê⁄  «·⁄„·Ì…" : Exit Sub
        If Trim(main_name.Text) = "" Or Trim(main_code.Text) = "" Then Me.text = "«·—Ã«¡ «· √ﬂœ „‰ «·⁄Ì«œ…" : Exit Sub
        If IsNumeric(cash.Text) = False Then Me.text = "«·—Ã«¡ «· √ﬂœ „‰ «·”⁄—" : Exit Sub
        If ls = 0 And sub_code.Text <> 4 Then MsgBox("«·—Ã«¡ «Œ Ì«— »‰œ «·„’—Ê›«  «·Ã«—Ì…", MsgBoxStyle.Critical) : Exit Sub
        Dim n As Integer = 0
        If save_code.Text = "" Or save_code.Text = "0" Then MsgBox("«Œ «— «·Œ“Ì‰…") : Exit Sub
        If save_name.Text = "" Or save_name.Text = "0" Then MsgBox("«Œ «— «·Œ“Ì‰…") : Exit Sub

        If flg.Checked = True Then n = 1 Else n = -1
        dr.Close() : cmd.CommandText = "select * from lcash  where ID='" & id.Text & "' and branch_name='" & branch_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True And edt = 0 And ChangeFormat(date1.Text) <> ChangeFormat(Now) Then
            msgx.Text = "·« Ì„ﬂ‰ «· ⁄œÌ·"
            Exit Sub
        ElseIf dr.HasRows = True Then
            Dim x As String
            x = MsgBox("Â·  —Ìœ  ⁄œÌ·  ", MsgBoxStyle.YesNo)
            If x = vbNo Then dr.Close() : Exit Sub
            If edt = 0 Then cash.Text = dr("cash")
            dr.Close() : dr.Close() : cmd.CommandText = "delete  from lcash where ID='" & id.Text & "' and branch_name='" & branch_name.Text & "'"
            cmd.ExecuteNonQuery()
        Else
            If Val(cash.Text) > Val(RSD.Text) And Val(sub_code.Text) = 101 Then MsgBox("«· ÕÊÌ· «ﬂ»— „‰ «·„ÊÃÊœ ›Ï «·›—⁄", MsgBoxStyle.Exclamation) : Exit Sub

            If Val(sub_code.Text) = 101 Then
                dr.Close()
                cmd.CommandText = "update branch set trl='" & Val(RSD.Text) - Val(cash.Text) & "'  where  name='" & branch_name.Text & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "update lbill set trl='1'  where  bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "update lbill_test set trl='1'  where  bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "update lbill_esl set trl='1'  where  bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "update lcash set trl='1'  where  branch_name='" & branch_name.Text & "'"
                cmd.ExecuteNonQuery()
            End If

        End If

        dr.Close() : cmd.CommandText = "insert into lcash ([main_name],[main_code],[sub_code],[sub_name],[flg],[cash],[crd],[time1],[date1],[id],[notse],usr,shift,save_name,save_code,branch_code,branch_name,st,emp_name,emp_code,PRM) values ('" & main_name.Text & " ','" & main_code.Text & "','" & sub_code.Text & "','" & sub_name.Text & "','" & n & "','" & cash.Text & "','" & crd.Text & "','" & time1.Text & "','" & ChangeFormat(date1.Text) & "','" & id.Text & "','" & notse.Text & "','" & USR & "','" & SHF & "','" & save_name.Text & "','" & save_code.Text & "','" & branch_code.Text & "','" & branch_name.Text & "','1' ,'" & emp_name.Text & "','" & Val(empcode.Text) & "','" & Val(PRM.CheckState) & "')"
        cmd.ExecuteNonQuery()

    End Sub

    Private Sub TextBox3_GiveFeedback(ByVal sender As Object, ByVal e As System.Windows.Forms.GiveFeedbackEventArgs) Handles TextBox3.GiveFeedback

    End Sub

    Private Sub TextBox3_GotFocus2(ByVal sender As Object, ByVal e As System.EventArgs) Handles TextBox3.GotFocus
        If scan1 = 0 Then flng("EN") Else flng("AR")
        colu(Me, Val(bcolor), Val(fcolor))

        TextBox3.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "TextBox3")
        ams = 1
    End Sub

    Private Sub TextBox3_KeyDown1(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles TextBox3.KeyDown

        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Public Sub GRD()
        Dim aaaa As Integer = 0
        group_name.Text = TextBox3.Text
        dr.Close()
        cmd.CommandText = "SELECT * FROM lgroup_price WHERE Gname='" & group_name.Text & "' and  book_price_CODE='" & BOOK_CODE.Text & "' "
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            tot1.Text = 0
            aaaa = 1
        Else
            If dr("tot") > 0 Then tot1.Text = dr("tot") Else tot1.Text = 0 : aaaa = 1
        End If
        ACdr.Close()
        dr.Close()
        cmd.CommandText = "select * from lgroup_test where gname='" & group_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            ACcmd.CommandText = "update test_price set qun=1,TOT1='" & Val(tot1.Text) & "',bar='" & group_name.Text & "',TOT2='1'  where test_code=" & dr("test_code")
            ACcmd.ExecuteNonQuery()
        End If
        While dr.Read
            ACcmd.CommandText = "update test_price set qun=1,TOT1='" & Val(tot1.Text) & "',bar='" & group_name.Text & "',TOT2='2'  where test_code=" & dr("test_code")
            ACcmd.ExecuteNonQuery()
        End While
        'If aaaa = 1 Then
        '    ACdr.Close()
        '    ACcmd.CommandText = "select sum(tot) from test_price where bar='" & group_name.Text & "'"
        '    ACdr = ACcmd.ExecuteReader
        '    ACdr.Read()
        '    Dim ssum As Integer = ACdr(0)
        '    ACdr.Close()
        '    ACcmd.CommandText = "update test_price set TOT1='" & Val(ssum) & "'  where  bar='" & group_name.Text & "'"
        '    ACcmd.ExecuteNonQuery()
        '    tot1.Text = ssum
        'End If
        If IsNumeric(TextBox3.Text) = True Then
            ACdr.Close()
            ACcmd.CommandText = "update test_price set bar=test_name  where bar='" & TextBox3.Text & "'"
            ACcmd.ExecuteNonQuery()
        End If
        fprice(1)
        SUMT()
    End Sub

    Public Sub FIRES(ByVal s As Integer)
        Try
            If s = 1 Then
                FRC = gen.Select("NAME1='" & TextBox3.Text & "'")
                Dim yys As String = "shortname='" & TextBox3.Text & "'"
                Dim yyn As String = "shortname"
                Dim nna As Int16 = 0
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    nna = RC("f")
                    If nna = 1 Then yys = "shortname"
                    If fftest_name = 1 And nna = 2 Then yys = "test_name"
                    If nna = 4 Then yys = "test_ar"
                    If nna = 5 Then yys = "gr_name" : yyn = yys
                    If nna = 6 Then
                        GRD()
                    End If
                End If
                If nna <> 6 Then
                    ACdr.Close()
                    ACcmd.CommandText = "update test_price set qun=1,bar=" & yyn & " ,TOT2='0' where " & yys & "='" & TextBox3.Text & "'"
                    ACcmd.ExecuteNonQuery()
                End If
                If IsNumeric(TextBox3.Text) = True Then
                    ACdr.Close()
                    ACcmd.CommandText = "update test_price set bar=test_name  where bar='" & TextBox3.Text & "'"
                    ACcmd.ExecuteNonQuery()
                End If
                TextBox3.Text = ""
                TextBox3.Focus()
                If Val(dissn.Text) > 0 Then
                    ACdr.Close()
                    ACcmd.CommandText = "update test_price set dis_n='" & Val(dissn.Text) & "'"
                    ACcmd.ExecuteNonQuery()
                End If
                fprice(1)
                SUMT()
                TextBox3.Text = ""
            Else
                FRC = gen.Select("NAME1='" & TextBox3.Text & "'")
                Dim yys As String = "shortname"
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If RC("f") = 1 Then yys = "shortname"
                    If RC("f") = 2 Then yys = "test_name"
                    If RC("f") = 3 Then yys = "test_code"
                    If RC("f") = 4 Then yys = "test_ar"
                    If RC("f") = 5 Then yys = "gr_name"
                    If RC("f") = 6 Then
                        yys = "bar"
                        ACdr.Close()
                        dr.Close()
                        group_name.Text = TextBox3.Text
                        cmd.CommandText = "select * from lgroup_test where gname='" & group_name.Text & "'"
                        dr = cmd.ExecuteReader
                        While dr.Read
                            ACcmd.CommandText = "update test_price set bar='" & group_name.Text & "'  where test_code=" & dr("test_code")
                            ACcmd.ExecuteNonQuery()
                        End While

                        cmdBILL.CommandText = "select * from TEST_PRICE WHERE " & yys & " ='" & TextBox3.Text & "'"
                        adBILL.SelectCommand = cmdBILL
                        adBILL.Fill(DBS, "BILL")
                        BILL = DBS.Tables("BILL")
                        DBS.Tables("BILL").Clear()
                        adBILL.Fill(DBS, "BILL")
                        BILL = DBS.Tables("BILL")
                        btestd.DataSource = BILL
                    Else
                        cmdBILL.CommandText = "select * from TEST_PRICE WHERE " & yys & " LIKE '%" & TextBox3.Text & "%'"
                        adBILL.SelectCommand = cmdBILL
                        adBILL.Fill(DBS, "BILL")
                        BILL = DBS.Tables("BILL")
                        DBS.Tables("BILL").Clear()
                        adBILL.Fill(DBS, "BILL")
                        BILL = DBS.Tables("BILL")
                        btestd.DataSource = BILL

                    End If
                End If
            End If
            fprice(1)
        Catch ex As Exception
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','choose test','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub TextBox3_KeyUp2(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles TextBox3.KeyUp
        If e.KeyCode = Keys.Enter And TextBox3.Text <> "" Then
            FIRES(1)

        ElseIf e.KeyCode = Keys.Delete Then
            ACdr.Close()
            ACcmd.CommandText = "update test_price set qun=0  where shortname='" & TextBox3.Text & "'"
            ACcmd.ExecuteNonQuery()
            TextBox3.Text = ""
            TextBox3.Focus()
            fprice(1)
            SUMT()
            TextBox3.Text = ""
        ElseIf e.KeyCode = Keys.ControlKey Then
            FIRES(2)



        ElseIf TextBox3.Text <> "" Then
            cmdBILL.CommandText = "select * from TEST_PRICE WHERE [shortname] LIKE '%" & TextBox3.Text & "%' or  [test_name] LIKE '%" & TextBox3.Text & "%' "
            adBILL.SelectCommand = cmdBILL
            adBILL.Fill(DBS, "BILL")
            BILL = DBS.Tables("BILL")
            DBS.Tables("BILL").Clear()
            adBILL.Fill(DBS, "BILL")
            BILL = DBS.Tables("BILL")
            btestd.DataSource = BILL

        Else
            fprice(1)
        End If
    End Sub

    Private Sub TextBox3_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles TextBox3.LostFocus

    End Sub

    Private Sub TextBox3_MouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles TextBox3.MouseClick

    End Sub

    Private Sub TextBox3_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles TextBox3.MouseHover
        llname = "TextBox3"

    End Sub


    Private Sub TextBox3_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox3.SelectedIndexChanged

    End Sub

    Private Sub cash_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles cash.KeyUp
        If e.KeyCode = Keys.Enter Then
            crd.Focus()
        End If
    End Sub

    Private Sub cash_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cash.TextChanged

    End Sub

    Private Sub crd_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles crd.KeyDown
        If e.KeyCode = Keys.Enter Then
            notse.Focus()

        End If
    End Sub

    Private Sub crd_MouseUp(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles crd.MouseUp

    End Sub

    Private Sub crd_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles crd.TextChanged

    End Sub

    Private Sub notse_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles notse.GotFocus
        flng("AR")
    End Sub

    Private Sub notse_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles notse.KeyDown
        If e.KeyCode = Keys.Enter Then
            GlassButton32_Click_1(GL21, e)
        End If
    End Sub

    Private Sub notse_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles notse.TextChanged

    End Sub

    Private Sub GlassButton39_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL24.Click
        Dim YY As String = ""
        If cesl_date.Checked = False Then YY = "where date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" Else YY = "where date1 ='" & ChangeFormat(esl_date.Value) & "'"
        If ls = 0 Then YY = "where date1 between '" & ChangeFormat(Now) & "' and '" & ChangeFormat(Now) & "'"
        If CMNAME.Checked = True Then YY = YY & " AND  MAIN_NAME='" & main_name.Text & "'"
        If CSNAME.Checked = True Then YY = YY & " AND  SUB_NAME='" & sub_name.Text & "'"
        If CCASH.Checked = True Then YY = YY & " AND  CASH" & FCASH.Text & "'" & cash.Text & "'"
        If CCRD.Checked = True Then YY = YY & " AND  CRD" & FCRD.Text & "'" & crd.Text & "'"
        If CSNAME.Checked = True Then YY = YY & " AND  SUB_NAME='" & sub_name.Text & "'"
        If CNOTSE.Checked = True Then YY = YY & " AND NOTSE LIKE '%" & notse.Text & "%'"
        If csave.Checked = True Then YY = YY & " AND save_code='" & save_code.Text & "'"
        If CEMP.Checked = True Then YY = YY & " AND EMP_NAME='" & emp_name.Text & "'"
        If PRM.Checked = False Then YY = YY & " AND prm='0'"
        If CBRAN.Checked = True Then YY = YY & " AND branch_name='" & branch_name.Text & "'"
        If cshift.Checked = True Then YY = YY & " and shift='" & shift.Text & "'"

        If pa = 0 Then YY = YY & " AND save_code='" & saven & "'"
        tm = 10
        dr.Close()
        dr1.Close()
        Dim N As Int16 = 0
        cmd.CommandText = "SELECT  MAX(ky) AS KY, COUNT(id) AS A, id, branch_name, date1, notse  FROM lcash  WHERE YEAR(date1) = 2019  GROUP BY id, branch_name, date1, notse HAVING(COUNT(branch_name) > 1) ORDER BY id"
        dr = cmd.ExecuteReader
        While dr.Read
            cmd1.CommandText = "DELETE FROM lcash WHERE KY=" & dr("KY")
            cmd1.ExecuteNonQuery()
            N += 1
        End While
        
        dr.Close() : cmd.CommandText = "select * FROM lCASH " & YY
        adcash1.SelectCommand = cmd
        adcash1.Fill(DBS, "cash1")
        cash1 = DBS.Tables("cash1")
        DBS.Tables("cash1").Clear()
        adcash1.Fill(DBS, "cash1")
        cash1 = DBS.Tables("cash1")
        brpd.DataSource = ""
        brpd.DataSource = cash1
        brpd.Columns("flg").Visible = False
        brpd.Columns("TIME1").Visible = False
        brpd.Columns("sub_code").Visible = False
        brpd.Columns("sub_name").HeaderText = "‰Ê⁄ «·⁄„·Ì…"
        brpd.Columns("sub_name").Width = 70
        brpd.Columns("main_code").Visible = False
        brpd.Columns("main_name").HeaderText = "ﬂ Ì» «·«”⁄«—"
        brpd.Columns("main_name").Width = 70
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\cash.rpt")
        oj.Database.Tables(0).SetDataSource(cash1)
        oj.SetParameterValue("1", d1.Value)
        oj.SetParameterValue("prrm", Val(PRM.CheckState))
        oj.SetParameterValue("2", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show()
        rp.Focus()

    End Sub

    Private Sub GlassButton38_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL30.Click

        Dim YY As String = ""
        YY = "where date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' "
        If ls = 0 Then YY = "where date1 between '" & ChangeFormat(Now) & "' and '" & ChangeFormat(Now) & "'"
        If CBRAN.Checked = True Then YY = YY & " AND branch_name='" & branch_name.Text & "'"
        If CMNAME.Checked = True Then YY = YY & " AND  MAIN_NAME='" & main_name.Text & "'"
        If CSNAME.Checked = True Then YY = YY & " AND  SUB_NAME='" & sub_name.Text & "'"
        If CCASH.Checked = True Then YY = YY & " AND  CASH" & FCASH.Text & "'" & cash.Text & "'"
        If CCRD.Checked = True Then YY = YY & " AND  CRD" & FCRD.Text & "'" & crd.Text & "'"
        If CSNAME.Checked = True Then YY = YY & " AND  SUB_NAME='" & sub_name.Text & "'"
        If CNOTSE.Checked = True Then YY = YY & " AND NOTSE LIKE '%" & notse.Text & "%'"
        If mng = 0 Then YY = YY & " AND save_code='" & saven & "'"
        If csave.Checked = True Then YY = YY & " AND save_code='" & save_code.Text & "'"
        If PRM.Checked = False Then YY = YY & " AND prm='0'"

        dr.Close() : cmd.CommandText = "select main_name,sub_name,sum(CASH)as CASH,sum(crd)as crd,flg FROM lCASH " & YY & " GROUP BY main_name,sub_name,flg"
        adcash1.SelectCommand = cmd
        adcash1.Fill(DBS, "cash1")
        cash1 = DBS.Tables("cash1")
        DBS.Tables("cash1").Clear()
        adcash1.Fill(DBS, "cash1")
        cash1 = DBS.Tables("cash1")
        brpd.DataSource = ""
        brpd.DataSource = cash1

        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\cashA.rpt")
        oj.Database.Tables(0).SetDataSource(cash1)
        oj.SetParameterValue("1", d1.Value)
        oj.SetParameterValue("2", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show()
        rp.Focus()
    End Sub

    Private Sub GlassButton37_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL32.Click

        Dim YY As String = ""
        YY = "where date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        If ls = 0 Then YY = "where date1 between '" & ChangeFormat(Now) & "' and '" & ChangeFormat(Now) & "'"

        If CMNAME.Checked = True Then YY = YY & " AND  MAIN_NAME='" & main_name.Text & "'"
        If CSNAME.Checked = True Then YY = YY & " AND  SUB_NAME='" & sub_name.Text & "'"
        If CCASH.Checked = True Then YY = YY & " AND  CASH" & FCASH.Text & "'" & cash.Text & "'"
        If CCRD.Checked = True Then YY = YY & " AND  CRD" & FCRD.Text & "'" & crd.Text & "'"
        If CSNAME.Checked = True Then YY = YY & " AND  SUB_NAME='" & sub_name.Text & "'"
        If CNOTSE.Checked = True Then YY = YY & " AND NOTSE LIKE '%" & notse.Text & "%'"
        dr.Close() : cmd.CommandText = "select main_name,sub_name,SHIFT,sum(CASH)as CASH,sum(crd)as crd,flg FROM lCASH " & YY & " GROUP BY main_name,sub_name,flg,SHIFT"
        adcash1.SelectCommand = cmd
        adcash1.Fill(DBS, "cash1")
        cash1 = DBS.Tables("cash1")
        DBS.Tables("cash1").Clear()
        adcash1.Fill(DBS, "cash1")
        cash1 = DBS.Tables("cash1")
        brpd.DataSource = ""
        brpd.DataSource = cash1
        'brpd.Columns("flg").Visible = False
        'brpd.Columns("TIME1").Visible = False
        'brpd.Columns("sub_code").Visible = False
        'brpd.Columns("sub_name").HeaderText = "‰Ê⁄ «·⁄„·Ì…"
        'brpd.Columns("sub_name").Width = 70
        'brpd.Columns("main_code").Visible = False
        'brpd.Columns("main_name").HeaderText = "ﬂ Ì» «·«”⁄«—"
        'brpd.Columns("main_name").Width = 70
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\cashG.rpt")
        oj.Database.Tables(0).SetDataSource(cash1)
        oj.SetParameterValue("1", d1.Value)
        oj.SetParameterValue("2", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show()
        rp.Focus()
    End Sub

    Private Sub GlassButton40_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton40.Click
        Dim aa As Integer = 0
        aa = InputBox("enter code ")
        dr.Close()
        cmd.CommandText = "update Branch set CASH='" & Val(aa) + 1 & "' where code='" & branch_code.Text & "'"
        cmd.ExecuteNonQuery()
        ACdr.Close()
        ACcmd.CommandText = "update srv set CASH='" & Val(aa) & "' "
        ACcmd.ExecuteNonQuery()

    End Sub

    Private Sub GlassButton41_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton41.Click
        Dim aa As Integer = 0
        aa = InputBox("enter code ")
        dr.Close()
        cmd.CommandText = "update Branch set PA='" & Val(aa) + 1 & "' where code='" & branch_code.Text & "'"
        cmd.ExecuteNonQuery()
        ACdr.Close()
        ACcmd.CommandText = "update srv set PA='" & Val(aa) & "' "
        ACcmd.ExecuteNonQuery()
    End Sub

    Private Sub GlassButton31_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL22.Click
        
        If IsNumeric(id.Text) = False Then Me.Text = "«·—Ã«¡ «· √ﬂœ „‰ «·ﬂÊœ" : Exit Sub
        dr.Close() : cmd.CommandText = "select * from lcash  where ID=" & id.Text
        dr = cmd.ExecuteReader
        If dr.HasRows = True And edt = 0 And ChangeFormat(date1.Text) <> ChangeFormat(Now) Then
            msgx.Text = "·« Ì„ﬂ‰ «·Õ–›"
            Exit Sub
        ElseIf dr.HasRows = True Then
            Dim x As String
            x = MsgBox("Â·  —Ìœ «·Õ–›  ", MsgBoxStyle.YesNo)
            If x = vbNo Then dr.Close() : Exit Sub
            dr.Close() : dr.Close() : cmd.CommandText = "delete  from lcash where ID='" & id.Text & "' and branch_name='" & branch_name.Text & "'"
            cmd.ExecuteNonQuery()
            If PORV <> "" Then
                dr.Close()
                cmd.CommandText = "insert into ldel (esl_no,type) values ('" & id.Text & "','cash')"
                cmd.ExecuteNonQuery()
            End If
        End If
    End Sub

    Private Sub culttestn_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles culttestn.SelectedIndexChanged
        'On Error Resume Next
        dr.Close()
        cmd.CommandText = "select * from Lbill_TEST WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_NAME='" & culttestn.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then culttestc.Text = dr("test_code")
        cmd.CommandText = "select * from Lbill_cult WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_NAME='" & culttestn.Text & "'"
        adcultd.SelectCommand = cmd
        adcultd.Fill(DBS, "cultd")
        cultd = DBS.Tables("cultd")
        DBS.Tables("cultd").Clear()
        adcultd.Fill(DBS, "cultd")
        cultd = DBS.Tables("cultd")

        DataGridView3.DataSource = cultd
        dr.Close()
        cmd.CommandText = "select * from Lbill_cult_det WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_NAME='" & culttestn.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            SPECIMEN.Text = dr("SPECIMEN")
            DIRECT_FILM.Text = dr("DIRECT_ FILM")
            Pus_cells.Text = dr("Pus_cells")
            RBCs.Text = dr("RBCs")
            Others.Text = dr("Others")
            Culture_conditions.Text = dr("Culture_conditions")
            Growth_of.Text = dr("Growth_of")
            VAIBLE_COUNT.Text = dr("VAIBLE_COUNT")
            Count_is.Text = dr("Count_is")
            Epithelial.Text = dr("Epithelial")

        End If
    End Sub

    Private Sub test_name_GotFocus1(ByVal sender As Object, ByVal e As System.EventArgs) Handles test_name.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        test_name.BackColor = Color.FromArgb(backcolor1)
        ams = 1
    End Sub

    Private Sub test_name_KeyUp1(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles test_name.KeyUp
        If e.KeyCode = Keys.Enter And test_name.Text <> "" Then
            ACdr.Close()
            ACcmd.CommandText = "select * from test_price   where test_name='" & test_name.Text & "' and qun=1"
            ACdr = ACcmd.ExecuteReader
            ACdr.Read()
            If ACdr.HasRows = True Then Me.text = "«· Õ·Ì·  „ «÷«› Â „‰ ﬁ»·" : Exit Sub
            ACdr.Close()

            ACcmd.CommandText = "update test_price set qun=1  where test_name='" & test_name.Text & "'"
            ACcmd.ExecuteNonQuery()
            If testpro.Text = "" Then testpro.Text = TextBox3.Text Else testpro.Text = testpro.Text & " - " & TextBox3.Text


            SUMT()
            fprice(1)
            TextBox3.Text = ""
            test_name.Text = ""
        ElseIf test_name.Text <> "" Then
            cmdBILL.CommandText = "select * from TEST_PRICE WHERE [test_name] LIKE '%" & test_name.Text & "%'"
            adBILL.SelectCommand = cmdBILL
            adBILL.Fill(DBS, "BILL")
            BILL = DBS.Tables("BILL")
            DBS.Tables("BILL").Clear()
            adBILL.Fill(DBS, "BILL")
            BILL = DBS.Tables("BILL")
            btestd.DataSource = BILL

        Else
            fprice(1)
        End If


    End Sub

    Private Sub test_name_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles test_name.MouseHover
        llname = "TEST_NAME"
    End Sub



    Private Sub LABALLToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)



    End Sub

    Private Sub Label83_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label83.Click

    End Sub

    Private Sub Label91_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles q142.Click

    End Sub

    Private Sub FindToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FindToolStripMenuItem.Click
        Dim aa As String
        aa = InputBox("«œŒ· —ﬁ„ «·«Ì’«· ø")

        esl_no.Text = Val(aa)

        fesl(0, 0)


    End Sub

    Private Sub FindNameToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FindNameToolStripMenuItem.Click
        flng("AR")
        Dim aa As String
        aa = InputBox("«œŒ· «”„ «·„—Ì÷ ø", , pname.Text)

        SAVERES(1, 0)
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandText = "select * from lbill where pname like'%" & aa & "%' and bdel=0 and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()

        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & pname.Text, 0, bran.Text)

        fnor(3)
    End Sub

    Private Sub FindLabToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        flng("AR")
        Dim aa As String
        aa = InputBox("enter ref doc ?")

        SAVERES(1, 0)
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandText = "select * from lbill where company_name like'%" & aa & "%' and bdel=0 and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()

        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
       F31DTG()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & COMPANY_name.Text, 0, bran.Text)

        fnor(3)
    End Sub

    Private Sub GlassButton43_Click_3(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL33.Click
        esl_date.Value = Now.Date
        cesl_date.Checked = True
        If edt = 0 And ChangeFormat(esl_date.Value) = ChangeFormat(Now) Then MsgBox("·« Ì„ﬂ‰  —ÕÌ· «·«Ì—«œ ﬁÏ ‰›” «·ÌÊ„", MsgBoxStyle.Critical) : Exit Sub
        If save_code.Text = "" Or save_code.Text = "0" Then MsgBox("«Œ «— «·Œ“Ì‰…") : Exit Sub
        If save_name.Text = "" Or save_name.Text = "0" Then MsgBox("«Œ «— «·Œ“Ì‰…") : Exit Sub

        dr.Close()
        cmd.CommandText = "SELECT * FROM LCASH WHERE NOTSE='  Õ”«» ÌÊ„    " & esl_date.Value.Date & "  ›—⁄ " & save_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then MsgBox(" „  —ÕÌ· «·«Ì—«œ „‰ ﬁ»· ", MsgBoxStyle.Critical) : Exit Sub
        dr.Close()
        cmd.CommandText = "SELECT * FROM LCASH WHERE sub_code='1' and date1='" & ChangeFormat(esl_date.Value) & "' and branch_name='" & branch_name.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = True Then
            Dim n11 As String = MsgBox(" „  —ÕÌ· «·«Ì—«œ „‰ ﬁ»· Â·  —Ìœ «· ÕœÌÀø", MsgBoxStyle.YesNo)
            If n11 = vbNo Then Exit Sub
            dr.Close()
            cmd.CommandText = "delete  FROM LCASH WHERE sub_code='1' and date1='" & ChangeFormat(esl_date.Value) & "' and branch_name='" & branch_name.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "delete  FROM LCASH WHERE sub_code='100' and date1='" & ChangeFormat(esl_date.Value) & "' and branch_name='" & branch_name.Text & "'"
            cmd.ExecuteNonQuery()
        End If

        cesl_date.Checked = True
        CBRAN.Checked = True
        dr.Close()
        cmd.CommandText = "select * from lsave where CODE='" & saven & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            save_name.Text = dr("NAME")
        End While
        Dim s2 As Integer = 0
        Dim n As Int16
        dr.Close()
        Dim D As Date = Now
        time1.Text = D.Hour.ToString & " : " & D.Minute.ToString
        date1.Text = D.Date.ToShortDateString
        cash.Text = -1 * Val(REST.Text)
        crd.Text = 0

        dr.Close()
        cmd.CommandText = "select * from lsub where sub_code='1'"
        dr = cmd.ExecuteReader
        dr.Read()

        If dr("flg") = 1 Then flg.Checked = True Else flg.Checked = False
        main_code.Text = dr("main_code")
        main_name.Text = dr("main_name")
        dr.Close()
        cmd.CommandText = "select * from lsub where sub_code='1'"
        dr = cmd.ExecuteReader
        dr.Read()
        sub_name.Text = dr("sub_name")

        tm = 10
        RSD.Text = 0
      FCASH1()
        ACdr.Close()
        ACcmd.CommandText = "update srv set CASH='" & Val(id.Text) & "' "
        ACcmd.ExecuteNonQuery()
        cesl_date.Checked = True
        RP1.Checked = False
        f3(1)
        If flg.Checked = True Then n = 1 Else n = -1
        Dim NN1 As Integer = 0
        Dim NN2 As Integer = 0
        dr1.Close()
        dr.Close()
        While Not NN1 = F31.Rows.Count
           FCASH1()
            ACdr.Close()
            ACcmd.CommandText = "update srv set CASH='" & Val(id.Text) & "' "
            ACcmd.ExecuteNonQuery()
            dr.Close()
            cmd.CommandText = "insert into lcash ([main_name],[main_code],[sub_code],[sub_name],[flg],[cash],[crd],[time1],[date1],[id],[notse],usr,shift,SAVE_NAME,SAVE_CODE,branch_code,branch_name) values ('" & main_name.Text & " ','" & main_code.Text & "','" & sub_code.Text & "','" & sub_name.Text & "','" & n & "','" & F31.Rows(NN1).Item("eslb") & "','0','" & time1.Text & "','" & ChangeFormat(esl_date.Value) & "','" & id.Text & "',' Õ”«»    " & F31.Rows(NN1).Item("pname") & "','" & F31.Rows(NN1).Item("USR") & "','" & F31.Rows(NN1).Item("SHIFT") & "','" & save_name.Text & "','" & save_code.Text & "','" & branch_code.Text & "','" & branch_name.Text & "')"
            cmd.ExecuteNonQuery()
            NN1 = NN1 + 1
        End While
        If tlabtolab = 1 Then
            LABTO()
            NN1 = 0
            If temp.Rows.Count > 0 Then
                dr.Close()
                cmd.CommandText = "select * from lsub where sub_code='100'"
                dr = cmd.ExecuteReader
                dr.Read()
                flg.Checked = False
                main_code.Text = dr("main_code")
                main_name.Text = dr("main_name")
                dr.Close()
                cmd.CommandText = "select * from lsub where sub_code='100'"
                dr = cmd.ExecuteReader
                dr.Read()
                sub_name.Text = dr("sub_name")
            End If
            While Not NN1 = temp.Rows.Count
                FCASH1()
                ACdr.Close()
                ACcmd.CommandText = "update srv set CASH='" & Val(id.Text) & "' "
                ACcmd.ExecuteNonQuery()
                dr.Close()
                cmd.CommandText = "insert into lcash ([main_name],[main_code],[sub_code],[sub_name],[flg],[cash],[crd],[time1],[date1],[id],[notse],usr,shift,SAVE_NAME,SAVE_CODE,branch_code,branch_name) values ('" & main_name.Text & " ','" & main_code.Text & "','" & sub_code.Text & "','" & sub_name.Text & "','-1','" & temp.Rows(NN1).Item("PTOT") & "','0','" & time1.Text & "','" & ChangeFormat(esl_date.Value) & "','" & id.Text & "',' Õ”«»    " & temp.Rows(NN1).Item("pname") & "','" & temp.Rows(NN1).Item("USR") & "','" & temp.Rows(NN1).Item("SHIFT") & "','" & save_name.Text & "','" & save_code.Text & "','" & branch_code.Text & "','" & branch_name.Text & "')"
                cmd.ExecuteNonQuery()
                NN1 = NN1 + 1
            End While
            RP1.Checked = True

        End If
        If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" Else Me.Text = "IT'S SAVED"

    End Sub



    Private Sub TestpriceToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TestpriceToolStripMenuItem1.Click
        ftprice()
    End Sub
    Public Sub genx()
        ACdr.Close()
        ACcmd.CommandText = "delete * from gen"
        ACcmd.ExecuteNonQuery()
        Dim nnn As String = ""
        dr.Close()
        cmd.CommandText = "select * from ltest order by gr_name"
        dr = cmd.ExecuteReader
        While dr.Read

            ACcmd.CommandText = "INSERT INTO gen (CODE,NAME1,f) VALUES ('" & dr("TEST_CODE") & "','" & dr("short") & "','1')"
            ACcmd.ExecuteNonQuery()
            If fftest_name = 1 Then
                ACcmd.CommandText = "INSERT INTO gen (CODE,NAME1,f,gso,color) VALUES ('" & dr("TEST_CODE") & "','" & dr("test_name") & "','2','" & dr("gso") & "','" & dr("color") & "')"
                ACcmd.ExecuteNonQuery()
            End If
            If fftest_code = 1 Then
                ACcmd.CommandText = "INSERT INTO gen (CODE,NAME1,f) VALUES ('" & dr("TEST_CODE") & "','" & dr("test_code") & "','3')"
                ACcmd.ExecuteNonQuery()
            End If
            If fftest_ar = 1 Then
                ACcmd.CommandText = "INSERT INTO gen (CODE,NAME1,f) VALUES ('" & dr("TEST_CODE") & "','" & dr("ar") & "','4')"
                ACcmd.ExecuteNonQuery()
            End If


        End While
        dr.Close()
        If ffprofile = 1 Then
            cmd.CommandText = "select * from lgr "
            dr = cmd.ExecuteReader
            While dr.Read
                ACcmd.CommandText = "INSERT INTO gen (CODE,NAME1,f,gso,color) VALUES ('" & dr("code") & "','" & dr("name") & "','5','" & dr("gso") & "','" & dr("color") & "')"
                ACcmd.ExecuteNonQuery()
            End While
        End If
        dr.Close()
        cmd.CommandText = "select * from lgroup "
        dr = cmd.ExecuteReader
        While dr.Read
            ACcmd.CommandText = "INSERT INTO gen (CODE,NAME1,f,gso,color) VALUES ('" & dr("code") & "','" & dr("name") & "','6','" & dr("gso") & "','" & dr("color") & "')"
            ACcmd.ExecuteNonQuery()
        End While

    End Sub
    Public Sub ftprice()

        Dim rrr As Process = Process.Start(Application.StartupPath & "\bar.exe")
        Try
            ACdr.Close()
            ACcmd.CommandText = "select kid_type from test_price  "
            ACdr = ACcmd.ExecuteReader
        Catch ex As Exception
            ACdr.Close()
            ACcmd.CommandText = "ALTER table TEST_PRICE  ADD kid_type text"
            ACcmd.ExecuteNonQuery()
        End Try

        ACdr.Close()
        ACcmd.CommandText = "DELETE * FROM TEST_PRICE"
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = "DELETE * FROM TEST_sub"
        ACcmd.ExecuteNonQuery()

        Dim asx As Integer = 0
        While Not asx = BOOK.Rows.Count
            asx = asx + 1
            FRC = BOOK.Select("CODE='" & asx & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                BOOK_CODE.Text = RC("code")
            End If
            If asx = 1 Then
                ACdr.Close()
                dr.Close()
                cmd.CommandText = "SELECT LTEST_PRICE.*,LTEST.kid_type as kid_type,LTEST.lck as lck,LTEST.ar as aar,LTEST.res,LTEST.NOTES,LTEST.GNAME,LTEST.lab,LTEST.GCODE,LTEST.CULT,LTEST.SUB,LTEST.so as so1 ,LTEST.ResultAfter,LTEST.short,LTEST.gr_name,LTEST.gr_code,LTEST.gr_code,RSO  FROM   LTEST_PRICE INNER JOIN LTEST ON LTEST_PRICE.TEST_CODE = LTEST.TEST_CODE WHERE LTEST_PRICE.BOOK_PRICE_CODE='" & BOOK_CODE.Text & "'"
                dr = cmd.ExecuteReader
                While dr.Read
                    Dim nnn As Integer = 0
                    nnn = nulls(dr("gr_code"))
                    ACcmd.CommandText = "INSERT INTO TEST_PRICE(TEST_CODE,TEST_NAME,TEST_AR,price1,GCODE,GNAME,sub,CULT,ResultAfter,[shortname],gr_name,gr_code,so,RSO,LAB2,rcv_date,res,NOTES,kid_type,lck) VALUES ('" & dr("TEST_CODE") & "','" & dr("TEST_NAME") & "','" & dr("aar") & "','" & dr("TOT") & "','" & dr("GCODE") & "','" & dr("GNAME") & "','" & dr("sub") & "','" & dr("CULT") & "','" & dr("ResultAfter") & "','" & dr("short") & "','" & dr("gr_name") & "','" & nnn & "','" & dr("so1") & "','" & dr("RSO") & "','" & dr("LAB") & "','" & Now & "','" & dr("res") & "','" & dr("NOTES") & "','" & dr("kid_type") & "','" & dr("lck") & "')"
                    ACcmd.ExecuteNonQuery()
                End While
                fprice(0)
                FRC = BILL.Select("sub='1'")
                ACdr.Close()
                Dim n As Integer = 0
                While Not n = FRC.Length
                    dr.Close()
                    RC = FRC(n)
                    cmd.CommandText = "select * from lsubtest where mtest_code='" & RC("test_code") & "' AND SO>0"
                    dr = cmd.ExecuteReader
                    While dr.Read
                        ACcmd.CommandText = "insert into test_sub(test_code,test_name,mtest_code,mtest_name,q,so,p,res1,rso,NOTES) values ('" & dr("test_code") & "','" & dr("test_name") & "','" & dr("mtest_code") & "','" & dr("mtest_name") & "','" & dr("q") & "','" & dr("so") & "','" & dr("p") & "','" & dr("res") & "','" & dr("rso") & "','" & dr("NOTES") & "')"
                        ACcmd.ExecuteNonQuery()
                    End While
                    n = n + 1
                End While

            ElseIf asx > 1 Then
                dr.Close()
                ACdr.Close()
                cmd.CommandText = "select * from ltest_price where  BOOK_PRICE_CODE='" & BOOK_CODE.Text & "'"
                dr = cmd.ExecuteReader

                While dr.Read

                    ACcmd.CommandText = "update test_price set  price" & BOOK_CODE.Text & "='" & dr("tot") & "' where test_NAME='" & dr("test_name") & "'"
                    ACcmd.ExecuteNonQuery()
                End While

            End If

        End While
        '**************************************** chang book price/////////////////////////////////////////////////
        dr.Close()
        cmd.CommandText = "select * from Branch where code='" & branch_code.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            esl_no.Text = dr("esl")
            ACdr.Close()
            ACcmd.CommandText = "update srv set esl='" & Val(esl_no.Text) - 1 & "' "
            ACcmd.ExecuteNonQuery()
        End If
        fprice(0)
        ACdr.Close()
        dr.Close()
        genx()
        gen.Clear()
        ACdr.Close() : ACcmd.CommandText = "select *  from gen  "
        adgen.SelectCommand = ACcmd
        adgen.Fill(DBS, "gen")
        gen = DBS.Tables("gen")
        DBS.Tables("gen").Clear()
        adgen.Fill(DBS, "gen")
        gen = DBS.Tables("gen")
        TextBox3.DataSource = gen
        TextBox3.DisplayMember = "name1"
        dr.Close()
        cmd.CommandText = "update device set flg='0' where name='" & sname & "'"
        cmd.ExecuteNonQuery()
        rrr.Kill()
        TPRICE()
        anew(1, 1)

    End Sub

    Public Sub fnor(ByVal n1 As Integer)
        'On Error Resume Next
        Dim na As Integer = 0
        Dim n As Integer = 0
        If n1 = 1 Then

            While Not na = testres.Rows.Count
                If IsNumeric(testres.Rows(na).Item("res")) = True Then
                    If IsNumeric(testres.Rows(na).Item("nore")) = True And IsNumeric(testres.Rows(na).Item("norb")) = True Then
                        testres.Rows(na).BeginEdit()
                        If testres.Rows(na).Item("res") > testres.Rows(na).Item("nore") And testres.Rows(na).Item("nore") > 0 Then
                            FRC = testres.Select("test_name='" & testres.Rows(na).Item("test_name") & "'")
                            If FRC.Length > 0 Then
                                RC = FRC(0)
                                RC.BeginEdit()
                                RC("ds") = 1
                                If UCase(RC("REF")) = "NEGATIVE" Then RC("res") = "Positive ( " & RC("RES") & " )"
                                RC.EndEdit()
                            End If
                        ElseIf testres.Rows(na).Item("res") < testres.Rows(na).Item("norb") And testres.Rows(na).Item("nore") > 0 Then
                            FRC = testres.Select("test_name='" & testres.Rows(na).Item("test_name") & "'")
                            If FRC.Length > 0 Then
                                RC = FRC(0)
                                RC.BeginEdit()
                                RC("ds") = -1
                                If UCase(RC("REF")) = "NEGATIVE" Then RC("res") = "Positive ( " & RC("RES") & " )"
                                RC.EndEdit()
                            End If
                        Else
                            FRC = testres.Select("test_name='" & testres.Rows(na).Item("test_name") & "'")
                            If FRC.Length > 0 Then
                                RC = FRC(0)
                                RC.BeginEdit()
                                RC("ds") = 0
                                If UCase(RC("REF")) = "NEGATIVE" Then RC("res") = "Negative ( " & RC("RES") & " )"
                                RC.EndEdit()
                            End If
                        End If
                    End If
                    ACdr.Close()
                Else
                    If testres.Rows(na).Item("nore") = testres.Rows(na).Item("norb") And testres.Rows(na).Item("norb") <> 0 Then
                        If UCase(testres.Rows(na).Item("res")) <> UCase(testres.Rows(na).Item("ref")) Then
                            RC = FRC(0)
                            RC.BeginEdit()
                            RC("ds") = 2
                            RC.EndEdit()
                        End If
                    End If

                    testres.Rows(na).EndEdit()
                End If
                na = na + 1
            End While
            While Not n = DataGridView1.RowCount
                If DataGridView1(("dsnew"), n).Value = 1 Then
                    DataGridView1.Rows(n).DefaultCellStyle.BackColor = Color.Red
                ElseIf DataGridView1(("dsnew"), n).Value = -1 Then
                    DataGridView1.Rows(n).DefaultCellStyle.BackColor = Color.Yellow
                Else
                    DataGridView1.Rows(n).DefaultCellStyle.BackColor = Color.White
                End If
                If DataGridView1(("DataGridViewTextBoxColumn2"), n).Value = "-" Then
                    DataGridView1.Rows(n).DefaultCellStyle.BackColor = Color.Pink
                End If
                If DataGridView1(("sub"), n).Value = "1" Or DataGridView1(("cult"), n).Value = 1 Then
                    DataGridView1.Rows(n).DefaultCellStyle.BackColor = Color.Cyan
                End If
                n = n + 1
            End While

        End If
        If n1 = 2 Then
            na = 0
            While Not na = subres.Rows.Count
                If IsNumeric(subres.Rows(na).Item("res")) = True Then
                    If IsNumeric(subres.Rows(na).Item("nore")) = True And IsNumeric(subres.Rows(na).Item("norb")) = True Then
                        subres.Rows(na).BeginEdit()
                        If subres.Rows(na).Item("res") > subres.Rows(na).Item("nore") And subres.Rows(na).Item("nore") > 0 Then
                            FRC = subres.Select("test_name='" & subres.Rows(na).Item("test_name") & "'")
                            If FRC.Length > 0 Then
                                RC = FRC(0)
                                RC.BeginEdit()
                                RC("ds") = 1
                                RC.EndEdit()
                            End If
                        ElseIf subres.Rows(na).Item("res") < subres.Rows(na).Item("norb") And subres.Rows(na).Item("nore") > 0 Then
                            FRC = subres.Select("test_name='" & subres.Rows(na).Item("test_name") & "'")
                            If FRC.Length > 0 Then
                                RC = FRC(0)
                                RC.BeginEdit()
                                RC("ds") = -1
                                RC.EndEdit()
                            End If
                        Else
                            FRC = subres.Select("test_name='" & subres.Rows(na).Item("test_name") & "'")
                            If FRC.Length > 0 Then
                                RC = FRC(0)
                                RC.BeginEdit()
                                RC("ds") = 0
                                RC.EndEdit()
                            End If
                        End If

                        ACdr.Close()
                    End If

                Else
                    'FRC = subres.Select("test_name='" & subres.Rows(na).Item("test_name") & "'")
                    'RC = FRC(0)
                    'RC.BeginEdit()
                    'RC("ds") = 0
                    'RC.EndEdit()
                    If subres.Rows(na).Item("nore") = subres.Rows(na).Item("norb") And subres.Rows(na).Item("norb") <> 0 Then
                        If UCase(subres.Rows(na).Item("res")) <> UCase(subres.Rows(na).Item("ref")) Then
                            FRC = subres.Select("test_name='" & subres.Rows(na).Item("test_name") & "'")
                            RC = FRC(0)
                            RC.BeginEdit()
                            RC("ds") = 2
                            RC.EndEdit()

                        End If
                    End If

                    subres.Rows(na).EndEdit()
                End If
                If IsNumeric(subres.Rows(na).Item("absu")) = True Then
                    If IsNumeric(subres.Rows(na).Item("re2")) = True And IsNumeric(subres.Rows(na).Item("re1")) = True Then
                        subres.Rows(na).BeginEdit()
                        If subres.Rows(na).Item("absu") > subres.Rows(na).Item("re2") And subres.Rows(na).Item("re2") > 0 Then
                            FRC = subres.Select("test_name='" & subres.Rows(na).Item("test_name") & "'")
                            If FRC.Length > 0 Then
                                RC = FRC(0)
                                RC.BeginEdit()
                                RC("ds1") = 1
                                RC.EndEdit()
                            End If
                        ElseIf subres.Rows(na).Item("absu") < subres.Rows(na).Item("re1") And subres.Rows(na).Item("re2") > 0 Then
                            FRC = subres.Select("test_name='" & subres.Rows(na).Item("test_name") & "'")
                            If FRC.Length > 0 Then
                                RC = FRC(0)
                                RC.BeginEdit()
                                RC("ds1") = -1
                                RC.EndEdit()
                            End If
                        Else
                            FRC = subres.Select("test_name='" & subres.Rows(na).Item("test_name") & "'")
                            If FRC.Length > 0 Then
                                RC = FRC(0)
                                RC.BeginEdit()
                                RC("ds1") = 0
                                RC.EndEdit()
                            End If
                        End If

                        ACdr.Close()
                    End If
                End If
                na = na + 1
            End While

            n = 0
            If DTEST_SUB.RowCount > 1 Then
                While Not n = DTEST_SUB.RowCount
                    If DTEST_SUB(("subds"), n).Value = 1 Then
                        DTEST_SUB.Rows(n).DefaultCellStyle.BackColor = Color.Red
                    ElseIf DTEST_SUB(("subds"), n).Value = -1 Then
                        DTEST_SUB.Rows(n).DefaultCellStyle.BackColor = Color.Yellow
                    Else
                        DTEST_SUB.Rows(n).DefaultCellStyle.BackColor = Color.White
                    End If
                    If DTEST_SUB(("DataGridViewTextBoxColumn4"), n).Value = "-" Then
                        DTEST_SUB.Rows(n).DefaultCellStyle.BackColor = Color.Pink
                    End If

                    n = n + 1
                End While
            End If

        End If
        If n1 = 3 Then
            While Not n = F31D.RowCount
                'If nulls(DataGridView6(("sprnt"), n).Value) > 0 Then
                '    DataGridView6.Rows(n).DefaultCellStyle.BackColor = Color.Red
                'Else
                '    DataGridView6.Rows(n).DefaultCellStyle.BackColor = Color.White
                'End If
                If nulls(F31D(("sprnt"), n).Value) > 0 Then
                    F31D.Rows(n).DefaultCellStyle.BackColor = Color.Red
                ElseIf nulls(F31D(("FINAL"), n).Value) > 0 Then
                    F31D.Rows(n).DefaultCellStyle.BackColor = Color.LightGreen
                ElseIf nulls(F31D(("FS"), n).Value) > 0 Then
                    F31D.Rows(n).DefaultCellStyle.BackColor = Color.Gray
                Else
                    F31D.Rows(n).DefaultCellStyle.BackColor = Color.White
                End If
                n = n + 1
            End While
        End If
    End Sub






    Private Sub NOTSEToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NOTSEToolStripMenuItem.Click
        notse1.Show()
        notse1.Focus()
    End Sub

    Private Sub GlassButton47_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ37.Click
        Try
            Dim aww As String = ""
            If PORV <> "" Then aww = " st=1, "
            Dim N As String
            N = ""
            If lng = "AR" Then N = MsgBox(SAVEAR & " " & ppp.Text, MsgBoxStyle.YesNo) Else N = MsgBox(SAVEEN & " " & ppp.Text, MsgBoxStyle.YesNo)
            If Val(TextBox4.Text) = 1 Then
                dr1.Close()
                cmd1.CommandText = "update LBILL_TEST set " & aww & " ref='" & ref.Text & "',nore='" & rnore.Text & "',unit='" & funit.Text & "',norb='" & rnorb.Text & "' where ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " ANd test_name='" & ppp.Text & "'"
                cmd1.ExecuteNonQuery()
            ElseIf Val(TextBox4.Text) = 2 Then
                dr1.Close()
                cmd1.CommandText = "update LBILL_TESTsub set " & aww & " ref='" & ref.Text & "',nore='" & rnore.Text & "',unit='" & funit.Text & "',norb='" & rnorb.Text & "' where ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " ANd test_name='" & ppp.Text & "'"
                cmd1.ExecuteNonQuery()
            End If
            LLOG(" ⁄œÌ·", 0, "edit normal test " & Ntest_NAME.Text, 1, bran.Text)
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub GlassButton48_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton48.Click
        'If COMPANY_name.Text = "" Then Exit Sub
        Dim N1 As String
        N1 = ""
        If msga = 1 Then
            If lng = "AR" Then N1 = MsgBox(SAVEAR, MsgBoxStyle.YesNo) Else N1 = MsgBox(SAVEEN, MsgBoxStyle.YesNo)
        End If
        dr.Close()
        cmd.CommandText = "select * from lcompany where name='" & COMPANY_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            dr.Close()
            Dim n As String = 0
            dr.Close()
            cmd.CommandText = "update lcompany set nik='" & nik.Text & "'  where name='" & COMPANY_name.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update lbill set nnik='" & nik.Text & "'  where COMPANY_name='" & COMPANY_name.Text & "'"
            cmd.ExecuteNonQuery()
            If msga = 1 Then
                If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" Else Me.Text = "IT'S SAVED"
            End If
        End If
    End Sub


    Private Sub TextBox7_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox7.TextChanged

    End Sub

    Private Sub Pus_cells_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Pus_cells.KeyDown
        If e.KeyCode = Keys.Enter Then
            Epithelial.Focus()

        End If
    End Sub

    Private Sub Pus_cells_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Pus_cells.MouseHover
        llname = "Pus_cells"
    End Sub

    Private Sub Pus_cells_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Pus_cells.TextChanged

    End Sub

    Private Sub Others_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Others.KeyDown
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "select * from lhres where sh='" & Others.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read

                Others.Text = dr("name")

            End While
            RBCs.Focus()

        End If
    End Sub

    Private Sub Others_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Others.MouseHover
        llname = "Others"

    End Sub

    Private Sub Others_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Others.TextChanged

    End Sub

    Private Sub Culture_conditions_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Culture_conditions.KeyDown
        If e.KeyCode = Keys.Enter Then
            Growth_of.Focus()

        End If
    End Sub

    Private Sub Culture_conditions_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Culture_conditions.MouseHover
        llname = "Culture_conditions"
    End Sub

    Private Sub Culture_conditions_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Culture_conditions.SelectedIndexChanged

    End Sub

    Private Sub Count_is_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Count_is.KeyDown
        If e.KeyCode = Keys.Enter Then
            Epithelial.Focus()

        End If
    End Sub

    Private Sub Count_is_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Count_is.MouseHover
        llname = "Count_is"
    End Sub

    Private Sub Count_is_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Count_is.TextChanged

    End Sub

    Private Sub Epithelial_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Epithelial.KeyDown
        If e.KeyCode = Keys.Enter Then
            Others.Focus()

        End If
    End Sub

    Private Sub Epithelial_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Epithelial.MouseHover
        llname = "Epithelial"

    End Sub

    Private Sub Epithelial_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Epithelial.TextChanged

    End Sub

    Private Sub RBCs_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles RBCs.KeyDown
        If e.KeyCode = Keys.Enter Then
            Culture_conditions.Focus()

        End If
    End Sub

    Private Sub RBCs_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles RBCs.MouseHover
        llname = "RBCs"
    End Sub

    Private Sub RBCs_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RBCs.TextChanged

    End Sub

    Private Sub RefindToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RefindToolStripMenuItem.Click
        fesl(0, 0)


    End Sub

    Private Sub GlassButton49_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandType = CommandType.Text
        If Val(TextBox4.Text) = 1 Then
            dr.Close() : cmd.CommandText = "select * from lntest WHERE test_name = '" & Ntest_NAME.Text & "'"
        ElseIf Val(TextBox4.Text) = 2 Then
            dr.Close() : cmd.CommandText = "select * from lnstest WHERE test_name = '" & Ntest_NAME.Text & "'"
        Else
            dr.Close() : cmd.CommandText = "select * from lntest WHERE test_name = '" & Ntest_NAME.Text & "'"
        End If
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 9
        Dim v As Integer = 0
        While Not v = brpd.Columns.Count
            brpd.Columns(v).Visible = False
            v = v + 1
        End While

        brpd.Columns("ref").Visible = True
        brpd.Columns("ref").HeaderText = "ref"
        brpd.Columns("ref").Width = 100
        brpd.Columns("type").Visible = True
        brpd.Columns("type").Width = 50
        brpd.Columns("ageb").Visible = True
        brpd.Columns("ageb").Width = 50
        brpd.Columns("agee").Visible = True
        brpd.Columns("agee").Width = 50
        brpd.Columns("norb").Visible = True
        brpd.Columns("norb").Width = 50
        brpd.Columns("norb").HeaderText = "from"
        brpd.Columns("nore").Visible = True
        brpd.Columns("nore").Width = 50
        brpd.Columns("nore").HeaderText = "to"
        brpd.Columns("unit").Visible = True
        brpd.Columns("unit").Width = 50
        brpd.Columns("unit").Visible = True
        brpd.Columns("year").HeaderText = "year"
        brpd.Columns("year").Visible = True
        brpd.Columns("year").Width = 50
        TabControl2.SelectTab(0)

    End Sub

    Private Sub GlassButton50_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ35.Click

        If comment1.Text = "" Then Exit Sub
        Dim N As String
        N = ""

        dr.Close()
        cmd.CommandText = "select * from lcomment where NAME='" & comment1.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            If msga = 1 Then
                If lng = "AR" Then N = MsgBox(SAVEAR & " " & comment1.Text, MsgBoxStyle.YesNo) Else N = MsgBox(SAVEEN & " " & comment1.Text, MsgBoxStyle.YesNo)
                If N = vbNo Then Exit Sub
            End If
            dr.Close() : cmd.CommandText = "insert into lcomment  (NAME)  values ('" & Trim(comment1.Text) & "')"
            cmd.ExecuteNonQuery()
            comments.AutoCompleteCustomSource.Add(comments.Text)
            If msga = 1 Then
                Me.Text = "it's saved" & " " & comments.Text
            End If
        End If


    End Sub

    Private Sub GlassButton51_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton51.Click
        SAVERES(0, 0)
        dr.Close()
        cmd.CommandText = "update lbill_test set qun=0 WHERE ESL_NO='" & Val(esl_no.Text) & "'"
        cmd.ExecuteNonQuery()
        fres()
    End Sub



    Private Sub TnToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TnToolStripMenuItem.Click

    End Sub

    Private Sub MenuStrip1_ItemClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.ToolStripItemClickedEventArgs) Handles MenuStrip1.ItemClicked

    End Sub

   
    Private Sub ToolsToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ToolsToolStripMenuItem.Click

    End Sub
    Public Sub FBARS()
        Try
            If prnt = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG(" ÿ»«⁄… »«—ﬂÊœ  Õ·Ì·", esl_no.Text, " ÿ»«⁄… »«—ﬂÊœ  Õ·Ì·" & pname.Text, 0, bran.Text)
                Exit Sub
            End If
            ACdr.Close()
            ACcmd.CommandText = "select * from srv"
            ACdr = ACcmd.ExecuteReader
            ACdr.Read()
            PrintPreviewDialog1.Document = PrintDocument1
            'PrintPreviewDialog1.ShowDialog()3
            PrintDialog1.PrinterSettings.PrinterName = ACdr("prnt")
            PrintDialog1.Document = PrintDocument1
            If bar.Rows.Count <= 0 Then
                FBARR()
            End If
            docs = 0
            Dim W As Integer = Convert.ToInt32("150")
            Dim H As Integer = Convert.ToInt32("37")
            bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
            Dim type As BarcodeLib.TYPE = BarcodeLib.TYPE.UNSPECIFIED
            type = BarcodeLib.TYPE.CODE128
            bar1.IncludeLabel = True
            bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
            type = BarcodeLib.TYPE.CODE128
            bar1.IncludeLabel = True
            If bran.Text = "0" Then barco.Image = bar1.Encode(type, Me.esl_no.Text.Trim(), W, H) Else barco.Image = bar1.Encode(type, Me.bran.Text.Trim + Me.esl_no.Text.Trim(), W, H)
            ''PrintDialog1.ShowDialog()
            SSSS = 0
            nnq = 0
            nnw = 0
            'PrintDocument1.Print()
            While Not nnw = bar.Rows.Count
                nnq = 0
mm:
                If bar.Rows(nnw).Item("qun") > 0 And nnq < bar.Rows(nnw).Item("qun") Then
                    docs = 1
                    'PrintDialog1.ShowDialog()
                    PrintDocument1.Print()
                    SSSS = +1
                    nnq = nnq + 1
                    GoTo mm
                End If
                nnw = nnw + 1
            End While
            bar.Rows.Clear()
            LLOG(" ÿ»«⁄… »«—ﬂÊœ  Õ·Ì·", esl_no.Text, " ÿ»«⁄… »«—ﬂÊœ  Õ·Ì·" & pname.Text, 1, bran.Text)

        Catch ex As Exception
            Dim st1 As String = "BAR"
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
    Private Sub GlassButton57_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq60.Click
        FBARR() : FBARS()
    End Sub

    Private Sub TabPage1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TabPage1.Click


    End Sub

    Private Sub COMPANY_CODE_MouseMove(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles COMPANY_CODE.MouseMove
        llname = "COMPANY_CODE"
    End Sub



   
    Private Sub GlassButton59_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton59.Click
        If esl_no.Text = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·" : Exit Sub
        brpd.BackgroundColor = Color.White
        ers.Rows.Clear()
        TESTS("rpt")
        fres()

    End Sub

    Private Sub GlassButton60_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton60.Click
        If esl_no.Text = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·" : Exit Sub
        ers.Rows.Clear()
        SAVERES(0, 0)
        prof(esl_no.Text, "rpt", 1)
        Dim m As String = "gtext"
        fres()

    End Sub
    Public Sub PROMIS()
        If lpromz = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «·ÌÊ„Ï  ", 0, bran.Text)
            Exit Sub
        End If
        flng("AR")
        Dim asm As String = "promised for date " & Now.Date
        Dim yy As String = "  bran='" & bran.Text & "' and "
        If cesl_date.Checked = True Then yy = yy & " esl_DATE='" & ChangeFormat(esl_date.Value) & "'" : asm = "visits for date " & esl_date.Value.Date
        If crcv_date.Checked = True Then yy = yy & " rcv_DATE='" & ChangeFormat(rcv_date.Value) & "'" : asm = "promised for date " & rcv_date.Value.Date
        If cesl_date.Checked = False And crcv_date.Checked = False Then yy = yy & " rcv_DATE='" & ChangeFormat(Now) & "'"
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandText = "select * from lbill where " & yy
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «·ÌÊ„Ï  ", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & rptp.Text & "\promis.rpt")
        oj.Database.Tables(0).SetDataSource(F31)
        oj.SetParameterValue("3", asm)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show()
        rp.Focus()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—  ", 1, bran.Text)

    End Sub
    Public Sub CBCCOM()

    End Sub


    Private Sub GlassButton61_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton61.Click
        If lres = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷ ‰ ÌÃ…", 0, "⁄—÷ «·‰ ÌÃ…  ", 0, bran.Text)
            Exit Sub
        End If
        If esl_no.Text = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·" : Exit Sub
        If finals.Checked = False Then
            rp.CrystalReportViewer1.ShowPrintButton = False
            rp.CrystalReportViewer1.ShowExportButton = False
        End If
        If sprnt = 1 Then
            Me.Text = "«·—Ã«¡  ”œÌœ «·»«ﬁÏ"
            rp.CrystalReportViewer1.ShowPrintButton = False
            rp.CrystalReportViewer1.ShowExportButton = False
        Else
            rp.CrystalReportViewer1.ShowPrintButton = True
            rp.CrystalReportViewer1.ShowExportButton = True
        End If
        If cultd.Rows.Count <= 0 Then Exit Sub
        savecult()
        If msga = 1 Then
            Me.Text = " „  ⁄„·Ì… Õ›Ÿ «·‰ ÌÃ…"
        End If
        FCULT("RPT")

    End Sub
    Public Sub savecult()
        'On Error Resume Next
        FRC = testres.Select("cult=1")
        If FRC.Length > 0 Then
            dr.Close()
            cmd.CommandText = "delete from LBILL_CULT  WHERE ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_NAME='" & culttestn.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "delete from LBILL_CULT_det  WHERE ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_NAME='" & culttestn.Text & "'"
            cmd.ExecuteNonQuery()
            Dim n As Integer = 0
            Dim NA As Integer = 0
            While Not n = cultd.Rows.Count
                If cultd.Rows(n).RowState = DataRowState.Deleted Then GoTo mm
                cmd.CommandText = "INSERT INTO   LBILL_CULT (TEST_NAME,TEST_CODE,NAME1,NAME2,NAME3,ESL_NO,SO,VIRUS,yearn,bran) VALUES ('" & culttestn.Text & "','" & culttestc.Text & "','" & cultd.Rows(n).Item("NAME1") & "','" & cultd.Rows(n).Item("NAME2") & "','" & cultd.Rows(n).Item("NAME3") & "','" & testres.Rows(0).Item("ESL_NO") & "','" & cultd.Rows(n).Item("SO") & "','" & cultd.Rows(n).Item("VIRUS") & "','" & esl_date.Value.Year & "','" & bran.Text & "')"
                cmd.ExecuteNonQuery()
                NA = NA + 1
mm:             n = n + 1
            End While
            cmd.CommandText = "INSERT INTO LBILL_CULT_DET ([test_name],[test_code],[esl_no],[SPECIMEN],[DIRECT_ FILM],[PUS_CELLS],[RBCs],[OTHERS],[CULTURE_CONDITIONS],[GROWTH_OF],[VAIBLE_COUNT],[COUNT_IS],NUM,yearn,bran,Epithelial) VALUES ('" & culttestn.Text & "','" & culttestc.Text & "','" & testres.Rows(0).Item("ESL_NO") & "','" & SPECIMEN.Text & "','" & DIRECT_FILM.Text & "','" & Pus_cells.Text & "','" & RBCs.Text & "','" & Others.Text & "','" & Culture_conditions.Text & "','" & Growth_of.Text & "','" & VAIBLE_COUNT.Text & "','" & Count_is.Text & "','" & NA & "','" & esl_date.Value.Year & "','" & bran.Text & "','" & Epithelial.Text & "') "
            cmd.ExecuteNonQuery()
            FRC = testres.Select("test_name='" & culttestn.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("res") = 1
                RC.EndEdit()
            End If
            If PORV.Length < 10 Then
                dr.Close()
                cmd.CommandText = " update lbill set st=2 where st=0 and ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
            End If

        End If

    End Sub
    Private Sub GlassButton62_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq130.Click
        ' Create an instance of the class that reads Excel files

        ''Dim xlApp As Microsoft.Office.Interop.Excel.Application
        ''Dim xlWorkBook As Microsoft.Office.Interop.Excel.Workbook
        ''Dim xlWorkSheet As Microsoft.Office.Interop.Excel.Worksheet

        ''xlApp = New Microsoft.Office.Interop.Excel.ApplicationClass
        ''xlWorkBook = xlApp.Workbooks.Open(Application.StartupPath & "\culture.xlsx")
        ''xlWorkSheet = xlWorkBook.Worksheets("sheet1")
        ' ''display the cells value B2
        ' ''MsgBox(xlWorkSheet.Cells(2, 2).value)
        ACdr.Close()
        ACcmd.CommandText = "select * from zzz"
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            If IsDBNull(ACdr("sen")) = False Then MEDCINE_NAME.Text = ACdr("sen") : GlassButton9_Click(GlassButton9, e)
            If IsDBNull(ACdr("mod")) = False Then MEDCINE_NAME.Text = ACdr("mod") : GlassButton10_Click(GlassButton10, e)
            If IsDBNull(ACdr("ress")) = False Then MEDCINE_NAME.Text = ACdr("ress") : GlassButton11_Click(GlassButton11, e)
        End While

        'edit the cell with new value
        'xlWorkSheet.Cells(2, 2) = "http://vb.net-informations.com"
        'xlWorkBook.Close()
        'xlApp.Quit()

        'releaseObject(xlApp)
        'releaseObject(xlWorkBook)
        'releaseObject(xlWorkSheet)
    End Sub
    Private Sub releaseObject(ByVal obj As Object)
        Try
            System.Runtime.InteropServices.Marshal.ReleaseComObject(obj)
            obj = Nothing
        Catch ex As Exception
            obj = Nothing
        Finally
            GC.Collect()
        End Try
    End Sub
    Private Sub GlassButton63_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton63.Click
        If drb.Visible = True Then drb.Visible = False Else drb.Visible = True
    End Sub

    Private Sub OnTestToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        dr.Close() : cmd.CommandText = "SELECT  * from v_lab where company_name='" & COMPANY_name.Text & "' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        adesl.SelectCommand = cmd
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        DBS.Tables("esl").Clear()
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        brpd.DataSource = esl
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\contact det.rpt")
        oj.Database.Tables(0).SetDataSource(esl)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub GlassButton64_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ41.Click
        FPRINTV()
    End Sub

   

    Private Sub ref_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ref.MouseHover
        llname = "REF"
    End Sub

    Private Sub ref_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ref.TextChanged

    End Sub

    Private Sub GlassButton66_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub



    Private Sub CODEB_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)
        If e.KeyCode = Keys.Enter Then

        End If
    End Sub
    Public Sub prntss()
        Dim SS As Integer = 0
        If F31.Rows.Count > 0 Then
            SS = 0
            FRC = F31.Select("esl_no='" & CODEB.Text & "'")
            If FRC.Length > 0 Then
                While Not SS = F31.Rows.Count
                    F31.Rows(SS).BeginEdit()
                    F31.Rows(SS).Item("QUN") = 0
                    F31.Rows(SS).BeginEdit()
                    SS = SS + 1
                End While
                RC = FRC(0)
                RC.BeginEdit()
                RC("QUN") = 1
                RC.EndEdit()
            Else
                GoTo mm
            End If
        Else
mm:
            dr.Close() : cmd.Connection = CN
            dr.Close() : cmd.CommandText = "select * from lbill where  ESL_NO ='" & CODEB.Text & "' and yearn='" & YEARN.Text & "'"
            adF31.SelectCommand = cmd
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            DBS.Tables("F31").Clear()
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            F31D.DataSource = F31
            RC = F31.Rows(0)
            RC.BeginEdit()
            RC("QUN") = 1
            RC.EndEdit()
            tm = 4
            F31DTG()

            SS = 0
            While SS = F31.Rows.Count
                F31.Rows(SS).BeginEdit()
                F31.Rows(SS).Item("QUN") = 1
                F31.Rows(SS).BeginEdit()
                SS = SS + 1
            End While
        End If

        printall()

    End Sub
    Public Sub printall()
        Try
            SAVERES(1, 0)
            If finals.Checked = False Then MsgBox("«· ﬁ—Ì— ·„   „ „—«Ã⁄ Â ") : Exit Sub
            Dim xx As Integer = 0
            If F31.Rows.Count <= 0 Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·« " : Exit Sub
            While Not xx = F31.Rows.Count
                If F31.Rows(xx).RowState = DataRowState.Deleted Then GoTo mmm
                If nulls(F31.Rows(xx).Item("qun")) = 0 Then GoTo mmm
                If nulls(F31.Rows(xx).Item("qun")) <> 1 Then GoTo mmm
                Dim totx As Double = 0
                Dim totz As Double = 0
                Dim toty As Double = 0
                esl_no.Text = F31.Rows(xx).Item("esl_no")
                REST.Text = F31.Rows(xx).Item("rest")
                dr.Close()
                If FESLT = 1 Then
                    cmd.CommandText = "SELECT sum(tot) FROM lbill_esl where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    dr = cmd.ExecuteReader
                    dr.Read()
                    totx = nulls(dr(0))
                    dr.Close()
                    cmd.CommandText = "select sum(test_price - (test_price * dis_n * .01)) from lbill_test where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and qun=0 and prntn > 0 and bran='" & bran.Text & "'"
                    dr = cmd.ExecuteReader
                    dr.Read()
                    toty = nulls(dr(0))
                    dr.Close()
                    cmd.CommandText = "select sum(test_price - (test_price * dis_n * .01)) from lbill_test where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and qun=1 and bran='" & bran.Text & "'"
                    dr = cmd.ExecuteReader
                    dr.Read()
                    totz = nulls(dr(0))
                    rppnt = 0
                End If

                If edt = 0 Then
                    If Val(totx * cash_per.Text * 0.01) >= (totz + toty) Or REST.Text = 0 Or mng = 1 Then
                        TESTS("prnt")
                        prof(esl_no.Text, "prnt", 1)
                        FCULT("PRNT")
                    End If
                ElseIf REST.Text = 0 Or REST_PRNT = 1 Then
                    TESTS("prnt")
                    prof(esl_no.Text, "prnt", 1)
                    FCULT("PRNT")
                Else
                    MsgBox("«· Õ«·Ì· «· Ï  „ «Œ Ì«—Â« «ﬂ»— „‰ «·„»·€ «·„œ›Ê⁄", MsgBoxStyle.Critical)
                End If

                If rppnt = 1 Then
                    dr.Close()
                    cmd.CommandText = "update lbill_test  set prntn=prntn+1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1"
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "update lbill set sprnt=sprnt+1 ,printtime='" & ChangeFormatall(Now) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    dr.Close()
                    If PORV <> "" Then
                        cmd.CommandText = " update lbill set st=1 where st=0 and ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                        cmd.ExecuteNonQuery()
                    End If
                    LLOG("ÿ»«⁄… ‰ ÌÃ… «· Õ«·Ì·", esl_no.Text, "ÿ»«⁄… ‰ ÌÃ… «· Õ«·Ì·  " & F31.Rows(xx).Item("pname"), 1, bran.Text)
                End If
mmm:
                xx = xx + 1
            End While


            docs = 0

            If msga = 1 Then
                MsgBox(" „  ⁄„·Ì… «·ÿ»«⁄…")
            End If
        Catch ex As Exception
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','print all','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub CODEB_MouseCaptureChanged(ByVal sender As Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub CODEB_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "CODEB"
    End Sub

    Private Sub CODEB_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton69_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton69.Click
        Dim N1 As String
        Dim aww As String = ""
        If PORV <> "" Then aww = " st=1, "
        SAVERES(1, 0)

        If msga = 1 Then
            N1 = MsgBox("SAVE COMMENT TO " & mtest.Text, MsgBoxStyle.YesNo)
            If N1 = vbNo Then Exit Sub
        End If
        If subres.Rows.Count > 0 Then
            dr1.Close()
            cmd1.CommandText = "update LBILL_TESTSUB set " & aww & " note='" & comment1.Text & "' where ESL_NO='" & subres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and   MTEST_CODE='" & subres.Rows(0).Item("MTEST_CODE") & "'"
            cmd1.ExecuteNonQuery()
            dr.Close()
            If PORV <> "" Then
                cmd.CommandText = " update lbill set st=2 where st=0 and ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
            End If

            GlassButton50_Click(QQ35, e)
            If msga = 1 Then
                If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" Else Me.Text = "IT'S SAVED"
            End If
        End If

    End Sub

    Private Sub GlassButton68_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton68.Click
        SAVERES(1, 0)
        Dim N1 As String
        If msga = 1 Then
            N1 = MsgBox("SAVE COMMENT " & grc.Text, MsgBoxStyle.YesNo)
            If N1 = vbNo Then Exit Sub
        End If
        If testres.Rows.Count > 0 Then
            dr1.Close()
            cmd1.CommandText = "update LBILL_TEST set comment='" & comment1.Text & "' where ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'and test_name='" & Ntest_NAME.Text & "'"
            cmd1.ExecuteNonQuery()
            If PORV <> "" Then
                dr.Close()
                cmd.CommandText = " update lbill set st=2 where st=0 and ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
            End If
            GlassButton50_Click(QQ35, e)
            If msga = 1 Then
                If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" Else Me.Text = "IT'S SAVED"
            End If
        End If

    End Sub



    Private Sub GlassButton70_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq47.Click
        If Ntest_NAME.Text = "" Then Me.Text = "«·—Ã«¡ ﬂ «»… «”„ «· Õ·Ì·" : Exit Sub
        Dim n As String
        n = MsgBox(" Â·  —Ìœ «÷«›… »Ì«‰«  «· Õ·Ì· ÃœÌœ ", MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "select * from ltest where test_name='" & Ntest_NAME.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        Dim NN As String
        If dr.HasRows Then Me.Text = "Â–« «· Õ·Ì· „”Ã· „‰ ﬁ»·" : Exit Sub
        NN = MsgBox("Â·  —Ìœ «·Õ›Ÿ" & " " & Ntest_NAME.Text, MsgBoxStyle.YesNo)
        If NN = vbNo Then Exit Sub
        dr.Close() : cmd.CommandText = "select MAx(test_code),MAX(SO) from LTEST "
        dr = cmd.ExecuteReader
        dr.Read()
        Ntest_CODE.Text = 1 + nulls(dr(0))
        dr1.Close()
        cmd1.CommandText = "select * from lbook_price where code='2'"
        dr1 = cmd1.ExecuteReader
        dr1.Read()
        dr.Close() : cmd.CommandText = "insert into LTEST (ResultAfter,test_code,test_name,Gcode,Gname,CULT,[KID_TYPE],short,gr_name,gr_code,lab,sub)  values ('" & ResultAfter.Text & "','" & Ntest_CODE.Text & "','" & Trim(Ntest_NAME.Text) & "','" & gro_code.Text & "','" & smain.Text & "','" & Val(cult.CheckState) & "','" & KID_TYPE.Text & "','" & Trim(shrt.Text) & " ','" & GRNAME.Text & "','" & gr_code.Text & "','" & Val(lab2.CheckState) & "','" & Val(sub2.CheckState) & "')"
        cmd.ExecuteNonQuery()
        dr.Close() : cmd.CommandText = "insert into ltest_price (test_code,test_name,[book_price_code],[book_price_name],tot,ar)  values ('" & Ntest_CODE.Text & "','" & Trim(Ntest_NAME.Text) & "','1','ﬂ Ì» «”⁄«— «·„⁄„·','" & Val(price1.Text) & "','')"
        cmd.ExecuteNonQuery()
        If scan1 = 10 Then
            dr.Close() : cmd.CommandText = "insert into ltest_price (test_code,test_name,[book_price_code],[book_price_name],tot,ar)  values ('" & Ntest_CODE.Text & "','" & Trim(Ntest_NAME.Text) & "','2','" & dr1("name") & "','" & Val(prc2.Text) & "','')"
            cmd.ExecuteNonQuery()
        End If
        LLOG("Õ›Ÿ ÃœÌœ", 0, "save test " & Ntest_NAME.Text, 1, bran.Text)
        MsgBox(" „  ⁄„·Ì… «÷«›…  Õ·Ì· ÃœÌœ")
        fprice1(1)
        FSAVEV()
    End Sub

    Private Sub GlassButton71_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq49.Click
        If Ntest_NAME.Text = "" Then Me.Text = "«·—Ã«¡ ﬂ «»… «”„ «· Õ·Ì·" : Exit Sub
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 205 Then Exit Sub
        dr.Close()
        cmd.CommandText = "select * from ltest where test_name='" & Ntest_NAME.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        Dim NN As String
        If dr.HasRows Then
            NN = MsgBox("Â·  —Ìœ «·Õ–›" & " " & Ntest_NAME.Text, MsgBoxStyle.YesNo)
            If NN = vbNo Then Exit Sub
            dr.Close()
            dr.Close()
            cmd.CommandText = "DELETE from ltest where test_code='" & Ntest_CODE.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "DELETE from LSUBTEST where mtest_code='" & Ntest_CODE.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "DELETE from lntest where test_code='" & Ntest_CODE.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "DELETE from lNstest where mtest_code='" & Ntest_CODE.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "DELETE from ltest_PRICE where test_code='" & Ntest_CODE.Text & "'"
            cmd.ExecuteNonQuery()
            dr.Close()
            cmd.CommandText = "insert into ldel (esl_no,type) values ('" & Ntest_CODE.Text & "','test')"
            cmd.ExecuteNonQuery()
            LLOG("Õ–›", 0, "delete test " & Ntest_NAME.Text, 1, bran.Text)
            fprice1(1)
        End If
    End Sub

    Private Sub TextBox9_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles TextBox9.KeyDown



    End Sub

    Private Sub TextBox9_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles TextBox9.KeyUp
        d1.Value = Now
        d1.Value = d1.Value.AddDays(-1 * Val(TextBox9.Text))
    End Sub

    Private Sub TextBox9_TextChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox9.TextChanged

    End Sub

    Private Sub GlassButton72_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DDK.Click
        emlprg = 0
        If lemail = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("ÿ»«⁄…", esl_no.Text, "ÿ»«⁄… «·«Ì’«·  ", 0, bran.Text)
            Exit Sub
        End If
        If eml.Text = "" Then
            Me.Text = "enter email"
            eml.Focus()
            Exit Sub
        End If
        Dim xx As Integer = 0
        If F31.Rows.Count <= 0 Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·« " : Exit Sub
        While Not xx = F31.Rows.Count
            If F31.Rows(xx).RowState = DataRowState.Deleted Then GoTo mmm
            esl_no.Text = F31.Rows(xx).Item("esl_no")
            pname.Text = F31.Rows(xx).Item("pname")
            pemail.Text = eml.Text
            FEMAIL()
mmm:
            xx = xx + 1
        End While

    End Sub



    Private Sub test_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "test"

    End Sub





    Private Sub PrintLabToLabToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If lab_name.Text = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·„⁄„·" : Exit Sub
        dr.Close() : cmd.CommandText = "SELECT  * from v_lab where lab_name='" & lab_name.Text & "' and bdel=0 and esl_date='" & ChangeFormat(esl_date.Value) & "'"
        adesl.SelectCommand = cmd
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        DBS.Tables("esl").Clear()
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        brpd.DataSource = esl
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\lab esl.rpt")
        oj.Database.Tables(0).SetDataSource(esl)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «·„⁄„·", 1, bran.Text)
    End Sub

    Private Sub  — Ì‰»«·ÿ»«⁄…ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

        dr.Close()
        cmd.CommandText = "select * from LSUBTEST "
        dr = cmd.ExecuteReader
        While dr.Read
            dr1.Close()
            cmd1.CommandText = "update lbill_testsub set q='" & dr("q") & "',p='" & dr("p") & "',so='" & dr("so") & "',rso='" & dr("rso") & "' where test_code='" & dr("test_code") & "' "
            cmd1.ExecuteNonQuery()

        End While
        dr.Close()
        cmd.CommandText = "select * from LTEST "
        dr = cmd.ExecuteReader
        While dr.Read

            dr1.Close()
            cmd1.CommandText = "update lbill_test set so='" & dr("so") & "',rso='" & dr("rso") & "' where test_code='" & dr("test_code") & "'"
            cmd1.ExecuteNonQuery()

        End While
    End Sub

    Private Sub esl_date_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles esl_date.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))
        'DOC_name.BackColor = Color.Silver
        esl_date.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "esl_date")
    End Sub

    Private Sub esl_date_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles esl_date.KeyDown

        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")

    End Sub

    Private Sub esl_date_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles esl_date.KeyPress

    End Sub

    Private Sub esl_date_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles esl_date.MouseHover
        llname = "esl_date"
    End Sub


    Private Sub TextBox10_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles TextBox10.KeyUp
        rcv_date.Value = Now
        rcv_date.Value = rcv_date.Value.AddDays(-1 * Val(TextBox10.Text))

    End Sub

    Private Sub TextBox10_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles TextBox10.MouseHover
        llname = "TextBox10"

    End Sub

    Private Sub TextBox10_TextChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox10.TextChanged

    End Sub

    Private Sub user_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles user.MouseHover
        llname = "user"

    End Sub

    Private Sub user_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles user.SelectedIndexChanged

    End Sub

    Private Sub gr1_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles gr1.MouseHover
        llname = "gr1"

    End Sub

    Private Sub gr1_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gr1.SelectedIndexChanged

    End Sub

    Private Sub FindTestToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        ctest.Checked = True
        test.Text = TextBox3.Text
        f3(1)
        ctest.Checked = False

    End Sub

    Private Sub  ﬁ—Ì—ToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        nyes.Text = "not sum"
        nno.Text = " with sum"
    End Sub





    Private Sub GlassButton73_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq91.Click
        Dim N As String
        If GRNAME.Text = "" Then Me.Text = "«Œ «— «·„Ã„Ê⁄…" : Exit Sub
        N = MsgBox("Â·  —Ìœ «· ⁄œÌ·ø" & " " & GRNAME.Text, MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub
        dr.Close()
        Dim M As Integer
        cmd.CommandText = "SELECT * FROM LGR WHERE NAME='" & GRNAME.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            M = dr("CODE")
        Else
            N = ""
            N = MsgBox(" Â·  —Ìœ «·Õ›Ÿ ø" & " " & GRNAME.Text, MsgBoxStyle.YesNo)
            If N = vbNo Then Exit Sub
            dr.Close() : cmd.CommandText = "select MAx(code) from lgr "
            dr = cmd.ExecuteReader
            dr.Read()
            M = 1 + nulls(dr(0))
            dr.Close() : cmd.CommandText = "insert into lgr (code,name,st)  values ('" & M & "','" & Trim(GRNAME.Text) & "','1')"
            cmd.ExecuteNonQuery()
        End If
        LLOG(" ⁄œÌ·", 0, "«·„Ã„Ê⁄… " & GRNAME.Text, 1, bran.Text)
        dr.Close()
        ACdr.Close()
        ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun>0 "
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            cmd.CommandText = "UPDATE LTEST SET GR_NAME='" & Trim(GRNAME.Text) & "' ,GR_CODE='" & M & "' WHERE  TEST_NAME='" & ACdr("TEST_NAME") & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "UPDATE LBILL_TEST SET GR_NAME ='" & GRNAME.Text & "' WHERE TEST_NAME='" & ACdr("TEST_NAME") & "'"
            cmd.ExecuteNonQuery()
        End While
        fprice1(1)
        If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" & " " & GRNAME.Text Else Me.Text = "IT'S SAVED" & " " & GRNAME.Text

    End Sub
    Public Sub fprice1(ByVal m As Integer)
        If m = 1 Then
            dr.Close()
            cmd.CommandText = "update device set flg=1"
            cmd.ExecuteNonQuery()
        Else
            dr.Close()
            cmd.CommandText = "select * from device where name='" & sname & "' and flg=1"
            dr = cmd.ExecuteReader
            If dr.HasRows = True Then ftprice()
        End If
    End Sub
    Private Sub  «—ÌŒ«· Õ«·Ì···„—Ì÷ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub  «—ÌŒ«· Õ«·Ì···„—Ì÷ToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        nyes.Text = "VIEW"
        nno.Text = "EMAIL"
    End Sub

    Private Sub bon_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles bon.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        bon.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "bon")
    End Sub

    Private Sub bon_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles bon.KeyDown
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")
    End Sub

    Private Sub bon_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles bon.MouseHover
        llname = "bon"

    End Sub

    Private Sub bon_TextChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles bon.TextChanged
        FUND()

    End Sub

    Private Sub depn_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles depn.DropDown
        depn.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from lbook_price where name='" & BOOK_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            depn.Items.Add(dr("P1"))
            depn.Items.Add(dr("P2"))
            depn.Items.Add(dr("P3"))
            depn.Items.Add(dr("P4"))

        End If
    End Sub

    Private Sub depn_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles depn.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))
        depn.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "depn")
    End Sub

    Private Sub depn_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles depn.KeyDown
        If e.KeyCode = Keys.Enter Then sdsdsdsd_Click(sdsdsdsd, e) : sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")

    End Sub

    Private Sub depn_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles depn.MouseHover
        llname = "depn"
    End Sub

    Private Sub depn_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles depn.SelectedIndexChanged


    End Sub

    Private Sub BackWriteColorToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        ColorDialog1.ShowDialog()
        bcolor = ColorDialog1.Color.ToArgb
        dr.Close()
        cmd.CommandText = "update USERS set backcolor=" & Val(bcolor) & "  where NAME='" & USR & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub nik_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles nik.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        nik.BackColor = Color.FromArgb(backcolor1)

    End Sub

    Private Sub nik_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles nik.MouseHover
        llname = "nik"

    End Sub

    Private Sub nik_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles nik.SelectedIndexChanged

    End Sub

    Private Sub pid_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles pid.GotFocus
        'colu(Me, Val(bcolor), Val(fcolor))

        'pid.BackColor = Color.FromArgb(backcolor1)
        'sotr(2, "pid")
        'esld.Focus()
        FFIND = "pid"
        FFINDT = pid.Text
    End Sub

    Private Sub pid_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles pid.KeyDown
        'If e.KeyCode = Keys.Enter Then sotr(1, "")
        'If e.KeyCode = Keys.Left Then sotr(-1, "")
        If e.KeyCode = Keys.F6 Then
            fufind()
        End If
        If e.KeyCode = Keys.F2 Then
            FIND.NFLD.Text = " pid "
            FIND.SNAME.Text = pid.Text
            FIND.ShowDialog()
        End If
    End Sub

    Private Sub pid_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles pid.MouseHover
        'llname = "PID"
    End Sub

    Private Sub pid_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pid.TextChanged

    End Sub

    Private Sub pntot_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles pntot.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        pntot.BackColor = Color.FromArgb(backcolor1)

    End Sub

    Private Sub pntot_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles pntot.MouseHover
        llname = "pntot"

    End Sub

    Private Sub pntot_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pntot.TextChanged

    End Sub

    Private Sub pnrest_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles pnrest.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))

        pnrest.BackColor = Color.FromArgb(backcolor1)

    End Sub

    Private Sub pnrest_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles pnrest.MouseHover
        llname = "pnrest"

    End Sub

    Private Sub pnrest_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pnrest.TextChanged

    End Sub

    Private Sub test_code_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles test_code.MouseHover
        llname = "test_code"

    End Sub


    Private Sub lname_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles lname.SelectedIndexChanged
        If PRAA = 0 Then Exit Sub
        ACdr.Close()
        ACcmd.CommandText = "SELECT * FROM exp WHERE lname='" & lname.Text & "'"
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            AxWindowsMediaPlayer1.URL = Application.StartupPath & "\HELP\" & ACdr("PATH")
        End While
    End Sub

    Private Sub Timer1_Disposed(ByVal sender As Object, ByVal e As System.EventArgs) Handles Timer1.Disposed

    End Sub
    Private Sub Ntest_NAME_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Ntest_NAME.KeyDown
        'On Error Resume Next
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "select * from ltest where test_name='" & Ntest_NAME.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                Ntest_CODE.Text = dr("test_code")
                shrt.Text = dr("short")
                KID_TYPE.Text = dr("KID_TYPE")
                sub2.Checked = dr("sub")
                cult.Checked = dr("cult")
                lab2.Checked = dr("lab")
                smain.Text = dr("gname")
                GRNAME.Text = dr("GR_NAME")
                ResultAfter.Text = dr("ResultAfter")
            End While
            price1.Text = 0
            prc2.Text = 0
            dr.Close()
            cmd.CommandText = "select * from Ltest_price  WHERE TEST_CODE='" & Val(Ntest_CODE.Text) & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                If dr("book_price_code") = "1" Then price1.Text = dr("tot")
                If dr("book_price_code") = "2" Then prc2.Text = dr("tot")
            End While
            TextBox4.Text = 1
            databook.DataSource = BOOK
            Dim v As Integer = 0
            While Not v = databook.Columns.Count
                databook.Columns(v).Visible = False
                v = v + 1
            End While
            databook.Columns("name").Visible = True
            databook.Columns("k").Visible = True
            databook.Visible = True
            GB22.Visible = True
            GB23.Visible = True
            Dim ii As Integer = 0
            While Not ii = BOOK.Rows.Count
                ss = 0
                dr.Close() : cmd.CommandText = "sELECT  tot from ltest_price WHERE test_code='" & Ntest_CODE.Text & "'  and book_price_code='" & BOOK.Rows(ii).Item("code") & "' "
                dr = cmd.ExecuteReader
                dr.Read()
                If dr.HasRows = True Then If IsDBNull(dr(0)) = False Then ss = ss + dr(0)
                '===================================================================
                dr.Close()
                RC = BOOK.Rows(ii)
                RC.BeginEdit()
                RC("k") = ss
                RC.EndEdit()
mv:
                ss = 0
                ii += 1
            End While


        End If

    End Sub

    Private Sub Ntest_NAME_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Ntest_NAME.MouseHover
        llname = "Ntest_NAME"
    End Sub

    Private Sub Ntest_NAME_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Ntest_NAME.TextChanged

    End Sub

    Private Sub YouHaveNewNoteToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles YouHaveNewNoteToolStripMenuItem.Click
        dr.Close() : cmd.CommandText = "select * from v_wall where rd=0 and usr='" & USR & "'"
        adnt1.SelectCommand = cmd
        adnt1.Fill(DBS, "nt1")
        nt1 = DBS.Tables("nt1")
        DBS.Tables("nt1").Clear()
        adnt1.Fill(DBS, "nt1")
        nt1 = DBS.Tables("nt1")
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\wall.rpt")
        oj.Database.Tables(0).SetDataSource(nt1)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show()
        rp.Focus()
        dr.Close()
        cmd.CommandText = "update lwall_usr set  rd=1  where  usr='" & USR & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub PRINTRESULTToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        GlassButton64_Click(QQ41, e)

    End Sub



    Private Sub GlassButton55_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs)
    End Sub

    Private Sub GlassButton74_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq221.Click
        If group_name.Text = "" Then Me.Text = "«ﬂ » «·„Ã„Ê⁄…" : Exit Sub
        Dim N As String
        N = MsgBox("Â·  —Ìœ «· ⁄œÌ·ø" & " " & group_name.Text, MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub
        Dim M As Integer
        dr.Close()
        cmd.CommandText = "select max(code) from  lgroup "
        dr = cmd.ExecuteReader
        dr.Read()
        M = nulls(dr(0)) + 1
        dr.Close()
        cmd.CommandText = "delete from lgroup  WHERE  NAME='" & group_name.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from lgroup_test  WHERE  GNAME='" & group_name.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from lgroup_price  WHERE  gNAME='" & group_name.Text & "' and book_price_name='" & BOOK_name.Text & "'"
        cmd.ExecuteNonQuery()
        dr1.Close()
        cmd1.CommandText = "insert into lgroup (code,name,st)  values ('" & M & " ','" & Trim(group_name.Text) & "','1')"
        cmd1.ExecuteNonQuery()
        ACdr.Close()
        ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun>0 "
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            dr1.Close()
            cmd1.CommandText = "insert into lgroup_test (test_code,test_name,gcode,gname)  values ('" & ACdr("test_code") & "','" & ACdr("test_name") & "','" & M & " ','" & Trim(group_name.Text) & "')"
            cmd1.ExecuteNonQuery()
        End While
        dr.Close()
        dr1.Close()
        cmd1.CommandText = "insert into lgroup_price (book_price_code,book_price_name,gcode,gname,tot)  values ('" & BOOK_CODE.Text & "','" & BOOK_name.Text & "','" & M & " ','" & Trim(group_name.Text) & "','" & tot1.Text & "')"
        cmd1.ExecuteNonQuery()
        LLOG(" ⁄œÌ·", 0, "«·„Ã„Ê⁄… " & group_name.Text, 1, bran.Text)

        group_name.Items.Add(Trim(group_name.Text))
        If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" & " " & group_name.Text Else Me.Text = "IT'S SAVED"

    End Sub

    Private Sub GlassButton75_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton75.Click
        Dim N As String
        N = ""
        If msga = 1 Then
            If lng = "AR" Then N = MsgBox(SAVEAR, MsgBoxStyle.YesNo) Else N = MsgBox(SAVEEN, MsgBoxStyle.YesNo)
            If N = vbNo Then Exit Sub

        End If
        If SPECIMEN.Text = "" Then Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lcultname where name='" & SPECIMEN.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            dr.Close()
            dr.Close() : cmd.CommandText = "insert into lcultname (name)  values ('" & Trim(SPECIMEN.Text) & "')"
            cmd.ExecuteNonQuery()
            dr.Close() : cmd.CommandText = "select * from lcultname "
            adcultname.SelectCommand = cmd
            adcultname.Fill(DBS, "cultname")
            cultname = DBS.Tables("cultname")
            DBS.Tables("cultname").Clear()
            adcultname.Fill(DBS, "cultname")
            cultname = DBS.Tables("cultname")
            SPECIMEN.DataSource = cultname
            SPECIMEN.DisplayMember = "name"
            If msga = 1 Then
                If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" Else Me.Text = "IT'S SAVED"
            End If
            LLOG("Õ›Ÿ ÃœÌœ", 0, "Õ›Ÿ „“—⁄… ÃœÌœ", 1, bran.Text)

        End If
    End Sub

    Private Sub ProToTestToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        group_name.Focus()
    End Sub

    Private Sub TestToolStripMenuItem2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        TextBox3.Focus()
    End Sub



    Private Sub eml_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles eml.MouseHover
        llname = "eml"

    End Sub

    Private Sub eml_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles eml.TextChanged

    End Sub

    Private Sub ComboBox4_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ComboBox4.MouseHover
        llname = "ComboBox4"

    End Sub

    Private Sub ComboBox4_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ComboBox4.SelectedIndexChanged
        pemail.Text = pemail.Text & ComboBox4.Text
    End Sub

    Private Sub GlassButton27_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ40.Click
        'On Error Resume Next
        If esl_no.Text = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·" : Exit Sub
        SAVERES(1, 0)


    End Sub

    Public Sub SAVERES(ByVal ass As Integer, ByVal asR As Integer)
        Try
            Dim aww As String = ""
            If PORV <> "" Then aww = " st=1, "
            'On Error Resume Next
            Dim ali As Integer = 0
            If lres = 0 Then
                ' If lng = "AR" Then msgbox(PERMAR) Else msgbox(PERMEN)
                LLOG(" ”ÃÌ· ‰ ÌÃ…", Val(esl_no.Text), " ”ÃÌ· ‰ ÌÃ… " & pname.Text, 0, bran.Text)
                Exit Sub
            End If
            Dim X As String = ""
            dr1.Close()
            Dim NB As Integer = 0
            If asR = 0 Then
                While Not NB = testres.Rows.Count
                    dr1.Close()
                    If testres.Rows(NB).Item("res") <> testres.Rows(NB).Item("rsv") Or testres.Rows(NB).Item("ds") <> testres.Rows(NB).Item("dsn") Then
                        cmd1.CommandText = "update LBILL_TEST set  usr='" & USR & "',PTHN='" & testres.Rows(NB).Item("PTHN") & "',tsq='" & testres.Rows(NB).Item("tsq") & "'," & aww & " qun='" & testres.Rows(NB).Item("qun") & "',res='" & testres.Rows(NB).Item("RES") & "',ds='" & testres.Rows(NB).Item("ds") & "',ref='" & testres.Rows(NB).Item("ref") & "' where ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & testres.Rows(NB).Item("TEST_CODE") & "'"
                        cmd1.ExecuteNonQuery()
                        If X = "" Then X = testres.Rows(NB).Item("TEST_NAME") & " from " & testres.Rows(NB).Item("rsv") & " TO " & testres.Rows(NB).Item("RES") Else X = X + Environment.NewLine + testres.Rows(NB).Item("TEST_NAME") & " from " & testres.Rows(NB).Item("rsv") & " TO " & testres.Rows(NB).Item("RES")
                        testres.Rows(NB).BeginEdit()
                        testres.Rows(NB).Item("rsv") = testres.Rows(NB).Item("res")
                        testres.Rows(NB).EndEdit()
                        ali = 1
                    ElseIf nulls(testres.Rows(NB).Item("pthn")) <> nulls(testres.Rows(NB).Item("rsvp")) Then
                        cmd1.CommandText = "update LBILL_TEST set  " & aww & " PTHN='" & testres.Rows(NB).Item("PTHN") & "',tsq='" & testres.Rows(NB).Item("tsq") & "'  where ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & testres.Rows(NB).Item("TEST_CODE") & "'"
                        cmd1.ExecuteNonQuery()
                        ali = 1
                    ElseIf nulls(testres.Rows(NB).Item("qun")) <> nulls(testres.Rows(NB).Item("qun1")) Then
                        cmd1.CommandText = "update LBILL_TEST set " & aww & " qun='" & testres.Rows(NB).Item("qun") & "',tsq='" & testres.Rows(NB).Item("tsq") & "'  where ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & testres.Rows(NB).Item("TEST_CODE") & "'"
                        cmd1.ExecuteNonQuery()
                        ali = 1
                    ElseIf testres.Rows(NB).Item("tsq") <> testres.Rows(NB).Item("tsq1") Then
                        cmd1.CommandText = "update LBILL_TEST set  tsq='" & testres.Rows(NB).Item("tsq") & "' where ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & testres.Rows(NB).Item("TEST_CODE") & "'"
                        cmd1.ExecuteNonQuery()
                        ali = 1
                    End If
                    NB = NB + 1
                End While
            End If

            If X <> "" Then LLOG(" ”ÃÌ· ‰ ÌÃ…", esl_no.Text, X, 1, bran.Text)
            Dim aax As String = ""
            NB = 0
            X = ""
            If subres.Rows.Count > 0 Then aax = subres.Rows(NB).Item("mTEST_NAME")

            While Not NB = subres.Rows.Count
                dr1.Close()
                If nulls(subres.Rows(NB).Item("res")) <> nulls(subres.Rows(NB).Item("rsv")) Or nulls(subres.Rows(NB).Item("ds")) <> nulls(subres.Rows(NB).Item("dsn")) Then
                    cmd1.CommandText = "update LBILL_TESTSUB set usr='" & USR & "', PTHN='" & subres.Rows(NB).Item("PTHN") & "' ," & aww & " qun='" & subres.Rows(NB).Item("qun") & "',res='" & subres.Rows(NB).Item("RES") & "',ds='" & subres.Rows(NB).Item("ds") & "',ref='" & subres.Rows(NB).Item("ref") & "',ref1='" & subres.Rows(NB).Item("ref1") & "',res1='" & subres.Rows(NB).Item("res1") & "',absu='" & subres.Rows(NB).Item("absu") & "',res2='" & subres.Rows(NB).Item("res2") & "',ds1='" & subres.Rows(NB).Item("ds1") & "' where ESL_NO='" & subres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & subres.Rows(NB).Item("TEST_CODE") & "' AND MTEST_CODE='" & subres.Rows(NB).Item("MTEST_CODE") & "'"
                    cmd1.ExecuteNonQuery()
                    If X = "" Then X = subres.Rows(NB).Item("mTEST_NAME") : X = X + Environment.NewLine + subres.Rows(NB).Item("TEST_NAME") & " from " & subres.Rows(NB).Item("rsv") & " TO " & subres.Rows(NB).Item("RES") Else X = X + Environment.NewLine + subres.Rows(NB).Item("TEST_NAME") & " from " & subres.Rows(NB).Item("rsv") & " TO " & subres.Rows(NB).Item("RES")
                    subres.Rows(NB).BeginEdit()
                    subres.Rows(NB).Item("st") = 1
                    subres.Rows(NB).Item("rsv") = subres.Rows(NB).Item("res")
                    subres.Rows(NB).Item("rsv1") = Val(subres.Rows(NB).Item("absu"))
                    subres.Rows(NB).EndEdit()
                    ali = 1
                ElseIf nulls(subres.Rows(NB).Item("pthn")) <> nulls(subres.Rows(NB).Item("rsvp")) Then
                    cmd1.CommandText = "update LBILL_TESTSUB set " & aww & " PTHN='" & subres.Rows(NB).Item("PTHN") & "' where ESL_NO='" & subres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & subres.Rows(NB).Item("TEST_CODE") & "' AND MTEST_CODE='" & subres.Rows(NB).Item("MTEST_CODE") & "'"
                    cmd1.ExecuteNonQuery()
                    ali = 1
                ElseIf nulls(subres.Rows(NB).Item("absu")) <> nulls(subres.Rows(NB).Item("rsv1")) Then
                    cmd1.CommandText = "update LBILL_TESTSUB set absu='" & subres.Rows(NB).Item("absu") & "' ," & aww & " ds1='" & subres.Rows(NB).Item("ds1") & "' where ESL_NO='" & subres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & subres.Rows(NB).Item("TEST_CODE") & "' AND MTEST_CODE='" & subres.Rows(NB).Item("MTEST_CODE") & "'"
                    cmd1.ExecuteNonQuery()
                    ali = 1
                ElseIf nulls(subres.Rows(NB).Item("qun")) <> nulls(subres.Rows(NB).Item("qun1")) Then
                    cmd1.CommandText = "update LBILL_TESTSUB set  " & aww & " qun='" & subres.Rows(NB).Item("qun") & "' where ESL_NO='" & subres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & subres.Rows(NB).Item("TEST_CODE") & "' AND MTEST_CODE='" & subres.Rows(NB).Item("MTEST_CODE") & "'"
                    cmd1.ExecuteNonQuery()
                    ali = 1
                ElseIf nulls(subres.Rows(NB).Item("DS")) <> nulls(subres.Rows(NB).Item("RDS")) Then
                    cmd1.CommandText = "update LBILL_TESTSUB set " & aww & " DS='" & subres.Rows(NB).Item("DS") & "' where ESL_NO='" & subres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & subres.Rows(NB).Item("TEST_CODE") & "' AND MTEST_CODE='" & subres.Rows(NB).Item("MTEST_CODE") & "'"
                    cmd1.ExecuteNonQuery()
                    ali = 1
                End If

                aax = subres.Rows(NB).Item("mTEST_NAME")
                NB = NB + 1
            End While
            dr.Close()
            If X <> "" Then LLOG(" ”ÃÌ· ‰ ÌÃ…", esl_no.Text, X, 1, bran.Text)
            If ass = 1 Then
                If cultd.Rows.Count > 0 Then
                    savecult()
                End If
            End If

            If ali = 1 And PORV.Length < 10 Then

                dr.Close()
                cmd.CommandText = " update lbill set st=2 where st=0 and ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
            End If
            If ali = 1 Then
                dr.Close()
                cmd.CommandText = " update lbill set FS=1 where  ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
            End If
            If onl = 1 Then pau()
        Catch ex As Exception
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','save result','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
    Private Sub GlassButton77_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton77.Click
        On Error Resume Next
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandType = CommandType.Text
        dr.Close() : cmd.CommandText = "select * from Lcult order by so"
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        Dim v As Integer = 0
        While Not v = brpd.Columns.Count
            brpd.Columns(v).Visible = False
            v = v + 1
        End While
        brpd.Columns("NAME").Visible = True
        brpd.Columns("shr").Visible = True
        If lng = "AR" Then brpd.Columns("NAME").HeaderText = "«·œÊ«¡" Else brpd.Columns("NAME").HeaderText = "Drug"
        If lng = "AR" Then brpd.Columns("shr").HeaderText = "«·«Œ ’«—" Else brpd.Columns("shr").HeaderText = "short"
        brpd.Columns("NAME").Width = 300
        TabControl2.SelectTab(0)
        tm = 22
    End Sub

    Private Sub ChangeRefDocToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim n As String = ""
        n = MsgBox("are you want to edit code ?", MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        Dim wq As String = 0
        wq = InputBox("enter new code of  " & COMPANY_name.Text)
        dr.Close()
        cmd.CommandText = "update lcompany set code='" & wq & "'  where code='" & COMPANY_CODE.Text & "' and name='" & COMPANY_name.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill set company_code='" & wq & "' where company_code='" & COMPANY_CODE.Text & "' and company_name='" & COMPANY_name.Text & "'"
        cmd.ExecuteNonQuery()
        LLOG(" ⁄œÌ·", 0, " ⁄œÌ· ﬂÊœ «·ÃÂ…" & COMPANY_name.Text, 1, bran.Text)

        Me.Text = "edit done"

    End Sub

    Private Sub GlassButton78_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton78.Click
        If MEDCINE_NAME.Text = "" Then Me.Text = "«ﬂ » "
        Dim N As String
        N = ""
        If msga = 1 Then
            If lng = "AR" Then N = MsgBox(SAVEAR & " " & MEDCINE_NAME.Text, MsgBoxStyle.YesNo) Else N = MsgBox(SAVEEN & " " & MEDCINE_NAME.Text, MsgBoxStyle.YesNo)
            If N = vbNo Then Exit Sub
        End If
        Dim ar As Integer
        dr.Close()
        cmd.CommandText = "select max(so) from lcult "
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            ar = dr(0) + 1
        End If
        dr.Close()
        cmd.CommandText = "select * from lcult where NAME='" & MEDCINE_NAME.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            dr.Close()
            cmd.CommandText = "delete from lcult where NAME='" & MEDCINE_NAME.Text & "'"
            cmd.ExecuteNonQuery()
        End If
        dr.Close() : cmd.CommandText = "insert into lcult  (NAME,shr,so)  values ('" & Trim(MEDCINE_NAME.Text) & "','" & Trim(MSHR.Text) & "','" & ar & "')"
        cmd.ExecuteNonQuery()
        MEDCINE_NAME.AutoCompleteCustomSource.Add(MEDCINE_NAME.Text)
        MSHR.AutoCompleteCustomSource.Add(MSHR.Text)
        If msga = 1 Then
            Me.Text = "it's saved" & " " & MEDCINE_NAME.Text
        End If
        LLOG("Õ›Ÿ ÃœÌœ", 0, "Õ›Ÿ „÷«œ ÃœÌœ", 1, bran.Text)

    End Sub

    Private Sub GlassButton76_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton76.Click
        Dim N As String
        N = ""
        If msga = 1 Then
            If lng = "AR" Then N = MsgBox(SAVEAR, MsgBoxStyle.YesNo) Else N = MsgBox(SAVEEN, MsgBoxStyle.YesNo)
            If N = vbNo Then Exit Sub
        End If
        dr.Close()
        cmd.CommandText = "select * from lGrowth_of where NAME='" & Growth_of.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = False Then
            dr.Close() : cmd.CommandText = "insert into lGrowth_of  (NAME)  values ('" & Trim(Growth_of.Text) & "')"
            cmd.ExecuteNonQuery()
            Growth_of.AutoCompleteCustomSource.Add(Growth_of.Text)
            If msga = 1 Then
                Me.Text = "it's saved"
            End If
            LLOG("Õ›Ÿ ÃœÌœ", 0, "Õ›Ÿ ÃÊ—”", 1, bran.Text)

        End If
    End Sub

    Private Sub FindMobileToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FindMobileToolStripMenuItem.Click
        flng("AR")
        Dim aa As String
        aa = InputBox("«œŒ· —ﬁ„ «· ·Ì›Ê‰ ø")
        SAVERES(0, 0)
        pmobile.Text = aa
        cpmobile.Checked = True
        f3(1)
        cpmobile.Checked = False

    End Sub

    Private Sub FindIdToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FindIdToolStripMenuItem.Click
        flng("AR")
        Dim aa As String
        aa = InputBox("enter id ?")
        SAVERES(0, 0)
        pid.Text = aa
        cpid.Checked = True
        f3(1)
        cpid.Checked = False
    End Sub

    Private Sub GlassButton79_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton79.Click
        Dim n As String

        If msga = 1 Then
            If lng = "AR" Then n = MsgBox(DELAR, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
        End If

        dr.Close()
        cmd.CommandText = "select * from lcult where NAME='" & MEDCINE_NAME.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            dr.Close() : cmd.CommandText = "delete from lcult where NAME='" & MEDCINE_NAME.Text & "'"
            cmd.ExecuteNonQuery()
            MEDCINE_NAME.AutoCompleteCustomSource.Remove(MEDCINE_NAME.Text)
            MSHR.AutoCompleteCustomSource.Remove(MSHR.Text)
            If msga = 1 Then
                Me.Text = "it's deleted"
            End If
            LLOG("Õ–›", 0, "Õ–› «œÊÌ…", 1, bran.Text)

        End If
    End Sub

    Private Sub GlassButton80_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton80.Click
        Dim n As String
        If msga = 1 Then
            If lng = "AR" Then n = MsgBox(DELAR, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
        End If
        dr.Close()
        cmd.CommandText = "select * from lGrowth_of where NAME='" & Growth_of.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = True Then
            dr.Close() : cmd.CommandText = "delete from lGrowth_of where NAME='" & Growth_of.Text & "'"
            cmd.ExecuteNonQuery()
            Growth_of.AutoCompleteCustomSource.Remove(Growth_of.Text)
            If msga = 1 Then
                Me.Text = "it's deleted"
            End If
            LLOG("Õ–›", 0, "Õ–› ÃÊ—”", 1, bran.Text)

        End If
    End Sub

    Private Sub  „«· »·Ì€ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim xx As Integer = 0
        If F31.Rows.Count <= 0 Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·« " : Exit Sub
        dr.Close()
        Dim x As String = ""
        x = MsgBox("Â·  —Ìœ  ”ÃÌ· «‰Â  „  »·Ì€ «· Õ«·Ì· ø", MsgBoxStyle.YesNo)
        If x = vbNo Then Exit Sub

        xx = 0
        While Not xx = F31.Rows.Count
            If F31.Rows(xx).RowState = DataRowState.Deleted Then GoTo mmm
            If nulls(F31.Rows(xx).Item("qun")) = 1 Then
                cmd.CommandText = "update  lbill_test set tblg =1  , tblgusr='" & USR & "', tblgtime='" & ChangeFormat(Now.Date) & "',qun=0 WHERE   qun=1    and esl_no='" & F31.Rows(xx).Item("esl_no") & "'"
                cmd.ExecuteNonQuery()
                F31.Rows(xx).Delete()
            End If
mmm:
            xx = xx + 1
        End While
        LLOG(" ⁄œÌ·", 0, " ”ÃÌ· «‰Â  „ «· ⁄œÌ·", 1, bran.Text)

        Me.Text = " „ «· »·Ì€ "

    End Sub

    Private Sub UpdateRefToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If COMPANY_name.Text = "" Then Exit Sub
        If REG_name.Text = "" Then Exit Sub

        dr.Close()
        cmd.CommandText = "select * from lcompany where name='" & COMPANY_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            dr.Close()
            Dim nn As String
            nn = MsgBox(EDITEN, MsgBoxStyle.YesNo)
            If nn = vbNo Then Exit Sub
            Dim n As String = 0
            If tell.Text = "" Then Me.Text = "«œŒ· —ﬁ„ «·Â« ›"
            dr.Close()
            cmd.CommandText = "update lbill set company_name='" & REG_name.Text & "' where COMPANY_name='" & COMPANY_name.Text & "'"
            cmd.ExecuteNonQuery()

        End If
        LLOG(" ⁄œÌ·", 0, " ⁄œÌ· «·ÃÂ… Ê «·ÿ»Ì» " & REG_name.Text, 1, bran.Text)

    End Sub

    Private Sub PayToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub





    Private Sub NAMToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim n As String
        If lng = "AR" Then n = MsgBox(EDITAR, MsgBoxStyle.YesNo) Else n = MsgBox(EDITEN, MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close()
        ACdr.Close()
        cmd.CommandText = "UPDATE LBILL_TEST SET test_NAME ='" & Trim(test.Text) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LBILL_TESTsub SET mtest_NAME ='" & Trim(test.Text) & "' WHERE MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE Lsubtest SET mtest_NAME ='" & Trim(test.Text) & "' WHERE MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LnsTEST SET mtest_NAME ='" & Trim(test.Text) & "' WHERE MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LsubTEST SET mtest_NAME ='" & Trim(test.Text) & "' WHERE MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE Ltest_price SET test_NAME ='" & Trim(test.Text) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE lntest SET test_NAME ='" & Trim(test.Text) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LTEST SET test_NAME ='" & Trim(test.Text) & "',short ='" & Trim(shrt.Text) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        LLOG(" ⁄œÌ·", 0, " ⁄œÌ· «· Õ·Ì· " & test.Text, 1, bran.Text)

        fprice1(1)
        Me.Text = " „  ⁄„·Ì… «· ⁄œÌ·"
    End Sub

    Private Sub GlassButton81_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ33.Click

        dr.Close()

        ' '' ''cmd.CommandText = "UPDATE LBILL SET QUN=0 WHERE  esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        ' '' ''cmd.ExecuteNonQuery()
        ' '' ''Dim naa As Integer = 0
        ' '' ''While Not naa = F31.Rows.Count
        ' '' ''    RC = F31.Rows(naa)
        ' '' ''    esl_no.Text = nulls(RC("ESL_no"))
        ' '' ''    cmd.CommandText = "UPDATE LBILL SET QUN=9 WHERE  esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' AND ESL_NO='" & esl_no.Text & "' AND BRAN='" & bran.Text & "' AND YEARN='" & YEARN.Text & "'"
        ' '' ''    cmd.ExecuteNonQuery()
        ' '' ''    naa = naa + 1
        ' '' ''End While
        '' ''testres.Rows.Clear()
        '' ''cmdress.CommandType = CommandType.Text
        ' '' '' cmdress.CommandText = "SELECT *  FROM V_LAB WHERE ESL_NO >='" & CODEB.Text & "' AND ESL_NO <='" & CODEE.Text & "' and yearn ='" & YEARN.Text & "' and bran = '" & bran.Text & "' and tdel = 0 order by cult,sub,RSO"
        '' ''cmdress.CommandText = "SELECT *  FROM V_LAB WHERE esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' AND CQUN=9 and yearn ='" & YEARN.Text & "' and bran = '" & bran.Text & "' and tdel = 0 order by cult,sub,RSO"
        '' ''adtestres.SelectCommand = cmdress
        '' ''adtestres.Fill(DBS, "testres")
        '' ''testres = DBS.Tables("testres")
        '' ''Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        '' ''MsgBox(testres.Rows.Count)
        '' ''oj.Load("D:\NPD\HOSBITAL\bin\Debug\techno\resgS.rpt")
        '' ''oj.Database.Tables(0).SetDataSource(testres)
        '' ''oj.SetParameterValue("REF", ref1)
        '' ''oj.SetParameterValue("11", 1)
        '' ''rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        '' ''rp.CrystalReportViewer1.ShowPrintButton = True
        '' ''rp.CrystalReportViewer1.ShowExportButton = True
        '' ''rp.Show()
        ' '' '' '' ''oj.ExportToDisk(CrystalDecisions.[Shared].ExportFormatType.PortableDocFormat, "c:\" & REG_name.Text & ".pdf")
        ' '' ''oj.Load("E:\NPD\HOSBITAL\bin\Debug\techno\resgS1.rpt")
        ' '' ''oj.Database.Tables(0).SetDataSource(testres)
        ' '' ''oj.SetParameterValue("REF", ref1)
        ' '' ''oj.SetParameterValue("11", 0)
        ' '' ''rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        ' '' ''rp.CrystalReportViewer1.ShowPrintButton = True
        ' '' ''rp.CrystalReportViewer1.ShowExportButton = True
        ' '' ''oj.ExportToDisk(CrystalDecisions.[Shared].ExportFormatType.RichText, "c:\" & REG_name.Text & ".DOC")
        ' '' ''Dim n As String
        ' '' ''If lng = "AR" Then n = MsgBox(DELAR, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN, MsgBoxStyle.YesNo)
        ' '' ''If n = vbNo Then Exit Sub

        dr.Close()
        cmd.CommandText = "select * from lcomment where NAME='" & comments.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            dr.Close() : cmd.CommandText = "delete from lcomment where NAME='" & comments.Text & "'"
            cmd.ExecuteNonQuery()
            comments.AutoCompleteCustomSource.Remove(comments.Text)
            Me.Text = "it's deleted"
        End If
    End Sub

    Private Sub PrintNumToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandText = "select * from lbill where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\print.rpt")
        oj.Database.Tables(0).SetDataSource(F31)
        oj.SetParameterValue("118", 1)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
        LLOG("⁄—÷", 0, " ﬁ—Ì— ⁄—÷ ⁄œœ „—«  «·ÿ»«⁄… ", 1, bran.Text)

    End Sub

    Private Sub SPECIMEN_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles SPECIMEN.MouseHover
        llname = "SPECIMEN"
    End Sub

    Private Sub SPECIMEN_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SPECIMEN.SelectedIndexChanged

    End Sub



    Private Sub StartToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim x As String
        x = InputBox("type the code", , "0")
        If x = 0 Then Exit Sub
        dr.Close()
        cmd.CommandText = "update Branch set esl='" & x + 1 & "' where code='" & branch_code.Text & "'"
        cmd.ExecuteNonQuery()
        ACdr.Close()
        ACcmd.CommandText = "update srv set esl='" & x & "' "
        ACcmd.ExecuteNonQuery()
        LLOG(" ⁄œÌ·", 0, " ⁄œÌ· ﬂÊœ «·»œ«Ì… " & x, 1, bran.Text)

        Me.Text = "code changed"
    End Sub

    Private Sub GlassButton6_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq223.Click
        If group_name.Text = "" Then Me.Text = "«Œ «— «·„Ã„Ê⁄…" : Exit Sub
        Dim N As String
        N = MsgBox("Â·  —Ìœ Õ–›ø" & " " & group_name.Text, MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub
        dr.Close()
        dr.Close()
        cmd.CommandText = "delete from lgroup  WHERE  NAME='" & group_name.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from lgroup_test  WHERE  GNAME='" & group_name.Text & "'"
        cmd.ExecuteNonQuery()
        dr1.Close()
        LLOG("Õ–›", 0, "«·„Ã„Ê⁄… " & group_name.Text, 1, bran.Text)

        group_name.Items.Remove(group_name.Text)
        If lng = "AR" Then MsgBox(DELAR) Else MsgBox(DELEN)

    End Sub

    Private Sub TabPage12_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TabPage12.Click

    End Sub

    Private Sub TabPage1_Enter(ByVal sender As Object, ByVal e As System.EventArgs) Handles TabPage1.Enter

    End Sub

    Private Sub TabPage1_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles TabPage1.GotFocus

    End Sub

    Private Sub TabPage5_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles TabPage5.GotFocus
    End Sub

    Private Sub TabPage5_Leave(ByVal sender As Object, ByVal e As System.EventArgs) Handles TabPage5.Leave


    End Sub

    Private Sub TabPage5_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TabPage5.Click

    End Sub

    Private Sub rcv_time_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles rcv_time.KeyUp

    End Sub

    Private Sub rcv_time_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles rcv_time.MouseHover
        llname = "rcv_time"
    End Sub

    Private Sub rcv_time_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles rcv_time.SelectedIndexChanged

    End Sub

    Private Sub GlassButton14_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton14.Click
        If rcv_time.Text = "" Then Me.Text = "Êﬁ  «·«” ·«„" : Exit Sub
        Dim N As String
        N = ""
        If lng = "AR" Then N = MsgBox(SAVEAR & " " & rcv_time.Text, MsgBoxStyle.YesNo) Else N = MsgBox(SAVEEN & " " & rcv_time.Text, MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "select * from ltimer where NAME='" & rcv_time.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = False Then
            dr.Close() : cmd.CommandText = "insert into ltimer  (NAME)  values ('" & Trim(rcv_time.Text) & "')"
            cmd.ExecuteNonQuery()
            rcv_time.Items.Add(Trim(rcv_time.Text))
            Me.Text = "it's saved" & " " & rcv_time.Text
        End If
    End Sub

    Private Sub GlassButton12_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton12.Click
        If rcv_time.Text = "" Then Me.Text = "Êﬁ  «·«” ·«„" : Exit Sub
        Dim n As String
        If lng = "AR" Then n = MsgBox(DELAR & " " & rcv_time.Text, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN & " " & rcv_time.Text, MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub

        dr.Close()
        cmd.CommandText = "select * from ltimer where NAME='" & rcv_time.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = True Then
            dr.Close() : cmd.CommandText = "delete from ltimer where NAME='" & rcv_time.Text & "'"
            cmd.ExecuteNonQuery()
            rcv_time.Items.Remove(rcv_time.Text)
            Me.Text = "it's deleted"
        End If
    End Sub

    Private Sub GlassButton56_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If mng = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("Õ›Ÿ ÃœÌœ", 0, "›—⁄ " & branch_name.Text, 1, bran.Text)
            Exit Sub
        End If
        Dim n As String
        n = ""
        If lng = "AR" Then n = MsgBox(SAVEAR & " " & branch_name.Text, MsgBoxStyle.YesNo) Else n = MsgBox(SAVEEN & " " & branch_name.Text, MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close() : cmd.CommandText = "select MAx(code) from branch "
        dr = cmd.ExecuteReader
        dr.Read()
        branch_code.Text = 1 + nulls(dr(0))
        If branch_name.Text = "" Then Me.Text = "«·—Ã«¡ «· √ﬂœ „‰ «·›—⁄" : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from branch where   name='" & branch_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            If ED = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                Exit Sub
            End If
            n = ""

            If lng = "AR" Then n = MsgBox(EDITAR & " " & branch_name.Text, MsgBoxStyle.YesNo) Else n = MsgBox(EDITEN & " " & branch_name.Text, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
            dr.Close()
            cmd.CommandText = "delete from branch where    name='" & branch_name.Text & "'"
            cmd.ExecuteNonQuery()

        End If
        LLOG("Õ›Ÿ ÃœÌœ", 0, "›—⁄ " & branch_name.Text, 1, bran.Text)

        dr.Close() : cmd.CommandText = "insert into branch (code,name)  values ('" & branch_code.Text & "','" & Trim(branch_name.Text) & "')"
        cmd.ExecuteNonQuery()
        dr.Close() : cmd.CommandText = "select * from branch"
        adbranch.SelectCommand = cmd
        adbranch.Fill(DBS, "branch")
        branch = DBS.Tables("branch")
        DBS.Tables("branch").Clear()
        adbranch.Fill(DBS, "branch")
        branch = DBS.Tables("branch")
        branch_name.DataSource = branch
        branch_name.DisplayMember = "NAME"

    End Sub

    Private Sub GlassButton58_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim n As String
        If mng = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("Õ–›", 0, "›—⁄ " & branch_name.Text, 0, bran.Text)
            Exit Sub
        End If

        If lng = "AR" Then n = MsgBox(DELAR & " " & branch_name.Text, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN & " " & branch_name.Text, MsgBoxStyle.YesNo)
        If IsNumeric(branch_code.Text) = False Then Me.Text = "«·—Ã«¡ «· √ﬂœ „‰ «·ﬂÊœ" : Exit Sub
        If branch_name.Text = "" Then Me.Text = "«·—Ã«¡ «· √ﬂœ „‰ «·›—⁄" : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from branch where   name='" & branch_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            dr.Close()
            cmd.CommandText = "delete from branch where    name='" & branch_name.Text & "'"
            cmd.ExecuteNonQuery()
        End If
        LLOG("Õ–›", 0, "›—⁄ " & branch_name.Text, 1, bran.Text)
        dr.Close() : cmd.CommandText = "select * from branch"
        adbranch.SelectCommand = cmd
        adbranch.Fill(DBS, "branch")
        branch = DBS.Tables("branch")
        DBS.Tables("branch").Clear()
        adbranch.Fill(DBS, "branch")
        branch = DBS.Tables("branch")
        branch_name.DataSource = branch
        branch_name.DisplayMember = "NAME"
    End Sub

    Private Sub kk88_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles kk88.Click

    End Sub

    Private Sub ETEST_CODE_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)

    End Sub

    Private Sub ETEST_CODE_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "ETEST_CODE"

    End Sub

    Private Sub ETEST_CODE_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub ESHR_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)

    End Sub

    Private Sub ESHR_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "ESHR"
    End Sub

    Private Sub ESHR_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub ires_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles ires.KeyUp
        If e.KeyCode = Keys.Enter Then Pus_cells.Focus()
    End Sub

    Private Sub ires_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ires.MouseHover
        llname = "IRES"
    End Sub

    Private Sub ires_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ires.TextChanged

    End Sub

    Private Sub VAIBLE_COUNT_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles VAIBLE_COUNT.KeyUp
        If e.KeyCode = Keys.Enter Then Count_is.Focus()
    End Sub

    Private Sub VAIBLE_COUNT_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles VAIBLE_COUNT.MouseHover
        llname = "VAIBLE_COUNT"

    End Sub

    Private Sub VAIBLE_COUNT_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles VAIBLE_COUNT.TextChanged

    End Sub


    Private Sub FUNCTIONToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FUNCTIONToolStripMenuItem.Click
        NORE(1, 0)
        NORE(2, 0)
        fnor(1)
        fnor(2)
    End Sub

    Private Sub GlassButton82_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq90.Click
        Dim N As String
        N = MsgBox("Â·  —Ìœ Õ–›ø", MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub
        dr.Close()
        dr.Close()
        cmd.CommandText = "delete from lgr  WHERE  NAME='" & GRNAME.Text & "'"
        cmd.ExecuteNonQuery()
        LLOG("Õ–›", 0, "«·„Ã„Ê⁄… " & GRNAME.Text, 1, bran.Text)
        GRNAME.Items.Remove(GRNAME.Text)
    End Sub

    Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
        If ccname = COMPANY_name.Text Then
           
        End If
        Timer1.Stop()
    End Sub

    Private Sub MostComeToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label3.Click

    End Sub

    Private Sub Label3_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label3.MouseHover
        llname = "Label3"
    End Sub

    Private Sub UpdateTestToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton84_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton83_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub DELETETEMPToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        'On Error Resume Next





    End Sub

   

    Private Sub YoutubeToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Process.Start("https://www.youtube.com/user/ASILITEG")

    End Sub

    Private Sub SendEmailToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        GroupBox4.Visible = True
    End Sub

    Private Sub GlassButton89_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton89.Click
        Dim rrr As Process = Process.Start(Application.StartupPath & "\bar.exe")
        semail("asiliteg@gmail.com", s11.Text, s12.Text, 0, 1)
        rrr.Kill()
        If emlprg = 1 Then MessageBox.Show(" success send  to ", "  Successful?", MessageBoxButtons.OK, MessageBoxIcon.Information)

        GroupBox4.Visible = False
    End Sub

    Private Sub GlassButton67_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub ChangeNameToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ChangeNameToolStripMenuItem.Click
        CHANGENAME()

    End Sub
    Public Sub CHANGENAME()
        Dim n As String = InputBox("enter password", , "0")
        If Val(n) <> 6666 Then Exit Sub
        Dim m As String = MsgBox("are you want to edit ?", MsgBoxStyle.YesNo)

        If m = vbNo Then Exit Sub
        flng("en")
        Dim sen As String = InputBox("enter new name en ")
        flng("ar")
        Dim sar As String = InputBox("«œŒ· «·«”„ »«·⁄—»Ï ")
        If sar = "" Then sar = "-"
        If sen = "" Then sen = "-"
        dr.Close()
        cmd.CommandText = "update iface set en='" & sen & "',ar='" & sar & "' where name='" & llname & "' "
        cmd.ExecuteNonQuery()
        Me.Text = "it's saved"
        cmdifc.Connection = CN
        cmdifc.CommandType = CommandType.Text
        cmdifc.CommandText = "select * from iface"
        adifc.SelectCommand = cmdifc
        adifc.Fill(DBS, "ifc")
        ifc = DBS.Tables("ifc")
        DBS.Tables("ifc").Clear()
        adifc.Fill(DBS, "ifc")
        ifc = DBS.Tables("ifc")
        ifaceb(Me)

    End Sub

    Private Sub GlassButton84_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton84"

    End Sub

    Private Sub GlassButton83_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton83"

    End Sub

    Private Sub Label1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label1.Click

    End Sub

    Private Sub Label1_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label1.MouseHover
        llname = "Label1"

    End Sub

    Private Sub Label17_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label17.Click


        'dr.Close()
        'cmd.CommandText = "select sum(test_price),sum(labprice) from lbill_test where lab=1 and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        'dr = cmd.ExecuteReader
        'While dr.Read
        '    MsgBox("test total :- " & dr(0) & " =====  lab total :- " & dr(1))
        'End While



        dr.Close()
        cmd.CommandText = "select sum(tot1) from v_esl where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            MsgBox("test total :- " & dr(0) & " ")
        End While
        dr.Close()
        cmd.CommandText = "select sum(diss) from lbill where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            MsgBox("diss total :- " & dr(0) & " ")
        End While

    End Sub

    Private Sub Label17_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label17.MouseHover
        llname = "Label17"

    End Sub

    Private Sub Label4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label4_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label4"

    End Sub

    Private Sub Label2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label2.Click

    End Sub

    Private Sub Label2_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label2.MouseHover
        llname = "Label2"

    End Sub

    Private Sub Label31_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label31.Click

    End Sub

    Private Sub Label31_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label31.MouseHover
        llname = "Label31"

    End Sub

    Private Sub Label27_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label27.Click

    End Sub

    Private Sub Label27_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label27.MouseHover
        llname = "Label27"

    End Sub

    Private Sub GlassButton65_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton65"

    End Sub

    Private Sub GlassButton67_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton67"

    End Sub

    Private Sub GlassButton48_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton48.MouseHover
        llname = "GlassButton48"

    End Sub

    Private Sub Label76_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label76_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label76"

    End Sub

    Private Sub GlassButton66_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton66"

    End Sub

    Private Sub GlassButton25_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton25"

    End Sub

    Private Sub GlassButton18_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton18"

    End Sub

    Private Sub GlassButton26_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton26.MouseHover
        llname = "GlassButton26"

    End Sub

    Private Sub GlassButton13_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton13.MouseHover
        llname = "GlassButton13"

    End Sub

    Private Sub GlassButton15_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton15"

    End Sub

    Private Sub GlassButton16_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton16"

    End Sub

    Private Sub Label28_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label28.Click

    End Sub

    Private Sub Label28_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label28.MouseHover
        llname = "Label28"

    End Sub

    Private Sub Label65_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label65.Click

    End Sub

    Private Sub Label65_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label65.MouseHover
        llname = "Label65"

    End Sub

    Private Sub Label6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label6.Click

    End Sub

    Private Sub Label6_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label6.MouseHover
        llname = "Label6"

    End Sub

    Private Sub Label14_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label14_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label14"

    End Sub

    Private Sub Label15_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label15.Click

    End Sub

    Private Sub Label15_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label15.MouseHover
        llname = "Label15"
    End Sub

    Private Sub Label7_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label7.Click

    End Sub

    Private Sub Label7_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label7.MouseHover
        llname = "Label7"

    End Sub

    Private Sub Label32_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label32.Click

    End Sub

    Private Sub Label32_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label32.MouseHover
        llname = "Label32"

    End Sub

    Private Sub Label36_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label36.Click

    End Sub

    Private Sub Label36_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label36.MouseHover
        llname = "Label36"

    End Sub

    Private Sub Label21_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label21.Click

    End Sub

    Private Sub Label21_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label21.MouseHover
        llname = "Label21"

    End Sub

    Private Sub Label16_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label16.Click

    End Sub

    Private Sub Label16_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label16.MouseHover
        llname = "Label16"

    End Sub

    Private Sub Label8_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label8.Click

    End Sub

    Private Sub Label8_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label8.MouseHover
        llname = "Label8"

    End Sub

    Private Sub Label64_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq21.Click


    End Sub

    Private Sub Label64_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq21.MouseHover
        llname = "Label64"
    End Sub

    Private Sub Label63_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label63_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label63"
    End Sub

    Private Sub Label9_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label9.Click
        MsgBox(PAY.Text * 2)
    End Sub

    Private Sub Label9_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label9.MouseHover
        llname = "Label9"
    End Sub

    Private Sub Label10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label10.Click

    End Sub

    Private Sub Label10_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label10.MouseHover
        llname = "Label10"
    End Sub

    Private Sub Label33_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label33.Click

    End Sub

    Private Sub Label33_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label33.MouseHover
        llname = "Label33"
    End Sub

    Private Sub Label34_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label34.Click
        Dim W As Integer = Convert.ToInt32("150")
        Dim H As Integer = Convert.ToInt32("37")
        bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
        Dim type As BarcodeLib.TYPE = BarcodeLib.TYPE.UNSPECIFIED
        type = BarcodeLib.TYPE.CODE128
        bar1.IncludeLabel = True
        If bran.Text = "0" Then barco.Image = bar1.Encode(type, Me.esl_no.Text.Trim(), W, H) Else barco.Image = bar1.Encode(type, Me.bran.Text + Me.esl_no.Text.Trim(), W, H)
    End Sub

    Private Sub Label34_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label34.MouseHover
        llname = "Label34"

    End Sub

    Private Sub Label5_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label5.Click

    End Sub

    Private Sub Label5_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label5.MouseHover
        llname = "Label5"
    End Sub

    Private Sub Label52_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label52_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label52"
    End Sub

    Private Sub chrcv_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles chrcv.MouseHover
        llname = "chrcv"
    End Sub

    Private Sub Label41_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label41.Click

    End Sub

    Private Sub Label41_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label41.MouseHover
        llname = "Label41"
    End Sub

    Private Sub Label77_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label77.Click

    End Sub

    Private Sub Label77_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label77.MouseHover
        llname = "Label77"
    End Sub


    Private Sub Label88_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label88.MouseHover
        llname = "Label88"
    End Sub

    Private Sub Label87_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label87.MouseHover
        llname = "Label87"
    End Sub


    Private Sub Label89_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label89.MouseHover
        llname = "Label89"
    End Sub



    Private Sub Label35_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq92.MouseHover
        llname = "Label35"
    End Sub

    Private Sub Label11_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq222.Click

    End Sub

    Private Sub Label11_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq222.MouseHover
        llname = "Label11"
    End Sub

    Private Sub Label62_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles LB12.Click
        '' ''Dim fs As IO.FileStream '= New IO.FileStream(filePath, IO.FileMode.Open, IO.FileAccess.Read)
        '' ''Dim br As IO.BinaryReader '= New IO.BinaryReader(fs)
        '' ''Dim bytes As Byte() '= br.ReadBytes(Convert.ToInt32(fs.Length))
        'br.Close()
        'fs.Close()
        'dr.Close()
        'cmd.CommandText = "insert into lbill_docs(docs, docsp,esl_no,yearn,bran) values (?, ?,'" & Val(esl_no.Text) & "','" & esl_date.Value.Year & "' ,'" & bran.Text & "')"
        'cmd.Parameters.Clear()
        'cmd.Parameters.Add("@docs", SqlDbType.Binary).Value = bytes
        'cmd.Parameters.Add("@docsp", SqlDbType.VarChar).Value = filename
        'cmd.ExecuteNonQuery()
        ''======================================



    End Sub

    Private Sub Label62_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles LB12.MouseHover
        llname = "Label62"
    End Sub

    Private Sub Label13_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label13.Click

    End Sub

    Private Sub Label13_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label13.MouseHover
        llname = "Label13"
    End Sub

    Private Sub Label61_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label61_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label61"
    End Sub

    Private Sub Label12_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label12_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label12"
    End Sub

    Private Sub GlassButton73_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq91.MouseHover
        llname = "GlassButton73"
    End Sub

    Private Sub GlassButton82_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq90.MouseHover
        llname = "GlassButton82"
    End Sub

    Private Sub GlassButton6_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq223.MouseHover
        llname = "GlassButton6"

    End Sub

    Private Sub GlassButton74_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq221.MouseHover
        llname = "GlassButton74"

    End Sub

    Private Sub GlassButton34_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq74.MouseHover
        llname = "GlassButton34"

    End Sub

    Private Sub GlassButton35_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq73.MouseHover
        llname = "GlassButton35"

    End Sub

    Private Sub GlassButton36_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq72.MouseHover
        llname = "GlassButton36"

    End Sub

    Private Sub GlassButton60_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton60.MouseHover
        llname = "GlassButton60"

    End Sub

    Private Sub GlassButton63_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton63.MouseHover
        llname = "GlassButton63"

    End Sub

    Private Sub GlassButton59_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton59.MouseHover
        llname = "GlassButton59"

    End Sub

    Private Sub CSUB_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CSUB.CheckedChanged
    End Sub

    Private Sub CSUB_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles CSUB.MouseHover
        llname = "csub"

    End Sub

    Private Sub CRES_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CRES.CheckedChanged

    End Sub

    Private Sub CRES_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles CRES.MouseHover
        llname = "cres"

    End Sub

    Private Sub GROP_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GROP.CheckedChanged

    End Sub

    Private Sub GROP_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GROP.MouseHover
        llname = "grop"

    End Sub

    Private Sub PANEL_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PANEL.CheckedChanged

    End Sub

    Private Sub PANEL_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles PANEL.MouseHover
        llname = "panel"

    End Sub

    Private Sub SEP_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SEP.CheckedChanged

    End Sub

    Private Sub SEP_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles SEP.MouseHover
        llname = "SEP"

    End Sub

    Private Sub GlassButton29_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles QQ30.MouseHover
        llname = "GlassButton29"

    End Sub


    Private Sub GlassButton50_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles QQ35.MouseHover
        llname = "GlassButton50"

    End Sub

    Private Sub GlassButton81_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles QQ33.MouseHover
        llname = "GlassButton81"

    End Sub

    Private Sub Label47_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq127.Click

    End Sub

    Private Sub Label47_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq127.MouseHover
        llname = "Label47"

    End Sub

    Private Sub GlassButton68_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton68.MouseHover
        llname = "GlassButton68"

    End Sub

    Private Sub GlassButton69_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton69.MouseHover
        llname = "GlassButton69"

    End Sub

    Private Sub GlassButton2_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles QQ45.MouseHover
        llname = "GlassButton2"

    End Sub

    Private Sub GlassButton47_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles QQ37.MouseHover
        llname = "GlassButton47"
    End Sub



    Private Sub rres_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "rres"

    End Sub


    Private Sub GlassButton51_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton51.MouseHover
        llname = "GlassButton51"

    End Sub

    Private Sub GlassButton23_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton23.MouseHover
        llname = "GlassButton23"

    End Sub

    Private Sub GlassButton22_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton22.MouseHover
        llname = "GlassButton22"

    End Sub

    Private Sub GlassButton7_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq80.MouseHover
        llname = "GlassButton7"

    End Sub

    Private Sub GlassButton28_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton28"

    End Sub

    Private Sub GlassButton44_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton44"

    End Sub

    Private Sub Label66_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label66_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "label66"

    End Sub

    Private Sub GlassButton30_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton30"

    End Sub

    Private Sub GlassButton52_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton52"

    End Sub

    Private Sub GlassButton45_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton45"

    End Sub

    Private Sub Label67_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label67_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label67"

    End Sub

    Private Sub GlassButton64_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles QQ41.MouseHover
        llname = "GlassButton64"

    End Sub

    Private Sub GlassButton57_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq60.MouseHover
        llname = "GlassButton57"

    End Sub

    Private Sub Label98_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label98_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label98"

    End Sub

    Private Sub GlassButton70_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq47.MouseHover
        llname = "GlassButton70"

    End Sub

    Private Sub GlassButton71_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq49.MouseHover
        llname = "GlassButton71"

    End Sub

    Private Sub GlassButton49_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton49"

    End Sub

    Private Sub GlassButton4_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton4"

    End Sub

    Private Sub GlassButton3_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton3"

    End Sub

    Private Sub Label70_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label70_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label70"

    End Sub

    Private Sub Label69_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label69_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label69"

    End Sub

    Private Sub Label48_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label48_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label48"

    End Sub

    Private Sub Label71_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label71_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label71"

    End Sub

    Private Sub Label72_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label72_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label72"

    End Sub

    Private Sub Label73_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label73_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label73"

    End Sub

    Private Sub Label75_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label75.Click

    End Sub

    Private Sub Label75_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label75.MouseHover
        llname = "Label75"

    End Sub

    Private Sub Label74_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label74.Click

    End Sub

    Private Sub Label74_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label74.MouseHover
        llname = "Label74"

    End Sub

    Private Sub Label101_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label101.Click

    End Sub

    Private Sub Label101_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label101.MouseHover
        llname = "Label101"

    End Sub

    Private Sub Label80_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ122.Click

    End Sub

    Private Sub Label80_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles QQ122.MouseHover
        llname = "Label80"

    End Sub

    Private Sub cult_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cult.CheckedChanged

    End Sub

    Private Sub cult_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cult.MouseHover
        llname = "cult"

    End Sub

    Private Sub Label38_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label38_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label38"

    End Sub

    Private Sub Label39_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label39_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label39"

    End Sub

    Private Sub GlassButton19_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton19"

    End Sub

    Private Sub GlassButton24_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton24"

    End Sub

    Private Sub GlassButton21_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton21"

    End Sub

    Private Sub GlassButton20_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton20"

    End Sub

    Private Sub GlassButton27_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles QQ40.MouseHover
        llname = "GlassButton27"

    End Sub

    Private Sub GlassButton72_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles DDK.MouseHover
        llname = "GlassButton72"

    End Sub

    Private Sub Label83_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label83.MouseHover
        llname = "Label83"

    End Sub

    Private Sub Label81_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label81.Click

    End Sub

    Private Sub Label81_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label81.MouseHover
        llname = "Label81"
    End Sub

    Private Sub CheckBox11_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox11.CheckedChanged

    End Sub

    Private Sub CheckBox11_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles CheckBox11.MouseHover
        llname = "CheckBox11"

    End Sub

    Private Sub CheckBox12_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CBRAN.CheckedChanged

    End Sub

    Private Sub CheckBox12_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles CBRAN.MouseHover
        llname = "CheckBox12"

    End Sub

    Private Sub PR_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub PR_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "pr"

    End Sub

    Private Sub PV_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub PV_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "pv"

    End Sub

    Private Sub nall_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub nall_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "nall"

    End Sub

    Private Sub nno_CheckedChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub nno_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "nno"

    End Sub

    Private Sub nyes_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub nyes_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "nyes"

    End Sub

    Private Sub fghhhf_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles fghhhf.Click

    End Sub

    Private Sub fghhhf_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles fghhhf.MouseHover
        llname = "fghhhf"

    End Sub

    Private Sub ghgh_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ghgh.Click

    End Sub

    Private Sub ghgh_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ghgh.MouseHover
        llname = "ghgh"
    End Sub

    Private Sub Label46_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label46.Click

    End Sub

    Private Sub Label46_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label46.MouseHover
        llname = "Label46"

    End Sub

    Private Sub RadioButton1_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RadioButton1.CheckedChanged

    End Sub

    Private Sub RadioButton1_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles RadioButton1.MouseHover
        llname = "RadioButton1"
    End Sub

    Private Sub RadioButton3_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RadioButton3.CheckedChanged

    End Sub

    Private Sub RadioButton3_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles RadioButton3.MouseHover
        llname = "RadioButton3"

    End Sub

    Private Sub RadioButton2_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RadioButton2.CheckedChanged

    End Sub

    Private Sub RadioButton2_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles RadioButton2.MouseHover
        llname = "RadioButton2"

    End Sub

    Private Sub Label79_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label79.Click

    End Sub

    Private Sub Label79_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label79.MouseHover
        llname = "Label79"

    End Sub

    Private Sub Label78_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label78.Click

    End Sub

    Private Sub Label78_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label78.MouseHover
        llname = "Label78"
    End Sub

    Private Sub GlassButton138_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton138_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton138"

    End Sub

    Private Sub GlassButton137_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton137_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton137"

    End Sub

    Private Sub «·«Œ ’«—_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles «·«Œ ’«—.Click

    End Sub

    Private Sub «·«Œ ’«—_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles «·«Œ ’«—.MouseHover
        llname = "«·«Œ ’«—"

    End Sub

    Private Sub «·œÊ«¡_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles «·œÊ«¡.Click

    End Sub

    Private Sub «·œÊ«¡_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles «·œÊ«¡.MouseHover
        llname = "«·œÊ«¡"

    End Sub

    Private Sub ContextMenuStrip1_Opening(ByVal sender As System.Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles ContextMenuStrip1.Opening

    End Sub

    Private Sub GlassButton78_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton78.MouseHover
        llname = "GlassButton78"

    End Sub

    Private Sub GlassButton79_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton79.MouseHover
        llname = "GlassButton79"

    End Sub

    Private Sub GlassButton11_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton11.MouseHover
        llname = "GlassButton11"

    End Sub

    Private Sub GlassButton10_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton10.MouseHover
        llname = "GlassButton10"

    End Sub

    Private Sub GlassButton9_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton9.MouseHover
        llname = "GlassButton9"

    End Sub

    Private Sub GlassButton75_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton75.MouseHover
        llname = "GlassButton75"

    End Sub

    Private Sub GlassButton61_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton61.MouseHover
        llname = "GlassButton61"

    End Sub

    Private Sub GlassButton77_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton77.MouseHover
        llname = "GlassButton77"

    End Sub

    Private Sub GlassButton62_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq130.MouseHover
        llname = "GlassButton62"

    End Sub

    Private Sub GlassButton76_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton76.MouseHover
        llname = "GlassButton76"

    End Sub

    Private Sub GlassButton80_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton80.MouseHover
        llname = "GlassButton80"

    End Sub

    Private Sub Label45_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label45.Click

    End Sub

    Private Sub Label45_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label45.MouseHover
        llname = "Label45"

    End Sub

    Private Sub Label40_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label40.Click

    End Sub

    Private Sub Label40_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label40.MouseHover
        llname = "Label40"

    End Sub

    Private Sub Label53_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label53.Click

    End Sub

    Private Sub Label53_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label53.MouseHover
        llname = "Label53"

    End Sub

    Private Sub Label54_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label54.Click

    End Sub

    Private Sub Label54_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label54.MouseHover
        llname = "Label54"

    End Sub

    Private Sub Label56_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label56.Click

    End Sub

    Private Sub Label56_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label56.MouseHover
        llname = "Label56"

    End Sub

    Private Sub Label57_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label57.Click

    End Sub

    Private Sub Label57_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label57.MouseHover
        llname = "Label57"

    End Sub

    Private Sub Label58_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label58.Click

    End Sub

    Private Sub Label58_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label58.MouseHover
        llname = "Label58"

    End Sub

    Private Sub Label59_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label59.Click

    End Sub

    Private Sub Label59_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label59.MouseHover
        llname = "Label59"

    End Sub

    Private Sub Label55_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label55.Click

    End Sub

    Private Sub Label55_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label55.MouseHover
        llname = "Label55"

    End Sub

    Private Sub Label60_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label60.Click

    End Sub

    Private Sub Label60_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label60.MouseHover
        llname = "Label60"

    End Sub

    Private Sub jukhkhhjmmbn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles jukhkhhjmmbn.Click

    End Sub

    Private Sub jukhkhhjmmbn_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles jukhkhhjmmbn.MouseHover
        llname = "jukhkhhjmmbn"

    End Sub

    Private Sub GlassButton33_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GL20.MouseHover
        llname = "GlassButton33"

    End Sub

    Private Sub GlassButton32_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GL21.MouseHover
        llname = "GlassButton32"

    End Sub

    Private Sub GlassButton31_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GL22.MouseHover
        llname = "GlassButton31"

    End Sub

    Private Sub GlassButton39_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GL24.MouseHover
        llname = "GlassButton39"

    End Sub

    Private Sub GlassButton38_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GL30.MouseHover
        llname = "GlassButton38"

    End Sub

    Private Sub GlassButton37_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GL32.MouseHover
        llname = "GlassButton37"

    End Sub


    Private Sub GlassButton42_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton42"

    End Sub

    Private Sub GlassButton43_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GL33.MouseHover
        llname = "GlassButton43"

    End Sub

    Private Sub Label90_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label90.Click

    End Sub

    Private Sub Label90_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label90.MouseHover
        llname = "Label90"

    End Sub

    Private Sub Label91_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles q142.MouseHover
        llname = "Label91"

    End Sub

    Private Sub flg_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles flg.CheckedChanged

    End Sub

    Private Sub flg_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles flg.MouseHover
        llname = "flg"

    End Sub

    Private Sub Label96_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label96.Click

    End Sub

    Private Sub Label96_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label96.MouseHover
        llname = "Label96"

    End Sub

    Private Sub Label95_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label95.Click

    End Sub

    Private Sub Label95_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label95.MouseHover
        llname = "Label95"

    End Sub

    Private Sub Label94_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label94.Click

    End Sub

    Private Sub Label94_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label94.MouseHover
        llname = "Label94"

    End Sub

    Private Sub Label93_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label93.Click

    End Sub

    Private Sub Label93_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label93.MouseHover
        llname = "Label93"

    End Sub

    Private Sub Label92_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label92.Click

    End Sub

    Private Sub Label92_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Label92.MouseHover
        llname = "Label92"

    End Sub

    Private Sub Label97_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq143.Click

    End Sub

    Private Sub Label97_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq143.MouseHover
        llname = "Label97"

    End Sub



    Private Sub FindToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles FindToolStripMenuItem.MouseHover
        llname = "FindToolStripMenuItem"
        llnamear = FindToolStripMenuItem.Text
    End Sub

    Private Sub FindNameToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles FindNameToolStripMenuItem.MouseHover
        llname = "FindNameToolStripMenuItem"
        llnamear = FindNameToolStripMenuItem.Text
    End Sub



    Private Sub FindIdToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles FindIdToolStripMenuItem.MouseHover
        llname = "FindIdToolStripMenuItem"
        llnamear = FindIdToolStripMenuItem.Text

    End Sub

    Private Sub FindMobileToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles FindMobileToolStripMenuItem.MouseHover
        llname = "FindMobileToolStripMenuItem"
        llnamear = FindMobileToolStripMenuItem.Text

    End Sub

    Private Sub PervToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles PervToolStripMenuItem.MouseHover
        llname = "PervToolStripMenuItem"
        llnamear = PervToolStripMenuItem.Text

    End Sub

    Private Sub NextToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles NextToolStripMenuItem.MouseHover
        llname = "NextToolStripMenuItem"
        llnamear = NextToolStripMenuItem.Text

    End Sub



    Private Sub RefindToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles RefindToolStripMenuItem.MouseHover
        llname = "RefindToolStripMenuItem"
        llnamear = RefindToolStripMenuItem.Text

    End Sub

    Private Sub NOTSEToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles NOTSEToolStripMenuItem.MouseHover
        llname = "NOTSEToolStripMenuItem"
        llnamear = NOTSEToolStripMenuItem.Text

    End Sub

    Private Sub TestpriceToolStripMenuItem1_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles TestpriceToolStripMenuItem1.MouseHover
        llname = "TestpriceToolStripMenuItem1"
        llnamear = TestpriceToolStripMenuItem1.Text

    End Sub




    Private Sub FUNCTIONToolStripMenuItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles FUNCTIONToolStripMenuItem.MouseHover
        llname = "FUNCTIONToolStripMenuItem"
        llnamear = FUNCTIONToolStripMenuItem.Text

    End Sub

    Private Sub HideItemToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles HideItemToolStripMenuItem.Click
        Dim n As String = InputBox("enter password", , "0")
        If n <> 6666 Then Exit Sub

        dr.Close()
        cmd.CommandText = "update iface set hide=1 where name='" & llname & "' "
        cmd.ExecuteNonQuery()
        Me.Text = "it's HIDE"
        cmdifc.Connection = CN
        cmdifc.CommandType = CommandType.Text
        cmdifc.CommandText = "select * from iface"
        adifc.SelectCommand = cmdifc
        adifc.Fill(DBS, "ifc")
        ifc = DBS.Tables("ifc")
        DBS.Tables("ifc").Clear()
        adifc.Fill(DBS, "ifc")
        ifc = DBS.Tables("ifc")
        ifaceb(Me)
    End Sub

    Private Sub CHANGENAMEToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CHANGENAMEToolStripMenuItem1.Click
        CHANGENAME()

    End Sub

    Private Sub ress_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles ress.DropDown

    End Sub
    Public Sub LRESS()
        ress.Visible = True
        ress.Text = ""
        ress.Items.Clear()
        dr.Close()
        cmd.CommandText = "select * from lress where test_name='" & Ntest_NAME.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            ress.Items.Add(dr("res"))
        End While
    End Sub

    Private Sub ress_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles ress.KeyDown
        If e.KeyCode = Keys.Escape Then
            ress.Visible = False
        End If
        Dim n As String
        If e.KeyCode = Keys.Enter Then

            If Trim(ress.Text) = "" Then Exit Sub
            dr.Close()
            cmd.CommandText = "select * from lress where test_NAME='" & Ntest_NAME.Text & "' and res='" & ress.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = False Then
                If msga = 1 Then
                    If lng = "AR" Then n = MsgBox(SAVEAR & " " & Ntest_NAME.Text, MsgBoxStyle.YesNo) Else n = MsgBox(SAVEEN & " " & Ntest_NAME.Text, MsgBoxStyle.YesNo)
                    If n = vbNo Then Exit Sub
                End If
                If Trim(ress.Text) = "" Then Exit Sub
                dr.Close() : cmd.CommandText = "insert into lress  (test_NAME,res)  values ('" & Ntest_NAME.Text & "','" & ress.Text & "')"
                cmd.ExecuteNonQuery()
                If msga = 1 Then
                    Me.Text = "it's saved" & " " & Ntest_NAME.Text
                End If
            End If

        End If
        If e.KeyCode = Keys.Delete Then
            dr.Close()
            cmd.CommandText = "select * from lress where test_NAME='" & Ntest_NAME.Text & "' and res='" & ress.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then
                If msga = 1 Then
                    If lng = "AR" Then n = MsgBox(DELAR & " " & Ntest_NAME.Text, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN & " " & Ntest_NAME.Text, MsgBoxStyle.YesNo)
                    If n = vbNo Then Exit Sub
                End If
                dr.Close()
                cmd.CommandText = "delete from lress where test_NAME='" & Ntest_NAME.Text & "' and res='" & ress.Text & "'"
                cmd.ExecuteNonQuery()
                If msga = 1 Then
                    Me.Text = "it's deleted" & " " & Ntest_NAME.Text
                End If
            End If
        End If
    End Sub

    Private Sub ress_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles ress.LostFocus
        ress.Visible = False
    End Sub
    Private Sub ress_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ress.SelectedIndexChanged
        'On Error Resume Next
        If TextBox4.Text = 1 Then
            FRC = testres.Select("TEST_NAME='" & ppp.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("RES") = ress.Text
                RC.EndEdit()
            End If

        Else
            FRC = subres.Select("TEST_NAME='" & ppp.Text & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                RC.BeginEdit()
                RC("RES") = ress.Text
                RC.EndEdit()
            End If
        End If
        ress.Text = ""
    End Sub


    Private Sub GlassButton85_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

        If Ntest_NAME.Text = "" Then Exit Sub
        Dim N, t As String
        N = ""
        t = InputBox("enter the res")
        If t = "" Then Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lress where test_NAME='" & Ntest_NAME.Text & "' and res='" & t & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            If msga = 1 Then
                If lng = "AR" Then N = MsgBox(SAVEAR & " " & Ntest_NAME.Text, MsgBoxStyle.YesNo) Else N = MsgBox(SAVEEN & " " & Ntest_NAME.Text, MsgBoxStyle.YesNo)
                If N = vbNo Then Exit Sub
            End If
            dr.Close() : cmd.CommandText = "insert into lress  (test_NAME,res)  values ('" & Ntest_NAME.Text & "','" & t & "')"
            cmd.ExecuteNonQuery()
            If msga = 1 Then
                Me.Text = "it's saved" & " " & Ntest_NAME.Text
            End If
        End If


    End Sub

    Private Sub GlassButton86_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If Ntest_NAME.Text = "" Then Exit Sub
        Dim N, t As String
        N = ""
        t = InputBox("enter the res")
        If t = "" Then Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lress where test_NAME='" & Ntest_NAME.Text & "' and res='" & t & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            If msga = 1 Then
                If lng = "AR" Then N = MsgBox(DELAR & " " & Ntest_NAME.Text, MsgBoxStyle.YesNo) Else N = MsgBox(DELEN & " " & Ntest_NAME.Text, MsgBoxStyle.YesNo)
                If N = vbNo Then Exit Sub
            End If
            dr.Close()
            cmd.CommandText = "delete from lress where test_NAME='" & Ntest_NAME.Text & "' and res='" & t & "'"
            cmd.ExecuteNonQuery()
            If msga = 1 Then
                Me.Text = "it's deleted" & " " & Ntest_NAME.Text
            End If
        End If
    End Sub

    Private Sub GlassButton14_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton14.MouseHover
        llname = "GlassButton14"

    End Sub

    Private Sub GlassButton12_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton12.MouseHover
        llname = "GlassButton12"

    End Sub

    Private Sub GlassButton17_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton17.MouseHover
        llname = "GlassButton17"

    End Sub

    Private Sub GlassButton85_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton85"

    End Sub

    Private Sub GlassButton86_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton86"

    End Sub

    Private Sub Label100_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        'SaveFileDialog1.ShowDialog()

    End Sub

    Private Sub Label100_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label100"

    End Sub

    Private Sub kk88_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles kk88.MouseHover
        llname = "KK88"

    End Sub

    Private Sub GlassButton56_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton56"

    End Sub

    Private Sub GlassButton55_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton55"

    End Sub

    Private Sub GlassButton58_MouseDown(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs)

    End Sub

    Private Sub GlassButton58_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton58"

    End Sub

    Private Sub Label85_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label85_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "Label85"

    End Sub

    Private Sub cptype_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cptype.CheckedChanged

    End Sub

    Private Sub cptype_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cptype.MouseHover
        llname = "cptype"

    End Sub

    Private Sub cpnik_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cpnik.CheckedChanged

    End Sub

    Private Sub cpnik_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cpnik.MouseHover
        llname = "cpnik"

    End Sub

    Private Sub cpcode_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cpcode.CheckedChanged

    End Sub

    Private Sub cpcode_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cpcode.MouseHover
        llname = "cpcode"

    End Sub

    Private Sub cpbrith_date_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cpbrith_date.CheckedChanged

    End Sub

    Private Sub cpbrith_date_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cpbrith_date.MouseHover
        llname = "cpbrith_date"
    End Sub

    Private Sub cpage_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cpage.CheckedChanged

    End Sub

    Private Sub cpage_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cpage.MouseHover
        llname = "cpage"

    End Sub

    Private Sub cpemail_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cpemail.CheckedChanged

    End Sub

    Private Sub cpemail_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cpemail.MouseHover
        llname = "cpemail"
    End Sub

    Private Sub cpmobile_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cpmobile.CheckedChanged

    End Sub

    Private Sub cpmobile_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cpmobile.MouseHover
        llname = "cpmobile"
    End Sub

    Private Sub ptype_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles ptype.GotFocus
        colu(Me, Val(bcolor), Val(fcolor))
        'DOC_name.BackColor = Color.Silver
        ptype.BackColor = Color.FromArgb(backcolor1)
        sotr(2, "ptype")
    End Sub

    Private Sub ptype_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles ptype.KeyDown
        If e.KeyCode = Keys.Enter Then sotr(1, "")
        If e.KeyCode = Keys.Left Then sotr(-1, "")

    End Sub

    Private Sub ptype_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ptype.MouseHover
        llname = "ptype"

    End Sub

    Private Sub ptype_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ptype.SelectedIndexChanged

    End Sub

    Private Sub cpgover_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cpgover.CheckedChanged

    End Sub

    Private Sub cpgover_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cpgover.MouseHover
        llname = "cpgover"

    End Sub

    Private Sub CheckBox9_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox9.CheckedChanged

    End Sub

    Private Sub CheckBox9_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles CheckBox9.MouseHover
        llname = "CheckBox9"

    End Sub

    Private Sub cdoc_code_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cdoc_code.CheckedChanged

    End Sub

    Private Sub cdoc_code_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cdoc_code.MouseHover
        llname = "cdoc_code"

    End Sub

    Private Sub cbook_code_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cbook_code.CheckedChanged

    End Sub

    Private Sub cbook_code_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cbook_code.MouseHover
        llname = "cbook_code"
    End Sub

    Private Sub cCOMPANY_CODE_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cCOMPANY_CODE.CheckedChanged

    End Sub

    Private Sub cCOMPANY_CODE_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cCOMPANY_CODE.MouseHover
        llname = "cCOMPANY_CODE"

    End Sub

    Private Sub cesl_no_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cesl_no.CheckedChanged

    End Sub

    Private Sub cesl_no_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cesl_no.MouseHover
        llname = "Cesl_no"

    End Sub

    Private Sub cesl_date_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cesl_date.CheckedChanged

    End Sub

    Private Sub cesl_date_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cesl_date.MouseHover
        llname = "cesl_date"

    End Sub

    Private Sub crest_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles crest.CheckedChanged

    End Sub

    Private Sub crest_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles crest.MouseHover
        llname = "crest"
    End Sub

    Private Sub trest_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "trest"
    End Sub

    Private Sub trest_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub cpay_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cpay.CheckedChanged

    End Sub

    Private Sub cpay_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cpay.MouseHover
        llname = "cpay"

    End Sub

    Private Sub tpay_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles tpay.MouseHover
        llname = "tpay"

    End Sub

    Private Sub tpay_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles tpay.TextChanged

    End Sub

    Private Sub cdiss_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cdiss.CheckedChanged

    End Sub

    Private Sub cdiss_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cdiss.MouseHover
        llname = "cdiss"
    End Sub

    Private Sub ccash_per_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ccash_per.CheckedChanged

    End Sub

    Private Sub ccash_per_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ccash_per.MouseHover
        llname = "ccash_per"

    End Sub

    Private Sub dcash_per_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles dcash_per.MouseHover
        llname = "dcash_per"
    End Sub

    Private Sub dcash_per_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles dcash_per.TextChanged

    End Sub

    Private Sub cbon_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cbon.CheckedChanged

    End Sub

    Private Sub cbon_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cbon.MouseHover
        llname = "cbon"
    End Sub

    Private Sub cdepn_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cdepn.CheckedChanged

    End Sub

    Private Sub cdepn_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cdepn.MouseHover
        llname = "cdepn"

    End Sub

    Private Sub cpid_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub cpid_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "cpid"

    End Sub

    Private Sub ctot_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ctot.CheckedChanged

    End Sub

    Private Sub ctot_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ctot.MouseHover
        llname = "ctot"

    End Sub

    Private Sub cprest_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cprest.CheckedChanged

    End Sub

    Private Sub cprest_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cprest.MouseHover
        llname = "cprest"

    End Sub

    Private Sub tprest_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles tprest.MouseHover
        llname = "tprest"
    End Sub

    Private Sub tprest_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles tprest.TextChanged

    End Sub

    Private Sub cppay_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cppay.CheckedChanged

    End Sub

    Private Sub cppay_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cppay.MouseHover
        llname = "cppay"

    End Sub

    Private Sub tppay_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles tppay.MouseHover
        llname = "tppay"

    End Sub

    Private Sub tppay_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles tppay.TextChanged

    End Sub

    Private Sub cptot_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cptot.CheckedChanged

    End Sub

    Private Sub cptot_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cptot.MouseHover
        llname = "cptot"

    End Sub

    Private Sub tptot_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles tptot.MouseHover
        llname = "tptot"

    End Sub

    Private Sub tptot_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles tptot.TextChanged

    End Sub

    Private Sub clab_name_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles clab_name.CheckedChanged

    End Sub

    Private Sub clab_name_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles clab_name.MouseHover
        llname = "clab_name"

    End Sub

    Private Sub CheckBox10_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox10.CheckedChanged

    End Sub

    Private Sub CheckBox10_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles CheckBox10.MouseHover
        llname = "CheckBox10"

    End Sub

    Private Sub crcv_date_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles crcv_date.CheckedChanged

    End Sub

    Private Sub crcv_date_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles crcv_date.MouseHover
        llname = "crcv_date"

    End Sub

    Private Sub ch_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ch.CheckedChanged

    End Sub

    Private Sub ch_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ch.MouseHover
        llname = "ch"

    End Sub

    Private Sub CheckBox8_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox8.CheckedChanged

    End Sub

    Private Sub CheckBox8_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles CheckBox8.MouseHover
        llname = "CheckBox8"

    End Sub

    Private Sub creg_code_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles creg_code.CheckedChanged

    End Sub

    Private Sub creg_code_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles creg_code.MouseHover
        llname = "creg_code"

    End Sub

    Private Sub tot1_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles tot1.MouseHover
        llname = "tot1"

    End Sub

    Private Sub tot1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles tot1.TextChanged

    End Sub

    Private Sub CheckBox3_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CTESTCODE.CheckedChanged

    End Sub

    Private Sub CheckBox3_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles CTESTCODE.MouseHover
        llname = "CheckBox3"

    End Sub

    Private Sub ctest_name_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ctest_name.CheckedChanged

    End Sub

    Private Sub ctest_name_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ctest_name.MouseHover
        llname = "ctest_name"

    End Sub

    Private Sub ctest_ar_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ctest_ar.CheckedChanged

    End Sub

    Private Sub ctest_ar_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ctest_ar.MouseHover
        llname = "ctest_ar"

    End Sub

    Private Sub dtot_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles dtot.MouseHover
        llname = "dtot"

    End Sub

    Private Sub dtot_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles dtot.TextChanged

    End Sub

    Private Sub uusr_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles uusr.MouseHover
        llname = "uusr"

    End Sub

    Private Sub uusr_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles uusr.TextChanged

    End Sub

    Private Sub testpro_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles testpro.MouseHover
        llname = "testpro"

    End Sub

    Private Sub testpro_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles testpro.TextChanged

    End Sub

    Private Sub CODEE_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "CODEe"

    End Sub

    Private Sub CODEE_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub CCODE_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub CCODE_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "CCODE"

    End Sub

    Private Sub ctest_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ctest.CheckedChanged

    End Sub

    Private Sub ctest_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles ctest.MouseHover
        llname = "ctest"

    End Sub

    Private Sub Ntest_CODE_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles Ntest_CODE.MouseHover
        llname = "Ntest"

    End Sub

    Private Sub Ntest_CODE_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Ntest_CODE.TextChanged

    End Sub

    Private Sub shrt_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles shrt.MouseHover
        llname = "shrt"

    End Sub

    Private Sub shrt_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles shrt.TextChanged

    End Sub

    Private Sub KID_TYPE_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles KID_TYPE.MouseHover
        llname = "KID_TYPE"

    End Sub

    Private Sub KID_TYPE_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles KID_TYPE.SelectedIndexChanged

    End Sub

    Private Sub TextBox8_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles price1.MouseHover
        llname = "TextBox8"

    End Sub

    Private Sub TextBox8_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles price1.TextChanged

    End Sub

    Private Sub NAGEE_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "NAGEE"

    End Sub

    Private Sub NAGEE_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub NAGEB_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "NAGEb"

    End Sub

    Private Sub NAGEB_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub ComboBox3_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "ComboBox3"

    End Sub

    Private Sub ComboBox3_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub NTYPE_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "NTYPE"

    End Sub

    Private Sub NTYPE_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub NNORB_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "NNORB"

    End Sub

    Private Sub NNORB_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub NREF_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "NREF"
    End Sub

    Private Sub NREF_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub tell_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles tell.MouseHover
        llname = "tell"

    End Sub

    Private Sub tell_TextChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles tell.TextChanged

    End Sub

    Private Sub shift_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles shift.MouseHover
        llname = "shift"

    End Sub

    Private Sub shift_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles shift.SelectedIndexChanged

    End Sub

    Private Sub HR2_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles HR2.MouseHover
        llname = "hr2"

    End Sub

    Private Sub HR2_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles HR2.SelectedIndexChanged

    End Sub

    Private Sub HR1_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles HR1.MouseHover
        llname = "hr1"

    End Sub

    Private Sub HR1_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles HR1.SelectedIndexChanged

    End Sub

    Private Sub TYPE1_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles TYPE1.MouseHover
        llname = "type1"

    End Sub

    Private Sub TYPE1_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TYPE1.SelectedIndexChanged

    End Sub

    Private Sub TabPage4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TabPage4.Click

    End Sub

    Private Sub cshift_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cshift.CheckedChanged

    End Sub

    Private Sub cshift_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cshift.MouseHover
        llname = "cshift"

    End Sub

    Private Sub cuser_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cuser.CheckedChanged

    End Sub

    Private Sub cuser_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles cuser.MouseHover
        llname = "cuser"

    End Sub

    Private Sub statc_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles statc.CheckedChanged

    End Sub

    Private Sub statc_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles statc.MouseHover
        llname = "statc"

    End Sub

    Private Sub CHR1_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CHR1.CheckedChanged

    End Sub

    Private Sub CHR1_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles CHR1.MouseHover
        llname = "CHR1"

    End Sub

    Private Sub CTYPE1_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CTYPE1.CheckedChanged

    End Sub

    Private Sub CTYPE1_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles CTYPE1.MouseHover
        llname = "CTYPE1"

    End Sub

    Private Sub CheckBox5_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub CheckBox5_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "CheckBox5"

    End Sub

    Private Sub CheckBox2_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub CheckBox2_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "CheckBox2"

    End Sub

    

    Private Sub CheckBox1_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "CheckBox1"
    End Sub

    Private Sub HIDEToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles HIDEToolStripMenuItem.Click
        Dim n As String = InputBox("enter password", , "0")
        If n <> 6666 Then Exit Sub

        dr.Close()
        cmd.CommandText = "update iface set hide=1 where name='" & llname & "' "
        cmd.ExecuteNonQuery()
        Me.Text = "it's HIDE"
        cmdifc.Connection = CN
        cmdifc.CommandType = CommandType.Text
        cmdifc.CommandText = "select * from iface"
        adifc.SelectCommand = cmdifc
        adifc.Fill(DBS, "ifc")
        ifc = DBS.Tables("ifc")
        DBS.Tables("ifc").Clear()
        adifc.Fill(DBS, "ifc")
        ifc = DBS.Tables("ifc")
        ifaceb(Me)
    End Sub

    Private Sub TabPage2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TabPage2.Click

    End Sub

    Private Sub FindPatienCodeToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        flng("AR")
        Dim aa As String
        aa = InputBox("«œŒ· ﬂÊœ «·„—Ì÷ ø", , pname.Text)
        SAVERES(0, 0)
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandText = "select * from lbill where pcode ='" & aa & "' and bdel=0"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & pname.Text, 0, bran.Text)


        fnor(3)
    End Sub
    Public Sub FBARR()
        ACdr.Close()
        ACcmd.CommandText = "delete * from barcode"
        ACcmd.ExecuteNonQuery()
        dr.Close()
        Dim nna As String = ""
        Dim nnk As String = ""
        Dim nk As Integer = 0
        cmd.CommandText = "select bar,kid_type from v_lab where ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND tdel=0 group by bar,kid_type order by kid_type"
        dr = cmd.ExecuteReader
        While dr.Read
            If nulls(dr("kid_type")) = "0" Or nulls(dr("kid_type")).Length = 1 Then
mm:
                ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nna & "','1')"
                ACcmd.ExecuteNonQuery()
                nna = ""
            ElseIf dr("kid_type") = "" Then
                ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nna & "','1')"
                ACcmd.ExecuteNonQuery()
                nna = ""
            Else
                If UCase(nnk) <> UCase(dr("kid_type")) Then
                    If nnk = "" Then GoTo mm
                    ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nnk & "','1')"
                    ACcmd.ExecuteNonQuery()

                    nna = ""
                End If
            End If
            If nna = "" Then nna = dr("bar") Else nna = nna & "+" & dr("bar")
            nnk = UCase(dr("kid_type"))

        End While
        ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nnk & "','1')"
        ACcmd.ExecuteNonQuery()

        ACdr.Close() : ACcmd.CommandText = "select * from barcode where kid<>''"
        adbar.SelectCommand = ACcmd
        adbar.Fill(DBS, "bar")
        bar = DBS.Tables("bar")
        DBS.Tables("bar").Clear()
        adbar.Fill(DBS, "bar")
        bar = DBS.Tables("bar")
        brpd.DataSource = bar
        brpd.Columns("qun").Visible = True
        TabControl2.SelectTab(0)
    End Sub
    Private Sub BarcodeToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        FBARR()
    End Sub

    Private Sub PrintDocument1_PrintPage(ByVal sender As System.Object, ByVal e As System.Drawing.Printing.PrintPageEventArgs) Handles PrintDocument1.PrintPage
        Dim f As New Font("arial", 6, FontStyle.Regular)
        Dim f1 As New Font("arial", 10, FontStyle.Regular)
        Dim f2 As New Font("arial", 22, FontStyle.Regular)
        Dim f3 As New Font("arial", 17, FontStyle.Regular)
        Dim W As Integer = Convert.ToInt32("150")
        Dim H As Integer = Convert.ToInt32("37")
        bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
        Dim type As BarcodeLib.TYPE = BarcodeLib.TYPE.UNSPECIFIED
        type = BarcodeLib.TYPE.CODE128
        bar1.IncludeLabel = True
        bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
        type = BarcodeLib.TYPE.CODE128
        bar1.IncludeLabel = True
        If bran.Text = "0" Then barco.Image = bar1.Encode(type, Me.esl_no.Text.Trim(), W, H) Else barco.Image = bar1.Encode(type, Me.bran.Text.Trim + Me.esl_no.Text.Trim(), W, H)
        e.Graphics.DrawImage(barco.Image, 0, 3)
        If docs = 1 Then
            Dim NN As String = bar.Rows(nnw).Item("test")
            e.Graphics.DrawString(bar.Rows(nnw).Item("kid"), f, Brushes.Black, 5, 50)
            e.Graphics.DrawString(pname.Text, f1, Brushes.Black, 20, 35)
            e.Graphics.DrawString(Math.Round(Val(page.Text), 0) & " " & PYEAR.Text, f, Brushes.Black, 70, 50)
            e.Graphics.DrawString("( " & Now.ToString("h:m:s tt") & " )", f, Brushes.Black, 100, 30)
            e.Graphics.DrawString(Now.Date, f, Brushes.Black, 2, 30)
            If NN.Length >= 36 Then e.Graphics.DrawString(NN.Substring(0, 35), f, Brushes.Black, 3, 60) Else e.Graphics.DrawString(NN, f, Brushes.Black, 3, 70)
            If NN.Length >= 70 Then e.Graphics.DrawString(NN.Substring(36, 34), f, Brushes.Black, 3, 70) Else If NN.Length >= 36 Then e.Graphics.DrawString(NN.Substring(36), f, Brushes.Black, 3, 80)
            If NN.Length > 70 Then e.Graphics.DrawString(NN.Substring(71), f, Brushes.Black, 3, 80)
        Else
            If scan1 = 0 Then
                e.Graphics.DrawString(esl_date.Value, f1, Brushes.Black, 20, 40)
                e.Graphics.DrawString(Math.Abs(Val(REST.Text)) & "«·„œ›Ê⁄" & Math.Round(Val(PAY.Text), 0) & "/" & " :«·»«ﬁÏ", f1, Brushes.Black, 20, 55)
                e.Graphics.DrawString(pname.Text, f1, Brushes.Black, 20, 70)
                e.Graphics.DrawImage(barco.Image, 0, 3)
            Else
                e.Graphics.DrawImage(barco.Image, 40, 20)
                e.Graphics.DrawString(esl_date.Value, f2, Brushes.Black, 50, 60)
                e.Graphics.DrawString(" «.œ/ " & COMPANY_name.Text, f2, Brushes.Black, 50, 90)
                e.Graphics.DrawString(PNIK.Text & " / " & pname.Text, f3, Brushes.Black, 50, 120)
                e.Graphics.DrawString(test.Text, f3, Brushes.Black, 50, 150)

            End If

        End If



    End Sub
    Public Sub FSCAN()
        dr.Close()
        If Val(esl_no.Text) = 0 Then MsgBox("«·—Ã«¡ «Œ Ì«— Ê—ﬁ… «·—Ê‘ Â") : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lbill WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr = cmd.ExecuteReader
        If dr.HasRows = False Then MsgBox("«·—Ã«¡ «Œ Ì«— «·«Ì’«· «Ê·«") : Exit Sub
        ACdr.Close()
        ACcmd.CommandText = "select * from srv "
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        Dim FileNames = TwainLib.ScanImages(esl_no.Text, True, ACdr("scan"))
        'NREF.Text = TwainLib.TwainOperations.GetScanSource
        PictureBox1.ImageLocation = FileNames(0)
        Dim oer As System.IO.FileStream
        Dim rer As IO.StreamReader
        oer = New IO.FileStream(FileNames(0), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
        rer = New IO.StreamReader(oer)
        Dim FileByteArrayr(oer.Length - 1) As Byte
        oer.Read(FileByteArrayr, 0, oer.Length)
        dr.Close()
        cmd.CommandText = "select max(code) from lbillimage WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr = cmd.ExecuteReader
        dr.Read()
        IMAGE_CODE.Text = nulls(dr(0)) + 1
        dr.Close()
        cmd.CommandText = "insert into lbillimage (ESL_NO,CODE,IIMAGE ,bran,yearn) values ('" & esl_no.Text & "','" & IMAGE_CODE.Text & "','" & IIMAGE.Text & "','" & bran.Text & "','" & YEARN.Text & "')"
        cmd.ExecuteNonQuery()
        Dim Sql As String = "update  lbillimage set image = ? , no = ? where  ESL_NO='" & Val(esl_no.Text) & "' AND CODE='" & IMAGE_CODE.Text & "' and yearn='" & YEARN.Text & "'"
        cmd.CommandText = Sql
        cmd.Parameters.Clear()
        cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
        cmd.Parameters.Add("@no", System.Data.OleDb.OleDbType.VarChar, 100).Value = oer.Length
        cmd.ExecuteNonQuery()
        dr.Close()
        If PORV <> "" Then
            cmd.CommandText = " update lbill set st=1 where st=0 and ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' and yearn='" & YEARN.Text & "'"
            cmd.ExecuteNonQuery()
        End If
        LLOG(" ’ÊÌ—", esl_no.Text, " ”Õ» —Ê‘ Â " & pname.Text, 1, bran.Text)
    End Sub
    Private Sub SCANNERIMAGEToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

        FSCAN()
    End Sub

    Private Sub GlassButton87_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton87.Click
       
        Dim n As String = InputBox("enter password", , "0")
        If n <> 5011545 Then Exit Sub
        dr.Close()
        cmd.CommandText = tlis.Text
        Me.Text = "don ya man rows  " & cmd.ExecuteNonQuery()
        adonbill.Fill(DBS, "onbill")
    End Sub





    Private Sub FILEIMAGEToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        OpenFileDialog1.ShowDialog()
        PictureBox1.ImageLocation = OpenFileDialog1.FileName
        Dim oer As System.IO.FileStream
        Dim rer As IO.StreamReader
        oer = New IO.FileStream(OpenFileDialog1.FileName, IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
        rer = New IO.StreamReader(oer)
        Dim FileByteArrayr(oer.Length - 1) As Byte
        oer.Read(FileByteArrayr, 0, oer.Length)
        dr.Close()
        dr.Close() : dr.Close() : cmd.CommandText = "select * from eimage where pecode='" & Val(esl_no.Text) & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            Dim x As String
            dr.Close()
            x = MsgBox("Â·  —Ìœ «· ⁄œÌ· ø", MsgBoxStyle.YesNo)
            If x = vbNo Then Exit Sub
            dr.Close() : dr.Close() : cmd.CommandText = "delete from lbillimage where  ESL_NO='" & Val(esl_no.Text) & "' AND YEARN='" & YEARN.Text & "' AND BRAN ='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
        End If
        dr.Close()
        dr.Close()
        cmd.CommandText = "select max(code) from lbillimage WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr = cmd.ExecuteReader
        dr.Read()
        IMAGE_CODE.Text = nulls(dr(0)) + 1
        dr.Close()
        cmd.CommandText = "insert into lbillimage (ESL_NO,CODE,IIMAGE,BRAN) values ('" & esl_no.Text & "','" & IMAGE_CODE.Text & "','" & IIMAGE.Text & "',YEARN='" & YEARN.Text & "','" & bran.Text & "')"
        cmd.ExecuteNonQuery()
        Dim Sql As String = "update  lbillimage set image = ? , no = ? where  ESL_NO='" & Val(esl_no.Text) & "' AND CODE='" & IMAGE_CODE.Text & "' AND YEARN='" & YEARN.Text & "' AND BRAN ='" & bran.Text & "'F"
        cmd.CommandText = Sql
        cmd.Parameters.Clear()
        cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
        cmd.Parameters.Add("@no", System.Data.OleDb.OleDbType.VarChar, 100).Value = oer.Length
        cmd.ExecuteNonQuery()
        Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ"
    End Sub


    Private Sub GlassButton90_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton90.Click
        If IsNumeric(esl_no.Text) = False Then Me.Text = "«·—Ã«¡«Œ Ì«— «·„ÊŸ›" : Exit Sub
        dr.Close() : dr.Close() : cmd.CommandText = "select * from lbillimage where esl_no='" & Val(esl_no.Text) & "' AND CODE='" & IMAGE_CODE.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            Dim x As String
            dr.Close()
            x = MsgBox("Â·  —Ìœ «·Õ–› ø", MsgBoxStyle.YesNo)
            If x = vbNo Then Exit Sub
            dr.Close() : dr.Close() : cmd.CommandText = "delete from lbillimage where  ESL_NO='" & Val(esl_no.Text) & "' AND CODE='" & IMAGE_CODE.Text & "'"
            cmd.ExecuteNonQuery()
        End If

    End Sub

    Private Sub GlassButton88_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton88.Click
        dr.Close()
        cmd.CommandText = "update  lbillimage set IIMAGE='" & IIMAGE.Text & "' where  ESL_NO='" & Val(esl_no.Text) & "' AND CODE='" & IMAGE_CODE.Text & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub GlassButton91_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton91.Click
        dr.Close() : cmd.CommandText = "SELECT  * from V_LIMAGE where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        adPVW.SelectCommand = cmd
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        DBS.Tables("PVW").Clear()
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        brpd.DataSource = PVW
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & rptp.Text & "\limage.rpt")
        oj.Database.Tables(0).SetDataSource(PVW)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub GlassButton92_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim W As Integer = Convert.ToInt32("150")
        Dim H As Integer = Convert.ToInt32("37")
        bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
        Dim type As BarcodeLib.TYPE = BarcodeLib.TYPE.UNSPECIFIED
        type = BarcodeLib.TYPE.CODE128
        bar1.IncludeLabel = True
        If bran.Text = "0" Then barco.Image = bar1.Encode(type, Me.esl_no.Text.Trim(), W, H) Else barco.Image = bar1.Encode(type, Me.bran.Text + Me.esl_no.Text.Trim(), W, H)
        ACdr.Close()
        ACcmd.CommandText = "select * from srv"
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()

        'PrintPreviewDialog1.Document = PrintDocument1
        'PrintPreviewDialog1.ShowDialog()
        PrintDialog1.Document = PrintDocument1
        'PrintDialog1.ShowDialog()
        'PrintDialog1.PrinterSettings.PrinterName = ACdr("prnt")
        SSSS = 0
        nnq = 0
        nnw = 0
        While Not nnw = bar.Rows.Count
            nnq = 0
mm:
            If bar.Rows(nnw).Item("qun") > 0 And nnq < bar.Rows(nnw).Item("qun") Then
                PrintPreviewDialog1.Document = PrintDocument1
                PrintPreviewDialog1.ShowDialog()
                SSSS = +1
                nnq = nnq + 1
                GoTo mm
            End If
            nnw = nnw + 1
        End While
    End Sub


  

    Private Sub HIDEToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub
    Public Sub FPRINTV()
        flng("AR")
        If CODEB.Text = CODEE.Text Then

            prntss()
        Else
            dr.Close()
            cmd.CommandText = "UPDATE lbill SET QUN=1 where  ESL_NO between '" & CODEB.Text & "' and '" & CODEE.Text & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
            dr1.Close()
            cmd.CommandText = "select * from lbill where  ESL_NO between '" & CODEB.Text & "' and '" & CODEE.Text & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            dr = cmd.ExecuteReader
            dr.Close() : cmd.Connection = CN
            dr.Close() : cmd.CommandText = "select * from lbill where  ESL_NO between '" & CODEB.Text & "' and '" & CODEE.Text & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            adF31.SelectCommand = cmd
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            DBS.Tables("F31").Clear()
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            F31D.DataSource = F31
            tm = 4
            F31DTG()
            TabControl2.SelectTab(1)
            Dim SS As Integer = 0
            While SS = F31.Rows.Count
                F31.Rows(SS).BeginEdit()
                F31.Rows(SS).Item("QUN") = 1
                F31.Rows(SS).BeginEdit()
                dr.Close()
                SS = SS + 1
            End While
            printall()
        End If

    End Sub
    Private Sub TotalSaveToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        FPRINTV()
    End Sub
    Public Sub FSAVEPRNT()
        Try
            FSAVEV()
            If fchk = 1 Then
                If sbar = 1 Then FBARR() : FBARS()
                If sbar = 1 And pap > 0 Then docs = 0 : barname()
                If sbill = 1 Then FPESL("esl")
                If slist = 1 Then FWORKSHEET()
                If sscan = 1 Then
                    If prnt = 0 Then
                        If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                        LLOG(" ’ÊÌ—", esl_no.Text, " ”Õ» ’Ê—… «·—Ê‘ Â " & pname.Text, 0, bran.Text)
                        Exit Sub
                    End If
                    FSCAN()
                End If

            End If
            If savenew = 1 Then pname.Text = "" : PNIK.Text = "" : PNIK.Focus()
        Catch ex As Exception
            Dim st1 As String = "CTRL + S"
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
    Private Sub Z1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z1.Click
        TextBox3.Text = Z1.Text
        FIRES(1)
        ams = 1
    End Sub

    Private Sub Z61_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z61.Click
        TextBox3.Text = Z61.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        group_name.Text = TextBox3.Text : ams = 2
    End Sub

    Private Sub TestColorToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TestColorToolStripMenuItem.Click
        changeclolr()
    End Sub
    Public Sub changeclolr()
        Dim scolor As Integer
        ColorDialog1.ShowDialog()
        scolor = ColorDialog1.Color.ToArgb
        dr.Close()
        If ams = 1 Then
            dr.Close()
            FRC = BILL.Select("qun='1'")
            Dim t As String = 0
            While Not t = FRC.Length
                RC = FRC(t)
                cmd.CommandText = "update lbill_test set color='" & scolor & "' where test_name='" & RC("test_name") & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "update ltest set color='" & scolor & "' where test_name='" & RC("test_name") & "'"
                cmd.ExecuteNonQuery()
                t = t + 1
            End While
            If FRC.Length = 0 Then
                cmd.CommandText = "update lbill_test set color='" & scolor & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "update ltest set color='" & scolor & "'"
                cmd.ExecuteNonQuery()
            End If
        ElseIf ams = 2 Then
            If group_name.Text <> "" Then
                dr.Close()
                cmd.CommandText = "update  lgroup set color='" & scolor & "'  WHERE  NAME='" & group_name.Text & "'"
                cmd.ExecuteNonQuery()
            Else
                dr.Close()
                cmd.CommandText = "update  lgroup set color='" & scolor & "'"
                cmd.ExecuteNonQuery()

            End If
        ElseIf ams = 3 Then
            If GRNAME.Text <> "" Then
                dr.Close()
                cmd.CommandText = "update  lgr set color='" & scolor & "'  WHERE  NAME='" & GRNAME.Text & "'"
                cmd.ExecuteNonQuery()
            Else
                dr.Close()
                cmd.CommandText = "update  lgr set color='" & scolor & "'"
                cmd.ExecuteNonQuery()

            End If
        End If
    End Sub
    Public Sub changgso()
        Dim scolor As String = InputBox("«œŒ· «· — Ì»", , 50)
        dr.Close()
        If ams = 1 Then
            cmd.CommandText = "update ltest set gso='" & scolor & "' where test_name='" & TextBox3.Text & "'"
            cmd.ExecuteNonQuery()
        ElseIf ams = 2 Then
            dr.Close()
            cmd.CommandText = "update  lgroup set gso='" & scolor & "'  WHERE  NAME='" & group_name.Text & "'"
            cmd.ExecuteNonQuery()
        ElseIf ams = 3 Then
            dr.Close()
            cmd.CommandText = "update  lgr set gso='" & scolor & "'  WHERE  NAME='" & GRNAME.Text & "'"
            cmd.ExecuteNonQuery()
        End If

    End Sub

    Private Sub TestSortingToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TestSortingToolStripMenuItem.Click
        changgso()

    End Sub

    Private Sub Z2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z2.Click
        TextBox3.Text = Z2.Text
        ams = 1 : FIRES(1)

    End Sub

    Private Sub Z3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z3.Click
        TextBox3.Text = Z3.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z4.Click
        TextBox3.Text = Z4.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z5_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z5.Click
        TextBox3.Text = Z5.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z6.Click
        TextBox3.Text = Z6.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z7_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z7.Click
        TextBox3.Text = Z7.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z8_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z8.Click
        TextBox3.Text = Z8.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z9_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z9.Click
        TextBox3.Text = Z9.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z10.Click
        TextBox3.Text = Z10.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z11_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z11.Click
        TextBox3.Text = Z11.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z12_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z12.Click
        TextBox3.Text = Z12.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z13_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z13.Click
        TextBox3.Text = Z13.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z14_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z14.Click
        TextBox3.Text = Z14.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z15_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z15.Click
        TextBox3.Text = Z15.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z17_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z17.Click
        TextBox3.Text = Z17.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z18_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z18.Click
        TextBox3.Text = Z18.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z19_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z19.Click
        TextBox3.Text = Z19.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z20_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z20.Click
        TextBox3.Text = Z20.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z21_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z21.Click
        TextBox3.Text = Z21.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z22_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z22.Click
        TextBox3.Text = Z22.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z23_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z23.Click
        TextBox3.Text = Z23.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z24_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z24.Click
        TextBox3.Text = Z24.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z25_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z25.Click
        TextBox3.Text = Z25.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z26_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z26.Click
        TextBox3.Text = Z26.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z27_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z27.Click
        TextBox3.Text = Z27.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z28_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z28.Click
        TextBox3.Text = Z28.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z29_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z29.Click
        TextBox3.Text = Z29.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z30_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z30.Click
        TextBox3.Text = Z30.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z31_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z31.Click
        TextBox3.Text = Z31.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z32_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z32.Click
        TextBox3.Text = Z32.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z33_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z33.Click
        TextBox3.Text = Z33.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z34_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z34.Click
        TextBox3.Text = Z34.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z35_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z35.Click
        TextBox3.Text = Z35.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z36_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z36.Click
        TextBox3.Text = Z36.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z37_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z37.Click
        TextBox3.Text = Z37.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z38_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z38.Click
        TextBox3.Text = Z38.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z39_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z39.Click
        TextBox3.Text = Z39.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z40_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z40.Click
        TextBox3.Text = Z40.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z41_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z41.Click
        TextBox3.Text = Z41.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z42_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z42.Click
        TextBox3.Text = Z42.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z43_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z43.Click
        TextBox3.Text = Z43.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z44_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z44.Click
        TextBox3.Text = Z44.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z45_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z45.Click
        TextBox3.Text = Z45.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z46_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z46.Click
        TextBox3.Text = Z46.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z47_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z47.Click
        TextBox3.Text = Z47.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z48_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z48.Click
        TextBox3.Text = Z48.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z49_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z49.Click
        TextBox3.Text = Z49.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z50_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z50.Click
        TextBox3.Text = Z50.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z16_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z16.Click
        TextBox3.Text = Z16.Text
        ams = 1 : FIRES(1)
    End Sub

    Private Sub Z51_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z51.Click
        TextBox3.Text = Z51.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        GRNAME.Text = TextBox3.Text : ams = 3
    End Sub

    Private Sub Z52_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z52.Click
        TextBox3.Text = Z52.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        GRNAME.Text = TextBox3.Text : ams = 3

    End Sub

    Private Sub Z53_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z53.Click
        TextBox3.Text = Z53.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        GRNAME.Text = TextBox3.Text : ams = 3
    End Sub

    Private Sub Z54_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z54.Click
        TextBox3.Text = Z54.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        GRNAME.Text = TextBox3.Text : ams = 3
    End Sub

    Private Sub Z55_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z55.Click
        TextBox3.Text = Z55.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        GRNAME.Text = TextBox3.Text : ams = 3
    End Sub

    Private Sub Z56_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z56.Click
        TextBox3.Text = Z56.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        GRNAME.Text = TextBox3.Text : ams = 3
    End Sub

    Private Sub Z57_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z57.Click
        TextBox3.Text = Z57.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        GRNAME.Text = TextBox3.Text : ams = 3
    End Sub

    Private Sub Z58_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z58.Click
        TextBox3.Text = Z58.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        GRNAME.Text = TextBox3.Text : ams = 3
    End Sub

    Private Sub Z59_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z59.Click
        TextBox3.Text = Z59.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        GRNAME.Text = TextBox3.Text : ams = 3
    End Sub

    Private Sub Z60_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z60.Click
        TextBox3.Text = Z60.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        GRNAME.Text = TextBox3.Text : ams = 3
    End Sub

    Private Sub Z62_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z62.Click
        TextBox3.Text = Z62.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        group_name.Text = TextBox3.Text : ams = 2
    End Sub

    Private Sub Z63_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z63.Click
        TextBox3.Text = Z63.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        group_name.Text = TextBox3.Text : ams = 2
    End Sub

    Private Sub Z64_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z64.Click
        TextBox3.Text = Z64.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        group_name.Text = TextBox3.Text : ams = 2
    End Sub

    Private Sub Z65_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z65.Click
        TextBox3.Text = Z65.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        group_name.Text = TextBox3.Text : ams = 2
    End Sub

    Private Sub Z66_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z66.Click
        TextBox3.Text = Z66.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        group_name.Text = TextBox3.Text : ams = 2
    End Sub

    Private Sub Z67_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z67.Click
        TextBox3.Text = Z67.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        group_name.Text = TextBox3.Text : ams = 2
    End Sub

    Private Sub Z68_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z68.Click
        TextBox3.Text = Z68.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        group_name.Text = TextBox3.Text : ams = 2
    End Sub

    Private Sub Z69_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z69.Click
        TextBox3.Text = Z69.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        group_name.Text = TextBox3.Text : ams = 2
    End Sub

    Private Sub Z70_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Z70.Click
        TextBox3.Text = Z70.Text
        If gprv.Checked = True Then FIRES(2) Else FIRES(1)
        group_name.Text = TextBox3.Text : ams = 2
    End Sub

    Private Sub GlassButton93_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton93.Click
        Try
            cmdb.DataAdapter = adBILL
            adBILL.Update(DBS, "BILL")
            SUMT()
            fprice(1)
        Catch ex As Exception
            fprice(1)
        End Try

    End Sub

  

    Private Sub esld_CellEndEdit(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles esld.CellEndEdit
        'ESLBILL.Text = 0
        'Dim n As Integer = 0
        'While Not n = eslb.Rows.Count
        '    ESLBILL.Text = Val(ESLBILL.Text) + Val(eslb.Rows(n).Item("tot"))
        '    n = n + 1
        'End While
        'If Val(ESLBILL.Text) < TOT.Text Then ESLBILL.BackColor = Color.Red Else ESLBILL.BackColor = Color.Green
    End Sub

    Private Sub esld_CellMouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellMouseEventArgs) Handles esld.CellMouseClick
        'ESLBILL.Text = 0
        'Dim n As Integer = 0
        'While Not n = eslb.Rows.Count
        '    ESLBILL.Text = Val(ESLBILL.Text) + Val(eslb.Rows(n).Item("tot"))
        '    n = n + 1
        'End While
        'If Val(ESLBILL.Text) < TOT.Text Then ESLBILL.BackColor = Color.Red Else ESLBILL.BackColor = Color.Green
    End Sub

    Private Sub esld_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles esld.GotFocus
        sotr(2, "esld")
    End Sub

    Private Sub esld_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles esld.KeyDown
        If e.KeyCode = Keys.Enter Then sotr(1, "")


    End Sub
    Public Sub FWORKSHEET()
        Try
            If prnt = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG("ÿ»«⁄…", esl_no.Text, " ÿ»«⁄… Ê—ﬂ ‘Ì  " & pname.Text, 0, bran.Text)
                Exit Sub
            End If

            Dim ss As String = " "
            dr.Close()
            cmd.CommandText = "select count(esl_no) from lbill where pcode='" & pcode.Text & "' and esl_no<>'" & esl_no.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then
                If dr(0) > 1 Then ss = "Â–« «·„—Ì÷ ”»ﬁ “Ì«— Â ·‰« „‰ ﬁ»· «·—Ã«¡ «· «»⁄…"
            End If
            dr.Close()
            DBS.Tables("esl").Clear()
            cmdesl.Parameters.Clear()
            cmdesl.CommandText = "pesl"
            cmdesl.CommandType = CommandType.StoredProcedure
            cmdesl.Parameters.AddWithValue("esl_no", Val(esl_no.Text))
            cmdesl.Parameters.AddWithValue("yearn", Val(YEARN.Text))
            cmdesl.Parameters.AddWithValue("bran", bran.Text)
            adesl.SelectCommand = cmdesl
            adesl.Fill(DBS, "esl")
            Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
            oj.Load(Application.StartupPath & rptp.Text & "\work sheet.rpt")
            oj.Database.Tables(0).SetDataSource(DBS.Tables("esl"))
            oj.SetParameterValue("ss", ss)
            rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
            If vv.Checked = True Then rp.Show() : rp.Focus() Else oj.PrintToPrinter(1, False, 0, 0)
            LLOG("ÿ»«⁄…", esl_no.Text, " ÿ»«⁄… ÃÊ» «Ê—œ— " & pname.Text, 1, bran.Text)
        Catch ex As Exception
            Dim st1 As String = "WORK SHEET"
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
   
    Private Sub GlassButton94_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton94.Click
        Try
            Dim N As String = MsgBox("Â·  „ «· ”·Ì„ «·‰ ÌÃ… ··„—Ì÷ " & " " & pname.Text, MsgBoxStyle.YesNo)
            If N = vbNo Then Exit Sub
            dr.Close()
            cmd.CommandText = "update lbill set rcv=1,RCV_DATE='" & ChangeFormatall(Now) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
            dr.Close()
            If PORV <> "" Then
                cmd.CommandText = " update lbill set st=1 where st=0 and ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
            End If
            LLOG("«” ·«„", esl_no.Text, "   „  ”·Ì„ " & pname.Text, 0, bran.Text)
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub GlassButton95_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub Label68_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq115.Click
        LABTO()
    End Sub

    Private Sub Label68_MouseHover1(ByVal sender As Object, ByVal e As System.EventArgs) Handles qq115.MouseHover
        llname = "Label68"

    End Sub

    Private Sub GlassButton96_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub



    Private Sub ROYALTESTToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub esld_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles esld.KeyPress
        If IsNumeric(e.KeyChar) = False Then e.Handled = True
    End Sub

    Private Sub esld_Leave(ByVal sender As Object, ByVal e As System.EventArgs) Handles esld.Leave
        'ESLBILL.Text = 0
        'Dim n As Integer = 0
        'While Not n = eslb.Rows.Count
        '    ESLBILL.Text = Val(ESLBILL.Text) + eslb.Rows(n).Item("tot")
        '    n = n + 1
        'End While
    End Sub
    Public Sub barname()
        If prnt = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("ÿ»«⁄… »«—ﬂÊœ «”„", esl_no.Text, "  ÿ»«⁄… »«—ﬂÊœ «”„ " & pname.Text, 0, bran.Text)
            Exit Sub
        End If
        ACdr.Close()
        ACcmd.CommandText = "select * from srv"
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        PrintPreviewDialog1.Document = PrintDocument1
        'PrintPreviewDialog1.ShowDialog()3
        PrintDialog1.PrinterSettings.PrinterName = ACdr("prnt")
        PrintDialog1.Document = PrintDocument1
        Dim n As Integer = 0
        While Not n = pap
            docs = 0
            PrintDocument1.Print()
            n = n + 1
        End While
        LLOG("ÿ»«⁄… »«—ﬂÊœ «”„", esl_no.Text, "  ÿ»«⁄… »«—ﬂÊœ «”„ " & pname.Text, 0, bran.Text)

    End Sub
    Private Sub GlassButton98_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq59.Click
        docs = 0 : barname()
    End Sub

    Private Sub GlassButton99_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq28.Click
        FWORKSHEET()


    End Sub

    Private Sub GlassButton100_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ42.Click
        Try
            If final = 0 Then MsgBox("·«  „ ·ﬂ «·’·«ÕÌ…") : Exit Sub
            Dim N As String = MsgBox("Â·  „ «· √ﬂœ „‰ ‰ «∆Ã «· Õ«·Ì· " & " " & pname.Text, MsgBoxStyle.YesNo)
            If N = vbNo Then Exit Sub
            dr.Close()
            cmd.CommandText = "update lbill set final=1  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()

            SAVERES(1, 0)
            finals.Checked = True

            dr.Close()
            cmd.CommandText = "update lbill set st=1,final=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update lbill_ESL set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update lbill_test  set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update lbill_testsub set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update LBILL_CULT set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update LBILL_CULT_DET set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
        'cmd.CommandText = "update lbillemage set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        'cmd.ExecuteNonQuery()
        'dr.Close()
        ''cmd.CommandText = "delete from ltest "
        ''cmd.ExecuteNonQuery()
        'ACdr.Close()
        'ACcmd.CommandText = "select * from test_sub"
        'ACdr = ACcmd.ExecuteReader
        'While ACdr.Read
        '    'cmd.CommandText = "INSERT INTO ltest(TEST_CODE,TEST_NAME,ar,GCODE,GNAME,sub,CULT,ResultAfter,short,gr_name ,so,RSO,LAB ,res,NOTES) values ('" & ACdr("TEST_CODE") & "','" & ACdr("TEST_NAME") & "','" & ACdr("TEST_AR") & "','" & ACdr("GCODE") & "','" & ACdr("GNAME") & "','" & ACdr("sub") & "','" & ACdr("CULT") & "','" & ACdr("ResultAfter") & "','" & ACdr("shortname") & "','" & ACdr("gr_name") & "','" & ACdr("so") & "','" & ACdr("RSO") & "','" & ACdr("LAB2") & "','" & ACdr("res") & "','" & ACdr("NOTES") & "')"
        '    'cmd.ExecuteNonQuery()
        '    ''cmd.CommandText = "INSERT INTO ltest_price(TEST_CODE,TEST_NAME,tot,book_price_code,book_price_name) values ('" & ACdr("TEST_CODE") & "','" & ACdr("TEST_NAME") & "','" & ACdr("price1") & "','1','ﬂ Ì» «”⁄«— «·„⁄„·')"
        '    ''cmd.ExecuteNonQuery()
        '    ''cmd.CommandText = "INSERT INTO ltest_price(TEST_CODE,TEST_NAME,tot,book_price_code,book_price_name) values ('" & ACdr("TEST_CODE") & "','" & ACdr("TEST_NAME") & "','" & ACdr("price2") & "','2','Lab To Lab')"
        '    ''cmd.ExecuteNonQuery()
        '    ''cmd.CommandText = "INSERT INTO ltest_price(TEST_CODE,TEST_NAME,tot,book_price_code,book_price_name) values ('" & ACdr("TEST_CODE") & "','" & ACdr("TEST_NAME") & "','" & ACdr("price3") & "','3','«·„ƒ””… «·⁄·«ÃÌ…')"
        '    ''cmd.ExecuteNonQuery()
        '    cmd.CommandText = "insert into LSUBTEST(test_code,test_name,mtest_code,mtest_name,q,so,p,res,rso,NOTES ) values ('" & ACdr("test_code") & "','" & ACdr("test_name") & "','" & ACdr("mtest_code") & "','" & ACdr("mtest_name") & "','" & ACdr("q") & "','" & ACdr("so") & "','" & ACdr("p") & "','" & ACdr("res1") & "','" & ACdr("rso") & "','" & ACdr("NOTES") & "')"
        '    cmd.ExecuteNonQuery()
        'End While

    End Sub

    Private Sub  ﬁ—Ì—œŒ·«·„⁄„·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton101_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton101.Click
        'Try
        DBS.Tables("a1").Clear()
        dr.Close() : cmd.CommandText = "SELECT  * from V_LIMAGE where ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        ada1.SelectCommand = cmd
        adPVW.Fill(DBS, "a1")
        a1 = DBS.Tables("a1")
        brpd.DataSource = a1
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\limage.rpt")
        oj.Database.Tables(0).SetDataSource(a1)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
        'dr.Close() : cmd.CommandText = "SELECT * from lbillimage  where ESL_NO='" & esl_no.Text & "' " & " and yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        'adPVW.SelectCommand = cmd
        'DBS.Tables("PVw").Clear()
        'adPVW.Fill(DBS, "PVw")
        'PVW = DBS.Tables("PVw")
        'brpd.DataSource = PVW
        'Dim v As Integer = 0
        'While Not v = brpd.Columns.Count
        '    brpd.Columns(v).Visible = False
        '    v = v + 1
        'End While
        'brpd.Columns("image").Visible = True
        'brpd.Columns("ky").Visible = True
    End Sub

    Private Sub GlassButton102_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton102.Click
        Dim n As String = InputBox("«œŒ· —ﬁ„ «·«Ì’«·", , 0)
        dr.Close()
        cmd.CommandText = "select * from lbill_esl where  bill='" & n & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            esl_no.Text = dr("esl_no")
            fesl(0, 0)
            Exit Sub
        End While
    End Sub

    Public Sub teste(ByVal s As Integer)
        Dim S1 As Integer = InputBox("ENTER PASWORD")
        If S1 <> 205 Then Exit Sub
        Dim yyyy As String = ""
        Dim yyy1 As String = ""
        If ctest.Checked = True Then yyy1 = " and test_name='" & test.Text & "'"
        dr1.Close()
        cmd1.CommandText = "update lbill_test set lab='0',labprice='0',test_price='0' WHERE esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' " & yyyy
        cmd1.ExecuteNonQuery()
        Dim pr1, pr2, lab As Integer
        FRC = BOOK.Select("code='2'")
        If FRC.Length <= 0 Then
        Else
            RC = FRC(0)
            BOOK_CODE.Text = RC("name")
            BOOK_CODE.Text = RC("code")
        End If
        dr.Close()
        cmd.CommandText = "select * from ltest where lab=1 " & yyy1
        dr = cmd.ExecuteReader
        While dr.Read
            pr1 = 0
            pr2 = 0
            lab = 0
            dr1.Close()
            cmd1.CommandText = "select * from ltest_price where test_code='" & dr("test_code") & "' and book_price_code=2 order by book_price_code "
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            If dr1.HasRows = True Then
                If dr1("book_price_code") = 1 Then pr1 = dr1("tot") Else pr2 = dr1("tot")
            End If
            dr1.Close()
            cmd1.CommandText = "select * from ltest_price where test_code='" & dr("test_code") & "' and book_price_code=1 order by book_price_code "
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            If dr1.HasRows = True Then
                If dr1("book_price_code") = 1 Then pr1 = dr1("tot") Else pr2 = dr1("tot")
            End If
            lab = dr("lab")
            dr1.Close()
            cmd1.CommandText = "update lbill_test set lab='" & lab & "',labprice='" & pr2 & "',test_price='" & pr1 & "' where test_code='" & dr("test_code") & "' AND esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
            cmd1.ExecuteNonQuery()
        End While
        dr.Close()
        cmd.CommandText = "select * from ltest where lab=0" & yyy1
        dr = cmd.ExecuteReader
        While dr.Read
            pr1 = 0
            dr1.Close()
            cmd1.CommandText = "select * from ltest_price where test_code='" & dr("test_code") & "' and book_price_code=1 order by book_price_code "
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            If dr1.HasRows = True Then
                If dr1("book_price_code") = 1 Then pr1 = dr1("tot") Else pr2 = dr1("tot")
            End If
            dr1.Close()
            cmd1.CommandText = "update lbill_test set test_price='" & pr1 & "' where test_code='" & dr("test_code") & "' AND esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
            cmd1.ExecuteNonQuery()
        End While
        Dim nnnn As String = ""
        dr.Close()
        cmd.CommandText = "select sum(labprice) as labprice ,esl_no,sum(test_price) as test_price from lbill_test  where tdel=0 AND esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' group by esl_no"
        dr = cmd.ExecuteReader
        While dr.Read
            nnnn = ""
            Dim nss As Double = 0
            nss = 0
            dr1.Close()
            cmd1.CommandText = "select test_name ,esl_no,lab,labprice from lbill_test where esl_no='" & dr("esl_no") & "' and lab=1 group by test_name ,esl_no,lab,labprice"
            dr1 = cmd1.ExecuteReader
            While dr1.Read
                nnnn = nnnn & " +  " & dr1("test_name")
                nss = dr1("labprice") + nss
            End While
            dr1.Close()
            cmd1.CommandText = "update lbill set lab_name='" & BOOK_name.Text & "',lab_code='2',labtest='" & nnnn & "',ptot='" & nss & "',ppay='" & nss & "',tot='" & dr("test_price") & "' where esl_no='" & dr("esl_no") & "'"
            cmd1.ExecuteNonQuery()
        End While
    End Sub
    Private Sub  ⁄œÌ·«·⁄Ì‰…ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        'Dim n As String = InputBox("«œŒ· ‰Ê⁄ «·⁄Ì‰… ·· Õ·Ì·")
        dr1.Close()
        cmd1.CommandText = "update ltest set kid_type='" & KID_TYPE.Text & "' where test_code='" & Ntest_CODE.Text & "'"
        cmd1.ExecuteNonQuery()
        Me.Text = "ites saved"

    End Sub

    Private Sub GlassButton35_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)
        On Error Resume Next

        fesl(1, 0)
    End Sub

   
    Public Sub incomet(ByVal t As Integer)
        Dim acc As String = ""
        If t = 2 Then
            acc = " and bon>0 "
        ElseIf t = 1 Then
            acc = "  and pinc=0 and bon=0"
        ElseIf t = 3 Then
            acc = " and pinc=1 "
        End If
        If fath = 0 Then
            RP1.Checked = False
            LABTO()
            f3(1)
            RP1.Checked = True
        End If
        RP1.Checked = False
        Dim nr As Double = 0
        yy = ""
        Dim nxx As String = ""
        If cesl_date.Checked = True Then
            yy = yy & "  " & " and esl_date='" & ChangeFormat(esl_date.Value) & "'"
            YYN = "esl_date"
            nxx = " and rest=0"
        End If
        dr1.Close()
        cmd1.CommandText = "update lbill set pcanc=0,pinc=0 "
        cmd1.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "select * from lcompany where inc>0"
        dr = cmd.ExecuteReader
        While dr.Read
            dr1.Close()
            cmd1.CommandText = "update lbill set pinc=1 where company_code='" & dr("code") & "'"
            cmd1.ExecuteNonQuery()
        End While
        dr.Close()
        dr.Close()
        cmd.CommandText = "select * from lcompany where canc>0"
        dr = cmd.ExecuteReader
        While dr.Read
            dr1.Close()
            cmd1.CommandText = "update lbill set pcanc=1 where company_code='" & dr("code") & "'"
            cmd1.ExecuteNonQuery()
        End While
        dr.Close()
        cmd.CommandText = "SELECT   * from lbill where pcanc=0 and bdel=0 and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" & yy & acc
        dr = cmd.ExecuteReader
        '================================================================
        tfinal.Rows.Clear()
        While dr.Read
            nr = 0
            RC = tfinal.NewRow
            RC("bon") = dr("bon")
            RC("pinc") = dr("pinc")
            RC("esl_no") = dr("esl_no")
            RC("pname") = dr("pname")
            RC("lprice") = Val(dr("ptot"))
            RC("tot") = dr("tot")
            RC("company_name") = dr("company_name")
            tfinal.Rows.Add(RC)
            Dim n As Int16 = 0
            Dim nx As Int16 = tfinal.Rows.Count - 1
            dr1.Close()
            cmd1.CommandText = "select * from v_esl where yearn='" & YEARN.Text & "' and esl_no='" & dr("esl_no") & "' and sdate between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" & nxx
            dr1 = cmd1.ExecuteReader
            While dr1.Read
                If n = 0 Then
                    RC = tfinal.Rows(tfinal.Rows.Count - 1)
                    RC.BeginEdit()
                    RC("bill") = dr1("bill")
                    RC("btot") = dr1("tot1")
                    RC("esl_no") = dr1("esl_no")
                    If dr1("rest") = 0 Then RC("sdate") = dr1("esl_date") Else RC("sdate") = dr1("sdate")
                    RC.EndEdit()
                Else
                    RC = tfinal.NewRow
                    RC("bill") = dr1("bill")
                    RC("btot") = dr1("tot1")
                    RC("esl_no") = dr("esl_no")
                    If dr1("rest") = 0 Then RC("sdate") = dr1("esl_date") Else RC("sdate") = dr1("sdate")
                    RC("lprice") = 0
                    RC("tot") = 0
                    tfinal.Rows.Add(RC)
                End If
                n = n + 1
            End While
            Dim nn As Int16 = nx
            If n = 0 Then n = 1
            n = n + nx
            dr1.Close()
            cmd1.CommandText = "select * from lbill_test where esl_no='" & dr("esl_no") & "' and lab=1 and tdel=0"
            dr1 = cmd1.ExecuteReader
            While dr1.Read
                If TESTSH = 1 Then
                    If n > nn Then
                        RC = tfinal.Rows(nn)
                        RC.BeginEdit()
                        RC("tname") = dr1("test_name")
                        RC("tprice") = dr1("test_price")
                        RC("tlprice") = dr1("labprice")
                        RC.EndEdit()
                    Else
                        RC = tfinal.NewRow
                        RC("tname") = dr1("test_name")
                        RC("tprice") = dr1("test_price")
                        RC("tlprice") = dr1("labprice")
                        RC("esl_no") = dr1("esl_no")
                        RC("lprice") = 0
                        RC("tot") = 0
                        tfinal.Rows.Add(RC)
                    End If
                End If
                If TESTP = 1 Then nr = nr + dr1("test_price")
                nn = nn + 1
            End While
            If TESTP = 1 Then
                RC = tfinal.Rows(nx)
                RC.BeginEdit()
                RC("lprice") = nr
                RC("tot") = 0
                RC.EndEdit()
            End If
            If fath = 0 Then
                FRC = temp.Select("esl_no='" & dr("esl_no") & "'")
                If FRC.Length > 0 Then
                    RC = tfinal.Rows(nx)
                    RC.BeginEdit()
                    RC("lprice") = FRC(0).Item("PTOT")
                    RC("tot") = 0
                    RC.EndEdit()
                Else
                    RC = tfinal.Rows(nx)
                    RC.BeginEdit()
                    RC("lprice") = 0
                    RC("tot") = 0
                    RC.EndEdit()
                End If
            End If
            dr2.Close()
            cmd2.CommandText = "update lbill_esl set sdate='" & ChangeFormat(dr("esl_date")) & "' where  esl_no='" & dr("esl_no") & "' and rest=0"
            cmd2.ExecuteNonQuery()
            cmd2.CommandText = "select sum(tot),sdate from lbill_esl where yearn='" & YEARN.Text & "' and esl_no='" & dr("esl_no") & "' " & nxx & " group by sdate"
            dr2 = cmd2.ExecuteReader
            If dr2.HasRows Then
                While dr2.Read
                    FRC = tfinal.Select("esl_no='" & dr("esl_no") & "' and sdate='" & dr2("sdate") & "'")
                    If FRC.Length > 0 Then
                        RC = FRC(0)
                        RC.BeginEdit()
                        RC("tot") = dr2(0)
                        RC.EndEdit()
                    End If
                End While
            End If
        End While
        If nxx <> "" Then
            dr.Close()
            cmd.CommandText = "select * from v_esl where rest=1 and sdate='" & ChangeFormat(esl_date.Value) & "'" & acc
            dr = cmd.ExecuteReader
            While dr.Read()
                RC = tfinal.NewRow
                RC("bill") = dr("bill")
                RC("btot") = dr("tot1")
                RC("sdate") = dr("sdate")
                RC("bon") = 0
                RC("pinc") = 0
                RC("esl_no") = dr("esl_no")
                RC("pname") = "»«ﬁÏ  " & dr("pname")
                RC("lprice") = 0
                RC("tot") = dr("tot1")
                RC("company_name") = dr("company_name")
                If fath = 1 Then RC("lprice") = dr("billrest") Else RC("lprice") = 0
                tfinal.Rows.Add(RC)
            End While
        Else
            dr2.Close()
            cmd2.CommandText = "select * from v_esl where  yearn='" & YEARN.Text & "' and sdate<>esl_date " & acc & " and sdate between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' "
            dr2 = cmd2.ExecuteReader
            If dr2.HasRows Then
                While dr2.Read
                    FRC = tfinal.Select("esl_no='" & dr2("esl_no") & "' and sdate='" & dr2("sdate") & "'")
                    If FRC.Length > 0 Then
                        RC = FRC(0)
                        RC.BeginEdit()
                        RC("bill") = dr2("bill")
                        RC("btot") = dr2("tot1")
                        RC("sdate") = dr2("sdate")
                        RC("bon") = 0
                        RC("pinc") = 0
                        RC("esl_no") = dr2("esl_no")
                        RC("pname") = "»«ﬁÏ  " & dr2("pname")
                        RC("lprice") = 0
                        RC("tot") = dr2("tot1")
                        RC("company_name") = dr2("company_name")
                        If fath = 1 Then RC("lprice") = dr2("billrest") Else RC("lprice") = 0
                        RC.EndEdit()
                    Else
                        RC = tfinal.NewRow
                        RC("bill") = dr2("bill")
                        RC("btot") = dr2("tot1")
                        RC("sdate") = dr2("sdate")
                        RC("bon") = 0
                        RC("pinc") = 0
                        RC("esl_no") = dr2("esl_no")
                        RC("pname") = "»«ﬁÏ  " & dr2("pname")
                        RC("lprice") = 0
                        RC("tot") = dr2("tot1")
                        RC("company_name") = dr2("company_name")
                        If fath = 1 Then RC("lprice") = dr2("billrest") Else RC("lprice") = 0
                        tfinal.Rows.Add(RC)

                    End If
                End While
            End If
        End If
        'Dim AAA As Integer = 0
        'While Not AAA = tfinal.Rows.Count
        '    RC = tfinal.Rows(AAA)
        '    If IsDBNull(RC("PNAME")) = True Then
        '        RC.Delete()
        '    ElseIf Trim$(RC("PNAME")) = "" Then
        '        RC.Delete()
        '    End If
        '    AAA += 1
        'End While
        RP1.Checked = True
        Dim lab1 As Integer = 0
        Dim laa As Integer = 0
        Dim nnn As Integer = 0
        While Not nnn = temp.Rows.Count
            lab1 = lab1 + temp.Rows(nnn).Item("ptot")
            nnn += 1
        End While
        nnn = 0
        While Not nnn = F31.Rows.Count
            laa = laa + F31.Rows(nnn).Item("eslb")
            nnn += 1
        End While
        'MsgBox(lab1)
        '================================================================
        brpd.DataSource = tfinal
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\gens.rpt")
        oj.Database.Tables(0).SetDataSource(tfinal)
        oj.SetParameterValue("sdt", esl_date.Value)
        If fath = 0 Then oj.SetParameterValue("qw1", lab1) : oj.SetParameterValue("laa", laa)
        If fath = 1 Then
            If mng = 0 Then oj.SetParameterValue("1", 0) Else oj.SetParameterValue("1", 1)
        End If
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()

    End Sub
    
    Private Sub GlassButton103_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        On Error Resume Next
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandText = "select * from lbill where reg_name like'%" & REG_name.Text & "%' and bdel=0 and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' order by esl_date desc"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & COMPANY_name.Text, 0, bran.Text)

        If F31.Rows.Count = 1 Then esl_no.Text = F31.Rows(0).Item("esl_no") : fesl(1, 0)
        fnor(3)
    End Sub

    Private Sub Õ–› Õ·Ì·„‰«Ì’«·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

        dr.Close()
        cmd.CommandText = "delete from lbill_test  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND TEST_name='" & TextBox3.Text & "'"
        cmd.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "delete from lbill_testsub where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND MTEST_name='" & TextBox3.Text & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub GlassButton104_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton104.Click

        f3(1)
    End Sub

    Private Sub GlassButton104_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton104.MouseHover
        llname = "GlassButton104"
    End Sub

    Private Sub GlassButton35_MouseHover1(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton35"
    End Sub



    Private Sub GlassButton106_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        ACdr.Close()
        ACcmd.CommandText = "update test_price set  tot1=0,tot2=0"
        ACcmd.ExecuteNonQuery()
        SUMT()
        fprice(1)
    End Sub

    Private Sub F_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ32.Click
        FILLA("lcomment", "NAME")
    End Sub

    

   



    Private Sub PHToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PHToolStripMenuItem.Click
        ptha()
    End Sub
    Public Sub ptha()
        If pah = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «· «—ÌŒ «·„—÷Ï" & pname.Text, 0, bran.Text)

            Exit Sub
        End If
        Dim yy As String = ""
        Dim rr As String = ""
        Dim ss As String = ""
        If ctest_name.Checked = True Then
            yy = yy & "  " & " and test_name='" & test_name.Text & "'"
            dr.Close()
            cmd.CommandText = "select * from ltest where test_name='" & test_name.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr("cult") = 1 Then
                rr = rptp.Text & "\res cult.rpt"
                ss = "SELECT  * from v_cult where  pcode='" & pcode.Text & "' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' and test_name='" & test_name.Text & "'"
            ElseIf dr("sub") = 1 Then
                rr = rptp.Text & "\res_sub.rpt"
                ss = "SELECT  * from v_sub where  pcode='" & pcode.Text & "' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' and mtest_name='" & test_name.Text & "'"
            Else
                rr = "\hres.rpt"
                ss = "SELECT  * from v_lab where  sub<>1  and cult<>1 and pcode='" & pcode.Text & "' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' " & yy
            End If

        Else
            rr = "\hres.rpt"
            ss = "SELECT  * from v_lab where  sub<>1  and cult<>1 and pcode='" & pcode.Text & "' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' " & yy
        End If
        dr.Close() : cmd.CommandText = ss
        adesl.SelectCommand = cmd
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        DBS.Tables("esl").Clear()
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        brpd.DataSource = esl
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & rr)
        oj.Database.Tables(0).SetDataSource(esl)

        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
        dr.Close()

        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «· «—ÌŒ «·„—÷Ï" & pname.Text, 1, bran.Text)
    End Sub
    Private Sub GlassButton53_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton53.Click
        Dim n1 As String = InputBox("enter password", , "0")
        If n1 <> 5011545 Then Exit Sub
        Dim N As String
        N = ""
        If lng = "AR" Then N = MsgBox(SAVEAR, MsgBoxStyle.YesNo) Else N = MsgBox(SAVEEN, MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub

        dr.Close()
        cmd.CommandText = "select * from lpath where NAME='" & rptp.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            dr.Close() : cmd.CommandText = "insert into lpath  (NAME)  values ('" & rptp.Text & "')"
            cmd.ExecuteNonQuery()
            rptp.Items.Add(rptp.Text)
        End If
    End Sub

    Private Sub GlassButton54_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton54.Click
        Dim n As String = InputBox("enter password", , "0")
        If n <> 5011545 Then Exit Sub
        ACdr.Close()
        ACcmd.CommandText = "update srv set rptp='" & rptp.Text & "'"
        ACcmd.ExecuteNonQuery()
    End Sub

    Private Sub GlassButton110_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton117_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton117.Click
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandType = CommandType.Text
        dr.Close() : cmd.CommandText = "select * from lGrowth_of order by name"
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        Dim v As Integer = 0
        While Not v = brpd.Columns.Count
            brpd.Columns(v).Visible = False
            v = v + 1
        End While
        brpd.Columns("NAME").Visible = True
        brpd.Columns("NAME").Width = 300
        TabControl2.SelectTab(0)
        tm = 22
    End Sub


    Public Sub FILLA(ByVal TB As String, ByVal FL As String)
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandType = CommandType.Text
        dr.Close() : cmd.CommandText = "select * from " & TB & " order by " & FL
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        Dim v As Integer = 0
        While Not v = brpd.Columns.Count
            brpd.Columns(v).Visible = False
            v = v + 1
        End While
        brpd.Columns(FL).Visible = True
        brpd.Columns(FL).Width = 300
        TabControl2.SelectTab(0)
        tm = 22

    End Sub
    Private Sub GlassButton112_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        FILLA("lgover", "gover_name")

    End Sub

    Private Sub GlassButton111_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        FILLA("lnotes", "name")

    End Sub

    Private Sub GlassButton114_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton114.Click
        FILLA("ldoc", "name")
    End Sub

    Private Sub GlassButton113_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton115_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        FILLA("lgr", "name")
    End Sub

    Private Sub GlassButton116_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton116.Click
        FILLA("lgroup", "name")
    End Sub



    Private Sub GlassButton118_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton118.Click
        GlassButton77_Click(GlassButton77, e)
    End Sub



    Private Sub GlassButton122_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub
    Private Sub GlassButton125_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If TabControl1.Height <> 600 Then
            TabControl1.Height = 600
            DTEST_SUB.Height = 600
            DataGridView1.Height = 600
        Else
            TabControl1.Height = 298
            DTEST_SUB.Height = 245
            DataGridView1.Height = 247
        End If

    End Sub


    Private Sub GlassButton105_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton105.Click
        If mng = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— „—«ﬁ»… «·„” Œœ„Ì‰", 0, bran.Text)
            Exit Sub
        End If
        Dim rrr As Process = Process.Start(Application.StartupPath & "\bar.exe")
        Dim yy As String = "where date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' "
        If cuser.Checked = True Then
            yy = yy & " and usr='" & USR & "'"
        End If
        If cesl_no.Checked = True Then
            yy = yy & " and ESL='" & esl_no.Text & "'"
        End If
        If statc.Checked = True Then
            If gr1.Text = "„Õ«Ê·… «Œ —«ﬁ" Then yy = yy & " and gr='0'" Else yy = yy & " and gr='1'"
        End If
        If CTYPE1.Checked = True Then
            yy = yy & " and TYPE='" & TYPE1.Text & "'"
        End If
        If CHR1.Checked = True Then
            yy = yy & " and HR >='" & HR1.Text & "'"
            yy = yy & " and HR <='" & HR2.Text & "'"
        End If
        dr.Close() : cmd.CommandText = "SELECT * FROM  llog    " & yy
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— „—«ﬁ»… «·„” Œœ„Ì‰", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\log.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("1", " ﬁ—Ì— „—«ﬁ»… «·„” Œœ„Ì‰ Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
        rrr.Kill()

    End Sub

    Private Sub GlassButton129_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton129.Click
        Dim n As String = InputBox("enter password", , "0")
        If n <> 5011545 Then Exit Sub
        ACdr.Close()
        Dim aaa As String
        aaa = TwainLib.TwainOperations.GetScanSource
        ACcmd.CommandText = "update srv set scan='" & aaa & "'"
        ACcmd.ExecuteNonQuery()
    End Sub

    Private Sub GlassButton119_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub pb3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles imlis.Click

    End Sub


    Private Sub GlassButton131_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton131.Click
        Try
            SAVERES(0, 0)
            CRES.Checked = True
            dr.Close()
            cmd.CommandText = "update lbill_test set qun=0 WHERE ESL_NO='" & Val(esl_no.Text) & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update lbill_test set qun=1 WHERE ESL_NO='" & Val(esl_no.Text) & "'  and test_name='" & Ntest_NAME.Text & "'"
            cmd.ExecuteNonQuery()
            prof(esl_no.Text, "prnt", 1)
            cmd.CommandText = "update lbill_test set qun=1 WHERE ESL_NO='" & Val(esl_no.Text) & "'"
            cmd.ExecuteNonQuery()
            CRES.Checked = False
            fres()
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub DataGridView1_CellContentClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView1.CellContentClick

    End Sub



    Private Sub CHANGEPASSToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub


    Private Sub GlassButton135_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim N As String = InputBox("«Œ· ﬂ·„… «·”— · ⁄œÌ· «·«”⁄«—")
        If Val(N) <> 5011545 Then Exit Sub
        dr1.Close()
        dr.Close()
        cmd.CommandText = "SELECT * FROM ltest_price WHERE book_price_code=1"
        dr = cmd.ExecuteReader
        While dr.Read
            cmd1.CommandText = "UPDATE ltest_price SET TOT ='" & Val(nulls(dr("AR"))) & "' WHERE book_price_code=2 AND TEST_CODE='" & dr("TEST_CODE") & "'"
            cmd1.ExecuteNonQuery()
            cmd1.CommandText = "UPDATE ltest SET ResultAfter ='" & dr("SO") & "' WHERE  TEST_CODE='" & dr("TEST_CODE") & "'"
            cmd1.ExecuteNonQuery()
        End While
    End Sub

    Private Sub GlassButton136_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton136.Click
        Dim n As String

        If lng = "AR" Then n = MsgBox(EDITAR, MsgBoxStyle.YesNo) Else n = MsgBox(EDITEN, MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "UPDATE LTEST SET notes ='" & comment1.Text & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE Lsubtest SET notes ='" & comment1.Text & "' WHERE MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        fprice1(1)
        LLOG(" ⁄œÌ·", 0, " ⁄œÌ· «· Õ·Ì· " & test.Text, 1, bran.Text)
        MsgBox(" „  ⁄„·Ì… Õ›Ÿ «·ﬂÊ„‰ ", MsgBoxStyle.Information)
    End Sub

    Private Sub GlassButton92_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)

        Dim N As String = MsgBox("Â·  „ ÿ»«⁄… «·‰ ÌÃ… ··„—Ì÷ " & " " & pname.Text, MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "update lbill_test  set prntn=prntn+1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & "and qun=1"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill set sprnt=sprnt+1,printtime='" & ChangeFormatall(Now) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()

    End Sub

    Private Sub GlassButton139_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton139.Click
        dr.Close() : cmd.CommandText = "SELECT  * from V_LIMAGE where PNAME='" & pname.Text & "'  "
        adPVW.SelectCommand = cmd
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        DBS.Tables("PVW").Clear()
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        brpd.DataSource = PVW
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & rptp.Text & "\limage.rpt")
        oj.Database.Tables(0).SetDataSource(PVW)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub GlassButton133_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton133.Click
        'dr.Close()
        'cmd.CommandText = "update lbill set bran ='" & bran.Text & "'"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "update lbill_ESL set bran ='" & bran.Text & "'"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "update lbill_test  set bran ='" & bran.Text & "'"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "update lbill_testsub set bran ='" & bran.Text & "'"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "update LBILL_CULT set bran ='" & bran.Text & "'"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "update LBILL_CULT_DET set bran ='" & bran.Text & "'"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "update lbillemage set bran ='" & bran.Text & "'"
        'cmd.ExecuteNonQuery()





        Dim n As String
        If SV = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("Õ›Ÿ ÃœÌœ", 0, "«·Œ“Ì‰… " & save_name.Text, 0, bran.Text)
            Exit Sub
        End If
        n = ""
        If msga = 1 Then
            If lng = "AR" Then n = MsgBox(SAVEAR & " " & save_name.Text, MsgBoxStyle.YesNo) Else n = MsgBox(SAVEEN & " " & save_name.Text, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
        End If
        If save_name.Text = "" Then Me.Text = "«·—Ã«¡ «· √ﬂœ „‰ «·«·Œ“Ì‰…" : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lsave where   name='" & save_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then Exit Sub
        dr.Close()
        cmd.CommandText = "select max(code) from lsave "
        dr = cmd.ExecuteReader
        dr.Read()
        save_code.Text = 1 + nulls(dr(0))
        dr.Close() : cmd.CommandText = "insert into lsave (name,code)  values ('" & Trim(save_name.Text) & "','" & save_code.Text & "')"
        cmd.ExecuteNonQuery()
        dr.Close()
        save_name.Items.Clear()
        save1_name.Items.Clear()
        cmd.CommandText = "select * from lsave "
        dr = cmd.ExecuteReader
        While dr.Read
            save_name.Items.Add(nulls(dr("name")))
            save1_name.Items.Add(nulls(dr("name")))
        End While
        If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" & " " & save_name.Text Else Me.Text = "IT'S SAVED" & " " & save_name.Text

    End Sub

    Private Sub GlassButton132_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton132.Click
        Dim n As String
        dr.Close()
        cmd.CommandText = "select * from lsave where   name='" & save_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            If ED = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                Exit Sub
            End If
            n = ""
            If msga = 1 Then
                If lng = "AR" Then n = MsgBox(DELAR & " " & save_name.Text, MsgBoxStyle.YesNo) Else n = MsgBox(DEL & " " & save_name.Text, MsgBoxStyle.YesNo)
                If n = vbNo Then Exit Sub
            End If
            dr.Close()
            cmd.CommandText = "delete from lsave where    name='" & save_name.Text & "'"
            cmd.ExecuteNonQuery()
        Else
            LLOG("Õ›Ÿ ÃœÌœ", 0, "«·Œ“Ì‰… " & save_name.Text, 1, bran.Text)
        End If
    End Sub

    Private Sub save_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles save_name.SelectedIndexChanged
        If save_name.Focused = False Then Exit Sub
        If save_name.Text = "" Then Exit Sub
        If ldelg = 0 Then
            dr.Close()
            cmd.CommandText = "select * from lsave where code='" & saven & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                save_code.Text = dr("code")
                save_name.Text = dr("name")
                SSBRAN = dr("BRAN")
            End While
            Exit Sub
        Else
            dr.Close()
            cmd.CommandText = "select * from lsave where name='" & save_name.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                save_code.Text = dr("code")
                SSBRAN = dr("BRAN")
            End While
        End If



    End Sub

    Private Sub save1_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles save1_name.SelectedIndexChanged
        If save1_name.Focused = False Then Exit Sub
        If save1_name.Text = "" Then Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lsave where name='" & save1_name.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            save1_code.Text = dr("code")
            SSBRAN1 = nulls(dr("BRAN"))
        End While
    End Sub

    Private Sub GlassButton140_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qqq3.Click
        If ls = 0 Then Exit Sub
        If saven <> save_code.Text And edt = 0 Then
            msgx.Text = "·« Ì„ﬂ‰ «· ⁄œÌ·"
            Exit Sub
        End If
        If save1_code.Text = "" Or save1_code.Text = "0" Then MsgBox("«Œ «— «·Œ“Ì‰…") : Exit Sub
        If save1_name.Text = "" Or save1_name.Text = "0" Then MsgBox("«Œ «— «·Œ“Ì‰…") : Exit Sub
        If save_code.Text = "" Or save_code.Text = "0" Then MsgBox("«Œ «— «·Œ“Ì‰…") : Exit Sub
        If save_name.Text = "" Or save_name.Text = "0" Then MsgBox("«Œ «— «·Œ“Ì‰…") : Exit Sub
        If SSBRAN1 <> SSBRAN Then MsgBox(" «Œ «— «·Œ“Ì‰… ·‰›” «·›—⁄") : Exit Sub
        dr1.Close()
        dr.Close()
        cmd1.CommandText = "SELECT * FROM LCASH WHERE SAVE_code='" & save_code.Text & "' and date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        dr1 = cmd1.ExecuteReader
        While dr1.Read
            cmd.CommandText = "UPDATE LCASH SET SAVE_NAME='" & save1_name.Text & "',SAVE_CODE='" & save1_code.Text & "' WHERE ID='" & dr1("ID") & "'"
            cmd.ExecuteNonQuery()
        End While
        MsgBox(" „ ⁄„·Ì… «· ÕÊÌ·", MsgBoxStyle.Information)

    End Sub

    Private Sub GlassButton141_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton141.Click
        If ls = 0 Then Exit Sub
        Dim NNN As Double = InputBox("«œŒ· ﬁÌ„… «· ÕÊÌ·")
        dr.Close()
        cmd.CommandText = "select * from lsave where CODE='" & saven & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            save_name.Text = dr("NAME")
        End While
        Dim s2 As Integer = 0

        dr.Close()
        Dim D As Date = Now
        time1.Text = D.Hour.ToString & " : " & D.Minute.ToString
        date1.Text = D.Date.ToShortDateString
        cash.Text = -1 * Val(REST.Text)
        crd.Text = 0
        dr.Close()
        cmd.CommandText = "select * from lsub where sub_code='102'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr("flg") = 1 Then flg.Checked = True Else flg.Checked = False
        main_code.Text = dr("main_code")
        main_name.Text = dr("main_name")
        dr.Close()
        cmd.CommandText = "select * from lsub where sub_code='102'"
        dr = cmd.ExecuteReader
        dr.Read()
        sub_name.Text = dr("sub_name")
        ACdr.Close()
        ACcmd.CommandText = "select * from srv "
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        If ACdr("CASH") > 0 Then
            id.Text = ACdr("CASH")
        End If
        cesl_date.Checked = True
        RP1.Checked = False
        dr.Close()
        cmd.CommandText = "insert into lcash ([main_name],[main_code],[sub_code],[sub_name],[flg],[cash],[crd],[time1],[date1],[id],[notse],usr,shift,SAVE_NAME,SAVE_CODE) values ('" & main_name.Text & " ','" & main_code.Text & "','" & sub_code.Text & "','" & sub_name.Text & "','-1','" & NNN & "','0','" & time1.Text & "','" & ChangeFormat(esl_date.Value) & "','" & id.Text & "','  Õ”«» ÌÊ„  ÕÊÌ·   " & esl_date.Value.Date & "  „‰ «·Œ“Ì‰… " & save_name.Text & "','" & USR & "','" & SHF & "','" & save_name.Text & "','" & save_code.Text & "' )"
        cmd.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "select * from lsub where sub_code='101'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr("flg") = 1 Then flg.Checked = True Else flg.Checked = False
        main_code.Text = dr("main_code")
        main_name.Text = dr("main_name")
        dr.Close()
        cmd.CommandText = "select * from lsub where sub_code='101'"
        dr = cmd.ExecuteReader
        dr.Read()
        sub_name.Text = dr("sub_name")
        dr.Close()
        FCASH1()
        dr.Close()
        cmd.CommandText = "SELECT SUM (PTOT) FROM LBILL WHERE ESL_DATE='" & ChangeFormat(esl_date.Value) & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            dr1.Close()
            cmd1.CommandText = "insert into lcash ([main_name],[main_code],[sub_code],[sub_name],[flg],[cash],[crd],[time1],[date1],[id],[notse],usr,shift,SAVE_NAME,SAVE_CODE) values ('" & main_name.Text & " ','" & main_code.Text & "','" & sub_code.Text & "','" & sub_name.Text & "','1','" & NNN & "','0','" & time1.Text & "','" & ChangeFormat(esl_date.Value) & "','" & id.Text & "','   —ÕÌ· «·Ï «·Œ“Ì‰…     " & save1_name.Text & "','" & USR & "','" & SHF & "','" & save1_name.Text & "','" & save1_code.Text & "' )"
            cmd1.ExecuteNonQuery()
        End While
        If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" Else Me.Text = "IT'S SAVED"

    End Sub

    Private Sub GlassButton142_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL26.Click
        Dim n As String = MsgBox("Â·  —Ìœ «·«”ﬂ«‰— ", MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        ACdr.Close()
        ACcmd.CommandText = "select * from srv "
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        Dim FileNames = TwainLib.ScanImages(esl_no.Text, True, ACdr("scan"))
        'NREF.Text = TwainLib.TwainOperations.GetScanSource
        PictureBox1.ImageLocation = FileNames(0)
        Dim oer As System.IO.FileStream
        Dim rer As IO.StreamReader
        oer = New IO.FileStream(FileNames(0), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
        rer = New IO.StreamReader(oer)
        Dim FileByteArrayr(oer.Length - 1) As Byte
        oer.Read(FileByteArrayr, 0, oer.Length)
        dr.Close()
        Dim Sql As String = "update  lcash set image = ? , no = ? where  id='" & Val(id.Text) & "'"
        cmd.CommandText = Sql
        cmd.Parameters.Clear()
        cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
        cmd.Parameters.Add("@no", System.Data.OleDb.OleDbType.VarChar, 100).Value = oer.Length
        cmd.ExecuteNonQuery()
        Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ"
    End Sub

    Private Sub GlassButton143_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq141.Click
        dr.Close() : cmd.CommandText = "SELECT  * from lcash where id='" & id.Text & "'"
        adPVW.SelectCommand = cmd
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        DBS.Tables("PVW").Clear()
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        brpd.DataSource = PVW
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\limages.rpt")
        oj.Database.Tables(0).SetDataSource(PVW)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub GlassButton144_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton144.Click
        Dim n As String = InputBox("enter password", , "0")
        If n <> 5011545 Then Exit Sub
        ACdr.Close()
        Dim aaa As String = InputBox("enter barcode name")
        ACcmd.CommandText = "update srv set prnt='" & aaa & "'"
        ACcmd.ExecuteNonQuery()
    End Sub

    Private Sub branch_name_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles branch_name.KeyDown
        If e.KeyCode = Keys.Enter Then
            fbranch(1)
            brans = branch_code.Text
        End If
    End Sub

    Private Sub branch_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles branch_name.SelectedIndexChanged
        If branch_name.Focused = False Then Exit Sub
        If branch_name.Text = "" Then Exit Sub
        fbranch(1)

    End Sub



    Private Sub TextBox11_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles TextBox11.KeyDown
        If e.KeyCode = Keys.Enter Then
            If IsNumeric(TextBox11.Text) = True Then
                esl_no.Text = TextBox11.Text
            Else
                dr.Close()
                cmd.CommandText = "select * from  lbill where " & "yearn='" & Val(YEARN.Text) & "' and brans='" & TextBox11.Text & "'" & " and bdel=0"
                dr = cmd.ExecuteReader
                dr.Read()
                If dr.HasRows = True Then
                    esl_no.Text = dr("esl_no")
                End If
            End If
            fesl(1, 0)
        End If
        'If e.KeyCode = Keys.ControlKey Then
        '    dr.Close()
        '    cmd.CommandText = "update lbill set FND=0 where FND=1 AND yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        '    cmd.ExecuteNonQuery()
        '    cmd.CommandText = "update lbill set FND=1 where FND=0 AND ESL_NO='" & Val(TextBox11.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        '    cmd.ExecuteNonQuery()
        '    Shell("NET SEND * PLEASE CHECK THE VISIT PROPLEM")
        'End If
    End Sub

    Private Sub TextBox11_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TextBox11.TextChanged

    End Sub

    Private Sub PrintFinalToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim lres1 As Integer = lres
        Dim lpnum1 As Integer = lpnum
        lpnum = 1
        lres = 1
        ffinal.Checked = True
        finals.Checked = True
        dr.Close()
        ComboBox5.Text = "not print"
        f3(1)
        Dim SS As Integer = 0
        While Not SS = F31.Rows.Count
            F31.Rows(SS).BeginEdit()
            F31.Rows(SS).Item("QUN") = 1
            F31.Rows(SS).BeginEdit()
            dr.Close()
            SS = SS + 1
        End While
        printall()
        ffinal.Checked = False
        finals.Checked = False
        lres = lres1
        lpnum = lpnum1
    End Sub

    Private Sub GlassButton55_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton55.Click
        Dim n As String = InputBox("enter password", , "0")
        If n <> 5011545 Then Exit Sub
        ACdr.Close()
        ACcmd.CommandText = "UPDATE SRV SET branch='" & branch_code.Text & "'"
        ACcmd.ExecuteNonQuery()
        MsgBox(" „   ⁄œÌ· «·›—⁄ ··ÃÂ«“")

    End Sub

    Private Sub GlassButton56_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub PASSWORDToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim N As String = InputBox("«œŒ· «·»”Ê—œ «·ÃœÌœ")
        dr.Close()
        cmd.CommandText = "UPDATE USERS SET PASS='" & N & "' WHERE NAME='" & USR & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub EMAILToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim N As String = InputBox("«œŒ· «·»—Ìœ «·«·ﬂ —Ê‰Ï «·ÃœÌœ")
        dr.Close()
        cmd.CommandText = "UPDATE USERS SET email='" & N & "' WHERE NAME='" & USR & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub LANGToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub YEARN_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles YEARN.SelectedIndexChanged

    End Sub



    Private Sub GRAPHICToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub
    Public Sub TESTREVNG()
        If tc = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì·", 0, bran.Text)
            Exit Sub
        End If

        yyl()
        dr.Close()
        cmd.CommandText = "update lbill_test set t=0"
        cmd.ExecuteNonQuery()
        FRC = BILL.Select("qun='1'")
        Dim t As String = 0
        While Not t = FRC.Length
            RC = FRC(t)
            cmd.CommandText = "update lbill_test set t=1 where test_name='" & RC("test_name") & "'"
            cmd.ExecuteNonQuery()
            t = t + 1
        End While
        If FRC.Length <= 0 Then
            cmd.CommandText = "update lbill_test set t=1"
            cmd.ExecuteNonQuery()
        End If
        dr.Close() : cmd.CommandText = "SELECT     * FROM  v_lab    where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' and bdel=0 and  t=1 " & yy
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì·", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\test tot.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("1", " ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì· Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub
    Public Sub yyl()
        yy = ""
        If cpnik.Checked = True Then
            yy = yy & "  " & " and  pnik='" & PNIK.Text & "'"
        End If
        If cpcode.Checked = True Then
            yy = yy & "  " & " and  pcode='" & pcode.Text & "'"
        End If
        If cptype.Checked = True Then
            yy = yy & "  " & " and  ptype='" & ptype.Text & "'"
        End If
        If cpbrith_date.Checked = True Then
            yy = yy & "  " & " and  pbrith_date='" & ChangeFormat(pbrith_date.Value) & "'"
        End If
        If cpage.Checked = True Then
            yy = yy & "  " & " and  page='" & page.Text & "'"
        End If
        If cpphone.Checked = True Then
            yy = yy & "  " & " and  pphone='" & pphone.Text & "'"
        End If
        If cpmobile.Checked = True Then
            yy = yy & "  " & " and  pmobile='" & pmobile.Text & "'"
        End If
        If cpgover.Checked = True Then
            yy = yy & "  " & " and  pgover='" & pgover.Text & "'"
        End If
        If cpcity.Checked = True Then
            yy = yy & "  " & " and  pcity='" & pcity.Text & "'"
        End If
        If cpstreet.Checked = True Then
            yy = yy & "  " & " and  pstreet='" & pstreet.Text & "'"
        End If
        If cpemail.Checked = True Then
            yy = yy & "  " & " and  pemail='" & pemail.Text & "'"
        End If
        If cpid.Checked = True Then
            yy = yy & "  " & " and  pid='" & pid.Text & "'"
        End If
        If cbook_code.Checked = True Then
            yy = yy & "  " & " and  BOOK_CODE='" & BOOK_CODE.Text & "'"
        End If
        If cf.Checked = True Then
            yy = yy & "  " & " and  cfast='" & Val(cfast.CheckState) & "'"
        End If
        If chrcv.Checked = True Then
            yy = yy & "  " & " and  cfast='" & Val(chrcv.CheckState) & "'"
        End If
        If crcv.Checked = True Then
            yy = yy & "  " & " and  rcv='" & Val(rcv.CheckState) & "'"
        End If
        If crcv_date.Checked = True Then
            yy = yy & "  " & " and  rcv_date='" & ChangeFormat(rcv_date.Value) & "'"
        End If
        If CheckBox4.Checked = True Then
            yy = yy & "  " & " and  rcvn='" & rcvn.Text & "'"
        End If
        If cCOMPANY_CODE.Checked = True Then
            yy = yy & "  " & " and  COMPANY_CODE='" & COMPANY_CODE.Text & "'"
        End If
        If cdoc_code.Checked = True Then
            yy = yy & "  " & " and  DOC_CODE='" & DOC_CODE.Text & "'"
        End If
        If cdepn.Checked = True Then
            yy = yy & "  " & " and  depn='" & depn.Text & "'"
        End If
        If cesl_no.Checked = True Then
            yy = yy & "  " & " and  ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        End If
        If cesl_date.Checked = True Then
            yy = yy & "  " & " and  esl_date='" & ChangeFormat(esl_date.Value) & "'"
        End If
        If creg_code.Checked = True Then
            yy = yy & "  " & " and  REG_CODE='" & REG_CODE.Text & "'"
        End If
        If ccrd_per.Checked = True Then
            yy = yy & "  " & " and  crd_per='" & crd_per.Text & "'"
        End If
        If ccash_per.Checked = True Then
            yy = yy & "  " & " and  cash_per='" & cash_per.Text & "'"
        End If
        If cuser.Checked = True Then
            yy = yy & "  " & " and  usr='" & user.Text & "'"
        End If
        If cshift.Checked = True Then
            yy = yy & "  " & " and  shift='" & shift.Text & "'"
        End If
        If ccash_v.Checked = True Then
            yy = yy & "  " & " and  cash_v='" & cash_v.Text & "'"
        End If
        If ccrd_v.Checked = True Then
            yy = yy & "  " & " and  crd_v='" & crd_v.Text & "'"
        End If
        If cbon.Checked = True Then
            yy = yy & "  " & " and  bon='" & bon.Text & "'"
        End If
        If cpay.Checked = True Then
            yy = yy & "  " & " and  PAY='" & PAY.Text & "'"
        End If
        If crest.Checked = True Then
            yy = yy & "  " & " and  REST='" & REST.Text & "'"
        End If

        If ctot.Checked = True Then
            yy = yy & "  " & " and  TOT='" & TOT.Text & "'"
        End If

        If cdiss.Checked = True Then
            yy = yy & "  " & " and  diss='" & DISS.Text & "'"
        End If
    End Sub

    Public Sub testg()
        If tc = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì·", 0, bran.Text)
            Exit Sub
        End If
        yy = ""

        dr.Close()
        cmd.CommandText = "update lbill_test set t=0"
        cmd.ExecuteNonQuery()
        FRC = BILL.Select("qun='1'")
        Dim t As String = 0
        While Not t = FRC.Length
            RC = FRC(t)
            cmd.CommandText = "update lbill_test set t=1 where test_name='" & RC("test_name") & "'"
            cmd.ExecuteNonQuery()
            t = t + 1
        End While
        If FRC.Length <= 0 Then
            cmd.CommandText = "update lbill_test set t=1"
            cmd.ExecuteNonQuery()
        End If
        dr.Close() : cmd.CommandText = "SELECT     * FROM  v_lab    where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' and bdel=0 and  t=1 " & yy
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì·", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\test ups.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("1", " ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì· Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub
    Private Sub NUMBERToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub
    Public Sub TESTREVN()
        If tv = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì·", 0, bran.Text)

            Exit Sub
        End If
        yyl()
        dr.Close()
        cmd.CommandText = "update lbill_test set t=0"
        cmd.ExecuteNonQuery()
        FRC = BILL.Select("qun='1'")
        Dim t As String = 0
        While Not t = FRC.Length
            RC = FRC(t)
            cmd.CommandText = "update lbill_test set t=1 where test_name='" & RC("test_name") & "'"
            cmd.ExecuteNonQuery()
            t = t + 1
        End While
        If FRC.Length <= 0 Then
            cmd.CommandText = "update lbill_test set t=1"
            cmd.ExecuteNonQuery()
        End If
        dr.Close() : cmd.CommandText = "SELECT     test_name,SUM(TEST_PRICE)as qun FROM  v_lab    where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' and bdel=0 and t=1 " & yy & " group by test_name"
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì·", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\test up.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("1", " ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì· Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub
    Private Sub GRAPHICToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub
    Public Sub dayrevng()
        If dc = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «Õ’«∆Ì«  «·«Ì—«œ", 0, bran.Text)
            Exit Sub
        End If
        dr.Close()
        cmd.CommandText = "update lbill set totv=tot-diss "
        cmd.ExecuteNonQuery()
        yyl()
        dr.Close() : cmd.CommandText = "SELECT     * FROM  lbill    where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' and bdel=0 " & yy
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «Õ’«∆Ì«  «·«Ì—«œ", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\day up.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("1", " ﬁ—Ì— «Õ’«∆Ì«  «·«Ì—«œ «·ÌÊ„Ï Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()

    End Sub
    Private Sub GlassButton56_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq62.Click
        PATHO.tar.Text = lrr.Text
        PATHO.Show()

    End Sub

    Private Sub Label105_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Label105.Click

    End Sub

    Private Sub csave_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles csave.CheckedChanged

    End Sub

    Private Sub GlassButton58_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton58.Click
        dr.Close()
        Dim nn As String = MsgBox("Â·  „ ”Õ» ⁄Ì‰… «·„—Ì÷" & Environment.NewLine & pname.Text, MsgBoxStyle.YesNo)
        If nn = vbNo Then Exit Sub
        cmd.CommandText = "update lbill set sampl=1,sampldate='" & ChangeFormatall(Now) & "',samplusr='" & USR & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()

    End Sub

    Private Sub GlassButton58_MouseHover1(ByVal sender As Object, ByVal e As System.EventArgs) Handles GlassButton58.MouseHover
        llname = "GlassButton58"

    End Sub

    Private Sub GlassButton103_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)
        llname = "GlassButton59"

    End Sub

    Private Sub GlassButton134_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        ListBox1.Visible = Not ListBox1.Visible
        If ListBox1.Visible = True Then
            ListBox1.Items.Clear()
            Dim TAS As String = ""
            If CBRAN.Checked = True Then TAS = " and bran='" & bran.Text & "'"
            dr.Close()
            cmd.CommandText = "select * from Lbill WHERE ESL_DATE='" & ChangeFormat(Now.Date) & "' and  SAMPL=0 AND bdel=0 " & TAS
            dr = cmd.ExecuteReader
            While dr.Read
                ListBox1.Items.Add(dr("PNAME"))
            End While
        End If
    End Sub

    Private Sub ListBox1_MouseClick(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles ListBox1.MouseClick
        Dim AA As String = MsgBox("Â·  —Ìœ «Œ Ì«— «·„—Ì÷" & Environment.NewLine & ListBox1.Text, MsgBoxStyle.YesNo)
        If AA = vbNo Then Exit Sub
        Shell("NET SEND " & RECEP & " " & ListBox1.Text)
    End Sub

    Private Sub ListBox1_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ListBox1.SelectedIndexChanged

    End Sub

    Private Sub GlassButton145_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        dr.Close()
        cmd.CommandText = "SELECT * FROM lbill  where FND=1  and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            esl_no.Text = dr("esl_no")
        End While
        fesl(0, 0)

    End Sub

    Private Sub GlassButton146_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim AA As String = InputBox("enter chat")
        Shell("NET SEND * " & AA)
    End Sub

    Private Sub GlassButton147_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq25.Click
        
        FPESL("esl")
    End Sub
    Public Sub FPESL(ByVal rpt As String)
        Try
            If prnt = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG("ÿ»«⁄…", esl_no.Text, " ÿ»«⁄… «Ì’«· " & pname.Text, 0, bran.Text)
                Exit Sub
            End If

            Dim n As Int16 = 0
            esla = 0
            dr.Close()
            DBS.Tables("esl").Clear()
            cmdesl.Parameters.Clear()
            cmdesl.CommandText = "pesl"
            cmdesl.CommandType = CommandType.StoredProcedure
            cmdesl.Parameters.AddWithValue("esl_no", Val(esl_no.Text))
            cmdesl.Parameters.AddWithValue("yearn", Val(YEARN.Text))
            cmdesl.Parameters.AddWithValue("bran", bran.Text)
            adesl.SelectCommand = cmdesl
            adesl.Fill(DBS, "esl")
            Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
            oj.Load(Application.StartupPath & rptp.Text & "\" & rpt & ".rpt")
            oj.Database.Tables(0).SetDataSource(DBS.Tables("esl"))
            oj.SetParameterValue("a", esla)
            rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
            If vv.Checked = True Then rp.Show() : rp.Focus() Else oj.PrintToPrinter(1, False, 0, 0)
            LLOG("ÿ»«⁄…", esl_no.Text, " ÿ»«⁄… «Ì’«· " & pname.Text, 1, bran.Text)
        Catch ex As Exception
            Dim st1 As String = "PRINT BILL"
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try

    End Sub
    Private Sub GlassButton148_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq27.Click
        FSCAN()
    End Sub
   
    Public Sub UPDATEBILL()
        Try
            If lp = 1 Then
                esl_cash(3)
                ACdr.Close()
                ACcmd.CommandText = "SELECT sum(tot),sum(erbank) FROM esl  "
                ACdr = ACcmd.ExecuteReader
                ACdr.Read()
                BANK.Text = nulls(ACdr(1))
                PAY.Text = nulls(ACdr(0))
                dr.Close()
                cmd.CommandText = "update lbill set bank='" & Val(BANK.Text) & "', pay='" & Val(PAY.Text) & "', rest='" & Val(REST.Text) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                cmd.ExecuteNonQuery()
                fesl(0, 0)
            End If
        Catch ex As Exception
            Dim st1 As String = "UPDATE BILL"
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
    Private Sub ChangeDisscountToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim s As String = MsgBox("Â·  —Ìœ  ⁄œÌ· «·‰”»… ø", MsgBoxStyle.YesNo)
        If s = vbNo Then Exit Sub
        Dim l As Integer = InputBox("«œŒ· ﬁÌ„… «·Œ’„")
        If mng = 0 Then Me.Text = "·«  ÊÃœ ’·«ÕÌÂ"
        dr.Close()
        cmd.CommandText = "update branch set dis='" & l & "'  where  name='" & branch_name.Text & "'"
        cmd.ExecuteNonQuery()
    End Sub

    

    Private Sub s12_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles s12.TextChanged

    End Sub

    Private Sub  €Ì—«· —ÕÌ·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If mng = 1 Then

            dr.Close()
            cmd.CommandText = "update lbill set trl=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update lbill_ESL set trl=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update lbill_test set trl=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
            cmd.ExecuteNonQuery()
        End If
    End Sub

    Private Sub DataGridView1_CellEnter(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView1.CellEnter

    End Sub

    Private Sub GlassButton92_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton92.Click
        'OpenFileDialog1.ShowDialog()

        'Dim AAQ As New Microsoft.Office.Interop.Word.Application
        'AAQ.Visible = True
        'AAQ.Documents.Open(OpenFileDialog1.FileName, , , True)
        'filePath = OpenFileDialog1.FileName
        'filename = OpenFileDialog1.SafeFileName

    End Sub

    Private Sub GlassButton149_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton149.Click
        'Dim fs As IO.FileStream = New IO.FileStream(filePath, IO.FileMode.Open, IO.FileAccess.Read)
        'Dim br As IO.BinaryReader = New IO.BinaryReader(fs)
        'Dim bytes As Byte() = br.ReadBytes(Convert.ToInt32(fs.Length))
        'br.Close()
        'fs.Close()
        'dr.Close()
        'cmd.CommandText = "insert into lbill_docs(docs, docsp,esl_no,yearn,bran) values (?, ?,'" & Val(esl_no.Text) & "','" & esl_date.Value.Year & "' ,'" & bran.Text & "')"
        'cmd.Parameters.Clear()
        'cmd.Parameters.Add("@docs", SqlDbType.Binary).Value = bytes
        'cmd.Parameters.Add("@docsp", SqlDbType.VarChar).Value = filename
        'cmd.ExecuteNonQuery()
        ''======================================

    End Sub

    Private Sub GlassButton150_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton150.Click
        IO.Directory.CreateDirectory("C:\ASIL")
        For Each foundFile As String In My.Computer.FileSystem.GetFiles("C:\ASIL", FileIO.SearchOption.SearchAllSubDirectories, "*.*")
            IO.File.Delete(foundFile)
        Next
        Dim MyData() As Byte
        dr.Close()
        cmd.CommandText = "select * from lbill_docs WHERE ESL_NO='" & Val(esl_no.Text) & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            MyData = dr("docs")
            Dim K As Long
            K = UBound(MyData)
            Dim fs1 As New IO.FileStream("C:\ASIL\" & dr("docsp"), IO.FileMode.OpenOrCreate, IO.FileAccess.Write)
            fs1.Write(MyData, 0, K)
            fs1.Close()
            fs1 = Nothing
        End While
        Process.Start("explorer.exe", "C:\ASIL")
    End Sub

    Private Sub GlassButton151_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        XXRAY.Show()

    End Sub

    Private Sub GlassButton67_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If COMPANY_name.Text = "" Then Exit Sub

        fcompany(1)
    End Sub

    Private Sub GlassButton154_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If REG_name.Text = "" Then Me.Text = "«Œ «— «·ÃÂ… " : Exit Sub
        If ldref = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("Õ–›", 0, "ÃÂ… " & REG_name.Text, 0, bran.Text)
            Exit Sub
        End If
        dr.Close()
        cmd.CommandText = "select * from lcompany where name='" & Trim(REG_name.Text) & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            Dim nn As String
            If msga = 1 Then
                nn = MsgBox(DELEN & " " & REG_name.Text, MsgBoxStyle.YesNo)
                If nn = vbNo Then Exit Sub
            End If
            dr.Close()
            Dim n As String = 0
            dr.Close()
            cmd.CommandText = "delete  from lcompany   where name='" & Trim(REG_name.Text) & "'"
            cmd.ExecuteNonQuery()
            If msga = 1 Then
                Me.Text = "it's deleted" & " " & REG_name.Text
            End If
            LLOG("Õ–›", 0, "ÃÂ… " & REG_name.Text, 1, bran.Text)
        End If

    End Sub

    Private Sub GlassButton25_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim N As String
        N = ""
        If msga = 1 Then
            If lng = "AR" Then N = MsgBox(SAVEAR, MsgBoxStyle.YesNo) Else N = MsgBox(SAVEEN, MsgBoxStyle.YesNo)
            If N = vbNo Then Exit Sub
        End If
        dr.Close()
        cmd.CommandText = "select * from ltype where NAME='" & PNIK.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = False Then
            dr.Close() : cmd.CommandText = "insert into ltype  (sNAME,name)  values ('" & Trim(PNIK.Text) & "','" & Trim(ptype.Text) & "')"
            cmd.ExecuteNonQuery()
            PNIK.Items.Add(PNIK.Text)
            If msga = 1 Then
                Me.Text = "it's saved"
            End If
            LLOG("Õ›Ÿ ÃœÌœ", 0, "Õ›Ÿ ·ﬁ» ÃœÌœ", 1, bran.Text)
        End If

    End Sub

    Private Sub GlassButton18_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim n As String
        If lng = "AR" Then n = MsgBox(DELAR, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN, MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub

        dr.Close()
        cmd.CommandText = "select * from ltype where sNAME='" & PNIK.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = True Then
            dr.Close() : cmd.CommandText = "delete from ltype where sNAME='" & PNIK.Text & "'"
            cmd.ExecuteNonQuery()
            PNIK.Items.Remove(PNIK.Text)
            Me.Text = "it's deleted"
            LLOG("Õ–›", 0, "Õ–› ·ﬁ»", 1, bran.Text)

        End If
    End Sub

    Private Sub GlassButton66_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If pcode.Text = "" Then Exit Sub
        If DEL = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("Õ–›", 0, "„—Ì÷  " & pcode.Text, 0, bran.Text)
            Exit Sub
        End If
        Dim n As String
        If msga = 1 Then
            If lng = "AR" Then n = MsgBox(DELAR & " " & pname.Text, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN & " " & pname.Text, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
        End If
        If pcode.Text = "" Then Me.Text = "«·—Ã«¡ «· √ﬂœ „‰ „—Ì÷" : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from LPATIEN where   pcode='" & pcode.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            dr.Close()
            cmd.CommandText = "delete from LPATIEN where    pcode='" & pcode.Text & "'"
            cmd.ExecuteNonQuery()
        End If
        dr.Close()
        pname.AutoCompleteCustomSource.Remove(pname.Text)

        LLOG("Õ–›", 0, " „—Ì÷  " & pcode.Text, 1, bran.Text)
    End Sub

    Private Sub GlassButton83_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)
        PSAVE()
    End Sub

    Private Sub GlassButton155_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim CN, RN As String
MM:
        dr.Close()
        cmd.CommandText = "SELECT * FROM lcompany WHERE NAME='" & REG_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            REG_name.Text = dr("NAME")
            REG_CODE.Text = dr("CODE")
            If Val("diss") > 0 Then dissn.Text = dr("diss")
        Else
            CN = COMPANY_name.Text
            RN = REG_name.Text
            COMPANY_name.Text = REG_name.Text
            fcompany(1)
            COMPANY_name.Text = CN
            fcompany(1)
            REG_name.Text = RN
            GoTo MM
        End If
    End Sub

    Private Sub QQ10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If lnotes.Text = "" Then Exit Sub
        If DEL = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("Õ–›", 0, "„·«ÕŸ… " & lnotes.Text, 0, bran.Text)
            Exit Sub
        End If
        Dim n As String
        If msga = 1 Then
            If lng = "AR" Then n = MsgBox(DELAR & " " & lnotes.Text, MsgBoxStyle.YesNo) Else n = MsgBox(DELEN & " " & lnotes.Text, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
        End If
        If lnotes.Text = "" Then Me.Text = "«·—Ã«¡ «· √ﬂœ „‰ «·„·«ÃŸ…" : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lnotes where   name='" & lnotes.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            dr.Close()
            cmd.CommandText = "delete from lnotes where    name='" & lnotes.Text & "'"
            cmd.ExecuteNonQuery()
        End If
        dr.Close()
        lnotes.Items.Clear()
        cmd.CommandText = "select * from lnotes "
        dr = cmd.ExecuteReader
        While dr.Read
            lnotes.Items.Add(dr("name"))
        End While
        LLOG("Õ–›", 0, "„·«ÕŸ… " & lnotes.Text, 1, bran.Text)
    End Sub

    Private Sub GlassButton16_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub QQ9_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim n As String
        If SV = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("Õ›Ÿ ÃœÌœ", 0, "„·«ÕŸ… " & lnotes.Text, 0, bran.Text)
            Exit Sub
        End If
        n = ""
        If msga = 1 Then
            If lng = "AR" Then n = MsgBox(SAVEAR & " " & lnotes.Text, MsgBoxStyle.YesNo) Else n = MsgBox(SAVEEN & " " & lnotes.Text, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
        End If
        If lnotes.Text = "" Then Me.Text = "«·—Ã«¡ «· √ﬂœ „‰ «·„·«ÕŸ…" : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lnotes where   name='" & lnotes.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            If ED = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                Exit Sub
            End If
            n = ""
            If msga = 1 Then
                If lng = "AR" Then n = MsgBox(EDITAR & " " & lnotes.Text, MsgBoxStyle.YesNo) Else n = MsgBox(EDITEN & " " & lnotes.Text, MsgBoxStyle.YesNo)
                If n = vbNo Then Exit Sub
            End If
            dr.Close()
            cmd.CommandText = "delete from lnotes where    name='" & lnotes.Text & "'"
            cmd.ExecuteNonQuery()
        Else
            LLOG("Õ›Ÿ ÃœÌœ", 0, "„·«ÕŸ… " & lnotes.Text, 1, bran.Text)
        End If

        dr.Close() : cmd.CommandText = "insert into lnotes (name)  values ('" & Trim(lnotes.Text) & "')"
        cmd.ExecuteNonQuery()
        lnotes.Items.Clear()

        cmd.CommandText = "select * from lnotes "
        dr = cmd.ExecuteReader
        While dr.Read
            lnotes.Items.Add(dr("name"))
        End While
        If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" & " " & lnotes.Text Else Me.Text = "IT'S SAVED" & " " & lnotes.Text

    End Sub

    Private Sub QQ11_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub QQ5_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If COMPANY_name.Text = "" Then Me.Text = "«Œ «— «·ÃÂ… " : Exit Sub
        If ldref = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("Õ–›", 0, "ÃÂ… " & COMPANY_name.Text, 0, bran.Text)
            Exit Sub
        End If

        dr.Close()
        cmd.CommandText = "select * from lcompany where name='" & Trim(COMPANY_name.Text) & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            Dim nn As String
            If msga = 1 Then
                nn = MsgBox(DELEN & " " & COMPANY_name.Text, MsgBoxStyle.YesNo)
                If nn = vbNo Then Exit Sub
            End If
            dr.Close()
            Dim n As String = 0
            dr.Close()
            cmd.CommandText = "delete  from lcompany   where name='" & Trim(COMPANY_name.Text) & "'"
            cmd.ExecuteNonQuery()
            If msga = 1 Then
                Me.Text = "it's deleted" & " " & COMPANY_name.Text
            End If
            LLOG("Õ–›", 0, "ÃÂ… " & COMPANY_name.Text, 1, bran.Text)

        End If
    End Sub

    Private Sub QQ12_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Try

        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub QQ15_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub QQ13_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        On Error Resume Next
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandText = "select * from lbill where pmobile like'%" & pmobile.Text & "%' and bdel=0 and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & pname.Text, 0, bran.Text)
        If F31.Rows.Count = 1 Then esl_no.Text = F31.Rows(0).Item("esl_no") : fesl(1, 0)

        fnor(3)
    End Sub

    Private Sub qq48_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq48.Click
        Dim n As String
        n = MsgBox("Â·  —Ìœ  ⁄œÌ· »Ì«‰«  «· Õ·Ì· ", MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close()
        ACdr.Close()
        cmd.CommandText = "select * from ltest where test_code='" & Ntest_CODE.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        Dim oldt As String = dr("test_name")
        dr.Close()
        cmd.CommandText = "UPDATE LBILL_TEST SET test_NAME ='" & Trim(Ntest_NAME.Text) & "',cult ='" & Val(cult.CheckState) & "',sub ='" & Val(sub2.CheckState) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LBILL_TESTsub SET mtest_NAME ='" & Trim(Ntest_NAME.Text) & "' WHERE MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE Lsubtest SET mtest_NAME ='" & Trim(Ntest_NAME.Text) & "' WHERE MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LnsTEST SET mtest_NAME ='" & Trim(Ntest_NAME.Text) & "' WHERE MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LsubTEST SET mtest_NAME ='" & Trim(Ntest_NAME.Text) & "' WHERE MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE Ltest_price SET test_NAME ='" & Trim(Ntest_NAME.Text) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE lntest SET test_NAME ='" & Trim(Ntest_NAME.Text) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LTEST SET GR_NAME='" & Trim(GRNAME.Text) & "',gname='" & Trim(smain.Text) & "',ResultAfter ='" & Val(ResultAfter.Text) & "',cult ='" & Val(cult.CheckState) & "',sub ='" & Val(sub2.CheckState) & "',LAB ='" & Val(lab2.CheckState) & "',test_NAME ='" & Trim(Ntest_NAME.Text) & "',short ='" & Trim(shrt.Text) & "',KID_TYPE='" & KID_TYPE.Text & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE Ltest_price SET tot ='" & Val(price1.Text) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "' and book_price_code='1'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE Ltest_price SET tot ='" & Val(prc2.Text) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "' and book_price_code='2'"
        cmd.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "update lbill set test = replace(test, '" & oldt & "', '" & Ntest_NAME.Text & "') where test like '%" & oldt & "%'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LBILL_TEST SET GNAME ='" & smain.Text & "',GR_NAME ='" & GRNAME.Text & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        LLOG(" ⁄œÌ·", 0, " ⁄œÌ· «· Õ·Ì· " & Ntest_NAME.Text, 1, bran.Text)

        fprice1(1)
        MsgBox(" „  ⁄„·Ì… «· ⁄œÌ·")
    End Sub


    Private Sub nname_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs)
        flng("AR")
    End Sub

    Private Sub nname_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)


    End Sub

    Private Sub nname_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub smain_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles smain.KeyDown

    End Sub

    Private Sub smain_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles smain.SelectedIndexChanged
        If smain.Focus = False Then Exit Sub
        If smain.Text = "" Then Exit Sub
        cmdBILL.CommandText = "select * from TEST_PRICE WHERE GNAME='" & smain.Text & "' order by so"
        adBILL.SelectCommand = cmdBILL
        adBILL.Fill(DBS, "BILL")
        BILL = DBS.Tables("BILL")
        DBS.Tables("BILL").Clear()
        adBILL.Fill(DBS, "BILL")
        BILL = DBS.Tables("BILL")
        btestd.DataSource = BILL
    End Sub

    Private Sub qq95_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq95.Click
        Dim N As String
        N = MsgBox("Â·  —Ìœ Õ–›ø", MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "delete from lgtest  WHERE  NAME='" & smain.Text & "'"
        cmd.ExecuteNonQuery()
        LLOG("Õ–›", 0, "«·„Ã„Ê⁄… " & smain.Text, 1, bran.Text)
        GRNAME.Items.Remove(smain.Text)
        smain.Items.Remove(smain.Text)
    End Sub

    Private Sub qq94_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq94.Click
        Dim N As String
        If smain.Text = "" Then Me.Text = "«Œ «— «·„Ã„Ê⁄…" : Exit Sub
        N = MsgBox("Â·  —Ìœ «· ⁄œÌ·ø" & " " & smain.Text, MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub
        dr.Close()
        Dim M As Integer
        cmd.CommandText = "SELECT * FROM lgtest WHERE NAME='" & smain.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            M = dr("CODE")
        Else
            N = ""
            N = MsgBox(" Â·  —Ìœ «·Õ›Ÿ ø" & " " & smain.Text, MsgBoxStyle.YesNo)
            If N = vbNo Then Exit Sub
            dr.Close() : cmd.CommandText = "select MAx(code) from lgtest "
            dr = cmd.ExecuteReader
            dr.Read()
            M = 1 + nulls(dr(0))
            dr.Close() : cmd.CommandText = "insert into lgtest (code,name,st)  values ('" & M & "','" & Trim(smain.Text) & "','1')"
            cmd.ExecuteNonQuery()
        End If
        LLOG(" ⁄œÌ·", 0, "«·„Ã„Ê⁄… " & smain.Text, 1, bran.Text)

        ACdr.Close()
        ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun>0 "
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            cmd.CommandText = "UPDATE LTEST SET gname='" & Trim(smain.Text) & "' ,gcode='" & M & "'  WHERE  TEST_NAME='" & ACdr("TEST_NAME") & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "UPDATE LBILL_TEST SET GNAME ='" & smain.Text & "' WHERE TEST_CODE='" & ACdr("TEST_CODE") & "'"
            cmd.ExecuteNonQuery()
        End While

        fprice1(1)
        If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" & " " & smain.Text Else Me.Text = "IT'S SAVED" & " " & smain.Text

    End Sub


    Private Sub GlassButton2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq103.Click
        If part_code.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— ·⁄Ì«œ…", MsgBoxStyle.Information) : Exit Sub
        If DWEEK.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— «·ÌÊ„", MsgBoxStyle.Information) : Exit Sub
        'If docs_code.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— «·ÿ»Ì»", MsgBoxStyle.Information) : Exit Sub
        Dim CN, RN As String
MM:
        dr.Close()
        cmd.CommandText = "SELECT * FROM lcompany WHERE NAME='" & docs_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            docs_name.Text = dr("NAME")
            docs_code.Text = dr("CODE")
            If Val("diss") > 0 Then dissn.Text = dr("diss")
        Else
            CN = COMPANY_name.Text
            RN = docs_name.Text
            COMPANY_name.Text = docs_name.Text
            fcompany(1)
            COMPANY_name.Text = CN
            fcompany(1)
            docs_name.Text = RN
            GoTo MM
        End If
        dr.Close()
        cmd.CommandText = "update lcompany set doc=1 WHERE NAME='" & docs_name.Text & "'"
        cmd.ExecuteNonQuery()
        Dim x As Date = d1.Value
        Dim m As String = ""
        Dim ma As Integer = ComboBox8.Text
        While Not ma > ComboBox7.Text
            m = m & " , h" & ma & "='" & docs_code.Text & "'"
            ma += 1
        End While

        While Not d1.Value >= d2.Value
            d1.Value = d1.Value.AddDays(7)
            dr.Close()
            cmd.CommandText = "select * from lresv where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "' AND ds>0 and (d1='" & docs_code.Text & "' or d2='" & docs_code.Text & "' or d3='" & docs_code.Text & "' or d4='" & docs_code.Text & "')"
            dr = cmd.ExecuteReader
            If dr.HasRows = True Then
                dr.Close()
                cmd.CommandText = "update lresv set sdate='" & ChangeFormat(d1.Value) & "'" & m & "  where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "'"
                cmd.ExecuteNonQuery()
                GoTo mmb

            Else
                dr.Close()
                cmd.CommandText = "update lresv set d1='" & docs_code.Text & "' " & m & " , ds=1 where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "' and ds=0 "
                ma = cmd.ExecuteNonQuery()
                If ma > 0 Then GoTo mmb
                cmd.CommandText = "update lresv set d2='" & docs_code.Text & "' " & m & " , ds=2 where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "' and ds=1 "
                ma = cmd.ExecuteNonQuery()
                If ma > 0 Then GoTo mmb
                cmd.CommandText = "update lresv set d3='" & docs_code.Text & "' " & m & " , ds=3 where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "' and ds=2 "
                ma = cmd.ExecuteNonQuery()
                If ma > 0 Then GoTo mmb
                cmd.CommandText = "update lresv set d4='" & docs_code.Text & "' " & m & " , ds=4 where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "' and ds=3 "
                ma = cmd.ExecuteNonQuery()
                If ma > 0 Then GoTo mmb
            End If


mmb:
        End While
        d1.Value = x
        MsgBox(" „  ⁄„·Ì… Õ›Ÿ ÃœÊ· «·ÿ»Ì»", MsgBoxStyle.Information)
    End Sub

    Private Sub GlassButton2_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq105.Click
        If part_name.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— ·⁄Ì«œ…", MsgBoxStyle.Information) : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lresv where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "'"
        dr = cmd.ExecuteReader

        dr.Read()
        dr1.Close()
        Dim x As Date = d1.Value
        While Not d1.Value >= d2.Value
            d1.Value = d1.Value.AddDays(1)
            Dim sse As String = ""
            Select Case d1.Value.DayOfWeek
                Case DayOfWeek.Friday
                    sse = "«·Ã„⁄…"
                Case DayOfWeek.Saturday
                    sse = "«·”» "
                Case DayOfWeek.Sunday
                    sse = "«·«Õœ"
                Case DayOfWeek.Monday
                    sse = "«·«À‰Ì‰"
                Case DayOfWeek.Tuesday
                    sse = "«·À·«À«¡"
                Case DayOfWeek.Wednesday
                    sse = "«·«—»⁄«¡"
                Case DayOfWeek.Thursday
                    sse = "«·Œ„Ì”"
            End Select
            cmd1.CommandText = "insert into  lresv  (part_name,part_code,day_week,sdate)  values ('" & part_name.Text & "','" & part_code.Text & "','" & sse & "','" & ChangeFormat(d1.Value) & "')"
            cmd1.ExecuteNonQuery()
            dr.Read()
        End While

        d1.Value = x
        MsgBox(" „  ⁄„·Ì… Õ›Ÿ ÃœÊ· «·⁄Ì«œÂ", MsgBoxStyle.Information)
    End Sub

    Private Sub part_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles part_name.SelectedIndexChanged
        If part_name.Focus = False Then Exit Sub
        If part_name.Text = "" Then Exit Sub
        dr.Close()
        cmd.CommandText = "SELECT * FROM lgtest WHERE NAME='" & part_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            part_code.Text = dr("CODE")
        End If
    End Sub

    Private Sub qq109_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq109.Click
        If part_code.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— ·⁄Ì«œ…", MsgBoxStyle.Information) : Exit Sub
        If DWEEK.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— «·ÌÊ„", MsgBoxStyle.Information) : Exit Sub
        Dim CN, RN As String
MM:
        dr.Close()
        cmd.CommandText = "SELECT * FROM lcompany WHERE NAME='" & docs_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            docs_name.Text = dr("NAME")
            docs_code.Text = dr("CODE")
            If Val("diss") > 0 Then dissn.Text = dr("diss")
        Else
            CN = COMPANY_name.Text
            RN = docs_name.Text
            COMPANY_name.Text = docs_name.Text
            fcompany(1)
            COMPANY_name.Text = CN
            fcompany(1)
            docs_name.Text = RN
            GoTo MM
        End If
        dr.Close()
        cmd.CommandText = "update lcompany set doc=1 WHERE NAME='" & docs_name.Text & "'"
        cmd.ExecuteNonQuery()
        Dim x As Date = d1.Value
        Dim m As String = ""
        Dim ma As Integer = ComboBox8.Text
        While Not ma > ComboBox7.Text
            m = m & " , h" & ma & "='0'"
            ma += 1
        End While
        While Not d1.Value >= d2.Value
            d1.Value = d1.Value.AddDays(7)
            dr.Close()
            cmd.CommandText = "update lresv set ds=ds-1 , sdate='" & ChangeFormat(d1.Value) & "'" & m & "  where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "'"
            cmd.ExecuteNonQuery()
            dr.Close()
            cmd.CommandText = "update lresv set d1=d2,d2=d3,d3=d4,d4=0  where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "' and d1='" & docs_code.Text & "'"
            ma = cmd.ExecuteNonQuery()
            If ma > 0 Then GoTo mmb
            cmd.CommandText = "update lresv set d2=d3,d3=d4,d4=0  where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "' and d2='" & docs_code.Text & "'"
            ma = cmd.ExecuteNonQuery()
            If ma > 0 Then GoTo mmb
            cmd.CommandText = "update lresv set d3=d4,d4=0  where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "' and d3='" & docs_code.Text & "'"
            ma = cmd.ExecuteNonQuery()
            If ma > 0 Then GoTo mmb
            cmd.CommandText = "update lresv set d4=0  where sdate='" & ChangeFormat(d1.Value) & "' AND part_name='" & part_name.Text & "' and d4='" & docs_code.Text & "'"
            ma = cmd.ExecuteNonQuery()
            If ma > 0 Then GoTo mmb
mmb:
        End While
        d1.Value = x
        MsgBox(" „  ⁄„·Ì… Õ–› ÃœÊ· «·ÿ»Ì»", MsgBoxStyle.Information)
    End Sub


    Private Sub qq112_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq112.Click
        dr1.Close()
        cmd1.CommandText = "update lbill set st=0 where  " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd1.ExecuteNonQuery()
        cmd1.CommandText = "update lbill_ESL set st=0 where  " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd1.ExecuteNonQuery()
        cmd1.CommandText = "update lbill_test set st=0  where  " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd1.ExecuteNonQuery()
        cmd1.CommandText = "update lbill_testsub set st=0 where  " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd1.ExecuteNonQuery()
        cmd1.CommandText = "update LBILL_CULT set st=0 where  " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd1.ExecuteNonQuery()
        cmd1.CommandText = "update LBILL_CULT_DET set st=0 where  " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd1.ExecuteNonQuery()
        cmd1.CommandText = "update LPATIEN set st=0 "
        cmd1.ExecuteNonQuery()
    End Sub

    Private Sub qq24_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq24.Click
        ctest.Checked = True
        test.Text = TextBox3.Text
        f3(1)
        ctest.Checked = False

    End Sub

    Private Sub GlassButton2_Click_3(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ123.Click
        FSAVEPRNT()

    End Sub


    Private Sub QQ131_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ131.Click
        Try
            NORE(2, 0)
            fnor(2)
            comment1.Text = ""
            'comment1.Text = comment1.Text & Environment.NewLine
            Dim x As Integer = comment1.Text.Length
            Dim HB As Double = 0
            Dim hbs As String = ""
            Dim mcv As String = ""
            Dim hct As String = ""
            Dim WBC As String = ""
            Dim PLET As String = ""
            Dim bands As String = ""
            Dim neutr As String = ""
            Dim lymph As String = ""
            Dim mono As String = ""
            Dim esino As String = ""
            Dim baso As String = ""
            If subres.Rows(0).Item("mtest_code") = "228" Then
                FRC = subres.Select("test_code='148'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 0 Then WBC = ""
                    If nulls(Val(RC("ds"))) = 1 Then WBC = " Leucocytosis "
                    If nulls(Val(RC("ds"))) = -1 Then WBC = " Leucopenia "
                End If
                FRC = subres.Select("test_code='147'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 0 Then PLET = ""
                    If nulls(Val(RC("ds"))) = 1 Then PLET = " Thrombocytosis"
                    If nulls(Val(RC("ds"))) = -1 Then PLET = " Thrombocytopenia "
                End If
                FRC = subres.Select("test_code='142'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    HB = nulls(Val(RC("res")))
                End If

                If HB >= 10 And nulls(Val(RC("ds"))) = -1 Then hbs = " Mild "
                If HB >= 8 And HB < 10 Then hbs = " Mod. "
                If HB >= 0 And HB < 8 Then hbs = " Severe "

                FRC = subres.Select("test_code='145'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 0 Then mcv = " Normocytic "
                    If nulls(Val(RC("ds"))) = 1 Then mcv = " Macrocytic "
                    If nulls(Val(RC("ds"))) = -1 Then mcv = " Microcytic "
                End If
                FRC = subres.Select("test_code='145'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 0 Then hct = " Normochromic "
                    If nulls(Val(RC("ds"))) = 1 Then hct = " Hyperchromic " : GoTo mm
                    If nulls(Val(RC("ds"))) = -1 Then hct = " Hypochromic " : GoTo mm
                End If
                FRC = subres.Select("test_code='146'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 0 Then hct = " Normochromic "
                    If nulls(Val(RC("ds"))) = 1 Then hct = " Hyperchromic " : GoTo mm
                    If nulls(Val(RC("ds"))) = -1 Then hct = " Hypochromic " : GoTo mm
                End If
                FRC = subres.Select("test_code='161'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 0 Then hct = " Normochromic "
                    If nulls(Val(RC("ds"))) = 1 Then hct = " Hyperchromic " : GoTo mm
                    If nulls(Val(RC("ds"))) = -1 Then hct = " Hypochromic " : GoTo mm
                End If
mm:
                FRC = subres.Select("test_code='150'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("res"))) >= 6 And nulls(Val(RC("res"))) <= 12 Then bands = "  mild shift to the left "
                End If
                FRC = subres.Select("test_code='151'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 1 Then neutr = " - Neutrophilia "
                    If nulls(Val(RC("ds"))) = -1 Then neutr = " - Neutropenia "
                End If
                FRC = subres.Select("test_code='153'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 1 Then lymph = " - Lymphocytosis "
                    If nulls(Val(RC("ds"))) = -1 Then lymph = " - Lymphopenia "
                End If
                FRC = subres.Select("test_code='154'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 1 Then mono = " -  Monocytosis "
                    If nulls(Val(RC("ds"))) = -1 Then mono = " -  Monocytopenia "
                End If
                FRC = subres.Select("test_code='155'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 1 Then esino = " -  Eosinophilia "
                End If
                FRC = subres.Select("test_code='156'")
                If FRC.Length > 0 Then
                    RC = FRC(0)
                    If nulls(Val(RC("ds"))) = 1 Then baso = " -  Basophilia "
                End If
                If WBC <> "" Then comment1.Text = " WBCs shows : " & WBC
                If bands <> "" Or neutr <> "" Or lymph <> "" Or mono <> "" Or esino <> "" Or baso <> "" Then comment1.Text = comment1.Text + Environment.NewLine + "Differential count shows :" & bands & neutr & lymph & mono & esino & baso
                If PLET <> "" Then comment1.Text = comment1.Text + Environment.NewLine + "Platelets shows : " & PLET
                If hbs <> "" Then comment1.Text = comment1.Text + Environment.NewLine + "RBCs shows : " & hbs & mcv & hct & "Anemia  "

            End If
            If comment1.Text.Length = x Then comment1.Text = "CBC Is Within Normal."
            GlassButton69_Click(GlassButton69, e)
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    

    Private Sub «÷«›…ÃœÌœToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        GroupBox1.Visible = Not GroupBox1.Visible
    End Sub

    Private Sub GlassButton42_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub qq150_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        'dr.Close() : cmd.Connection = CN
        'dr.Close() : cmd.CommandText = "select * from lbill where pname like'%" & pname.Text & "%' and bdel=0 and pmobile like'%" & pmobile.Text & "%' and page like'%" & page.Text & "%'"
        'adF31.SelectCommand = cmd
        'adF31.Fill(DBS, "F31")
        'F31 = DBS.Tables("F31")
        'DBS.Tables("F31").Clear()
        'adF31.Fill(DBS, "F31")
        'F31 = DBS.Tables("F31")
        'DataGridView6.DataSource = F31
        'tm = 4
        'Dim v As Integer = 0
        'While Not v = DataGridView6.Columns.Count
        '    DataGridView6.Columns(v).Visible = False
        '    v = v + 1
        'End While
        'DataGridView6.Columns("choice").Visible = True
        'DataGridView6.Columns("esl_date").Visible = True
        'If lng = "AR" Then DataGridView6.Columns("esl_date").HeaderText = "«· «—ÌŒ" Else DataGridView6.Columns("esl_date").HeaderText = "DATE"
        'DataGridView6.Columns("esl_no").Visible = True
        'If lng = "AR" Then DataGridView6.Columns("esl_no").HeaderText = "«·«Ì’«·" Else DataGridView6.Columns("esl_no").HeaderText = "BILL NO"
        'DataGridView6.Columns("esl_no").Width = 50
        'DataGridView6.Columns("COMPANY_NAME").Visible = True
        'DataGridView6.Columns("COMPANY_NAME").HeaderText = "REF DOC"
        'DataGridView6.Columns("COMPANY_NAME").Width = 50
        'DataGridView6.Columns("pname").Visible = True
        'If lng = "AR" Then DataGridView6.Columns("pname").HeaderText = "«·Õ«·…" Else DataGridView6.Columns("pname").HeaderText = "Patient"
        'DataGridView6.Columns("tot").Visible = True
        'If lng = "AR" Then DataGridView6.Columns("tot").HeaderText = "«·«Ã„«·Ï" Else DataGridView6.Columns("tot").HeaderText = "TOTAL"
        'DataGridView6.Columns("test").Visible = True
        'If lng = "AR" Then DataGridView6.Columns("test").HeaderText = "«· Õ·Ì·" Else DataGridView6.Columns("test").HeaderText = "TEST"
        'LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & pname.Text, 0, bran.Text)
        'If F31.Rows.Count = 1 Then esl_no.Text = F31.Rows(0).Item("esl_no") : fesl(1, 0)
        'TabControl2.SelectTab(1)
        'fnor(3)


    End Sub

    Private Sub ﬂ·«·’Ê—ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        dr.Close() : cmd.CommandText = "SELECT  * from V_LIMAGE where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        adPVW.SelectCommand = cmd
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        DBS.Tables("PVW").Clear()
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        brpd.DataSource = PVW
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & rptp.Text & "\limage.rpt")
        oj.Database.Tables(0).SetDataSource(PVW)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()

    End Sub

    Private Sub GlassButton2_Click_4(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq160.Click
        Try
            esla = 1

            dr.Close()
            DBS.Tables("esl").Clear()
            cmdesl.Parameters.Clear()
            cmdesl.CommandText = "pesl"
            cmdesl.CommandType = CommandType.StoredProcedure
            cmdesl.Parameters.AddWithValue("esl_no", Val(esl_no.Text))
            cmdesl.Parameters.AddWithValue("yearn", Val(YEARN.Text))
            cmdesl.Parameters.AddWithValue("bran", bran.Text)
            adesl.SelectCommand = cmdesl
            adesl.Fill(DBS, "esl")
            Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
            oj.Load(Application.StartupPath & rptp.Text & "\esl.rpt")
            oj.Database.Tables(0).SetDataSource(DBS.Tables("esl"))
            oj.SetParameterValue("a", esla)
            rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
            If vv.Checked = True Then rp.Show() : rp.Focus() Else oj.PrintToPrinter(1, False, 0, 0)
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try



    End Sub

    Private Sub GlassButton2_Click_5(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq152.Click
        If PORV.Length < 10 Then Exit Sub
        Dim nali As Integer = 0

        If SCN.State = ConnectionState.Closed Then
            Try
                SCN.ConnectionString = PORV
                SCN.Open()
                SCMD.Connection = SCN
                SCMD.CommandText = "select * from branch"
                SDR = SCMD.ExecuteReader
                SDR.Read()
                scmd1.Connection = SCN
                scmd1.CommandText = "select * from branch"
                sdr1 = scmd1.ExecuteReader
                sdr1.Read()
                MsgBox("YOU CONNECTED TO SERVER GIVE ME MINUTS TO UPLOAD DATA")
                SCMD.Connection = SCN
            Catch ex As OleDb.OleDbException
                MsgBox(" ⁄›Ê¬ ÌÊÃœ Œÿ√ ›Ï «·« ’«· »ﬁ«⁄œ… «·»Ì«‰« ", MsgBoxStyle.Critical + MsgBoxStyle.MsgBoxRight)
                Exit Try
            End Try
        End If
        Dim rrr As Process = Process.Start(Application.StartupPath & "\progs.exe")
        pau()
        rrr.Kill()
        If SSFINAL = 1 Then
            Dim yas As String = MsgBox("will you print final", MsgBoxStyle.YesNo)
            If yas = vbYes Then GlassButton100_Click(QQ42, e)
        End If
        MsgBox("ALL DATA IS UPTO DATE THANKS " & USR, MsgBoxStyle.Information)
    End Sub
    Public Sub pau()
        Try
            If PORV.Length < 10 Then Exit Sub
            Dim nali As Integer = 0
            If SCN.State = ConnectionState.Closed Then
                Try
                    SCN.ConnectionString = PORV
                    SCN.Open()
                    SCMD.Connection = SCN
                    SCMD.CommandText = "select * from branch"
                    SDR = SCMD.ExecuteReader
                    SDR.Read()
                    scmd1.Connection = SCN
                    scmd1.CommandText = "select * from branch"
                    sdr1 = scmd1.ExecuteReader
                    sdr1.Read()
                    SCMD.Connection = SCN
                Catch ex As OleDb.OleDbException
                    MsgBox(" ⁄›Ê¬ ÌÊÃœ Œÿ√ ›Ï «·« ’«· »ﬁ«⁄œ… «·»Ì«‰« ", MsgBoxStyle.Critical + MsgBoxStyle.MsgBoxRight)
                    Exit Try
                End Try
            End If
            SDR.Close()
            sdr1.Close()
            Dim oer As System.IO.FileStream
            Dim rer As IO.StreamReader
            dr.Close()
            Dim n As Integer = 0
            Dim n11 As Integer = 0
            cmd.CommandText = " update lbill set st=1 where st=1 and  " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            n = cmd.ExecuteNonQuery
            cmd.CommandText = "select * from lbill  where st=1 and  " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & " order by esl_no"
            dr = cmd.ExecuteReader
            ACdr.Close()
            n = n + 1
            Dim t As String = ""
            While dr.Read
                n11 = n11 + 1
                If n11 > n Then n11 = n - 1
                ACcmd.CommandText = "update srv set pass11='" & (n11 / n) * 100 & "'"
                ACcmd.ExecuteNonQuery()
                SCMD.CommandText = "delete from lbill where ESL_NO='" & dr("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                SCMD.ExecuteNonQuery()
                SCMD.CommandText = "delete from lbillemage where ESL_NO='" & dr("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                SCMD.ExecuteNonQuery()
                SCMD.CommandText = "delete from lbill_ESL where ESL_NO='" & dr("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                SCMD.ExecuteNonQuery()
                SCMD.CommandText = "INSERT INTO lbill ([esl_date],[esl_no],[pname],[reg_name],[doc_name],[book_code],[book_name],[company_code],[company_name],[doc_code],[pcode],[ptype],[page],[pid],[depn],[reg_code],[esl_time],[crd_per],[crd_v],[cash_per],[cash_v],[bon],[pay],[rest],[tot],[nik],[test],[diss],[USR],[SHIFT],[rcv_date],[rcv],[fastv],[hrcvv],[rcvv],[rcvn],[fastn],[cfast],[chrcv],[totv],[ty],[doc_per],[branch_name],[branch_code],[pemail],[dissn],[notes],[tblg],[sprnt],[pyear],[lab_name],[lab_code],[ptot],[ppay],[prest],[labprice],[labtest],[tnum],[nnik],[qun],[testpro],[rcv_time],[pinc],[pcrd],[pcanc],[YEARN],[ESLBILL],[urgant],[final],[bdel],[bdelusr],[bdeldate],[eslb],[bran],[printtime],[st],[brans],[sampl],[sampldate],[samplusr],[restusr],[restdate],[trl],fs,labd,dev) VALUES ('" & dr("esl_date") & "' , '" & dr("esl_no") & "' , '" & dr("pname") & "' , '" & dr("reg_name") & "' , '" & dr("doc_name") & "' , '" & dr("book_code") & "' , '" & dr("book_name") & "' , '" & dr("company_code") & "' , '" & dr("company_name") & "' , '" & dr("doc_code") & "' , '" & dr("pcode") & "' , '" & dr("ptype") & "' , '" & dr("page") & "' , '" & dr("pid") & "' , '" & dr("depn") & "' , '" & dr("reg_code") & "' , '" & dr("esl_time") & "' , '" & dr("crd_per") & "' , '" & dr("crd_v") & "' , '" & dr("cash_per") & "' , '" & dr("cash_v") & "' , '" & dr("bon") & "' , '" & dr("pay") & "' , '" & dr("rest") & "' , '" & dr("tot") & "' , '" & dr("nik") & "' , '" & dr("test") & "' , '" & dr("diss") & "' , '" & dr("USR") & "' , '" & dr("SHIFT") & "' , '" & dr("rcv_date") & "' , '" & dr("rcv") & "' , '" & dr("fastv") & "' , '" & dr("hrcvv") & "' , '" & dr("rcvv") & "' , '" & dr("rcvn") & "' , '" & dr("fastn") & "' , '" & dr("cfast") & "' , '" & dr("chrcv") & "' , '" & dr("totv") & "' , '" & dr("ty") & "' , '" & dr("doc_per") & "' , '" & dr("branch_name") & "' , '" & dr("branch_code") & "' , '" & dr("pemail") & "' , '" & dr("dissn") & "' , '" & dr("notes") & "' , '" & dr("tblg") & "' , '" & dr("sprnt") & "' , '" & dr("pyear") & "' , '" & dr("lab_name") & "' , '" & dr("lab_code") & "' , '" & dr("ptot") & "' , '" & dr("ppay") & "' , '" & dr("prest") & "' , '" & dr("labprice") & "' , '" & dr("labtest") & "' , '" & dr("tnum") & "' , '" & dr("nnik") & "' , '" & dr("qun") & "' , '" & dr("testpro") & "' , '" & dr("rcv_time") & "' , '" & dr("pinc") & "' , '" & dr("pcrd") & "' , '" & dr("pcanc") & "' , '" & dr("YEARN") & "' , '" & dr("ESLBILL") & "' , '" & dr("urgant") & "' , '" & dr("final") & "' , '" & dr("bdel") & "' , '" & dr("bdelusr") & "' , '" & dr("bdeldate") & "' , '" & dr("eslb") & "' , '" & dr("bran") & "' , '" & dr("printtime") & "' , '0' , '" & dr("brans") & "'  , '" & dr("sampl") & "' , '" & dr("sampldate") & "' , '" & dr("samplusr") & "' , '" & dr("restusr") & "' , '" & dr("restdate") & "' , '" & dr("trl") & "' , '" & dr("fs") & "', '" & dr("labd") & "', '" & dr("dev") & "')"
                SCMD.ExecuteNonQuery()
                dr1.Close()
                cmd1.CommandText = "select * from lbillimage where ESL_NO='" & dr("esl_no") & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                dr1 = cmd1.ExecuteReader
                While dr1.Read
                    SCMD.CommandText = "INSERT INTO [lbillimage] ([no],[esl_no],[yearn],[code],[IIMAGE],[bran],[st],usr) VALUES ('" & dr1("no") & "' , '" & dr1("esl_no") & "' , '" & dr1("yearn") & "' , '" & dr1("code") & "' , '" & dr1("IIMAGE") & "' , '" & dr1("bran") & "' , '" & dr1("st") & "', '" & dr1("usr") & "')"
                    SCMD.ExecuteNonQuery()
                    Dim newMstream As New System.IO.MemoryStream(CType(dr1.Item("image"), Byte()))
                    Dim ImageFromDB As New Bitmap(newMstream)
                    PictureBox1.Image = ImageFromDB
                    t = Now.DayOfYear & Now.Hour & Now.Minute & Now.Second
                    IO.File.Delete(Application.StartupPath & "\images\" & t & dr1("esl_no"))
                    PictureBox1.Image.Save(Application.StartupPath & "\images\" & t & dr("esl_no"), System.Drawing.Imaging.ImageFormat.Jpeg)
                    oer = New IO.FileStream(Application.StartupPath & "\images\" & t & dr("esl_no"), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
                    rer = New IO.StreamReader(oer)
                    Dim FileByteArrayr1(oer.Length - 1) As Byte
                    oer.Read(FileByteArrayr1, 0, oer.Length)
                    Dim AAAAA1 As String = ""
                    Dim Sql1 As String = "update  lbillimage set image = ? " & AAAAA1 & "  where  ESL_NO='" & Val(dr("esl_no")) & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
                    SCMD.CommandText = Sql1
                    SCMD.Parameters.Clear()
                    SCMD.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr1
                    SCMD.ExecuteNonQuery()
                End While
                dr1.Close()
                cmd1.CommandText = "select * from lbill_CID where ESL_NO='" & dr("esl_no") & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
                dr1 = cmd1.ExecuteReader
                While dr1.Read
                    SCMD.CommandText = "INSERT INTO [lbill_CID] ([no],[esl_no],[yearn],[code],[IIMAGE],[bran],usr) VALUES ('" & dr1("no") & "' , '" & dr1("esl_no") & "' , '" & dr1("yearn") & "' , '" & dr1("code") & "' , '" & dr1("IIMAGE") & "' , '" & dr1("bran") & "', '" & dr1("usr") & "')"
                    SCMD.ExecuteNonQuery()
                    Dim newMstream As New System.IO.MemoryStream(CType(dr1.Item("image"), Byte()))
                    Dim ImageFromDB As New Bitmap(newMstream)
                    PictureBox1.Image = ImageFromDB
                    t = Now.DayOfYear & Now.Hour & Now.Minute & Now.Second
                    IO.File.Delete(Application.StartupPath & "\images\" & t & dr1("esl_no"))
                    PictureBox1.Image.Save(Application.StartupPath & "\images\" & t & dr("esl_no"), System.Drawing.Imaging.ImageFormat.Jpeg)
                    oer = New IO.FileStream(Application.StartupPath & "\images\" & t & dr("esl_no"), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
                    rer = New IO.StreamReader(oer)
                    Dim FileByteArrayr1(oer.Length - 1) As Byte
                    oer.Read(FileByteArrayr1, 0, oer.Length)
                    Dim AAAAA1 As String = ""
                    Dim Sql1 As String = "update  lbill_CID set image = ? " & AAAAA1 & "  where  ESL_NO='" & Val(dr("esl_no")) & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
                    SCMD.CommandText = Sql1
                    SCMD.Parameters.Clear()
                    SCMD.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr1
                    SCMD.ExecuteNonQuery()
                End While
                dr1.Close()
                cmd1.CommandText = "select * from lbill_cmt where ESL_NO='" & dr("esl_no") & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
                dr1 = cmd1.ExecuteReader
                While dr1.Read
                    SCMD.CommandText = "INSERT INTO [lbill_cmt] ([no],[esl_no],[yearn],[code],[IIMAGE],[bran],usr) VALUES ('" & dr1("no") & "' , '" & dr1("esl_no") & "' , '" & dr1("yearn") & "' , '" & dr1("code") & "' , '" & dr1("IIMAGE") & "' , '" & dr1("bran") & "', '" & dr1("usr") & "' )"
                    SCMD.ExecuteNonQuery()
                    Dim newMstream As New System.IO.MemoryStream(CType(dr1.Item("image"), Byte()))
                    Dim ImageFromDB As New Bitmap(newMstream)
                    PictureBox1.Image = ImageFromDB
                    t = Now.DayOfYear & Now.Hour & Now.Minute & Now.Second
                    IO.File.Delete(Application.StartupPath & "\images\" & t & dr1("esl_no"))
                    PictureBox1.Image.Save(Application.StartupPath & "\images\" & t & dr("esl_no"), System.Drawing.Imaging.ImageFormat.Jpeg)
                    oer = New IO.FileStream(Application.StartupPath & "\images\" & t & dr("esl_no"), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
                    rer = New IO.StreamReader(oer)
                    Dim FileByteArrayr1(oer.Length - 1) As Byte
                    oer.Read(FileByteArrayr1, 0, oer.Length)
                    Dim AAAAA1 As String = ""
                    Dim Sql1 As String = "update  lbill_cmt set image = ? " & AAAAA1 & "  where  ESL_NO='" & Val(dr("esl_no")) & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
                    SCMD.CommandText = Sql1
                    SCMD.Parameters.Clear()
                    SCMD.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr1
                    SCMD.ExecuteNonQuery()
                End While
                dr1.Close()
                cmd1.CommandText = "select * from LPATIEN where pcode='" & dr("pcode") & "'"
                dr1 = cmd1.ExecuteReader
                While dr1.Read
                    SCMD.CommandText = "delete  from LPATIEN where pcode='" & dr("pcode") & "'"
                    SCMD.ExecuteNonQuery()
                    SCMD.CommandText = "INSERT INTO [LPATIEN]([pname],[pcode],[ptype],[pbrith_date],[page],[pphone],[pmobile],[pgover],[pcity],[pstreet],[pemail],[pid],[book_code],[book_name],[company_code],[company_name],[Pnik],[PYEAR],[YAER],[YEAR],[reg_code],[reg_name],[st]) VALUES ('" & dr1("pname") & "' , '" & dr1("pcode") & "' , '" & dr1("ptype") & "' , '" & dr1("pbrith_date") & "' , '" & dr1("page") & "' , '" & dr1("pphone") & "' , '" & dr1("pmobile") & "' , '" & dr1("pgover") & "' , '" & dr1("pcity") & "' , '" & dr1("pstreet") & "' , '" & dr1("pemail") & "' , '" & dr1("pid") & "' , '" & dr1("book_code") & "' , '" & dr1("book_name") & "' , '" & dr1("company_code") & "' , '" & dr1("company_name") & "' , '" & dr1("Pnik") & "' , '" & dr1("PYEAR") & "' , '" & dr1("YAER") & "' , '" & dr1("YEAR") & "' , '" & dr1("reg_code") & "' , '" & dr1("reg_name") & "' , '" & dr1("st") & "')"
                    SCMD.ExecuteNonQuery()
                End While
om:
                dr1.Close()
                cmd1.CommandText = "select * from LBILL_CULT_DET where ESL_NO='" & dr("esl_no") & "'    and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                dr1 = cmd1.ExecuteReader
                While dr1.Read
                    SCMD.CommandText = "delete from LBILL_CULT_DET  where test_code='" & dr1("test_code") & "' and ESL_NO='" & dr("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                    SCMD.ExecuteNonQuery()
                    SCMD.CommandText = "delete from LBILL_CULT  where test_code='" & dr1("test_code") & "' and ESL_NO='" & dr("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                    SCMD.ExecuteNonQuery()
                    SCMD.CommandText = "INSERT INTO [LBILL_CULT_DET]([test_name],[test_code],[esl_no],[NOTE],[SPECIMEN],[DIRECT_ FILM],[PUS_CELLS],[RBCs],[OTHERS],[CULTURE_CONDITIONS],[GROWTH_OF],[VAIBLE_COUNT],[COUNT_IS],[epithelial],[num],[YEARN],[bran],[st])VALUES ('" & dr1("test_name") & "' , '" & dr1("test_code") & "' , '" & dr1("esl_no") & "' , '" & dr1("NOTE") & "' , '" & dr1("SPECIMEN") & "' , '" & dr1("DIRECT_ FILM") & "' , '" & dr1("PUS_CELLS") & "' , '" & dr1("RBCs") & "' , '" & dr1("OTHERS") & "' , '" & dr1("CULTURE_CONDITIONS") & "' , '" & dr1("GROWTH_OF") & "' , '" & dr1("VAIBLE_COUNT") & "' , '" & dr1("COUNT_IS") & "' , '" & dr1("epithelial") & "' , '" & dr1("num") & "' , '" & dr1("YEARN") & "' , '" & dr1("bran") & "' , '0')"
                    SCMD.ExecuteNonQuery()
                End While
                dr1.Close()
                cmd1.CommandText = "select * from LBILL_CULT where ESL_NO='" & dr("esl_no") & "' and st=1 and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                dr1 = cmd1.ExecuteReader
                While dr1.Read
                    SCMD.CommandText = "INSERT INTO [LBILL_CULT]([test_name],[test_code],[esl_no],[name1],[NAME2],[NAME3],[VIRUS],[VIRUSC],[so],[YEARN],[bran],[st]) VALUES ('" & dr1("test_name") & "' , '" & dr1("test_code") & "' , '" & dr1("esl_no") & "' , '" & dr1("name1") & "' , '" & dr1("NAME2") & "' , '" & dr1("NAME3") & "' , '" & dr1("VIRUS") & "' , '" & dr1("VIRUSC") & "' , '" & dr1("so") & "' , '" & dr1("YEARN") & "' , '" & dr1("bran") & "' , '0')"
                    SCMD.ExecuteNonQuery()
                End While
                dr1.Close()
                SCMD.CommandText = "delete from lbill_esl  where ESL_NO='" & dr("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                SCMD.ExecuteNonQuery()
                cmd1.CommandText = "select * from lbill_esl where ESL_NO='" & dr("esl_no") & "'   and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                dr1 = cmd1.ExecuteReader
                While dr1.Read
                    SCMD.CommandText = "INSERT INTO [lbill_esl]([esl_no],[bill],[yearn],[sdate],[rest],[billrest],[TOT],[qun],[id],[bran],[st],[trl],usr,erbank)VALUES ('" & dr1("esl_no") & "' , '" & dr1("bill") & "' , '" & dr1("yearn") & "' , '" & dr1("sdate") & "' , '" & dr1("rest") & "' , '" & dr1("billrest") & "' , '" & dr1("TOT") & "' , '" & dr1("qun") & "' , '" & nulls(dr1("id")) & "' , '" & dr1("bran") & "' , '0' , '" & dr1("trl") & "', '" & dr1("usr") & "', '" & dr1("erbank") & "')"
                    SCMD.ExecuteNonQuery()
                End While
                SCMD.CommandText = "INSERT INTO [lbillemage]([esl_no],[yearn],[bran])VALUES ('" & dr("esl_no") & "' , '" & dr("yearn") & "' , '" & dr("bran") & "' )"
                SCMD.ExecuteNonQuery()
                dr1.Close()
                cmd1.CommandText = "select * from lbill_test where ESL_NO='" & dr("esl_no") & "'  and st=1  and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                dr1 = cmd1.ExecuteReader
                While dr1.Read
                    SCMD.CommandText = "delete from lbill_test  where test_code='" & dr1("test_code") & "' and ESL_NO='" & dr("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                    SCMD.ExecuteNonQuery()
                    SCMD.CommandText = "INSERT INTO [lbill_test]([qun],[pthn],[ds],[test_name],[res],[test_code],[test_ar],[test_price],[tot1],[ref],[esl_no],[esl_date],[sub],[pname],[pcode],[page],[ptype],[cult],[fres],[rcv_date],[rcv],[note],[NOTEN],[NORB],[NORE],[UNIT],[take],[gr_name],[gr_code],[s],[p],[gname],[GCODE],[t],[TBLG],[tblgtime],[tblgusr],[prntn],[lab],[labprice],[so],[RSO],[comment],[HOMS],[BAR],[dis_n],[uadd],[uadddate],[YEARN],[urem],[uremdate],[tdel],[sres],[TOT2],[prnttime],[pth],[rsv],[rsvp],[QUN1],[id],[bran],[st],[trl],notesp,notesg,usr,tsq,pricep) VALUES ('" & dr1("qun") & "' , '" & dr1("pthn") & "' , '" & dr1("ds") & "' , '" & dr1("test_name") & "' , '" & dr1("res") & "' , '" & dr1("test_code") & "' , '" & dr1("test_ar") & "' , '" & dr1("test_price") & "' , '" & dr1("tot1") & "' , '" & dr1("ref") & "' , '" & dr1("esl_no") & "' , '" & dr1("esl_date") & "' , '" & dr1("sub") & "' , '" & dr1("pname") & "' , '" & dr1("pcode") & "' , '" & dr1("page") & "' , '" & dr1("ptype") & "' , '" & dr1("cult") & "' , '" & dr1("fres") & "' , '" & dr1("rcv_date") & "' , '" & dr1("rcv") & "' , '" & dr1("note") & "' , '" & dr1("NOTEN") & "' , '" & dr1("NORB") & "' , '" & dr1("NORE") & "' , '" & dr1("UNIT") & "' , '" & dr1("take") & "' , '" & dr1("gr_name") & "' , '" & dr1("gr_code") & "' , '" & dr1("s") & "' , '" & dr1("p") & "' , '" & dr1("gname") & "' , '" & dr1("GCODE") & "' , '" & dr1("t") & "' , '" & dr1("TBLG") & "' , '" & dr1("tblgtime") & "' , '" & dr1("tblgusr") & "' , '" & dr1("prntn") & "' , '" & dr1("lab") & "' , '" & dr1("labprice") & "' , '" & dr1("so") & "' , '" & dr1("RSO") & "' , '" & dr1("comment") & "' , '" & dr1("HOMS") & "' , '" & dr1("BAR") & "' , '" & dr1("dis_n") & "' , '" & dr1("uadd") & "' , '" & dr1("uadddate") & "' , '" & dr1("YEARN") & "' , '" & dr1("urem") & "' , '" & dr1("uremdate") & "' , '" & dr1("tdel") & "' , '" & dr1("sres") & "' , '" & dr1("TOT2") & "' , '" & dr1("prnttime") & "' , '" & dr1("pth") & "' , '" & dr1("rsv") & "' , '" & dr1("rsvp") & "' , '" & dr1("QUN1") & "' , '" & nulls(dr1("id")) & "' , '" & dr1("bran") & "' , '0' , '" & dr1("trl") & "', '" & dr1("notesp") & "', '" & dr1("notesg") & "', '" & dr1("usr") & "', '" & dr1("tsq") & "', '" & dr1("pricep") & "')"
                    SCMD.ExecuteNonQuery()
                End While
                dr1.Close()
                cmd1.CommandText = "select * from lbill_testsub where ESL_NO='" & dr("esl_no") & "'  and st=1  and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                dr1 = cmd1.ExecuteReader
                While dr1.Read
                    SCMD.CommandText = "delete from lbill_testsub  where test_code='" & dr1("test_code") & "' and ESL_NO='" & dr("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                    SCMD.ExecuteNonQuery()
                    SCMD.CommandText = "INSERT INTO [lbill_testsub]([qun],[pthn],[test_name],[res],[res1],[res2],[so],[test_code],[test_ar],[ref],[esl_no],[mtest_code],[mtest_name],[ds],[rcv],[note],[NOTEN],[NORB],[NORE],[q],[absu],[ref1],[p],[unit],[rso],[YEARN],[re1],[re2],[ds1],[pth],[rsv],[rsvp],[rsv1],[QUN1],[RDS],[bran],[st],usr) VALUES ('" & dr1("qun") & "' , '" & dr1("pthn") & "' , '" & dr1("test_name") & "' , '" & dr1("res") & "' , '" & dr1("res1") & "' , '" & dr1("res2") & "' , '" & dr1("so") & "' , '" & dr1("test_code") & "' , '" & dr1("test_ar") & "' , '" & dr1("ref") & "' , '" & dr1("esl_no") & "' , '" & dr1("mtest_code") & "' , '" & dr1("mtest_name") & "' , '" & dr1("ds") & "' , '" & dr1("rcv") & "' , '" & dr1("note") & "' , '" & dr1("NOTEN") & "' , '" & dr1("NORB") & "' , '" & dr1("NORE") & "' , '" & dr1("q") & "' , '" & dr1("absu") & "' , '" & dr1("ref1") & "' , '" & dr1("p") & "' , '" & dr1("unit") & "' , '" & dr1("rso") & "' , '" & dr1("YEARN") & "' , '" & dr1("re1") & "' , '" & dr1("re2") & "' , '" & dr1("ds1") & "' , '" & dr1("pth") & "' , '" & dr1("rsv") & "' , '" & dr1("rsvp") & "' , '" & dr1("rsv1") & "' , '" & dr1("QUN1") & "' , '" & dr1("RDS") & "' , '" & dr1("bran") & "' , '" & dr1("st") & "', '" & dr1("usr") & "')"
                    SCMD.ExecuteNonQuery()
                End While
                dr1.Close()
                sdr1.Close()
                
            End While

            n = 0
            n11 = 0
            dr.Close()
            cmd.CommandText = "UPDATE lbill SET ST=2 where st='2' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
            n = cmd.ExecuteNonQuery
            n = n + 1
            dr.Close()
            cmd.CommandText = "select * from lbill where st='2' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
            dr = cmd.ExecuteReader
            While dr.Read
                GoTo om
            End While
            dr.Close()
            cmd1.CommandText = "update lbill set st=0 where    " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            cmd1.ExecuteNonQuery()
            cmd1.CommandText = "update lbill_ESL set st=0 where    " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            cmd1.ExecuteNonQuery()
            cmd1.CommandText = "update lbill_test set st=0  where    " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            cmd1.ExecuteNonQuery()
            cmd1.CommandText = "update lbill_testsub set st=0 where " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            cmd1.ExecuteNonQuery()
            cmd1.CommandText = "update LBILL_CULT set st=0 where  " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            cmd1.ExecuteNonQuery()
            cmd1.CommandText = "update LBILL_CULT_DET set st=0 where   " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            cmd1.ExecuteNonQuery()
            dr.Close()
            SDR.Close()
            SCMD.CommandText = "SELECT * FROM LBILLEMAGE WHERE IMAGE IS NULL  "
            SDR = SCMD.ExecuteReader
            While SDR.Read
                If IO.File.Exists(Application.StartupPath & "\esl\" & n11 & SDR("BRAN") & SDR("BRAN")) = False Then
                    Dim W As Integer = Convert.ToInt32("150")
                    Dim H As Integer = Convert.ToInt32("37")
                    bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
                    Dim type As BarcodeLib.TYPE = BarcodeLib.TYPE.UNSPECIFIED
                    type = BarcodeLib.TYPE.CODE128
                    bar1.IncludeLabel = True
                    barco.Image = bar1.Encode(type, n11 & SDR("BRAN").ToString.Trim & SDR("ESL_NO").ToString.Trim, W, H)
                    IO.File.Delete(Application.StartupPath & "\esl\" & n11 & SDR("BRAN") & SDR("ESL_NO"))
                    barco.Image.Save(Application.StartupPath & "\esl\" & n11 & SDR("BRAN") & SDR("ESL_NO"), System.Drawing.Imaging.ImageFormat.Jpeg)
                End If
                Dim oer1 As System.IO.FileStream
                Dim rer1 As IO.StreamReader
                oer1 = New IO.FileStream(Application.StartupPath & "\esl\" & n11 & SDR("BRAN") & SDR("ESL_NO"), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
                rer1 = New IO.StreamReader(oer1)
                Dim FileByteArrayr(oer1.Length - 1) As Byte
                oer1.Read(FileByteArrayr, 0, oer1.Length)
                sdr1.Close()
                Dim AAAAA As String = ""
                Dim Sql As String = "update  lbillemage set image = ? " & AAAAA & "  where  ESL_NO='" & Val(SDR("esl_no")) & "' and " & "yearn='" & Val(SDR("YEARN")) & "' and bran='" & SDR("BRAN") & "'"
                scmd1.CommandText = Sql
                scmd1.Parameters.Clear()
                scmd1.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer1.Length).Value = FileByteArrayr
                scmd1.ExecuteNonQuery()
                n11 += 1
            End While
            dr1.Close()
            cmd1.CommandText = "select * from llogsheet where ST='1' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
            dr1 = cmd1.ExecuteReader
            While dr1.Read
                SDR.Close()
                SCMD.CommandText = "INSERT INTO llogsheet ([no],[yearn],[code],[bran],esl_date) VALUES ('" & dr1("no") & "'  , '" & dr1("yearn") & "' , '" & dr1("code") & "'  , '" & dr1("bran") & "', '" & dr1("esl_date") & "' )"
                SCMD.ExecuteNonQuery()
                Dim newMstream As New System.IO.MemoryStream(CType(dr1.Item("image"), Byte()))
                Dim ImageFromDB As New Bitmap(newMstream)
                PictureBox1.Image = ImageFromDB
                t = Now.DayOfYear & Now.Hour & Now.Minute & Now.Second
                IO.File.Delete(Application.StartupPath & "\images\" & t & dr1("code"))
                PictureBox1.Image.Save(Application.StartupPath & "\images\" & t & dr1("code"), System.Drawing.Imaging.ImageFormat.Jpeg)
                oer = New IO.FileStream(Application.StartupPath & "\images\" & t & dr1("code"), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
                rer = New IO.StreamReader(oer)
                Dim FileByteArrayr1(oer.Length - 1) As Byte
                oer.Read(FileByteArrayr1, 0, oer.Length)
                Dim AAAAA1 As String = ""
                Dim Sql1 As String = "update  llogsheet set image = ? " & AAAAA1 & "  where  code='" & Val(dr1("code")) & "' and esl_date='" & dr1("esl_date") & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
                SCMD.CommandText = Sql1
                SCMD.Parameters.Clear()
                SCMD.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr1
                SCMD.ExecuteNonQuery()
            End While
            dr1.Close()
            cmd.CommandText = "update llogsheet set st=0 "
            cmd.ExecuteNonQuery()


            '==================================================================dawnload============================
            SDR.Close()
            sdr1.Close()
            dr.Close()
            dr1.Close()
            SCMD.CommandText = "select * from lbill where st='1' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
            SDR = SCMD.ExecuteReader
            While SDR.Read
                cmd.CommandText = "delete from lbill where ESL_NO='" & SDR("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                cmd.ExecuteNonQuery()
                cmd.CommandText = "INSERT INTO lbill ([esl_date],[esl_no],[pname],[reg_name],[doc_name],[book_code],[book_name],[company_code],[company_name],[doc_code],[pcode],[ptype],[page],[pid],[depn],[reg_code],[esl_time],[crd_per],[crd_v],[cash_per],[cash_v],[bon],[pay],[rest],[tot],[nik],[test],[diss],[USR],[SHIFT],[rcv_date],[rcv],[fastv],[hrcvv],[rcvv],[rcvn],[fastn],[cfast],[chrcv],[totv],[ty],[doc_per],[branch_name],[branch_code],[pemail],[dissn],[notes],[tblg],[sprnt],[pyear],[lab_name],[lab_code],[ptot],[ppay],[prest],[labprice],[labtest],[tnum],[nnik],[qun],[testpro],[rcv_time],[pinc],[pcrd],[pcanc],[YEARN],[ESLBILL],[urgant],[final],[bdel],[bdelusr],[bdeldate],[eslb],[bran],[printtime],[st],[brans],[fnd],[sampl],[sampldate],[samplusr],[restusr],[restdate],[trl],fs,dev) VALUES ('" & SDR("esl_date") & "' , '" & SDR("esl_no") & "' , '" & SDR("pname") & "' , '" & SDR("reg_name") & "' , '" & SDR("doc_name") & "' , '" & SDR("book_code") & "' , '" & SDR("book_name") & "' , '" & SDR("company_code") & "' , '" & SDR("company_name") & "' , '" & SDR("doc_code") & "' , '" & SDR("pcode") & "' , '" & SDR("ptype") & "' , '" & SDR("page") & "' , '" & SDR("pid") & "' , '" & SDR("depn") & "' , '" & SDR("reg_code") & "' , '" & SDR("esl_time") & "' , '" & SDR("crd_per") & "' , '" & SDR("crd_v") & "' , '" & SDR("cash_per") & "' , '" & SDR("cash_v") & "' , '" & SDR("bon") & "' , '" & SDR("pay") & "' , '" & SDR("rest") & "' , '" & SDR("tot") & "' , '" & SDR("nik") & "' , '" & SDR("test") & "' , '" & SDR("diss") & "' , '" & SDR("USR") & "' , '" & SDR("SHIFT") & "' , '" & SDR("rcv_date") & "' , '" & SDR("rcv") & "' , '" & SDR("fastv") & "' , '" & SDR("hrcvv") & "' , '" & SDR("rcvv") & "' , '" & SDR("rcvn") & "' , '" & SDR("fastn") & "' , '" & SDR("cfast") & "' , '" & SDR("chrcv") & "' , '" & SDR("totv") & "' , '" & SDR("ty") & "' , '" & SDR("doc_per") & "' , '" & SDR("branch_name") & "' , '" & SDR("branch_code") & "' , '" & SDR("pemail") & "' , '" & SDR("dissn") & "' , '" & SDR("notes") & "' , '" & SDR("tblg") & "' , '" & SDR("sprnt") & "' , '" & SDR("pyear") & "' , '" & SDR("lab_name") & "' , '" & SDR("lab_code") & "' , '" & SDR("ptot") & "' , '" & SDR("ppay") & "' , '" & SDR("prest") & "' , '" & SDR("labprice") & "' , '" & SDR("labtest") & "' , '" & SDR("tnum") & "' , '" & SDR("nnik") & "' , '" & SDR("qun") & "' , '" & SDR("testpro") & "' , '" & SDR("rcv_time") & "' , '" & SDR("pinc") & "' , '" & SDR("pcrd") & "' , '" & SDR("pcanc") & "' , '" & SDR("YEARN") & "' , '" & SDR("ESLBILL") & "' , '" & SDR("urgant") & "' , '" & SDR("final") & "' , '" & SDR("bdel") & "' , '" & SDR("bdelusr") & "' , '" & SDR("bdeldate") & "' , '" & SDR("eslb") & "' , '" & SDR("bran") & "' , '" & SDR("printtime") & "' , '0' , '" & SDR("brans") & "' , '" & SDR("fnd") & "' , '" & SDR("sampl") & "' , '" & SDR("sampldate") & "' , '" & SDR("samplusr") & "' , '" & SDR("restusr") & "' , '" & SDR("restdate") & "' , '" & SDR("trl") & "', '" & SDR("trl") & "', '" & SDR("dev") & "')"
                cmd.ExecuteNonQuery()
                sdr1.Close()
lm:
                sdr1.Close()
                scmd1.CommandText = "select * from LBILL_CULT_DET where ESL_NO='" & SDR("esl_no") & "' and st=1  and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                sdr1 = scmd1.ExecuteReader
                While sdr1.Read
                    cmd.CommandText = "delete from LBILL_CULT_DET  where test_code='" & sdr1("test_code") & "' and ESL_NO='" & SDR("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "delete from LBILL_CULT  where test_code='" & sdr1("test_code") & "' and ESL_NO='" & SDR("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "INSERT INTO [LBILL_CULT_DET]([test_name],[test_code],[esl_no],[NOTE],[SPECIMEN],[DIRECT_ FILM],[PUS_CELLS],[RBCs],[OTHERS],[CULTURE_CONDITIONS],[GROWTH_OF],[VAIBLE_COUNT],[COUNT_IS],[epithelial],[num],[YEARN],[bran],[st])VALUES ('" & sdr1("test_name") & "' , '" & sdr1("test_code") & "' , '" & sdr1("esl_no") & "' , '" & sdr1("NOTE") & "' , '" & sdr1("SPECIMEN") & "' , '" & sdr1("DIRECT_ FILM") & "' , '" & sdr1("PUS_CELLS") & "' , '" & sdr1("RBCs") & "' , '" & sdr1("OTHERS") & "' , '" & sdr1("CULTURE_CONDITIONS") & "' , '" & sdr1("GROWTH_OF") & "' , '" & sdr1("VAIBLE_COUNT") & "' , '" & sdr1("COUNT_IS") & "' , '" & sdr1("epithelial") & "' , '" & sdr1("num") & "' , '" & sdr1("YEARN") & "' , '" & sdr1("bran") & "' , '0')"
                    cmd.ExecuteNonQuery()
                End While
                sdr1.Close()
                scmd1.CommandText = "select * from LBILL_CULT where ESL_NO='" & SDR("esl_no") & "' and st=1 and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                sdr1 = scmd1.ExecuteReader
                While sdr1.Read
                    cmd.CommandText = "INSERT INTO [LBILL_CULT]([test_name],[test_code],[esl_no],[name1],[NAME2],[NAME3],[VIRUS],[VIRUSC],[so],[YEARN],[bran],[st]) VALUES ('" & sdr1("test_name") & "' , '" & sdr1("test_code") & "' , '" & sdr1("esl_no") & "' , '" & sdr1("name1") & "' , '" & sdr1("NAME2") & "' , '" & sdr1("NAME3") & "' , '" & sdr1("VIRUS") & "' , '" & sdr1("VIRUSC") & "' , '" & sdr1("so") & "' , '" & sdr1("YEARN") & "' , '" & sdr1("bran") & "' , '0')"
                    cmd.ExecuteNonQuery()
                End While
                sdr1.Close()
                scmd1.CommandText = "select * from lbill_test where ESL_NO='" & SDR("esl_no") & "'  and st=1  and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                sdr1 = scmd1.ExecuteReader
                While sdr1.Read
                    cmd.CommandText = "delete from lbill_test  where test_code='" & sdr1("test_code") & "' and ESL_NO='" & SDR("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "INSERT INTO [lbill_test]([qun],[pthn],[ds],[test_name],[res],[test_code],[test_ar],[test_price],[tot1],[ref],[esl_no],[esl_date],[sub],[pname],[pcode],[page],[ptype],[cult],[fres],[rcv_date],[rcv],[note],[NOTEN],[NORB],[NORE],[UNIT],[take],[gr_name],[gr_code],[s],[p],[gname],[GCODE],[t],[TBLG],[tblgtime],[tblgusr],[prntn],[lab],[labprice],[so],[RSO],[comment],[HOMS],[BAR],[dis_n],[uadd],[uadddate],[YEARN],[urem],[uremdate],[tdel],[sres],[TOT2],[prnttime],[pth],[rsv],[rsvp],[QUN1],[id],[bran],[st],[trl],pricep) VALUES ('" & sdr1("qun") & "' , '" & sdr1("pthn") & "' , '" & sdr1("ds") & "' , '" & sdr1("test_name") & "' , '" & sdr1("res") & "' , '" & sdr1("test_code") & "' , '" & sdr1("test_ar") & "' , '" & sdr1("test_price") & "' , '" & sdr1("tot1") & "' , '" & sdr1("ref") & "' , '" & sdr1("esl_no") & "' , '" & sdr1("esl_date") & "' , '" & sdr1("sub") & "' , '" & sdr1("pname") & "' , '" & sdr1("pcode") & "' , '" & sdr1("page") & "' , '" & sdr1("ptype") & "' , '" & sdr1("cult") & "' , '" & sdr1("fres") & "' , '" & sdr1("rcv_date") & "' , '" & sdr1("rcv") & "' , '" & sdr1("note") & "' , '" & sdr1("NOTEN") & "' , '" & sdr1("NORB") & "' , '" & sdr1("NORE") & "' , '" & sdr1("UNIT") & "' , '" & sdr1("take") & "' , '" & sdr1("gr_name") & "' , '" & sdr1("gr_code") & "' , '" & sdr1("s") & "' , '" & sdr1("p") & "' , '" & sdr1("gname") & "' , '" & sdr1("GCODE") & "' , '" & sdr1("t") & "' , '" & sdr1("TBLG") & "' , '" & sdr1("tblgtime") & "' , '" & sdr1("tblgusr") & "' , '" & sdr1("prntn") & "' , '" & sdr1("lab") & "' , '" & sdr1("labprice") & "' , '" & sdr1("so") & "' , '" & sdr1("RSO") & "' , '" & sdr1("comment") & "' , '" & sdr1("HOMS") & "' , '" & sdr1("BAR") & "' , '" & sdr1("dis_n") & "' , '" & sdr1("uadd") & "' , '" & sdr1("uadddate") & "' , '" & sdr1("YEARN") & "' , '" & sdr1("urem") & "' , '" & sdr1("uremdate") & "' , '" & sdr1("tdel") & "' , '" & sdr1("sres") & "' , '" & sdr1("TOT2") & "' , '" & sdr1("prnttime") & "' , '" & sdr1("pth") & "' , '" & sdr1("rsv") & "' , '" & sdr1("rsvp") & "' , '" & sdr1("QUN1") & "' , '" & nulls(sdr1("id")) & "' , '" & sdr1("bran") & "' , '0' , '" & sdr1("trl") & "', '" & sdr1("pricep") & "')"
                    cmd.ExecuteNonQuery()
                End While
                sdr1.Close()
                scmd1.CommandText = "select * from lbill_testsub where ESL_NO='" & SDR("esl_no") & "'  and st=1  and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                sdr1 = scmd1.ExecuteReader
                While sdr1.Read
                    cmd.CommandText = "delete from lbill_testsub  where test_code='" & sdr1("test_code") & "' and ESL_NO='" & SDR("esl_no") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "INSERT INTO [lbill_testsub]([qun],[pthn],[test_name],[res],[res1],[res2],[so],[test_code],[test_ar],[ref],[esl_no],[mtest_code],[mtest_name],[ds],[rcv],[note],[NOTEN],[NORB],[NORE],[q],[absu],[ref1],[p],[unit],[rso],[YEARN],[re1],[re2],[ds1],[pth],[rsv],[rsvp],[rsv1],[QUN1],[RDS],[bran],[st]) VALUES ('" & sdr1("qun") & "' , '" & sdr1("pthn") & "' , '" & sdr1("test_name") & "' , '" & sdr1("res") & "' , '" & sdr1("res1") & "' , '" & sdr1("res2") & "' , '" & sdr1("so") & "' , '" & sdr1("test_code") & "' , '" & sdr1("test_ar") & "' , '" & sdr1("ref") & "' , '" & sdr1("esl_no") & "' , '" & sdr1("mtest_code") & "' , '" & sdr1("mtest_name") & "' , '" & sdr1("ds") & "' , '" & sdr1("rcv") & "' , '" & sdr1("note") & "' , '" & sdr1("NOTEN") & "' , '" & sdr1("NORB") & "' , '" & sdr1("NORE") & "' , '" & sdr1("q") & "' , '" & sdr1("absu") & "' , '" & sdr1("ref1") & "' , '" & sdr1("p") & "' , '" & sdr1("unit") & "' , '" & sdr1("rso") & "' , '" & sdr1("YEARN") & "' , '" & sdr1("re1") & "' , '" & sdr1("re2") & "' , '" & sdr1("ds1") & "' , '" & sdr1("pth") & "' , '" & sdr1("rsv") & "' , '" & sdr1("rsvp") & "' , '" & sdr1("rsv1") & "' , '" & sdr1("QUN1") & "' , '" & sdr1("RDS") & "' , '" & sdr1("bran") & "' , '" & sdr1("st") & "')"
                    cmd.ExecuteNonQuery()
                End While
                sdr1.Close()
            End While
            sdr1.Close()
            SDR.Close()
            SCMD.CommandText = "select * from lbill where st='2' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
            SDR = SCMD.ExecuteReader
            While SDR.Read
                GoTo lm
            End While
            sdr1.Close()
            scmd1.CommandText = "update lbill set st=0 where  yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            scmd1.ExecuteNonQuery()
            scmd1.CommandText = "update lbill_ESL set st=0 where    yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            scmd1.ExecuteNonQuery()
            scmd1.CommandText = "update lbill_test set st=0  where   yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            scmd1.ExecuteNonQuery()
            scmd1.CommandText = "update lbill_testsub set st=0 where  yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            scmd1.ExecuteNonQuery()
            scmd1.CommandText = "update LBILL_CULT set st=0 where   yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            scmd1.ExecuteNonQuery()
            scmd1.CommandText = "update LBILL_CULT_DET set st=0 where  yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'"
            scmd1.ExecuteNonQuery()

            'dr1.Close()
            'cmd1.CommandText = "select * from llog where ST='1' "
            'dr1 = cmd1.ExecuteReader
            'While dr1.Read
            '    SDR.Close()
            '    SCMD.CommandText = "INSERT INTO [llog] ([usr],[note],[time1],[date1],[gr],[ESL],[type],[hr],[BRAN],[ST]) VALUES  ('" & dr1("usr") & "','" & dr1("note") & "','" & dr1("time1") & "','" & dr1("date1") & "','" & dr1("gr") & "','" & dr1("ESL") & "','" & dr1("type") & "','" & dr1("hr") & "','" & dr1("BRAN") & "','" & dr1("ST") & "')"
            '    SCMD.ExecuteNonQuery()
            'End While
            'dr1.Close()
            'cmd.CommandText = "update llog set st=0 "
            'cmd.ExecuteNonQuery()
            'dr1.Close()
            'cmd1.CommandText = "select * from BRANIMAGE where ST='1' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
            'dr1 = cmd1.ExecuteReader
            'While dr1.Read
            '    SDR.Close()
            '    SCMD.CommandText = "insert into BRANIMAGE (SDATE,CODE,IIMAGE ,bran,yearn) values ('" & dr("SDATE") & "','" & dr1("CODE") & "','" & dr1("IIMAGE") & "','" & dr1("bran") & "','" & dr1("yearn") & "')"
            '    SCMD.ExecuteNonQuery()
            '    Dim newMstream As New System.IO.MemoryStream(CType(dr1.Item("image"), Byte()))
            '    Dim ImageFromDB As New Bitmap(newMstream)
            '    PictureBox1.Image = ImageFromDB
            '    t = Now.DayOfYear & Now.Hour & Now.Minute & Now.Second
            '    IO.File.Delete(Application.StartupPath & "\images\" & t & dr1("code"))
            '    PictureBox1.Image.Save(Application.StartupPath & "\images\" & t & dr1("code"), System.Drawing.Imaging.ImageFormat.Jpeg)
            '    oer = New IO.FileStream(Application.StartupPath & "\images\" & t & dr1("code"), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
            '    rer = New IO.StreamReader(oer)
            '    Dim FileByteArrayr1(oer.Length - 1) As Byte
            '    oer.Read(FileByteArrayr1, 0, oer.Length)
            '    Dim AAAAA1 As String = ""
            '    Dim Sql1 As String = "update  BRANIMAGE set image = ? " & AAAAA1 & "  where  code='" & Val(dr1("code")) & "'"
            '    SCMD.CommandText = Sql1
            '    SCMD.Parameters.Clear()
            '    SCMD.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr1
            '    SCMD.ExecuteNonQuery()
            'End While

            dr.Close()
            sdr1.Close()
            SDR.Close()
            upd()
        Catch ex As Exception
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','online','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
    Public Sub upd()
        If FESLT = 1 Then
            Dim nsd As Integer = 0
            Dim asdate As New List(Of DateTime)
            dr.Close()
            sdr1.Close()
            SDR.Close()
            dr1.Close()
            cmd1.CommandText = "select date1 from lcash where st=1  group by date1 "
            dr1 = cmd1.ExecuteReader
            While dr1.Read
                asdate.Add(dr1("date1"))
            End While
            dr.Close()
            sdr1.Close()
            SDR.Close()
            dr1.Close()
            Do While Not nsd = asdate.Count
                SCMD.CommandText = "delete  from lcash where date1='" & ChangeFormat(asdate.Item(nsd)) & "' and BRANCH_NAME='" & branch_name.Text & "'"
                SCMD.ExecuteNonQuery()
                dr1.Close()
                cmd1.CommandText = "SELECT *  from lcash where date1='" & ChangeFormat(asdate.Item(nsd)) & "'"
                dr1 = cmd1.ExecuteReader
                While dr1.Read
                    SCMD.CommandText = "INSERT INTO [lcash]([main_name],[main_code],[sub_code],[sub_name],[flg],[cash],[crd],[time1],[date1],[id],[notse],[usr],[shift],[SAVE_NAME],[save_code],branch_code,branch_name,st,PRM) VALUES ( '" & dr1("main_name") & "' , '" & dr1("main_code") & "' , '" & dr1("sub_code") & "' , '" & dr1("sub_name") & "' , '" & dr1("flg") & "' , '" & dr1("cash") & "' , '" & dr1("crd") & "' , '" & dr1("time1") & "' , '" & dr1("date1") & "' , '" & dr1("id") & "' , '" & dr1("notse") & "' , '" & dr1("usr") & "' , '" & dr1("shift") & "'  , '" & dr1("SAVE_NAME") & "' , '" & dr1("save_code") & "','" & dr1("branch_code") & "','" & dr1("branch_name") & "','0','" & dr1("PRM") & "')"
                    SCMD.ExecuteNonQuery()
                End While
                nsd += 1
            Loop
            dr.Close()
            cmd.CommandText = "update lcash set st=0 where st=1 "
            cmd.ExecuteNonQuery()
        End If

    End Sub

    Private Sub qq151_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

        'LLOG("«—”«·", esl_no.Text, "«—”«· »—Ìœ «·«·ﬂ —Ê‰Ï" & pname.Text, 1, bran.Text)

    End Sub

    Private Sub GlassButton2_Click_6(ByVal sender As System.Object, ByVal e As System.EventArgs)
        CN.Close()
        Try
            CN.ConnectionString = PORV
            CN.Open()
            MsgBox("YOU CONNECTED TO SERVER GIVE ME MINUTS TO UPLOAD DATA")
            cmd.Connection = SCN
        Catch ex As OleDb.OleDbException
            MsgBox(" ⁄›Ê¬ ÌÊÃœ Œÿ√ ›Ï «·« ’«· »ﬁ«⁄œ… «·»Ì«‰« ", MsgBoxStyle.Critical + MsgBoxStyle.MsgBoxRight)
            End
            Exit Try
        End Try

    End Sub

    Private Sub QQ15_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ15.Click
        Dim N As String = InputBox("«œŒ· «·»”Ê—œ «·ÃœÌœ")
        If N = "" Then Exit Sub
        dr.Close()
        cmd.CommandText = "UPDATE USERS SET PASS='" & N & "' WHERE NAME='" & USR & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub GlassButton3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton3.Click
        Dim N As String = InputBox("«–« «—œ  «··€… «·⁄—»Ì… «÷€ÿ 1 Ê «·«‰Ã·Ì“Ì… «÷€ÿ 2")
        If N = 1 Then N = "AR" Else N = "EN"
        dr.Close()
        cmd.CommandText = "UPDATE USERS SET LNG='" & N & "' WHERE NAME='" & USR & "'"
        cmd.ExecuteNonQuery()

    End Sub

    Private Sub QQ16_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ16.Click
        ColorDialog1.ShowDialog()
        bcolor = ColorDialog1.Color.ToArgb
        colu(Me, Val(bcolor), Val(fcolor))
        dr.Close() : cmd.CommandText = "update USERS set bcolor=" & Val(bcolor) & "  where NAME='" & USR & "'"
        cmd.ExecuteNonQuery()

    End Sub


    Private Sub GlassButton2_Click_7(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ156.Click
        ColorDialog1.ShowDialog()
        fcolor = ColorDialog1.Color.ToArgb
        colu(Me, Val(bcolor), Val(fcolor))
        dr.Close() : cmd.CommandText = "update USERS set fcolor=" & Val(fcolor) & "  where NAME='" & USR & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub QQ157_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ157.Click
        ColorDialog1.ShowDialog()
        bcolor = ColorDialog1.Color.ToArgb
        dr.Close()
        cmd.CommandText = "update USERS set backcolor=" & Val(bcolor) & "  where NAME='" & USR & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub QQ18_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
mmm:

        'dr.Close()
        'cmd.CommandText = "select * from ltest where test_name like kid "
        'dr = cmd.ExecuteReader
        'dr.Read()
        'MsgBox(dr("test_name"))
        'cmd.CommandText = "UPDATE    ltest SET  TEST_NAME = REPLACE(TEST_NAME, 'kideny', '')"
        'cmd.ExecuteNonQuery()
        ''Dim nn As Integer = 1000
        ''While Not 10000000
        ''    cmd.CommandText = "UPDATE    ltest SET  TEST_NAME = REPLACE(TEST_NAME, '" & nn & "', '')"
        ''    cmd.ExecuteNonQuery()
        ''    nn = nn + 1
        ''End While
        'dr.Close()
        'dr1.Close()
        'cmd.CommandText = "select   name from lcompany   group by  name having COUNT(name) > 1  "
        'dr = cmd.ExecuteReader
        'While dr.Read
        '    cmd1.CommandText = "delete from lcompany where ky in (select top 1 ky from [lcompany] where name='" & dr("name") & "' )"
        '    cmd1.ExecuteNonQuery()
        'End While
        'GoTo mmm
        'dr.Close()
        'dr1.Close()
        'cmd.CommandText = "select  esl_no, test_code, yearn from lbill_testsub where bran='M' and yearn='2016' and esl_no>5000 group by esl_no, test_code, yearn having COUNT(test_code) > 1 order by yearn,esl_no "
        'dr = cmd.ExecuteReader
        'While dr.Read
        '    cmd1.CommandText = "delete from lbill_testsub where ky in (select top 1 ky from [lbill_testsub] where bran='M' and esl_no='" & dr("esl_no") & "' and test_code='" & dr("test_code") & "' and yearn='" & dr("yearn") & "')"
        '    cmd1.ExecuteNonQuery()
        'End While
        ''TPRICE()
        ''SUMT()
        ''fprice(1)
        ''Dim nali As Integer = 0
        'If SCN.State = ConnectionState.Connecting Then
        '    SCN.Close()
        'End If
        'If SCN.State = ConnectionState.Closed Then
        '    Try
        '        SCN.ConnectionString = PORV
        '        SCN.Open()
        '        SCMD.Connection = SCN
        '        SCMD.CommandText = "select * from branch"
        '        SDR = SCMD.ExecuteReader
        '        SDR.Read()
        '        scmd1.Connection = SCN
        '        scmd1.CommandText = "select * from branch"
        '        sdr1 = scmd1.ExecuteReader
        '        sdr1.Read()
        '        MsgBox("YOU CONNECTED TO SERVER GIVE ME MINUTS TO UPLOAD DATA")

        '        SCMD.Connection = SCN
        '    Catch ex As OleDb.OleDbException
        '        MsgBox(" ⁄›Ê¬ ÌÊÃœ Œÿ√ ›Ï «·« ’«· »ﬁ«⁄œ… «·»Ì«‰« ", MsgBoxStyle.Critical + MsgBoxStyle.MsgBoxRight)
        '        End
        '        Exit Try
        '    End Try
        'End If
        'SDR.Close()
        'SCMD.CommandText = "update lbill set esl_no=esl_no-7000 where bran='M' and  " & "yearn='" & Val(YEARN.Text) & "' "
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update lbill_ESL set esl_no=esl_no-7000 where  bran='M' and  " & "yearn='" & Val(YEARN.Text) & "' "
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update lbill_test set esl_no=esl_no-7000  where  bran='M' and  " & "yearn='" & Val(YEARN.Text) & "' "
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update lbill_testsub set esl_no=esl_no+1000 where bran='M' and   " & "yearn='" & Val(YEARN.Text) & "' "
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update LBILL_CULT set esl_no=esl_no+1000 where  bran='M' and  " & "yearn='" & Val(YEARN.Text) & "' "
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update LBILL_CULT_DET set esl_no=esl_no+1000 where bran='M' and    " & "yearn='" & Val(YEARN.Text) & "' "
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update lbillimage set esl_no=esl_no-7000 where  bran='M' and  " & "yearn='" & Val(YEARN.Text) & "' "
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update lbillemage set esl_no=esl_no-7000 where   bran='M' and " & "yearn='" & Val(YEARN.Text) & "' "
        'SCMD.ExecuteNonQuery()
        ''SDR.Close()
        ' ''SCMD.CommandText = "ALTER TABLE  ltest ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  LSUBTEST ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  ltest_price ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  lnstest ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  lntest ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  LGTEST ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  LGr ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  users ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  lgroup ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  lgroup_price ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  lgroup_test ADD BRAN  varchar(2000)"
        ' ''SCMD.ExecuteNonQuery()



        ' ''SCMD.CommandText = "ALTER TABLE  ltest ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  LSUBTEST ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  ltest_price ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  lnstest ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  lntest ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  LGTEST ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  LGr ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  users ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  lgroup ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  lgroup_price ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        ' ''SCMD.CommandText = "ALTER TABLE  lgroup_test ADD st int"
        ' ''SCMD.ExecuteNonQuery()
        'SDR.Close()
        'SCMD.CommandText = "update   ltest set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update   LSUBTEST set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update   ltest_price set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update   lnstest set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update   lntest set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update   LGTEST set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update   LGr set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update   users set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update   lgroup set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update   lgroup_price set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
        'SCMD.CommandText = "update   lgroup_test set st=1,bran='" & sbran & "'"
        'SCMD.ExecuteNonQuery()
    End Sub

    Private Sub qq19_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq19.Click
        dr.Close()
        Dim ma As Integer = 0
        While Not ma = F31.Rows.Count
            If F31.Rows(ma).RowState <> DataRowState.Deleted Then
                cmd.CommandText = "update lbill set company_name='" & COMPANY_name.Text & "',company_code='" & COMPANY_CODE.Text & "'  where bran='" & F31.Rows(ma).Item("bran") & "' and ESL_NO='" & F31.Rows(ma).Item("esl_no") & "' " & " and " & "yearn='" & F31.Rows(ma).Item("yearn") & "'"
                cmd.ExecuteNonQuery()
            End If
            ma += 1
        End While
        MsgBox(" „  ⁄„·Ì… «· ⁄œÌ·", MsgBoxStyle.Critical)

    End Sub

    Private Sub ChangCompanyToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        qq19.Visible = True
        qq224.Visible = True
        gl10.Visible = True
    End Sub

    Private Sub spac_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles pname.GotFocus
        flng("AR")
        colu(Me, Val(bcolor), Val(fcolor))
        pname.BackColor = Color.FromArgb(backcolor1)
        FFIND = "pname"
        FFINDT = pname.Text
    End Sub

    Private Sub spac_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles pname.KeyDown


        If e.KeyCode = Keys.Enter AndAlso e.Control Then
            dr.Close()
            cmd.CommandText = "select * from lbill WHere PNAME like'%" & pname.Text & "%' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' order by esl_date desc"
            adF31.SelectCommand = cmd
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            DBS.Tables("F31").Clear()
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            brpd.DataSource = F31
            tm = 23
        ElseIf e.KeyCode = Keys.B AndAlso e.Control Then
            typec = 1
            blockitem()
        ElseIf e.KeyCode = Keys.F12 Then
            dr1.Close()
            cmd1.CommandText = "select * from lpatien where pname='" & pname.Text & "'"
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            If dr1.HasRows = True Then
                PNIK.Text = dr1("PNIK")
                pcode.Text = dr1("pcode")
                pname.Text = dr1("pname")
                ptype.Text = dr1("ptype")
                pbrith_date.Value = dr1("pbrith_date")
                page.Text = dr1("page")
                pphone.Text = nulls(dr1("pphone"))
                pmobile.Text = nulls(dr1("pmobile"))
                pgover.Text = dr1("pgover")
                pcity.Text = dr1("pcity")
                pstreet.Text = dr1("pstreet")
                pemail.Text = dr1("pemail")
                pid.Text = dr1("pid")
            End If
        ElseIf e.KeyCode = Keys.Enter Then
            FNEWV()
            ElseIf e.KeyCode = Keys.F2 Then
                FIND.NFLD.Text = " Pname "
                FIND.SNAME.Text = pname.Text
                FIND.ShowDialog()
            End If

    End Sub
    Public Sub blockitem()
        If pname.Text.Length < 4 And typec = 1 Then MsgBox("«·—Ã«¡ «·«Œ Ì«— ﬁ»· «·ÕÃ»") : Exit Sub
        If COMPANY_name.Text.Length < 4 And typec = 1 Then MsgBox("«·—Ã«¡ «·«Œ Ì«— ﬁ»· «·ÕÃ»") : Exit Sub
        GroupBox11.Location = New Point(8, 13)
        GroupBox11.Visible = True

    End Sub


    Private Sub spac_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles pname.KeyUp
        If e.KeyCode = Keys.F6 Then
            fufind()
        End If

        If e.KeyCode = Keys.Left Then PNIK.Focus()
        If e.KeyCode = Keys.Delete Then pname.Text = ""
    End Sub

    Private Sub pname_Layout(ByVal sender As Object, ByVal e As System.Windows.Forms.LayoutEventArgs) Handles pname.Layout

    End Sub

    Private Sub spac_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs) Handles pname.MouseHover
        llname = "pname"
    End Sub

    

    Private Sub spac_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles pname.TextChanged
        pcode.Text = 0
    End Sub

    Private Sub nname_GotFocus1(ByVal sender As Object, ByVal e As System.EventArgs) Handles nname.GotFocus
        flng("AR")
    End Sub

    Private Sub nname_KeyDown1(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles nname.KeyDown
        If e.KeyCode = Keys.Enter Then
            On Error Resume Next
            dr.Close() : cmd.Connection = CN
            dr.Close() : cmd.CommandText = "select * from lbill where pname like'%" & nname.Text & "%' "
            adF31.SelectCommand = cmd
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            DBS.Tables("F31").Clear()
            adF31.Fill(DBS, "F31")
            F31 = DBS.Tables("F31")
            F31D.DataSource = F31
            tm = 4
            F31DTG()
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & pname.Text, 0, bran.Text)
            If F31.Rows.Count = 1 Then esl_no.Text = F31.Rows(0).Item("esl_no") : fesl(1, 0)

            fnor(3)
        End If
    End Sub

    Private Sub nname_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles nname.SelectedIndexChanged

    End Sub

    Private Sub qq170_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq170.Click
        fprice(1)
        dr.Close()
        cmd.CommandText = "update lbill_test set t=0"
        cmd.ExecuteNonQuery()
        FRC = BILL.Select("qun='1'")
        Dim t As String = 0
        While Not t = FRC.Length
            RC = FRC(t)
            cmd.CommandText = "update lbill_test set t=1 where test_name='" & RC("test_name") & "'"
            cmd.ExecuteNonQuery()
            t = t + 1
        End While
        If FRC.Length <= 0 Then
            cmd.CommandText = "update lbill_test set t=1"
            cmd.ExecuteNonQuery()
        End If
        ACdr.Close()
        ACcmd.CommandText = " DELETE * FROM IFACE2 "
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = " SELECT NAME,MN,en,hid,FLG,PRG FROM IFACE2 "
        adPRICE.SelectCommand = ACcmd
        adPRICE.Fill(DBS, "PRICE")
        PRICE = DBS.Tables("PRICE")
        DBS.Tables("PRICE").Clear()
        adPRICE.Fill(DBS, "PRICE")
        PRICE = DBS.Tables("PRICE")
        F31D.DataSource = PRICE
        dr.Close() : cmd.CommandText = "SELECT      count( dbo.lbill_test.test_name),dbo.lbill_test.test_name, dbo.ltest_price.tot FROM dbo.lbill_test INNER JOIN dbo.ltest_price ON dbo.lbill_test.test_code = dbo.ltest_price.TEST_CODE WHERE     (dbo.ltest_price.book_price_code = '1')  and dbo.lbill_test.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' AND lbill_test.T=1 GROUP BY dbo.lbill_test.test_name, dbo.ltest_price.tot   ORDER BY dbo.lbill_test.test_name"
        dr = cmd.ExecuteReader
        Dim NNA As Integer = 0
        While dr.Read
            'If NNA = 0 Then
            RC = PRICE.NewRow
            RC("NAME") = dr("TEST_NAME")
            RC("MN") = dr("TOT")
            RC("hid") = dr(0)
            dr1.Close()
            cmd1.CommandText = "SELECT      count( dbo.lbill_test.test_name),dbo.lbill_test.test_name, dbo.ltest_price.tot FROM dbo.lbill_test INNER JOIN dbo.ltest_price ON dbo.lbill_test.test_code = dbo.ltest_price.TEST_CODE WHERE     (dbo.ltest_price.book_price_code = '2')  and (dbo.ltest_price.TEST_NAME = '" & dr("TEST_NAME") & "')  AND lbill_test.LAB=1 and  dbo.lbill_test.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' AND lbill_test.T=1 GROUP BY dbo.lbill_test.test_name, dbo.ltest_price.tot   ORDER BY dbo.lbill_test.test_name"
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            If dr1.HasRows = True Then
                RC("FLG") = dr1("TOT")
                RC("PRG") = dr1(0)
            Else
                RC("FLG") = 0
                RC("PRG") = 0
            End If

            PRICE.Rows.Add(RC)
            NNA = 1
            'Else
            '    RC = PRICE.Rows(PRICE.Rows.Count - 1)
            '    RC.BeginEdit()
            '    RC("EN") = dr("TEST_NAME")
            '    RC("HID") = dr("TOT")
            '    RC.EndEdit()
            '    NNA = 0
            'End If
        End While
        MsgBox(PRICE.Rows.Count)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\TEST PRICE 1.rpt")
        oj.Database.Tables(0).SetDataSource(PRICE)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub GlassButton2_Click_8(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq220.Click
        If GroupBox1.Location.X = 5 Then GroupBox1.Location = New Point(539, 353) Else GroupBox1.Location = New Point(5, 353)
    End Sub

    Private Sub QQ171_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ171.Click
        dr.Close()
        cmd.CommandText = "update lbill_test set t=0"
        cmd.ExecuteNonQuery()
        FRC = BILL.Select("qun='1'")
        Dim t As String = 0
        While Not t = FRC.Length
            RC = FRC(t)
            cmd.CommandText = "update lbill_test set t=1 where test_name='" & RC("test_name") & "'"
            cmd.ExecuteNonQuery()
            t = t + 1
        End While
        If FRC.Length <= 0 Then
            cmd.CommandText = "update lbill_test set t=1"
            cmd.ExecuteNonQuery()
        End If
        ACdr.Close()
        ACcmd.CommandText = " DELETE * FROM IFACE2 "
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = " SELECT * FROM IFACE2 "
        adPRICE.SelectCommand = ACcmd
        adPRICE.Fill(DBS, "PRICE")
        PRICE = DBS.Tables("PRICE")
        DBS.Tables("PRICE").Clear()
        adPRICE.Fill(DBS, "PRICE")
        PRICE = DBS.Tables("PRICE")
        'DataGridView6.DataSource = PRICE
        dr.Close() : cmd.CommandText = "SELECT     test_name ,COUNT(test_name) AS TESTC , SUM(test_PRICE) AS TESTS FROM lbill_test  WHERE dbo.lbill_test.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' AND lbill_test.T=1 GROUP BY dbo.lbill_test.test_name ORDER BY dbo.lbill_test.test_name"
        dr = cmd.ExecuteReader
        Dim NNA As Integer = 0
        While dr.Read
            If NNA = 0 Then
                RC = PRICE.NewRow
                RC("NAME") = dr("TEST_NAME")
                RC("MN") = dr("TESTS")
                RC("FLG") = dr("TESTC")
                PRICE.Rows.Add(RC)
                NNA = 1
            Else
                RC = PRICE.Rows(PRICE.Rows.Count - 1)
                RC.BeginEdit()
                RC("EN") = dr("TEST_NAME")
                RC("HID") = dr("TESTS")
                RC("SIZE") = dr("TESTC")
                RC.EndEdit()
                NNA = 0
            End If
        End While

        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\TEST RP.rpt")
        oj.Database.Tables(0).SetDataSource(PRICE)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub GlassButton7_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub GlassButton15_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq224.Click
        On Error Resume Next
        dr.Close()
        cmd.CommandText = "CREATE TABLE [dbo].[lblock]([pname] [nvarchar](200) NULL,[pcode] [nvarchar](50) NULL,[comment] [nvarchar](500) NULL,[type] [int] NOT NULL DEFAULT '0',[pmobile] [int] NOT NULL DEFAULT '0')"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lcompany ADD address  nvarchar(max) , price_name  varchar(50),oprice_name  nvarchar(50),price_diss INT NOT NULL DEFAULT '0',oprice_diss INT NOT NULL DEFAULT '0',tah_form  nvarchar(MAX),tah_exp  nvarchar(50),tah_date  nvarchar(50),emp_cash  nvarchar(50),fam_cash  nvarchar(50),HC  nvarchar(MAX),out_date  nvarchar(MAX) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lcompany ADD labin  INT  "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lcompany ADD lbill_esl  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill ADD dev  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lcompany ADD COMS  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE EEMP ADD O1_1S  numeric(18, 2) NOT NULL DEFAULT '0',O1_2S  numeric(18, 2) NOT NULL DEFAULT '0',O1_5S  numeric(18, 2) NOT NULL DEFAULT '0',O1_3S  numeric(18, 2) NOT NULL DEFAULT '0',O1_4S  numeric(18, 2) NOT NULL DEFAULT '0',O1_6S  numeric(18, 2) NOT NULL DEFAULT '0',O1_7S  numeric(18, 2) NOT NULL DEFAULT '0',O1_8S  numeric(18, 2) NOT NULL DEFAULT '0',O1_9S  numeric(18, 2) NOT NULL DEFAULT '0',O1_10S  numeric(18, 2) NOT NULL DEFAULT '0',O1_11S  numeric(18, 2) NOT NULL DEFAULT '0',O1_12S  numeric(18, 2) NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE EEMP ADD O3_1S  numeric(18, 2) NOT NULL DEFAULT '0',O3_2S  numeric(18, 2) NOT NULL DEFAULT '0',O3_5S  numeric(18, 2) NOT NULL DEFAULT '0',O3_3S  numeric(18, 2) NOT NULL DEFAULT '0',O3_4S  numeric(18, 2) NOT NULL DEFAULT '0',O3_6S  numeric(18, 2) NOT NULL DEFAULT '0',O3_7S  numeric(18, 2) NOT NULL DEFAULT '0',O3_8S  numeric(18, 2) NOT NULL DEFAULT '0',O3_9S  numeric(18, 2) NOT NULL DEFAULT '0',O3_10S  numeric(18, 2) NOT NULL DEFAULT '0',O3_11S  numeric(18, 2) NOT NULL DEFAULT '0',O3_12S  numeric(18, 2) NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE LBILL ADD COMS  int NOT NULL DEFAULT '1'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE LBILL ADD NCRD  int NOT NULL DEFAULT '0',BANK int NOT NULL DEFAULT '0',NDOC varchar(50) NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        'cmd.CommandText = "DROP TABLE LCASH"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "CREATE TABLE lcash ([main_name] [nvarchar](50) NULL,[main_code] [nvarchar](50) NULL,[sub_code] [nvarchar](50) NULL,[sub    _name] [nvarchar](50) NULL,[flg] [int] NOT NULL DEFAULT '0',[cash] [numeric](18, 2) NOT NULL DEFAULT '0',[crd] [numeric](18, 2) NOT NULL DEFAULT '0',[time1] [nvarchar](50) NULL,[date1] [datetime] NULL,[id] [numeric](18, 0) NOT NULL DEFAULT '0',[notse] [nvarchar](1000) NULL,[ky] [numeric](18, 0) IDENTITY(1,1) NOT NULL,[usr] [nvarchar](50) NULL,[shift] [nvarchar](50) NULL,[trl] [int]  NULL,[st] [int] NOT NULL DEFAULT '0' ,[save_name] [nvarchar](50) NULL,[save_code] [int] NULL,[branch_name] [nvarchar](50) NULL,[branch_code] [int] NULL,[emp_name] [nvarchar](200) NULL,[emp_code] [int] NULL,[image] [image] NULL,[no] [numeric](18, 0) NULL)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "DROP TABLE LSAVE"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "CREATE TABLE lsave ([name] [nvarchar](50) NULL,[code] [int] NULL,[ky] [int] IDENTITY(1,1) )"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "DROP TABLE LSUB"
        'cmd.ExecuteNonQuery()
        cmd.CommandText = "CREATE TABLE [dbo].[lsub]([main_name] [nvarchar](50) NULL,[main_code] [nvarchar](50) NULL,[sub_code] [nvarchar](50) NULL,[sub_name] [nvarchar](50) NULL,[flg] [int] NOT NULL DEFAULT '0',[st] [int] NOT NULL DEFAULT '0')"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "CREATE TABLE [dbo].[LCOMARKET]([COMPANY_NAME] [nvarchar](500) NULL,[COMPANY_code] [nvarchar](50) NULL,[EMP_CODE] [nvarchar](50) NULL,[EMP_name] [nvarchar](50) NULL)"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "CREATE TABLE lbill_cid([usr] [nvarchar](50) NULL,[image] [image] NULL,[no] [numeric](18, 0) NULL,[esl_no] [numeric](18, 0) NULL,[ky] [numeric](18, 0) IDENTITY(1,1) ,[yearn] [int] NOT NULL DEFAULT '0',[code] [int] NOT NULL DEFAULT '0',[IIMAGE] [nvarchar](50) NOT NULL DEFAULT '0',[bran] [nvarchar](50) NOT NULL DEFAULT '0',[st] [int] NOT NULL DEFAULT '0')"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "CREATE TABLE lbill_testimage([usr] [nvarchar](50) NULL,[image] [image] NULL,[no] [numeric](18, 0) NULL,[esl_no] [numeric](18, 0) NULL,[ky] [numeric](18, 0) IDENTITY(1,1),[yearn] [int] NOT NULL DEFAULT '0',[code] [int] NOT NULL DEFAULT '0',[IIMAGE] [nvarchar](50) NOT NULL DEFAULT '0',[bran] [nvarchar](50) NOT NULL DEFAULT '0',[st] [int] NOT NULL DEFAULT '0',[tb] [int] NOT NULL DEFAULT '0',[test_code] [int] NOT NULL DEFAULT '0')"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "CREATE TABLE lbill_cmt([usr] [nvarchar](50) NULL,[image] [image] NULL,[no] [numeric](18, 0) NULL,[esl_no] [numeric](18, 0) NULL,[ky] [numeric](18, 0) IDENTITY(1,1) ,[yearn] [int] NOT NULL DEFAULT '0',[code] [int] NOT NULL DEFAULT '0',[IIMAGE] [nvarchar](50) NOT NULL DEFAULT '0',[bran] [nvarchar](50) NOT NULL DEFAULT '0',[st] [int] NOT NULL DEFAULT '0')"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "CREATE TABLE llogsheet([usr] [nvarchar](50) NULL,[image] [image] NULL,[esl_date] [datetime] NULL,[no] [numeric](18, 0) NULL,[esl_no] [numeric](18, 0) NULL,[ky] [numeric](18, 0) IDENTITY(1,1) ,[yearn] [int] NOT NULL DEFAULT '0',[code] [int] NOT NULL DEFAULT '0',[IIMAGE] [nvarchar](50) NOT NULL DEFAULT '0',[bran] [nvarchar](50) NOT NULL DEFAULT '0')"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE branch ADD subres  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE branch ADD savenew   int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE branch ADD subres  LABOUT NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE branch ADD wuser  [nvarchar](50) NOT NULL DEFAULT '0',wpass  [nvarchar](50) NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()

        cmd.CommandText = "ALTER TABLE branch ADD online  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE branch ADD PMOBILE  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE branch ADD WSITE  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE users ADD EMP_CODE  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill ADD wuser   varchar(50) NOT NULL DEFAULT '0',wpass   varchar(50) NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill ADD wid   varchar(50) NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE branch ADD EMAILB  varchar(2000) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill ADD WEB  varchar(50) NOT NULL DEFAULT '0' "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE EEMP ADD DEMAIL  varchar(2000),OBOY INT NOT NULL DEFAULT '0',DOC INT NOT NULL DEFAULT '0' "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE branch ADD PASSB  varchar(2000) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE llog ADD BRAN  varchar(50) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE LBILL_ESL ADD SHIFT  varchar(50) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE Lbill_TEST ADD notesg  varchar(max) "
        cmd.ExecuteNonQuery()

        cmd.CommandText = "ALTER TABLE Lbill_TEST ADD notesp  varchar(max) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbillimage ADD usr  varchar(200) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE LCOMPANY ADD BRAN  varchar(MAX) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill ADD labd Nvarchar(50) NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbook_price ADD p1 Nvarchar(MAX) NOT NULL DEFAULT '1',p2 Nvarchar(MAX) NOT NULL DEFAULT '1',p3 Nvarchar(MAX) NOT NULL DEFAULT '1',p4 Nvarchar(MAX) NOT NULL DEFAULT '1' "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE ltest_price ADD p1 int NOT NULL DEFAULT '1',p2 int NOT NULL DEFAULT '1',p3 int NOT NULL DEFAULT '1',p4 int NOT NULL DEFAULT '1' "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE ltest_price ADD v1 int NOT NULL DEFAULT '1',v2 int NOT NULL DEFAULT '1',v3 int NOT NULL DEFAULT '1',v4 int NOT NULL DEFAULT '1' "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill ADD labd Nvarchar(MAX) NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()

        cmd.CommandText = "ALTER TABLE LCOMPANY ADD RESULT  Nvarchar(MAX) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE LCOMPANY ADD cond  varchar(MAX),name1  varchar(MAX),name2  varchar(MAX),name3  varchar(MAX),tel1  varchar(MAX),tel2  varchar(MAX),tel3  varchar(MAX),email1  varchar(MAX),email2  varchar(MAX),email3 varchar(MAX),test  varchar(MAX),web  varchar(MAX)"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "CREATE TABLE lcompany_image(code int NOT NULL DEFAULT '0'  ,[image] [image] NULL,[no] [numeric](18, 0) NULL,[company_code] [numeric](18, 0) NULL,[ky] [numeric](18, 0) IDENTITY(1,1) ,company_name  varchar(MAX),barn  varchar(MAX),)"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill_test ADD IMAGEN1  varchar(200),IMAGE1 IMAGE,IMAGEN3  varchar(200),IMAGE3 IMAGE,IMAGEN2  varchar(200),IMAGE2 IMAGE,IMAGEN4  varchar(200),IMAGE4 IMAGE,IMAGEN5  varchar(200),IMAGE5 IMAGE "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill_testsub ADD usr  varchar(200) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE LBILL_CULT_DET ADD usr  varchar(200) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE LBILL_CID ADD PRIMARY KEY (KY) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill_cmt ADD PRIMARY KEY (KY) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE llogsheet ADD PRIMARY KEY (KY) "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE llogsheet ADD ST int NOT NULL DEFAULT '1' "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE LBILL_TEST ADD DSN int NOT NULL DEFAULT '1' "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE LBILL_TESTSUB ADD DSN int NOT NULL DEFAULT '1' "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE USERS ADD SMSGA int NOT NULL DEFAULT '1' "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill_testimage ADD PRIMARY KEY (KY) "
        cmd.ExecuteNonQuery()
        ACdr.Close()
        ACcmd.CommandText = "ALTER TABLE TEST_PRICE ADD price11  Number,price12  Number,price13  Number,price14  Number,price15  Number,price16  Number,price17  Number,price18  Number,price19  Number,price20  Number,price21  Number,price22  Number,price23  Number,price24  Number,price25  Number,price26  Number,price27  Number,price28  Number,price29  Number,price30  Number,price31  Number,price32  Number,price33  Number,price34  Number,price35  Number,price36  Number,price37  Number,price38  Number,price39  Number,price40  Number,price41  Number,price42  Number,price43  Number,price44  Number,price45  Number,price46  Number,price47  Number,price48  Number,price49  Number,price50  Number,pricep  Number"
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = "ALTER TABLE TEST_PRICE ADD pricep  Number"
        ACcmd.ExecuteNonQuery()

        ACcmd.CommandText = "ALTER TABLE esl ADD erbank  Number"
        ACcmd.ExecuteNonQuery()



        ACcmd.CommandText = "ALTER TABLE TEST_PRICE ADD pricev Number"
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = "ALTER TABLE TEST_PRICE ADD RST Number NOT NULL DEFAULT '0'"
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = "ALTER TABLE TEST_PRICE ADD lck Number NOT NULL DEFAULT '0'"
        ACcmd.ExecuteNonQuery()

        ACcmd.CommandText = "ALTER TABLE TEST_SUB ADD RST Number NOT NULL DEFAULT '0'"
        ACcmd.ExecuteNonQuery()

        dr.Close()
        cmd.CommandText = "ALTER TABLE lbill_test ADD pricep  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lCASH ADD PRM  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lTEST ADD lck int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lsub ADD PRM  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lsub ADD PRM  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill_test ADD DSN  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE lbill_testSUB ADD DSN  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "ALTER TABLE lbill_test ADD tSQ  int NOT NULL DEFAULT '0',tSQ1  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE ltest ADD tS1  int NOT NULL DEFAULT '0',tS2  int NOT NULL DEFAULT '0',tS3  int NOT NULL DEFAULT '0',tS4  int NOT NULL DEFAULT '0',tS5  int NOT NULL DEFAULT '0'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "CREATE TABLE ERLOGE (st  int NOT NULL DEFAULT '1',EMSG varchar(MAX),ENUM VARCHAR(MAX),ESENDER VARCHAR(50),ETIME datetime,EDATE datetime,LNAME NVARCHAR(50),LBRANCH NVARCHAR(50),LBRAN VARCHAR(50),[ky] [numeric](18, 0) IDENTITY(1,1) )"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "ALTER TABLE erloge ADD PRIMARY KEY (KY)"
        cmd.ExecuteNonQuery()
        '================================================================================
        ''dr.Close()
        ''cmd.CommandText = "UPDATE lbill SET lbill.pmobile = LPATIEN.pmobile FROM lbill INNER JOIN LPATIEN ON lbill.pcode = LPATIEN.pcode and lbill.pname = LPATIEN.pname "
        ''cmd.ExecuteNonQuery()
        ' ''cmd.CommandText = "CREATE TABLE lbillemage([esl_no] [numeric](18, 0) NULL,[yearn] [int] NULL,[bran] [varchar](50) NULL,[image] [image] NULL,[ky] [numeric](18, 0) IDENTITY(1,1) NOT NULL,CONSTRAINT [PK_lbillemage] PRIMARY KEY CLUSTERED) "
        ' ''cmd.ExecuteNonQuery()
        ''cmd.CommandText = "INSERT INTO LBILLEMAGE (ESL_NO,BRAN,YEARN) SELECT ESL_NO,BRAN,YEARN FROM LBILL "
        ''cmd.ExecuteNonQuery()
        ''cmd.CommandText = "UPDATE lbill SET lbill.REG_CODE = LPATIEN.REG_CODE,lbill.COMPANY_CODE = LPATIEN.COMPANY_CODE,lbill.REG_NAME = LPATIEN.REG_NAME,lbill.COMPANY_NAME = LPATIEN.COMPANY_NAME FROM LPATIEN INNER JOIN ltest ON LPATIEN.PCODE = LBILL.PCODE"
        ''MsgBox(cmd.ExecuteNonQuery())

        'cmd.CommandText = "ALTER TABLE lbill add   fs int "
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE lbill add   utc int"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE lbill add   utn int"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE lbill add   ucash int"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE ltest DROP COLUMN  st"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  ltest ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  LSUBTEST ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  ltest_price ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lnstest ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lntest ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  LGTEST ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  LGr ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  users ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lgroup ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lgroup_price ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lgroup_test ADD BRAN  varchar(2000)"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  ltest ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  LSUBTEST ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lbill ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  Lbill_TEST ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  Lbill_TESTsub ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  Lbill_cult ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  Lbill_cult_det ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  Lbill_esl ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  LbillemAGE ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  ltest_price ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lnstest ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lntest ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  LGTEST ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  LGr ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  users ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lgroup ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lgroup_price ADD ST INT"
        'cmd.ExecuteNonQuery()
        'cmd.CommandText = "ALTER TABLE  lgroup_test ADD ST INT"
        'cmd.ExecuteNonQuery()
        MsgBox("ITS OK ALLAH")
    End Sub

    Private Sub qq180_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq180.Click
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandText = "select * from lbill where  bdel=0 and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' order by esl_no"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        Dim v As Integer = 0
        v = 0
        Dim aa As Integer = 0
        Dim a As Integer = 0
        Dim s As String = ""
        While Not v = F31.Rows.Count
            RC = F31.Rows(v)
            s = RC("esl_time")
            If s.Substring(0, s.IndexOf(":", 1)) <> a Then a = 0 : aa = 1
            s = s.Substring(0, s.IndexOf(":", 1))
            RC.BeginEdit()
            RC("pas") = s
            If a = 0 Then RC("rcv") = 1 Else RC("rcv") = aa
            RC.EndEdit()
            If Val(HR1.Text) > s Or Val(HR2.Text) < s Then RC.Delete()

            a = s
            aa = aa + 1
            v = v + 1
        End While
        F31DTG()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & pname.Text, 0, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\billp.rpt")
        oj.Database.Tables(0).SetDataSource(F31)
        oj.SetParameterValue("1", 1)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub QQ200_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim x As String = MsgBox("Â·  —Ìœ  ⁄œÌ· «·«”⁄«— ·› —Â", MsgBoxStyle.YesNo)
        If x = vbNo Then Exit Sub
        If Ntest_NAME.Text = "" Then Me.Text = "«·—Ã«¡ ﬂ «»… «”„ «· Õ·Ì·" : Exit Sub
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 205 Then Exit Sub
        dr1.Close()
        cmd1.CommandText = "update lbill_test set lab='0',labprice='0',test_price='0' WHERE esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' "
        cmd1.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "UPDATE lbill_test SET lbill_test.lab = ltest.lab FROM lbill_test INNER JOIN ltest ON lbill_test.test_code = ltest.test_code  where ltest.lab=1 and  lbill_test.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        MsgBox(cmd.ExecuteNonQuery())
        cmd.CommandText = "UPDATE lbill_test SET lbill_test.labprice = ltest_price.tot FROM lbill_test INNER JOIN ltest_price ON lbill_test.test_code = ltest_price.test_code  where lbill_test.lab=1 and ltest_price.book_price_code = '2' and lbill_test.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        MsgBox(cmd.ExecuteNonQuery())
        cmd.CommandText = "UPDATE lbill_test SET lbill_test.test_price = ltest_price.tot FROM lbill_test INNER JOIN ltest_price ON lbill_test.test_code = ltest_price.test_code  where lbill_test.lab=1 and ltest_price.book_price_code = '1' and lbill_test.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        MsgBox(cmd.ExecuteNonQuery())
        dr.Close()
        dr1.Close()
        cmd.CommandText = "select sum (labprice),esl_no from lbill_test where lab=1 and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' group by esl_no"
        dr = cmd.ExecuteReader
        While dr.Read

            dr1.Close()
            Dim nnnn As String = ""
            cmd1.CommandText = "select test_name ,esl_no,lab,labprice from lbill_test where esl_no='" & dr("esl_no") & "' and lab=1 group by test_name ,esl_no,lab,labprice"
            dr1 = cmd1.ExecuteReader
            While dr1.Read
                nnnn = nnnn & " +  " & dr1("test_name")
            End While
            dr1.Close()
            cmd1.CommandText = "update lbill set ptot='" & dr(0) & "',ppay='" & dr(0) & "',labtest='" & nnnn & "' where esl_no='" & dr(1) & "'"
            cmd1.ExecuteNonQuery()
        End While
    End Sub

    Private Sub DataGridView2_CellContentClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView2.CellContentClick

    End Sub

    Private Sub qq69_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub qq22_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq22.Click
        On Error Resume Next
        dr.Close()
        cmd.CommandText = "BACKUP DATABASE [ASILLAB] TO  DISK = N'E:\techno\asil" & Now.DayOfYear & "' WITH NOFORMAT, INIT,  NAME = N'ASILLAB-Full Database Backup', SKIP, NOREWIND, NOUNLOAD,  STATS = 10"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "BACKUP DATABASE [ASILLAB] TO  DISK = N'D:\asil" & Now.DayOfYear & "' WITH NOFORMAT, INIT,  NAME = N'ASILLAB-Full Database Backup', SKIP, NOREWIND, NOUNLOAD,  STATS = 10"
        cmd.ExecuteNonQuery()

        MsgBox("backup done ")
    End Sub

    Private Sub qq300_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 205 Then Exit Sub
        dr.Close()
        dr1.Close()
        cmd1.CommandText = "UPDATE lbill set esl_date='" & esl_date.Value & "'   where  esl_ no>17020  "
        cmd1.ExecuteNonQuery()
        'cmd1.CommandText = "UPDATE lbill_ESL where     " & "yearn='" & Val(YEARN.Text) & "'  "
        'cmd1.ExecuteNonQuery()
        'cmd1.CommandText = "UPDATE lbill_test  where     " & "yearn='" & Val(YEARN.Text) & "'  "
        'cmd1.ExecuteNonQuery()
        'cmd1.CommandText = "UPDATE lbill_testsub where     " & "yearn='" & Val(YEARN.Text) & "'  "
        'cmd1.ExecuteNonQuery()
        'cmd1.CommandText = "UPDATE LBILL_CULT where      " & "yearn='" & Val(YEARN.Text) & "'  "
        'cmd1.ExecuteNonQuery()
        'cmd1.CommandText = "UPDATE LBILL_CULT_DET where     " & "yearn='" & Val(YEARN.Text) & "'  "
        'cmd1.ExecuteNonQuery()
        'cmd1.CommandText = "UPDATE lbillimage where    " & "yearn='" & Val(YEARN.Text) & "'"
        'cmd1.ExecuteNonQuery()
        'cmd1.CommandText = "UPDATE  lbillemage where      " & "yearn='" & Val(YEARN.Text) & "'  "
        'cmd1.ExecuteNonQuery()

        'cmd1.CommandText = "delete LPATIEN set st=0 "
        'cmd1.ExecuteNonQuery()
    End Sub

    Private Sub QQ230_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ230.Click
        '        Try
        'mm:
        Dim n As Integer = 1
        dr.Close()
        cmd.CommandText = "SELECT * FROM LBILLEMAGE WHERE IMAGE IS NULL  "
        dr = cmd.ExecuteReader
        While dr.Read
            System.IO.File.WriteAllText("d:\Serials.text", "empty")
            If IO.File.Exists(Application.StartupPath & "\esl\" & dr("BRAN") & dr("BRAN")) = False Then
                Dim W As Integer = Convert.ToInt32("150")
                Dim H As Integer = Convert.ToInt32("37")
                bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
                Dim type As BarcodeLib.TYPE = BarcodeLib.TYPE.UNSPECIFIED
                type = BarcodeLib.TYPE.CODE128
                bar1.IncludeLabel = True
                barco.Image = bar1.Encode(type, dr("BRAN").ToString.Trim & dr("ESL_NO").ToString.Trim, W, H)
                IO.File.Delete(Application.StartupPath & "\esl\" & n & dr("BRAN") & dr("BRAN"))
                barco.Image.Save(Application.StartupPath & "\esl\" & n & dr("BRAN") & dr("ESL_NO"), System.Drawing.Imaging.ImageFormat.Jpeg)
            End If
            Dim oer As System.IO.FileStream
            Dim rer As IO.StreamReader
            oer = New IO.FileStream(Application.StartupPath & "\esl\" & n & dr("BRAN") & dr("ESL_NO"), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
            rer = New IO.StreamReader(oer)
            Dim FileByteArrayr(oer.Length - 1) As Byte
            oer.Read(FileByteArrayr, 0, oer.Length)
            dr1.Close()
            Dim AAAAA As String = ""
            Dim Sql As String = "update  lbillemage set image = ? " & AAAAA & "  where  ESL_NO='" & Val(dr("esl_no")) & "' and " & "yearn='" & Val(dr("YEARN")) & "' and bran='" & dr("BRAN") & "'"
            cmd1.CommandText = Sql
            cmd1.Parameters.Clear()
            cmd1.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
            cmd1.ExecuteNonQuery()

            n += 1
        End While
        'Catch ex As Exception
        '    GoTo mm
        'End Try


    End Sub

    Private Sub qq61_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq61.Click
        dr.Close()
        cmd.CommandText = "select * from lbill where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        ttrest = dr("rest")
        REST.Text = dr("rest")
        If REST.Text = 0 Then MsgBox("·« ÌÊÃœ »«ﬁÏ ⁄·Ï «·„—Ì÷") : Exit Sub
        ttpricenew.Focus()
        grest.Visible = Not grest.Visible
    End Sub
    Public Sub RESTF(ByVal TB As Integer)
        If esl_no.Text = "" Then Exit Sub : MsgBox("«·—Ã«¡ «Œ Ì«— «·«Ì’«·")
        If Val(ttpricenew.Text) = 0 Then Exit Sub : MsgBox("·« ÌÊÃœ »«ﬁÏ")
        dr.Close()
        cmd.CommandText = "select sum(tot),sum(erbank) from lbill_esl where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        BANK.Text = nulls(dr(1))
        PAY.Text = nulls(dr(0))
        Dim n As String = MsgBox("Â·  —Ìœ  ”ÃÌ· ø", MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close()
        Dim BILL1 As Integer
        cmd.CommandText = "select MAX(BILL),sum(erbank) from lbill_esl where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then BILL1 = nulls(dr(0)) + 1 Else BILL1 = 1

        Dim s1 As String = BILL1
        Dim s2 As Integer = 0
        Dim rst1 As Integer = 0
        Dim rst2 As Integer = 0
        Dim rst3 As Integer = 0
        Dim bbcash As Integer = 0
        Dim bbbank As Integer = 0
        If TB = 1 Then
            bbcash = ttpricenew.Text
        Else
            bbbank = ttpricenew.Text
        End If

        If edt = 0 And Math.Abs(Val(REST.Text)) < s2 Then Me.Text = "«·„·»€ «·»«ﬁÏ «ﬁ· „‰ «·„œ›Ê⁄" : Exit Sub
        dr.Close()
        cmd.CommandText = "select sum(test_price) from lbill_test where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and lab=1 and tdel=0"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            rst1 = nulls(dr(0))
        End If
        dr.Close()
        cmd.CommandText = "select sum(tot) from lbill_esl where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            rst2 = nulls(dr(0))
        End If
        If rst1 > rst2 Then rst3 = rst2 - rst1
        rst3 = rst3 * -1
        dr.Close()
        cmd.CommandText = "INSERT INTO  [lbill_esl]([esl_no],[bill],[tot],sdate,rest,billrest,BRAN,yearn,usr,shift,erbank) VALUES ('" & Val(esl_no.Text) & "','" & Val(s1) & "','" & bbcash & "','" & ChangeFormat(Now) & "','1','" & Val(rst3) & "','" & bran.Text & "','" & YEARN.Text & "','" & USR & "','" & SHF & "','" & bbbank & "')"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill set pay='" & bbcash + PAY.Text & "', bank='" & bbbank + BANK.Text & "', rest='" & ttpricenew.Text + ttrest & "', restusr='" & USR & "', restdate='" & ChangeFormatall(Now) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        Me.Text = " „  ”ÃÌ· «·»«ﬁÏ"
        If PORV <> "" Then
            dr.Close()
            cmd.CommandText = " update lbill set st=1 where st=0 and ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
        End If

        fesl(0, 0)
        ttpricenew.Text = ""
        grest.Visible = False
    End Sub
    Private Sub GlassButton2_Click_9(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GT21.Click
        pthg()
    End Sub

    Private Sub LASTToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles LASTToolStripMenuItem1.Click
        FLNB = -1
        FLNBF(1, 0)
    End Sub

    Private Sub NEXTToolStripMenuItem2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NEXTToolStripMenuItem2.Click
        FLNB = FLNB + 1
        esl_no.Text = FLNB
        fesl(0, 0)
    End Sub

    Private Sub PERVToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PERVToolStripMenuItem1.Click
        If FLNB <> -1 Then
            FLNB = FLNB - 1
        End If
        esl_no.Text = FLNB
        fesl(0, 0)
    End Sub

    Private Sub FRISTToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FRISTToolStripMenuItem1.Click
        FLNB = 1
        FLNBF(0, 0)
    End Sub

    Private Sub PervToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PervToolStripMenuItem.Click
        If FLNB <> -1 Then
            FLNB = FLNB - 1
        End If
        esl_no.Text = FLNB
        fesl(0, 0)

    End Sub

    Private Sub NextToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NextToolStripMenuItem.Click
        FLNB = FLNB + 1
        esl_no.Text = FLNB
        fesl(0, 0)
    End Sub

    Private Sub ÿ»«⁄…«·ﬂÊœToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ÿ»«⁄…«·ﬂÊœToolStripMenuItem.Click
        ACdr.Close()
        ACcmd.CommandText = "select * from srv"
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        PrintPreviewDialog2.Document = PrintDocument2
        PrintDialog2.PrinterSettings.PrinterName = ACdr("srv")
        PrintDialog2.Document = PrintDocument2
        docs = 2
        ACdr.Close()
        Dim paddedParam As String = ""
        ACcmd.CommandText = "SELECT TEST_AR,tot,shortname FROM TEST_PRICE WHERE qun>0 order by TEST_AR"
        ACdr = ACcmd.ExecuteReader
        barscode = ""
        barscode = "   code  " & paddedParam.PadRight(35) & "=>   price  "
        barscode = barscode & Environment.NewLine & "   " & "------------------------------------------"
        Dim sums As Integer = 0
        While ACdr.Read
            If Val(ACdr("TEST_AR")) = 0 Then
                barscode = barscode & Environment.NewLine & "   " & ACdr("shortname") & paddedParam.PadRight(35 - Val(ACdr("shortname").ToString.Length), " ") & "=>   " & ACdr("tot")
            Else
                barscode = barscode & Environment.NewLine & "   " & ACdr("TEST_AR") & paddedParam.PadRight(35 - Val(ACdr("TEST_AR").ToString.Length), " ") & "=>   " & ACdr("tot")
            End If
            sums = sums + ACdr("tot")
        End While
        barscode = barscode & Environment.NewLine & "   " & "------------------------------------------"
        barscode = barscode & Environment.NewLine & " TOTAL ========================> " & sums
        PrintDocument2.Print()


    End Sub


    Public Sub NBAR()
        ACdr.Close()
        ACcmd.CommandText = "delete * from barcode"
        ACcmd.ExecuteNonQuery()
        dr.Close()
        Dim nna As String = ""
        Dim nnk As String = ""
        cmd.CommandText = "select bar,kid_type from v_lab where ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND tdel=0 group by bar,kid_type order by kid_type"
        dr = cmd.ExecuteReader
        While dr.Read
            If nulls(dr("kid_type")) = "0" Or nulls(dr("kid_type")).Length = 1 Then
mm:
                ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nna & "','0')"
                ACcmd.ExecuteNonQuery()
                nna = ""
            ElseIf dr("kid_type") = "" Then
                ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nna & "','0')"
                ACcmd.ExecuteNonQuery()
                nna = ""
            Else
                If UCase(nnk) <> UCase(dr("kid_type")) Then
                    If nnk = "" Then GoTo mm
                    ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nnk & "','0')"
                    ACcmd.ExecuteNonQuery()

                    nna = ""
                End If
            End If
            If nna = "" Then nna = dr("bar") Else nna = nna & "+" & dr("bar")
            nnk = UCase(dr("kid_type"))
        End While
        ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nnk & "','0')"
        ACcmd.ExecuteNonQuery()

        ACdr.Close() : ACcmd.CommandText = "select * from barcode where kid<>''"
        adbar.SelectCommand = ACcmd
        adbar.Fill(DBS, "bar")
        bar = DBS.Tables("bar")
        DBS.Tables("bar").Clear()
        adbar.Fill(DBS, "bar")
        bar = DBS.Tables("bar")
        brpd.DataSource = bar
        brpd.Columns("qun").Visible = True
        TabControl2.SelectTab(0)
    End Sub
    Private Sub bran_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles bran.TextChanged
        FRC = branch.Select("bran='" & bran.Text & "'")
        RC = FRC(0)
        branch_name.Text = RC("name")
        fbranch(1)

    End Sub

    Private Sub PrintDocument2_PrintPage(ByVal sender As System.Object, ByVal e As System.Drawing.Printing.PrintPageEventArgs) Handles PrintDocument2.PrintPage
        Dim f1 As New Font("arial", 8, FontStyle.Regular)
        Dim ee As Integer = 0
        Dim eea As Integer = 0
        ''While ee <= barscode.Length
        ''    If barscode.Length - ee >= 35 Then e.Graphics.DrawString(barscode.Substring(ee, 35), f1, Brushes.Black, 0, eea) Else e.Graphics.DrawString(barscode.Substring(ee), f1, Brushes.Black, 0, eea)
        ''    ee += 35
        ''    eea += 25
        ''End While
        e.Graphics.DrawString(barscode, f1, Brushes.Black, 0, eea)
    End Sub


    Private Sub qq3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq3.Click
        fesl_no()
        CODEB.Text = esl_no.Text
        Dim naa As Integer = 0
        While Not naa = ptt.Rows.Count
            If RC.RowState <> DataRowState.Deleted Then
                RC = ptt.Rows(naa)
                esl_no.Text = 0
                pname.Text = nulls(RC("NAME"))
                page.Text = nulls(RC("AGE"))
                If nulls(RC("ESL")) = 0 Then fesl_no() Else esl_no.Text = nulls(RC("ESL"))
                pcode.Text = 0

                If UCase(nulls(RC("TYPE"))) = "M" Then
                    PNIK.Text = "«” «–"
                    ptype.Text = "MALE"
                Else
                    PNIK.Text = "«” «–…"
                    ptype.Text = "FEMALE"
                End If
                pmobile.Text = nulls(RC("ID"))
                FSAVEV()
                dr.Close()

                If CheckBox1.Checked = True Then FBARR() : FBARS()
                If CheckBox15.Checked = True Then
                    dr.Close() : cmd.CommandText = "SELECT  * from v_lab where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND tdel=0"
                    adesl.SelectCommand = cmd
                    adesl.Fill(DBS, "esl")
                    esl = DBS.Tables("esl")
                    DBS.Tables("esl").Clear()
                    adesl.Fill(DBS, "esl")
                    esl = DBS.Tables("esl")
                    brpd.DataSource = esl
                    Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
                    oj.Load(Application.StartupPath & rptp.Text & "\esl.rpt")
                    oj.Database.Tables(0).SetDataSource(esl)
                    rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
                    oj.PrintToPrinter(1, False, 0, 0)
                End If
                If CheckBox2.Checked = True Then
                    dr.Close()
                    cmd.CommandText = "select count(esl_no) from lbill where pcode='" & pcode.Text & "'"
                    dr = cmd.ExecuteReader
                    dr.Read()
                    If dr.HasRows = True Then
                        If dr(0) > 1 Then ss = "Â–« «·„—Ì÷ ”»ﬁ “Ì«— Â ·‰« „‰ ﬁ»· «·—Ã«¡ «· «»⁄…"
                    End If
                    dr.Close() : cmd.CommandText = "SELECT  * from v_lab where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND tdel=0"
                    adesl.SelectCommand = cmd
                    adesl.Fill(DBS, "esl")
                    esl = DBS.Tables("esl")
                    DBS.Tables("esl").Clear()
                    adesl.Fill(DBS, "esl")
                    esl = DBS.Tables("esl")
                    brpd.DataSource = esl
                    Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
                    oj.Load(Application.StartupPath & rptp.Text & "\work sheet.rpt")
                    oj.Database.Tables(0).SetDataSource(esl)
                    oj.SetParameterValue("ss", ss)
                    rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
                    oj.PrintToPrinter(1, False, 0, 0)
                End If

            End If

            naa = naa + 1
            CODEE.Text = esl_no.Text
        End While

        'qq3.Visible = False
    End Sub


    Private Sub QQ5_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ5.Click
        ACdr.Close()
        ACcmd.CommandText = "select * from srv"
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        PrintPreviewDialog1.Document = PrintDocument1
        PrintDialog1.PrinterSettings.PrinterName = ACdr("prnt")
        PrintDialog1.Document = PrintDocument1
        RP1.Checked = False
        CCODE.Checked = True
        f3(1)
        RP1.Checked = True
        CCODE.Checked = False
        Dim x As Integer = 0
        Dim NAA As Integer = CODEB.Text
        While Not NAA > CODEE.Text
            RC = F31.Rows(x)
            esl_no.Text = NAA
            pname.Text = RC("pname")
            page.Text = RC("page")
            docs = 0
            Dim W As Integer = Convert.ToInt32("150")
            Dim H As Integer = Convert.ToInt32("37")
            bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
            Dim type As BarcodeLib.TYPE = BarcodeLib.TYPE.UNSPECIFIED
            type = BarcodeLib.TYPE.CODE128
            bar1.IncludeLabel = True
            bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
            type = BarcodeLib.TYPE.CODE128
            bar1.IncludeLabel = True
            If bran.Text = "0" Then barco.Image = bar1.Encode(type, Me.esl_no.Text.Trim(), W, H) Else barco.Image = bar1.Encode(type, Me.bran.Text.Trim + Me.esl_no.Text.Trim(), W, H)
            SSSS = 0
            nnq = 0
            nnw = 0
            FBARR()

            While Not nnw = bar.Rows.Count
                nnq = 0
mm:
                If bar.Rows(nnw).Item("qun") > 0 And nnq < bar.Rows(nnw).Item("qun") Then
                    docs = 1
                    PrintDocument1.Print()
                    SSSS = +1
                    nnq = nnq + 1
                    GoTo mm
                End If
                nnw = nnw + 1
            End While
            NAA = NAA + 1

            x = x + 1
        End While
        'QQ5.Visible = False
    End Sub

    Private Sub QQ6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ6.Click
        Dim DD As String = MsgBox("Â·  —Ìœ Õ–› ﬂ· «·„ﬂ Ê» ø", MsgBoxStyle.YesNo)
        If DD = vbNo Then Exit Sub

        ACdr.Close()
        ACcmd.CommandText = "delete * from zzz"
        ACcmd.ExecuteNonQuery()
        cmdptt.Connection = ACcn
        cmdptt.CommandText = "select * from PATCH_SAVE "
        adptt.SelectCommand = cmdptt
        adptt.Fill(DBS, "ptt")

        ptt = DBS.Tables("ptt")
        brpd.DataSource = ptt
        'ptt.Rows.Clear()
        'ptt.Columns.Add("a")
        'ACdr.Close()
        'ACcmd.CommandText = "select * from PATCH_SAVE"
        'ACdr = ACcmd.ExecuteReader
        'While ACdr.Read
        '    RC = ptt.NewRow
        '    RC("sen") = ACdr("name")
        '    RC("mod") = 0
        '    RC("ress") = 0
        '    RC("mob") = ACdr("id")
        '    ptt.Rows.Add(RC)
        'End While
        flng("AR")

    End Sub

    Private Sub GlassButton6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton6.Click
        GroupBox10.Visible = False
    End Sub

    Private Sub REFRESHToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles REFRESHToolStripMenuItem.Click
        ftprice()
    End Sub

    Private Sub QQ31_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ31.Click
        Try
            dr.Close()
            cmd.CommandText = "update lbill_testsub set lbill_testsub.q=LSUBTEST.q ,lbill_testsub.p=LSUBTEST.p,lbill_testsub.so=LSUBTEST.so,lbill_testsub.rso=LSUBTEST.rso from lbill_testsub inner join LSUBTEST on lbill_testsub.test_code=LSUBTEST.test_code where  lbill_testsub.esl_no='" & esl_no.Text & "'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update lbill_test set lbill_test.so=LTEST.so,lbill_test.rso=LTEST.rso from lbill_test inner join ltest on lbill_test.test_code=ltest.test_code where  esl_no='" & esl_no.Text & "'"
            cmd.ExecuteNonQuery()
            MsgBox(" „  ⁄„·Ì…  ⁄œÌ· «· — Ì» ›Ï Â–« «·«Ì’«·", MsgBoxStyle.Information)
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub q32_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles q32.Click
        Try

            dr.Close()
            Dim XLOG As String = " «·«”„ " & pname.Text & "-" & " «·”‰ " & page.Text & "-" & " «· ·Ì›Ê‰ " & pmobile.Text & "-" & " «·ÿ»Ì» " & REG_name.Text & COMPANY_name.Text & "-" & " «·‘—ﬂ… " & "-" & "«·„œ›Ê⁄ " & PAY.Text & "-" & " «·Œ’„ " & DISS.Text & "-" & qqq5.Text
            LLOG(" ⁄œÌ· “Ì«—…", esl_no.Text, XLOG, 1, bran.Text)
            Dim n As String = MsgBox("Â·  —Ìœ  ⁄œÌ· «·„—Ì÷ " & Environment.NewLine, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub

            dr.Close()
            cmd.CommandText = "update lbill set NCRD='" & Val(NCRD.CheckState) & "' ,ucash='" & Val(ucash.CheckState) & "' ,UTC='" & Val(utc.CheckState) & "'  , UTN='" & Val(utn.CheckState) & "',rcv_date='" & ChangeFormat(rcv_date.Value) & "', pemail='" & pemail.Text & "',PID='" & pid.Text & "',pmobile='" & pmobile.Text & "',pyear='" & PYEAR.Text & "',notes='" & lnotes.Text & "',pname='" & pname.Text & "',page='" & page.Text & "',nik='" & PNIK.Text & "',ptype='" & ptype.Text & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
            xpname = pname.Text
            PSAVE()
            MsgBox(" „  ⁄œÌ· «·„—Ì÷", MsgBoxStyle.Information)
            fesl(0, 0)
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub GroupBox9_Enter(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub



    Private Sub QQ120_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ120.Click

    End Sub

    Private Sub GlassButton4_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq4.Click, asasadsd.Click
        If ldoc = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, " ﬁ—Ì— ‰”»… «·ÿ»Ì»" & COMPANY_name.Text, 0, bran.Text)
            Exit Sub
        End If
        ComboBox5.Text = "rest"
        f3(6)

    End Sub

    Private Sub qq2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qq2.Click
        ComboBox5.Text = "rest"
        f3(7)
    End Sub

    Private Sub GlassButton4_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ1111.Click
        ACdr.Close()
        ACcmd.CommandText = "select * from srv "
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        Dim FileNames = TwainLib.ScanImages(esl_no.Text, True, ACdr("scan"))
        PictureBox1.ImageLocation = FileNames(0)
        Dim oer As System.IO.FileStream
        Dim rer As IO.StreamReader
        oer = New IO.FileStream(FileNames(0), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
        rer = New IO.StreamReader(oer)
        Dim FileByteArrayr(oer.Length - 1) As Byte
        oer.Read(FileByteArrayr, 0, oer.Length)
        dr.Close()
        cmd.CommandText = "select max(code) from BRANIMAGE  "
        dr = cmd.ExecuteReader
        dr.Read()
        IMAGE_CODE.Text = nulls(dr(0)) + 1
        dr.Close()
        cmd.CommandText = "insert into BRANIMAGE (SDATE,CODE,IIMAGE ,bran,yearn) values ('" & ChangeFormat(Now) & "','" & IMAGE_CODE.Text & "','" & IIMAGE.Text & "','" & bran.Text & "','" & YEARN.Text & "')"
        cmd.ExecuteNonQuery()
        Dim Sql As String = "update  BRANIMAGE set image = ? , no = ? where  CODE='" & IMAGE_CODE.Text & "'"
        cmd.CommandText = Sql
        cmd.Parameters.Clear()
        cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
        cmd.Parameters.Add("@no", System.Data.OleDb.OleDbType.VarChar, 100).Value = oer.Length
        cmd.ExecuteNonQuery()

    End Sub

    Private Sub QQ2222_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQ2222.Click
        CN.Close()
        dr.Close()
        dr1.Close()
        dr2.Close()
        ACdr.Close()
        acdr1.Close()
        CN.ConnectionString = PORV
        CN.Open()
        cmd.Connection = CN
        cmd.CommandType = CommandType.Text
        cmd.CommandText = "select * from users"
        dr = cmd.ExecuteReader
        dr.Read()
        dr.Close()
        dr.Close() : cmd.CommandText = "SELECT  * from BRANIMAGE where SDATE='" & ChangeFormat(esl_date.Value) & "' AND BRAN='" & bran.Text & "'"
        adPVW.SelectCommand = cmd
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        DBS.Tables("PVW").Clear()
        adPVW.Fill(DBS, "PVW")
        PVW = DBS.Tables("PVW")
        brpd.DataSource = PVW
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\limages.rpt")
        oj.Database.Tables(0).SetDataSource(PVW)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
        CN.Close()
        dr.Close()
        dr1.Close()
        dr2.Close()
        ACdr.Close()
        acdr1.Close()
        open_sql()

    End Sub

    Private Sub qqq1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qqq1.Click
        CN.Close()
        dr.Close()
        dr1.Close()
        dr2.Close()
        ACdr.Close()
        acdr1.Close()
        CN.ConnectionString = PORV
        CN.Open()
        cmd.Connection = CN
        cmd.CommandType = CommandType.Text
        cmd.CommandText = "select * from users"
        dr = cmd.ExecuteReader
        dr.Read()
        dr.Close()
        PORV = ""
        dr.Close() : cmd.CommandText = "select * from branch"
        adbranch.SelectCommand = cmd
        adbranch.Fill(DBS, "branch")
        branch = DBS.Tables("branch")
        branch_name.DataSource = branch
        branch_name.DisplayMember = "NAME"
        MsgBox("YOU CONNECTED TO SERVER ", MsgBoxStyle.Information)

    End Sub

    Private Sub GlassButton4_Click_3(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qqq4.Click
        If lmach = 0 Then Exit Sub
        yy = ""
        If CBRAN.Checked = True Then yy = yy & " AND branch_name='" & branch_name.Text & "'"
        dr.Close()
        dr1.Close()
        cmd.CommandText = "delete from lbn"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "select sum (cash),date1 from lcash where  flg=1 and PRM=0 AND  date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" & yy & " group by date1 order by date1"
        dr = cmd.ExecuteReader
        While dr.Read
            cmd1.CommandText = "insert into lbn (sdate,in1,ot1) values ('" & ChangeFormat(dr(1)) & "','" & nulls(dr(0)) & "','0')"
            cmd1.ExecuteNonQuery()
        End While
        dr.Close()
        cmd.CommandText = "select sum (cash),date1 from lcash where  flg=-1 and  PRM =0 AND date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" & yy & " group by date1 order by date1"
        dr = cmd.ExecuteReader
        While dr.Read
            dr1.Close()
            cmd1.CommandText = "select * from lbn where sdate='" & ChangeFormat(dr("date1")) & "'"
            dr1 = cmd1.ExecuteReader()
            If dr1.HasRows = True Then
                dr1.Close()
                cmd1.CommandText = "update  lbn  set ot1='" & nulls(dr(0)) & "' where sdate='" & ChangeFormat(dr("date1")) & "'"
                cmd1.ExecuteNonQuery()
            Else
                dr1.Close()
                cmd1.CommandText = "insert into lbn (sdate,ot1,in1) values ('" & ChangeFormat(dr(1)) & "','" & nulls(dr(0)) & "','0')"
                cmd1.ExecuteNonQuery()
            End If

        End While
        dr.Close()
        dr1.Close()
        cmd.CommandText = "select cash,SUB_NAME from lcash where  flg=-1 and PRM=1 AND  date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" & yy & "  order by SUB_NAME"
        dr = cmd.ExecuteReader
        While dr.Read
            cmd1.CommandText = "insert into lbn (sdate,ot1,in1) values ('" & dr(1) & "','" & nulls(dr(0)) & "','0')"
            cmd1.ExecuteNonQuery()
        End While
        dr.Close()
        dr1.Close()
        cmd.CommandText = "select cash,SUB_NAME from lcash where  flg=1 and PRM=1 AND  date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'" & yy & "  order by SUB_NAME"
        dr = cmd.ExecuteReader
        While dr.Read
            cmd1.CommandText = "insert into lbn (sdate,in1,ot1) values ('" & dr(1) & "','" & nulls(dr(0)) & "','0')"
            cmd1.ExecuteNonQuery()
        End While
        dr.Close() : cmd.CommandText = "select * from lbn "
        adlbn.SelectCommand = cmd
        adlbn.Fill(DBS, "lbn")
        lbn = DBS.Tables("lbn")
        DBS.Tables("lbn").Clear()
        adlbn.Fill(DBS, "lbn")
        lbn = DBS.Tables("lbn")
        brpd.DataSource = ""
        brpd.DataSource = lbn

        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\lbn.rpt")
        oj.Database.Tables(0).SetDataSource(lbn)
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show()
        rp.Focus()
    End Sub

    Private Sub Õ›Ÿ‰ ÌÃ…ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        SAVERES(1, 0)
    End Sub

    Private Sub qqq6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qqq6.Click

        ComboBox5.Text = "print"
        f3(1)
        ComboBox5.Text = "rest"

    End Sub

    Private Sub qqqq1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        'If TextBox8.Text = "" Then Me.Text = "«·—Ã«¡ «· √ﬂœ „‰ «·«·Œ“Ì‰…" : Exit Sub
        'dr.Close()
        'cmd.CommandText = "select * from ltc where   name='" & TextBox8.Text & "'"
        'dr = cmd.ExecuteReader
        'dr.Read()
        'If dr.HasRows = True Then Exit Sub
        'dr.Close() : cmd.CommandText = "insert into ltc (name)  values ('" & Trim(TextBox8.Text) & "')"
        'cmd.ExecuteNonQuery()
        'dr.Close()
        'CheckedListBox1.Items.Clear()
        'dr.Close()
        'cmd.CommandText = "SELECT * FROM LTC"
        'dr = cmd.ExecuteReader
        'While dr.Read
        '    CheckedListBox1.Items.Add(dr("NAME"))
        'End While
        'TextBox8.Text = ""
    End Sub

    Private Sub TextBox8_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)
        'If e.KeyCode = Keys.Enter Then
        '    qqqq1_Click(qqqq1, e)
        'End If
    End Sub




    Private Sub qqq11_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub ssts_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)
        'cmdBILL.CommandText = "select * from TEST_PRICE WHERE [shortname] LIKE '%" & ssts.Text & "%' or  [test_name] LIKE '%" & ssts.Text & "%' "
        'adBILL.SelectCommand = cmdBILL
        'adBILL.Fill(DBS, "BILL")
        'BILL = DBS.Tables("BILL")
        'DBS.Tables("BILL").Clear()
        'adBILL.Fill(DBS, "BILL")
        'BILL = DBS.Tables("BILL")
        'btestd.DataSource = BILL
    End Sub

    Private Sub ssts_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub ToolStripMenuItem2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ToolStripMenuItem2.Click
        If ED = 0 Then Exit Sub
        Dim N As String = MsgBox("Â·  —Ìœ Õ–› «· Õ·Ì· „‰ «·«»’«·", MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "delete from lbill_test  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "delete from lbill_testsub where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        fesl(0, 0)
    End Sub

    Private Sub ToolStripMenuItem3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ToolStripMenuItem3.Click
        ACdr.Close()
        ACcmd.CommandText = "select * from srv"
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        PrintPreviewDialog1.Document = PrintDocument1
        'PrintPreviewDialog1.ShowDialog()3
        PrintDialog1.PrinterSettings.PrinterName = ACdr("prnt")
        PrintDialog1.Document = PrintDocument1
        ACdr.Close()
        ACcmd.CommandText = "delete * from barcode"
        ACcmd.ExecuteNonQuery()
        dr.Close()
        Dim nna As String = ""
        Dim nnk As String = ""
        Dim nk As Integer = 0
        cmd.CommandText = "select bar,kid_type from v_lab where  TEST_CODE='" & Ntest_CODE.Text & "' AND  ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND tdel=0 group by bar,kid_type order by kid_type"
        dr = cmd.ExecuteReader
        While dr.Read
            If nulls(dr("kid_type")) = "0" Or nulls(dr("kid_type")).Length = 1 Then
mm:
                ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nna & "','1')"
                ACcmd.ExecuteNonQuery()
                nna = ""
            ElseIf dr("kid_type") = "" Then
                ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nna & "','1')"
                ACcmd.ExecuteNonQuery()
                nna = ""
            Else
                If UCase(nnk) <> UCase(dr("kid_type")) Then
                    If nnk = "" Then GoTo mm
                    ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nnk & "','1')"
                    ACcmd.ExecuteNonQuery()

                    nna = ""
                End If
            End If
            If nna = "" Then nna = dr("bar") Else nna = nna & "+" & dr("bar")
            nnk = UCase(dr("kid_type"))

        End While
        ACcmd.CommandText = "insert into barcode (test,kid,qun) values ('" & nna & "','" & nnk & "','1')"
        ACcmd.ExecuteNonQuery()

        ACdr.Close() : ACcmd.CommandText = "select * from barcode where kid<>''"
        adbar.SelectCommand = ACcmd
        adbar.Fill(DBS, "bar")
        bar = DBS.Tables("bar")
        DBS.Tables("bar").Clear()
        adbar.Fill(DBS, "bar")
        bar = DBS.Tables("bar")
        brpd.DataSource = bar
        brpd.Columns("qun").Visible = True
        TabControl2.SelectTab(0)

        docs = 0
        Dim W As Integer = Convert.ToInt32("150")
        Dim H As Integer = Convert.ToInt32("37")
        bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
        Dim type As BarcodeLib.TYPE = BarcodeLib.TYPE.UNSPECIFIED
        type = BarcodeLib.TYPE.CODE128
        bar1.IncludeLabel = True
        bar1.Alignment = BarcodeLib.AlignmentPositions.CENTER
        type = BarcodeLib.TYPE.CODE128
        bar1.IncludeLabel = True
        If bran.Text = "0" Then barco.Image = bar1.Encode(type, Me.esl_no.Text.Trim(), W, H) Else barco.Image = bar1.Encode(type, Me.bran.Text.Trim + Me.esl_no.Text.Trim(), W, H)
        ''PrintDialog1.ShowDialog()
        SSSS = 0
        nnq = 0
        nnw = 0
        'PrintDocument1.Print()
        While Not nnw = bar.Rows.Count
            nnq = 0
mm1:
            If bar.Rows(nnw).Item("qun") > 0 And nnq < bar.Rows(nnw).Item("qun") Then
                docs = 1
                'PrintDialog1.ShowDialog()
                PrintDocument1.Print()
                SSSS = +1
                nnq = nnq + 1
                GoTo mm1
            End If
            nnw = nnw + 1
        End While
        bar.Rows.Clear()

    End Sub

    Private Sub EmailMangToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        emlprg = 1
        dr.Close()
        ACdr.Close()
        ACcmd.CommandText = "delete * from email "
        ACcmd.ExecuteNonQuery()
        EXPENS.Checked = True
        RP1.Checked = True
        cesl_date.Checked = True
        f3(4)
        cesl_date.Checked = True
        EXPENS.Checked = False
        Dim rrr As Process = Process.Start(Application.StartupPath & "\bar.exe")
        semail(bremail, pname.Text, "print report date " & esl_date.Value, 1, 0)
        rrr.Kill()
        If emlprg = 1 Then MessageBox.Show(" success send  to ", "  Successful?", MessageBoxButtons.OK, MessageBoxIcon.Information)

    End Sub

    Private Sub Timer2_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer2.Tick
        If rrname = COMPANY_name.Text Then
            dr.Close() : cmd.Connection = CN
            dr.Close() : cmd.CommandType = CommandType.Text
            dr.Close() : cmd.CommandText = "select * from Lcompany WHERE name LIKE '%" & REG_name.Text & "%'"
            adtemp.SelectCommand = cmd
            adtemp.Fill(DBS, "temp")
            temp = DBS.Tables("temp")
            DBS.Tables("temp").Clear()
            adtemp.Fill(DBS, "temp")
            temp = DBS.Tables("temp")
            brpd.DataSource = temp
            Dim v As Integer = 0
            While Not v = brpd.Columns.Count
                brpd.Columns(v).Visible = False
                v = v + 1
            End While
            brpd.Columns("code").Visible = True
            brpd.Columns("name").Visible = True
            brpd.Columns("name").Width = 300
        End If
        Timer2.Stop()
    End Sub

    Private Sub Timer3_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer3.Tick

    End Sub

    Private Sub FINDTESTToolStripMenuItem_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FINDTESTToolStripMenuItem.Click
        ctest.Checked = True
        test.Text = Ntest_NAME.Text
        ComboBox5.Text = "all"
        f3(1)
        ComboBox5.Text = "rest"
        ctest.Checked = False
    End Sub

    Private Sub GlassButton4_Click_4(ByVal sender As System.Object, ByVal e As System.EventArgs)
        acdr1.Close()
        ACdr.Close()
        ACcmd.CommandText = "select distinct(sname) from shady"
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            accmd1.CommandText = "insert into zzz(sen) values('" & ACdr(0) & "')"
            accmd1.ExecuteNonQuery()
        End While
    End Sub

    Private Sub GlassButton16_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton16.Click
        Dim X As String = MsgBox("Â·  —Ìœ  ⁄Ì‰ «·Œ“Ì‰… «·«”«”ÌÂ", MsgBoxStyle.YesNo)
        If X = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "UPDATE BRANCH set saven='" & save_code.Text & "' where code='" & branch_code.Text & "'"
        cmd.ExecuteNonQuery()

    End Sub
    Public Sub openonline()
        If SCN.State = ConnectionState.Connecting Then
            SCN.Close()
        End If

        If SCN.State = ConnectionState.Closed Then
            Try
                SCN.ConnectionString = PORV
                SCN.Open()
                SCMD.Connection = SCN
                SCMD.CommandText = "select * from branch"
                SDR = SCMD.ExecuteReader
                SDR.Read()
                scmd1.Connection = SCN
                scmd1.CommandText = "select * from branch"
                sdr1 = scmd1.ExecuteReader
                sdr1.Read()
                SDR.Close()
                sdr1.Close()
                MsgBox("YOU CONNECTED TO SERVER GIVE ME MINUTS TO UPLOAD DATA")

                SCMD.Connection = SCN
            Catch ex As OleDb.OleDbException
                MsgBox(" ⁄›Ê¬ ÌÊÃœ Œÿ√ ›Ï «·« ’«· »ﬁ«⁄œ… «·»Ì«‰« ", MsgBoxStyle.Critical + MsgBoxStyle.MsgBoxRight)
                End
                Exit Try
            End Try
        End If

    End Sub
    Private Sub updateonline_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles updateonline.Click
        If PORV.Length < 10 Then Exit Sub
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 206 Then Exit Sub
        Dim nali As Integer = 0
        openonline()
        Dim rrr As Process = Process.Start(Application.StartupPath & "\bar.exe")
        SDR.Close()
        sdr1.Close()
        dr.Close()
        SDR.Close()
        sdr1.Close()
        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from ltest "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from ltest "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "INSERT INTO ltest ([TEST_NAME],[short],[lab],[gso],[RSO],[SO],[KID_N],[KID_TYPE],[ResultAfter],[NormalRange],[TEST_CODE],[AR],[GCODE],[GNAME],[SUB],[CULT],[nor],[qun],[w],[gr_name],[gr_code],[color],[res],[notes],[st]) VALUES ('" & SDR("TEST_NAME") & "','" & SDR("short") & "','" & SDR("lab") & "','" & SDR("gso") & "','" & SDR("RSO") & "','" & SDR("SO") & "','" & SDR("KID_N") & "','" & SDR("KID_TYPE") & "','" & SDR("ResultAfter") & "','" & SDR("NormalRange") & "','" & SDR("TEST_CODE") & "','" & SDR("AR") & "','" & SDR("GCODE") & "','" & SDR("GNAME") & "','" & SDR("SUB") & "','" & SDR("CULT") & "','" & SDR("nor") & "','" & SDR("qun") & "','" & SDR("w") & "','" & SDR("gr_name") & "','" & SDR("gr_code") & "','" & SDR("color") & "','" & SDR("res") & "','" & SDR("notes") & "','" & SDR("LCK") & "') "
            cmd.ExecuteNonQuery()
        End While
        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lsub "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lsub "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into lsub (main_code,main_name,sub_code,sub_name,flg,PRM)  values ('" & SDR("main_code") & "','" & SDR("main_name") & "','" & SDR("sub_code") & "','" & SDR("sub_name") & "','" & SDR("flg") & "','" & SDR("PRM") & "')"
            cmd.ExecuteNonQuery()
        End While

        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lcult "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lcult "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into lcult (name,shr,groupe,so)  values ('" & SDR("name") & "','" & SDR("shr") & "','" & nulls(SDR("groupe")) & "','" & nulls(SDR("so")) & "')"
            cmd.ExecuteNonQuery()
        End While

        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lcomment "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lcomment "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into lcomment (name)  values ('" & SDR("name") & "')"
            cmd.ExecuteNonQuery()
        End While

        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lcultname "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lcultname "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into lcultname (name)  values ('" & SDR("name") & "')"
            cmd.ExecuteNonQuery()
        End While


        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lkid_type "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lkid_type "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into lkid_type (name)  values ('" & SDR("name") & "')"
            cmd.ExecuteNonQuery()
        End While

        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lnotes "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lnotes "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into lnotes (name)  values ('" & SDR("name") & "')"
            cmd.ExecuteNonQuery()
        End While

        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lhres "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lhres "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into lhres (name,sh)  values ('" & SDR("name") & "','" & SDR("sh") & "')"
            cmd.ExecuteNonQuery()
        End While

        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lshift "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lshift "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into lshift (name,code)  values ('" & SDR("name") & "','" & SDR("code") & "')"
            cmd.ExecuteNonQuery()
        End While

        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lunits "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lunits "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into lunits (name)  values ('" & SDR("name") & "')"
            cmd.ExecuteNonQuery()
        End While


        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from ltype "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from ltype "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into ltype (name,sname,sh)  values ('" & SDR("name") & "','" & SDR("sname") & "','" & nulls(SDR("sh")) & "')"
            cmd.ExecuteNonQuery()
        End While

        SDR.Close()
        dr.Close()
        cmd.CommandText = "delete  from LSUBTEST"
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from LSUBTEST "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = " INSERT INTO LSUBTEST ([TEST_CODE],[TEST_NAME],[MTEST_CODE],[MTEST_NAME],[res],[q],[so],[p],[rso],[notes],[st]) VALUES  ('" & SDR("TEST_CODE") & "','" & SDR("TEST_NAME") & "','" & SDR("MTEST_CODE") & "','" & SDR("MTEST_NAME") & "','" & SDR("res") & "','" & SDR("q") & "','" & SDR("so") & "','" & SDR("p") & "','" & SDR("rso") & "','" & SDR("notes") & "','0') "
            cmd.ExecuteNonQuery()
        End While

        SDR.Close()
        SDR.Close()
        sdr1.Close()
        cmd.CommandText = "delete  from lntest "
        cmd.ExecuteNonQuery()
        scmd1.CommandText = "select * from lntest "
        sdr1 = scmd1.ExecuteReader
        While sdr1.Read
            If IsDBNull(sdr1("TEST_CODE")) = False Then
                cmd.CommandText = " INSERT INTO lntest([TEST_CODE],[TEST_NAME],[REF],[TYPE],[AGEB],[AGEE],[NORB],[NORE],[UNIT],[year],[sres]) VALUES ('" & sdr1("TEST_CODE") & "','" & sdr1("TEST_NAME") & "','" & sdr1("REF") & "','" & sdr1("TYPE") & "','" & sdr1("AGEB") & "','" & sdr1("AGEE") & "','" & sdr1("NORB") & "','" & sdr1("NORE") & "','" & sdr1("UNIT") & "','" & sdr1("year") & "','" & sdr1("sres") & "')"
                cmd.ExecuteNonQuery()
            End If
        End While
        SDR.Close()
        cmd.CommandText = "delete  from lnstest"
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lnstest"
        SDR = SCMD.ExecuteReader
        While SDR.Read
            If IsDBNull(SDR("TEST_CODE")) = False And IsDBNull(SDR("mTEST_CODE")) = False Then
                cmd.CommandText = " INSERT INTO lnstest ([TEST_CODE],[TEST_NAME],[REF],[TYPE],[AGEB],[AGEE],[NORB],[NORE],[UNIT],[MTEST_CODE],[MTEST_NAME],[ref1],[year],[re1],[re2],[st]) VALUES  ('" & SDR("TEST_CODE") & "','" & SDR("TEST_NAME") & "','" & SDR("REF") & "','" & SDR("TYPE") & "','" & SDR("AGEB") & "','" & SDR("AGEE") & "','" & SDR("NORB") & "','" & SDR("NORE") & "','" & SDR("UNIT") & "','" & SDR("MTEST_CODE") & "','" & SDR("MTEST_NAME") & "','" & SDR("ref1") & "','" & SDR("year") & "','" & SDR("re1") & "','" & SDR("re2") & "','0') "
                cmd.ExecuteNonQuery()
            End If
        End While

        fprice1(1)

        '=========================


        rrr.Kill()
        MsgBox("ALL DATA IS UPTO DATE THANKS " & USR, MsgBoxStyle.Information)
    End Sub

    Private Sub weeeede_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles weeeede.Click
        'On Error Resume Next
        Dim x As String = ""
        If CBRAN.Checked = False Then
            x = " and bran='" & bran.Text & "'"
        End If
        dr.Close() : cmd.Connection = CN
        cmd.CommandText = "select * from V_LAB WHere company_name like'%" & COMPANY_name.Text & "%' and bdel=0 and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' and bran='" & bran.Text & "'" & x
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & COMPANY_name.Text, 0, bran.Text)

        If F31.Rows.Count = 1 Then esl_no.Text = F31.Rows(0).Item("esl_no") : fesl(1, 0)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\MTEST.rpt")
        oj.Database.Tables(0).SetDataSource(F31)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub qwwwww_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qwwwww.Click
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\billl.rpt")
        MsgBox("⁄œœ «·“Ì«—«  Œ·«· «·› —…" & F31.Rows.Count)
        oj.Database.Tables(0).SetDataSource(F31)
        oj.SetParameterValue("118", 1)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub NormalToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NormalToolStripMenuItem.Click
        test.Text = Ntest_NAME.Text
        dr.Close()
        cmd.Connection = CN
        cmd.CommandType = CommandType.Text
        cmd.CommandText = "select * FROM  lntest  where test_name='" & test.Text & "'"
        adlntest.SelectCommand = cmd
        adlntest.Fill(DBS, "lntest")
        lntest = DBS.Tables("lntest")
        DBS.Tables("lntest").Clear()
        adlntest.Fill(DBS, "lntest")
        lntest = DBS.Tables("lntest")
        DataGridView5.DataSource = lntest
        dr.Close()
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\test nor.rpt")
        oj.Database.Tables(0).SetDataSource(lntest)
        rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub GroupBox5_Enter(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles aaaaaaaaaaaaa.Enter

    End Sub

    Private Sub «·»ÕÀ›Ïﬂ·«·›—Ê⁄ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles «·»ÕÀ›Ïﬂ·«·›—Ê⁄ToolStripMenuItem.Click
        Dim aa As String
        aa = InputBox("«œŒ· —ﬁ„ «·«Ì’«· ø")
        esl_no.Text = Val(aa)
        dr.Close() : cmd.Connection = CN
        cmd.CommandText = "select * from lbill WHere esl_no='" & esl_no.Text & "' and yearn='" & YEARN.Text & "'"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & COMPANY_name.Text, 0, bran.Text)

        If F31.Rows.Count = 1 Then esl_no.Text = F31.Rows(0).Item("esl_no") : fesl(1, 0)
        fnor(3)
    End Sub

    Private Sub UpdateTestToolStripMenuItem_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)
        dr.Close()
        cmd.CommandText = "delete from lbill_test  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "delete from lbill_testsub where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND MTEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        TextBox3.Text = Ntest_NAME.Text
        ACdr.Close()
        ACcmd.CommandText = "update test_price set bar=test_name  where bar='" & Ntest_NAME.Text & "'"
        ACcmd.ExecuteNonQuery()
        FSAVEV()
    End Sub

    Private Sub qwqw_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qwqw.Click
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 205 Then Exit Sub
        DataGridView4.Rows.Clear()
        dr1.Close()
        dr.Close()
        cmd.CommandText = "select test_name as name   from v_lab WHere company_name like'%" & COMPANY_name.Text & "%' and bdel=0 and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' group by test_name"
        dr = cmd.ExecuteReader
        While dr.Read
            dr1.Close()
            cmd1.CommandText = "SELECT * FROM LTEST_PRICE WHERE TEST_NAME='" & dr(0) & "' AND BOOK_PRICE_NAME='" & BOOK_name.Text & "'"
            dr1 = cmd1.ExecuteReader
            If dr1.HasRows = True Then
                dr1.Read()
                DataGridView4.Rows.Add(dr(0), dr1("TOT"))
            Else
                DataGridView4.Rows.Add(dr(0), 0)
            End If

        End While
        DataGridView4.Visible = True
        DataGridView4.Height = 640
        DataGridView4.Location = New Point(655, 54)
    End Sub

    Private Sub qqqqqq_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qqqqqq.Click

        Dim n As String
        n = ""
        n = MsgBox(" Â·  —Ìœ «·Õ›Ÿ ø", MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close() : cmd.CommandText = "select MAx(code) from lbook_price "
        dr = cmd.ExecuteReader
        dr.Read()
        If IsDBNull(dr(0)) = False Then
            BOOK_CODE.Text = 1 + dr(0)
        Else
            BOOK_CODE.Text = 1
        End If
        If BOOK_name.Text = "" Then MsgBox("«·—Ã«¡ «· √ﬂœ „‰ «·»Ì«‰") : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lbook_price where   code='" & BOOK_CODE.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            n = ""
            n = MsgBox(" Â·  —Ìœ «· ⁄œÌ· ø", MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
            dr.Close()
            cmd.CommandText = "delete from lbook_price where    code='" & BOOK_CODE.Text & "'"
            cmd.ExecuteNonQuery()
        End If
        dr.Close() : cmd.CommandText = "insert into lbook_price (code,name)  values ('" & BOOK_CODE.Text & "','" & BOOK_name.Text & "')"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "insert into ltest_price (test_code,test_name,ar)  select test_code,test_name,ar from ltest "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update ltest_price set book_price_code='" & BOOK_CODE.Text & "',book_price_name='" & BOOK_name.Text & "' where book_price_code IS NULL"
        cmd.ExecuteNonQuery()
        BOOK_name.Items.Add(BOOK_name.Text)

    End Sub

    Private Sub DataGridView4_CellContentClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView4.CellContentClick

    End Sub

    Private Sub DataGridView4_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles DataGridView4.KeyDown
        If e.KeyCode = Keys.Escape Then
            DataGridView4.Visible = False
        End If
    End Sub

    Private Sub ewewe_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ewewe.Click
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 205 Then Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lbook_price where name='" & BOOK_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        BOOK_CODE.Text = dr("code")
        Dim n As Integer = 0
        While Not n = DataGridView4.Rows.Count
            If DataGridView4((1), n).Value <> 0 Then
                dr.Close()
                cmd.CommandText = "UPDATE lbill_test SET lbill_test.test_price ='" & DataGridView4((1), n).Value & "' FROM lbill_test INNER JOIN lbill ON lbill_test.yearn =  lbill.yearn and lbill_test.bran =  lbill.bran and lbill_test.esl_no =  lbill.esl_no  where lbill.company_name='" & COMPANY_name.Text & "' and lbill_test.test_name='" & DataGridView4((0), n).Value & "' and  lbill.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "UPDATE lbill SET book_name='" & BOOK_name.Text & "',book_code='" & BOOK_CODE.Text & "' FROM lbill  where company_name='" & COMPANY_name.Text & "' and  lbill.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
                cmd.ExecuteNonQuery()
                cmd.CommandText = "UPDATE Ltest_price SET tot ='" & DataGridView4((1), n).Value & "' WHERE TEST_NAME='" & DataGridView4((0), n).Value & "' and book_price_NAME='" & BOOK_name.Text & "'"
                cmd.ExecuteNonQuery()
            End If
            n = n + 1
        End While
        Dim nnnn As String = ""
        dr.Close()
        cmd.CommandText = "select esl_no,sum(test_price) as test_price from v_lab  where company_name='" & COMPANY_name.Text & "' and  esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' group by esl_no"
        dr = cmd.ExecuteReader
        While dr.Read
            nnnn = ""
            Dim nss As Double = 0
            nss = 0
            dr1.Close()
            cmd1.CommandText = "update lbill set tot='" & dr("test_price") & "' where esl_no='" & dr("esl_no") & "'"
            cmd1.ExecuteNonQuery()
        End While
        MsgBox(" „  ⁄„·Ì…  ⁄œÌ· «”⁄«— " & BOOK_name.Text, MsgBoxStyle.Information)
    End Sub

    Private Sub BOOK_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BOOK_name.SelectedIndexChanged
        chbook()
    End Sub

    Private Sub ENAME_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles ENAME.DropDown

    End Sub

    Private Sub ENAME_DropDownClosed(ByVal sender As Object, ByVal e As System.EventArgs) Handles ENAME.DropDownClosed

    End Sub

    Private Sub ComboBox2_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles ENAME.KeyUp
        If e.KeyCode = Keys.Enter Then
            If ENAME.Text.Length < 2 Then MsgBox("«·—Ã«¡ ﬂ «»… «”„ «·⁄Ì«œ… ﬁ»· Õ›ŸÂ«") : Exit Sub

            dr.Close()
            cmd.CommandText = "select * from ENAME where  NAME='" & ENAME.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = False Then
                dr.Close()
                cmd.CommandText = "select max(code) from ENAME "
                dr = cmd.ExecuteReader
                dr.Read()
                Dim n As Integer = 0
                ECODE.Text = 1 + nulls(dr(0))
                If flg.Checked = True Then n = 1 Else n = -1
                dr.Close() : cmd.CommandText = "insert into ENAME (code,NAME)  values ('" & ECODE.Text & "','" & ENAME.Text & "')"
                cmd.ExecuteNonQuery()

            Else
                cash.Focus()
            End If

        End If
        If e.KeyCode = Keys.Delete Then
            If ENAME.Text.Length < 2 Then MsgBox("«·—Ã«¡ ﬂ «»… «”„ «·⁄Ì«œ… ﬁ»· Õ–›Â«") : Exit Sub
            dr.Close()
            cmd.CommandText = "select * from ENAME where  NAME='" & ENAME.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then
                Dim aas As String = MsgBox("Â·  —Ìœ «·Õ–›", MsgBoxStyle.YesNo)
                If aas = vbNo Then Exit Sub
                dr.Close()
                cmd.CommandText = "delete from ENAME where  NAME='" & ENAME.Text & "'"
                cmd.ExecuteNonQuery()
            End If
        End If
    End Sub

    Private Sub ComboBox2_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ENAME.SelectedIndexChanged
        dr.Close()
        cmd.CommandText = "select * from CDOC where NAME='" & ENAME.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            ECODE.Text = dr("code")
        End While
        'dr.Close()
        'EDOCNAME.Items.Clear()
        'cmd.CommandText = "select * from EDOC WHERE ENAME='" & ENAME.Text & "'"
        'dr = cmd.ExecuteReader
        'While dr.Read
        '    EDOCNAME.Items.Add(dr("NAME"))
        'End While
        'EDOCNAME.Text = ""
    End Sub

    Private Sub EDOCNAME_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles EDOCNAME.DropDown


    End Sub

    Private Sub EDOCNAME_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles EDOCNAME.KeyUp
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "select * from EDOC where  NAME='" & EDOCNAME.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = False Then
                dr.Close()
                cmd.CommandText = "select max(code) from EDOC "
                dr = cmd.ExecuteReader
                dr.Read()
                Dim n As Integer = 0
                EDOCCODE.Text = 1 + nulls(dr(0))
                If flg.Checked = True Then n = 1 Else n = -1
                dr.Close() : cmd.CommandText = "insert into EDOC (code,NAME,ECODE,ENAME)  values ('" & EDOCCODE.Text & "','" & EDOCNAME.Text & "','" & ECODE.Text & "','" & ENAME.Text & "')"
                cmd.ExecuteNonQuery()
                dr.Close()
                EDOCNAME.Items.Clear()
                cmd.CommandText = "select * from EDOC WHERE ENAME='" & ENAME.Text & "'"
                dr = cmd.ExecuteReader
                While dr.Read
                    EDOCNAME.Items.Add(dr("NAME"))
                End While
            Else
                cash.Focus()
            End If

        End If
        If e.KeyCode = Keys.Delete Then
            dr.Close()
            cmd.CommandText = "select * from EDOC where  NAME='" & EDOCNAME.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then
                Dim aas As String = MsgBox("Â·  —Ìœ «·Õ–›", MsgBoxStyle.YesNo)
                If aas = vbNo Then Exit Sub
                dr.Close()
                cmd.CommandText = "delete from EDOC where  NAME='" & EDOCNAME.Text & "'"
                cmd.ExecuteNonQuery()
            End If
        End If
    End Sub

    Private Sub EDOCNAME_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles EDOCNAME.SelectedIndexChanged
        dr.Close()
        cmd.CommandText = "select * from CEYADA where NAME='" & EDOCNAME.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            EDOCCODE.Text = dr("code")
        End While
    End Sub

    Private Sub qqqq555_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qqqq555.Click
        dr.Close()
        cmd.CommandText = "select * from lsub where main_name='" & main_name.Text & "' and sub_name='" & sub_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            dr.Close()
            cmd.CommandText = "select max(sub_code) from lsub "
            dr = cmd.ExecuteReader
            dr.Read()
            Dim n As Integer = 0
            sub_code.Text = 1 + nulls(dr(0))
            If flg.Checked = True Then n = 1 Else n = -1
            dr.Close() : cmd.CommandText = "insert into lsub (main_code,main_name,sub_code,sub_name,flg,st,PRM)  values ('" & main_code.Text & "','" & main_name.Text & "','" & sub_code.Text & "','" & sub_name.Text & "','" & n & "','1','" & Val(PRM.CheckState) & "')"
            cmd.ExecuteNonQuery()
            dr.Close()
            sub_name.Items.Clear()
            cmd.CommandText = "select * from lsub "
            dr = cmd.ExecuteReader
            While dr.Read
                sub_name.Items.Add(dr("sub_name"))
            End While
            MsgBox(" „  ⁄„·Ì… «·Õ›Ÿ")
        Else
            MsgBox("Â–« «·»‰œ „”Ã· „‰ ﬁ»·")
        End If
    End Sub

    Private Sub qqq333_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qqq333.Click
        dr.Close()
        cmd.CommandText = "select * from lsub where  sub_name='" & sub_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            Dim aas As String = MsgBox("Â·  —Ìœ «·Õ–›", MsgBoxStyle.YesNo)
            If aas = vbNo Then Exit Sub
            dr.Close()
            cmd.CommandText = "delete from lsub where  sub_name='" & sub_name.Text & "'"
            cmd.ExecuteNonQuery()
            dr.Close()
            sub_name.Items.Clear()
            cmd.CommandText = "select * from lsub "
            dr = cmd.ExecuteReader
            While dr.Read
                sub_name.Items.Add(dr("sub_name"))
            End While
            MsgBox(" „  ⁄„·Ì… «·Õ–›")
        End If
    End Sub

    Private Sub qqqq6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qqqq6.Click
        dr.Close()
        Dim ma As Integer = 0
        While Not ma = F31.Rows.Count
            If F31.Rows(ma).RowState <> DataRowState.Deleted Then
                cmd.CommandText = "update lbill set reg_name='" & REG_name.Text & "',reg_code='" & REG_CODE.Text & "'  where bran='" & F31.Rows(ma).Item("bran") & "' and ESL_NO='" & F31.Rows(ma).Item("esl_no") & "' " & " and " & "yearn='" & F31.Rows(ma).Item("yearn") & "'"
                cmd.ExecuteNonQuery()
            End If
            ma += 1
        End While
        MsgBox(" „  ⁄„·Ì… «· ⁄œÌ·", MsgBoxStyle.Information)

    End Sub

    Private Sub qq70_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        'dr.Close()
        'cmd.CommandText = "update branch set subres='1'"
        'cmd.ExecuteNonQuery()
    End Sub

    Private Sub asasaswfweqfd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asasaswfweqfd.Click
        Try
            Dim aaa As String = MsgBox("Â·  —Ìœ „”Õ ﬂ· «·‰ «∆Ã Ê Ê÷⁄ «·«› —«÷Ïø", MsgBoxStyle.Critical + MsgBoxStyle.YesNo)
            If aaa = vbNo Then Exit Sub
            dr.Close()
            cmd.CommandText = "UPDATE lbill_testsub SET lbill_testsub.res = LSUBTEST.res FROM lbill_testsub INNER JOIN LSUBTEST ON lbill_testsub.test_code = LSUBTEST.test_code  where lbill_testsub.ESL_NO ='" & esl_no.Text & "' and lbill_testsub.yearn ='" & YEARN.Text & "' and lbill_testsub.bran = '" & bran.Text & "'  and lbill_testsub.mtest_code='" & Ntest_CODE.Text & "'"
            cmd.ExecuteNonQuery()
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub HYKIGFGJWER_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles HYKIGFGJWER.Click
        Dim aaa As String = MsgBox("Â·  —Ìœ  ⁄œÌ· ﬂ· «”„«¡ «·ÿ»«¡ Õ”» «·ﬂÊœø", MsgBoxStyle.Critical + MsgBoxStyle.YesNo)
        If aaa = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "UPDATE LBILL SET LBILL.company_NAME = lcompany.NAME FROM LBILL INNER JOIN lcompany ON LBILL.company_CODE = lcompany.CODE  "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LBILL SET LBILL.REG_NAME = lcompany.NAME FROM LBILL INNER JOIN lcompany ON LBILL.REG_CODE = lcompany.CODE  "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LPATIEN SET LPATIEN.company_NAME = lcompany.NAME FROM LPATIEN INNER JOIN lcompany ON LPATIEN.company_CODE = lcompany.CODE  "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LPATIEN SET LPATIEN.REG_NAME = lcompany.NAME FROM LPATIEN INNER JOIN lcompany ON LPATIEN.REG_CODE = lcompany.CODE  "
        cmd.ExecuteNonQuery()
        MsgBox(" „  ⁄„·Ì… «· ⁄œÌ·", MsgBoxStyle.Information)
    End Sub

    Private Sub scan111_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles scan111.Click
        Try
            'On Error GoTo mm
            If vv.Checked = False Then
                dr.Close()
                If IsNumeric(esl_no.Text) = False Then MsgBox("«·—Ã«¡ «Œ Ì«—«·“Ì«—…") : Exit Sub
                dr.Close()
                cmd.CommandText = "select * from lbill WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                dr = cmd.ExecuteReader
                If dr.HasRows = False Then MsgBox("«·—Ã«¡ «Œ Ì«— «·«Ì’«· «Ê·«") : Exit Sub
                dr.Close()
                ACdr.Close()
                ACcmd.CommandText = "select * from srv "
                ACdr = ACcmd.ExecuteReader
                ACdr.Read()
                Dim FileNames = TwainLib.ScanImages(esl_no.Text, True, ACdr("scan"))
                PictureBox1.ImageLocation = FileNames(0)
                Dim oer As System.IO.FileStream
                Dim rer As IO.StreamReader
                oer = New IO.FileStream(FileNames(0), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
                rer = New IO.StreamReader(oer)
                Dim FileByteArrayr(oer.Length - 1) As Byte
                oer.Read(FileByteArrayr, 0, oer.Length)
                dr.Close()
                cmd.CommandText = "select max(code) from lbill_cmt WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                dr = cmd.ExecuteReader
                dr.Read()
                IMAGE_CODE.Text = nulls(dr(0)) + 1
                dr.Close()
                cmd.CommandText = "insert into lbill_cmt (ESL_NO,CODE,IIMAGE ,bran,yearn,usr) values ('" & esl_no.Text & "','" & IMAGE_CODE.Text & "','" & IIMAGE.Text & "','" & bran.Text & "','" & YEARN.Text & "','" & USR & "')"
                cmd.ExecuteNonQuery()
                Dim Sql As String = "update  lbill_cmt set image = ? , no = ? where  ESL_NO='" & Val(esl_no.Text) & "' AND CODE='" & IMAGE_CODE.Text & "' and yearn='" & YEARN.Text & "'"
                cmd.CommandText = Sql
                cmd.Parameters.Clear()
                cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
                cmd.Parameters.Add("@no", System.Data.OleDb.OleDbType.VarChar, 100).Value = oer.Length
                cmd.ExecuteNonQuery()
                dr.Close()
                If PORV <> "" Then
                    cmd.CommandText = " update lbill set st=1 where st=0 and ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' and yearn='" & YEARN.Text & "'"
                    cmd.ExecuteNonQuery()
                End If
                Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ"
            Else
                dr.Close() : cmd.CommandText = "SELECT  lbill_cmt.IIMAGE, lbill.bran, lbill.esl_no, lbill.YEARN, lbill_cmt.no, lbill_cmt.code, lbill.pname,lbill.reg_name, lbill.company_name,lbill.pcode, lbill.ptype, lbill.page, lbill.pid, lbill.esl_time, lbill.reg_code, lbill.crd_per, lbill_cmt.image,  lbill.branch_name FROM  lbill_cmt INNER JOIN lbill ON lbill_cmt.esl_no = lbill.esl_no AND lbill_cmt.yearn = lbill.YEARN AND lbill_cmt.bran = lbill.bran where lbill.ESL_NO='" & esl_no.Text & "' " & " and lbill.yearn='" & Val(YEARN.Text) & "' and lbill.bran='" & bran.Text & "'"
                adpv1.SelectCommand = cmd
                DBS.Tables("PV1").Clear()
                adpv1.Fill(DBS, "PV1")
                pv1 = DBS.Tables("PV1")
                brpd.DataSource = pv1
                dr.Close() : cmd.CommandText = "SELECT * from lbill_cmt  where ESL_NO='" & esl_no.Text & "' " & " and yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                adPVW.SelectCommand = cmd
                DBS.Tables("PVw").Clear()
                adPVW.Fill(DBS, "PVw")
                PVW = DBS.Tables("PVw")
                brpd.DataSource = PVW
                Dim v As Integer = 0
                While Not v = brpd.Columns.Count
                    brpd.Columns(v).Visible = False
                    v = v + 1
                End While
                brpd.Columns("image").Visible = True
                brpd.Columns("ky").Visible = True

                Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
                oj.Load(Application.StartupPath & "\limtp.rpt")
                oj.Database.Tables(0).SetDataSource(pv1)
                rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
                rp.Show() : rp.Focus()

            End If
mm:         Exit Sub
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub scan123_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles scan123.Click
        Try
            'On Error GoTo mm
            If vv.Checked = False Then
                dr.Close()
                If IsNumeric(esl_no.Text) = False Then MsgBox("«·—Ã«¡ «Œ Ì«—«·“Ì«—…") : Exit Sub
                dr.Close()
                cmd.CommandText = "select * from lbill WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                dr = cmd.ExecuteReader
                If dr.HasRows = False Then MsgBox("«·—Ã«¡ «Œ Ì«— «·«Ì’«· «Ê·«") : Exit Sub
                dr.Close()
                ACdr.Close()
                ACcmd.CommandText = "select * from srv "
                ACdr = ACcmd.ExecuteReader
                ACdr.Read()
                Dim FileNames = TwainLib.ScanImages(esl_no.Text, True, ACdr("scan"))
                PictureBox1.ImageLocation = FileNames(0)
                Dim oer As System.IO.FileStream
                Dim rer As IO.StreamReader
                oer = New IO.FileStream(FileNames(0), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
                rer = New IO.StreamReader(oer)
                Dim FileByteArrayr(oer.Length - 1) As Byte
                oer.Read(FileByteArrayr, 0, oer.Length)
                dr.Close()
                cmd.CommandText = "select max(code) from lbill_cid WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                dr = cmd.ExecuteReader
                dr.Read()
                IMAGE_CODE.Text = nulls(dr(0)) + 1
                dr.Close()
                cmd.CommandText = "insert into lbill_cid (ESL_NO,CODE,IIMAGE ,bran,yearn,usr) values ('" & esl_no.Text & "','" & IMAGE_CODE.Text & "','" & IIMAGE.Text & "','" & bran.Text & "','" & YEARN.Text & "','" & USR & "')"
                cmd.ExecuteNonQuery()
                Dim Sql As String = "update  lbill_cid set image = ? , no = ? where  ESL_NO='" & Val(esl_no.Text) & "' AND CODE='" & IMAGE_CODE.Text & "' and yearn='" & YEARN.Text & "'"
                cmd.CommandText = Sql
                cmd.Parameters.Clear()
                cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
                cmd.Parameters.Add("@no", System.Data.OleDb.OleDbType.VarChar, 100).Value = oer.Length
                cmd.ExecuteNonQuery()
                dr.Close()
                If PORV <> "" Then
                    cmd.CommandText = " update lbill set st=1 where st=0 and ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' and yearn='" & YEARN.Text & "'"
                    cmd.ExecuteNonQuery()
                End If
                Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ"
            Else
                dr.Close() : cmd.CommandText = "SELECT  lbill_cid.IIMAGE, lbill.bran, lbill.esl_no, lbill.YEARN, lbill_cid.no, lbill_cid.code, lbill.pname,lbill.reg_name, lbill.company_name,lbill.pcode, lbill.ptype, lbill.page, lbill.pid, lbill.esl_time, lbill.reg_code, lbill.crd_per, lbill_cid.image,  lbill.branch_name FROM  lbill_cid INNER JOIN lbill ON lbill_cid.esl_no = lbill.esl_no AND lbill_cid.yearn = lbill.YEARN AND lbill_cid.bran = lbill.bran where lbill.ESL_NO='" & esl_no.Text & "' " & " and lbill.yearn='" & Val(YEARN.Text) & "' and lbill.bran='" & bran.Text & "'"
                adpv1.SelectCommand = cmd
                DBS.Tables("PV1").Clear()
                adpv1.Fill(DBS, "PV1")
                pv1 = DBS.Tables("PV1")
                brpd.DataSource = pv1
                dr.Close() : cmd.CommandText = "SELECT * from lbill_cid  where ESL_NO='" & esl_no.Text & "' " & " and yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                adPVW.SelectCommand = cmd
                DBS.Tables("PVw").Clear()
                adPVW.Fill(DBS, "PVw")
                PVW = DBS.Tables("PVw")
                brpd.DataSource = PVW
                Dim v As Integer = 0
                While Not v = brpd.Columns.Count
                    brpd.Columns(v).Visible = False
                    v = v + 1
                End While
                brpd.Columns("image").Visible = True
                brpd.Columns("ky").Visible = True
                Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
                oj.Load(Application.StartupPath & "\limage.rpt")
                oj.Database.Tables(0).SetDataSource(pv1)
                rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
                rp.Show() : rp.Focus()

            End If
mm:         Exit Sub
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub scan1234_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles scan1234.Click
        Try
            If vv.Checked = False Then
                dr.Close()
                ACdr.Close()
                ACcmd.CommandText = "select * from srv "
                ACdr = ACcmd.ExecuteReader
                ACdr.Read()
                Dim FileNames = TwainLib.ScanImages(esl_no.Text, True, ACdr("scan"))
                PictureBox1.ImageLocation = FileNames(0)
                Dim oer As System.IO.FileStream
                Dim rer As IO.StreamReader
                oer = New IO.FileStream(FileNames(0), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
                rer = New IO.StreamReader(oer)
                Dim FileByteArrayr(oer.Length - 1) As Byte
                oer.Read(FileByteArrayr, 0, oer.Length)
                dr.Close()
                cmd.CommandText = "select max(code) from llogsheet WHERE  yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                dr = cmd.ExecuteReader
                dr.Read()
                IMAGE_CODE.Text = nulls(dr(0)) + 1
                dr.Close()
                cmd.CommandText = "insert into llogsheet (CODE,IIMAGE ,bran,yearn,esl_date,usr) values ('" & IMAGE_CODE.Text & "','" & IIMAGE.Text & "','" & bran.Text & "','" & YEARN.Text & "','" & ChangeFormat(esl_date.Value) & "','" & USR & "')"
                cmd.ExecuteNonQuery()
                Dim Sql As String = "update  llogsheet set image = ? , no = ? where   CODE='" & IMAGE_CODE.Text & "' and yearn='" & YEARN.Text & "' and bran='" & bran.Text & "'"
                cmd.CommandText = Sql
                cmd.Parameters.Clear()
                cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
                cmd.Parameters.Add("@no", System.Data.OleDb.OleDbType.VarChar, 100).Value = oer.Length
                cmd.ExecuteNonQuery()
                dr.Close()
                Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ"
            Else
                If cesl_date.Checked = True Then
                    yy = " esl_date ='" & ChangeFormat(esl_date.Value) & "' "
                Else
                    yy = " esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"

                End If
                dr.Close() : cmd.CommandText = "SELECT  * from llogsheet where " & yy & " and bran='" & bran.Text & "'"
                adPVW.SelectCommand = cmd
                DBS.Tables("PVW").Clear()
                adPVW.Fill(DBS, "PVW")
                PVW = DBS.Tables("PVW")
                brpd.DataSource = PVW
                Dim v As Integer = 0
                While Not v = brpd.Columns.Count
                    brpd.Columns(v).Visible = False
                    v = v + 1
                End While
                brpd.Columns("image").Visible = True
                brpd.Columns("ky").Visible = True
                brpd.Columns("esl_date").Visible = True
                Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
                oj.Load(Application.StartupPath & "\logsheet.rpt")
                oj.Database.Tables(0).SetDataSource(PVW)
                rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
                rp.Show() : rp.Focus()
            End If
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub GlassButton18_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles sssa.Click
        SAVERES(1, 0)
        Dim N1 As String
        If msga = 1 Then
            N1 = MsgBox("SAVE COMMENT sub group  " & ntp.Text, MsgBoxStyle.YesNo)
            If N1 = vbNo Then Exit Sub
        End If
        If testres.Rows.Count > 0 Then
            cmd1.CommandText = "update LBILL_TEST set  notesp='" & comment1.Text & "' where ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and gr_name='" & ntp.Text & "'"
            cmd1.ExecuteNonQuery()
            If PORV <> "" Then
                dr.Close()
                cmd.CommandText = " update lbill set st=2 where st=0 and ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
            End If
            GlassButton50_Click(QQ35, e)
            If msga = 1 Then
                If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" Else Me.Text = "IT'S SAVED"
            End If
        End If
    End Sub

    Private Sub GlassButton19_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ssssb.Click
        SAVERES(1, 0)
        Dim N1 As String
        If msga = 1 Then
            N1 = MsgBox("SAVE COMMENT main group  " & ntg.Text, MsgBoxStyle.YesNo)
            If N1 = vbNo Then Exit Sub
        End If
        If testres.Rows.Count > 0 Then
            If companal = 1 Then
                cmd1.CommandText = "update LBILL_TEST set  notesg='" & comment1.Text & "' where ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " ANd gname='" & ntg.Text & "'"
                cmd1.ExecuteNonQuery()
            End If
            If PORV <> "" Then
                dr.Close()
                cmd.CommandText = " update lbill set st=2 where st=0 and ESL_NO='" & testres.Rows(0).Item("ESL_NO") & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                cmd.ExecuteNonQuery()
            End If
            GlassButton50_Click(QQ35, e)
            If msga = 1 Then
                If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" Else Me.Text = "IT'S SAVED"
            End If
        End If
    End Sub

    Private Sub ts5_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ts5.Click
        Dim n As String
        n = MsgBox("Â·  —Ìœ  ⁄œÌ· »Ì«‰«  «· Õ·Ì· ", MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close()
        ACdr.Close()
        cmd.CommandText = "select * from ltest where test_code='" & Ntest_CODE.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        Dim oldt As String = dr("test_name")
        'ts1.Text = dr("ts1")
        'ts2.Text = dr("ts2")
        'ts3.Text = dr("ts3")
        'ts4.Text = dr("ts4")
        dr.Close()
        cmd.CommandText = "UPDATE LTEST SET ts1 ='" & Val(ts1.Text) & "',ts2 ='" & Val(ts2.Text) & "',ts3 ='" & Val(ts3.Text) & "',ts4 ='" & Val(ts4.Text) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        MsgBox(" „  ⁄„·Ì… «· ⁄œÌ·", MsgBoxStyle.Information)

    End Sub

    Private Sub sdsdsdsd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles sdsdsdsd.Click
        Try
            dr.Close()
            cmd.CommandText = "select * from lcompany where name='" & COMPANY_name.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            ACdr.Close()
            If dr.HasRows = False Then Exit Sub
            Select Case depn.Items.IndexOf(depn.Text)
                Case 0
                    ACdr.Close()
                    dr.Close()
                    cmd.CommandText = "select * from ltest_price where book_price_code='" & BOOK_CODE.Text & "'"
                    dr = cmd.ExecuteReader
                    While dr.Read
                        ACcmd.CommandText = "update test_price set pricep='" & nulls(dr("p1")) & "',priceV='" & nulls(dr("V1")) & "' where test_code=" & dr("test_code")
                        ACcmd.ExecuteNonQuery()
                    End While

                Case 1
                    ACdr.Close()
                    dr.Close()
                    cmd.CommandText = "select * from ltest_price where book_price_code='" & BOOK_CODE.Text & "'"
                    dr = cmd.ExecuteReader
                    While dr.Read
                        ACcmd.CommandText = "update test_price set pricep='" & nulls(dr("p2")) & "',priceV='" & nulls(dr("V2")) & "'  where test_code=" & dr("test_code")
                        ACcmd.ExecuteNonQuery()
                    End While
                Case 2
                    dr.Close()
                    cmd.CommandText = "select * from ltest_price where book_price_code='" & BOOK_CODE.Text & "'"
                    dr = cmd.ExecuteReader
                    While dr.Read
                        ACcmd.CommandText = "update test_price set pricep='" & nulls(dr("p3")) & "',priceV='" & nulls(dr("V3")) & "' where test_code=" & dr("test_code")
                        ACcmd.ExecuteNonQuery()
                    End While

                Case 3
                    dr.Close()
                    cmd.CommandText = "select * from ltest_price where book_price_code='" & BOOK_CODE.Text & "'"
                    dr = cmd.ExecuteReader
                    While dr.Read
                        ACcmd.CommandText = "update test_price set pricep='" & nulls(dr("p4")) & "',priceV='" & nulls(dr("V4")) & "' where test_code=" & dr("test_code")
                        ACcmd.ExecuteNonQuery()
                    End While

            End Select
            SUMT()
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub DDDDD_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DDDDD.Click
        Try
            Dim ccode As Integer = 0
            Dim oer As System.IO.FileStream
            Dim rer As IO.StreamReader
            Dim n11 As Integer = 0
            If PORV.Length < 10 Then Exit Sub
            openonline()
            dr.Close()
            dr.Close()
            cmd.CommandText = "delete from LCOMPANY "
            cmd.ExecuteNonQuery()
            cmd.CommandText = "delete from  LCOMPANY_image"
            cmd.ExecuteNonQuery()
            SDR.Close()
            sdr1.Close()
            scmd1.Connection = SCN
            SCMD.Connection = SCN
            SCMD.CommandText = "select * from LCOMPANY ORDER BY CODE" ' where bran like'%+" & bran.Text.Trim & "%'"
            SDR = SCMD.ExecuteReader
            While SDR.Read()
                n11 += 1
                ccode = SDR("code")
                'cmd.CommandText = "delete from LCOMPANY where code='" & ccode & "'"
                'cmd.ExecuteNonQuery()
                'cmd.CommandText = "delete from  LCOMPANY_image where code='" & ccode & "'"
                'cmd.ExecuteNonQuery()
                cmd.CommandText = "insert into Lcompany (code,name,[book_price_code],[book_price_name],[ph],[ch] ,[pp],[cp],[ps],[cs],[pw],[cw],diss,[add1],email,tel,DOC,lab,inc,crd,canc,BRAN,name1,name2,name3,tel1,tel2,tel3,email1,email2,email3,test,cond,web,result,[address],[price_name],[oprice_name],[price_diss],[oprice_diss],[tah_form],[tah_exp],[tah_date],[emp_cash],[fam_cash],[HC],[out_date])  values ('" & SDR("code") & "','" & SDR("name") & "','" & SDR("book_price_code") & "','" & SDR("book_price_name") & "','" & SDR("ph") & "','" & SDR("ch") & "','" & SDR("pp") & "','" & SDR("cp") & "','" & SDR("ps") & "','" & SDR("cs") & "','" & SDR("pw") & "','" & SDR("cw") & "','" & SDR("diss") & "','" & SDR("add1") & "','" & SDR("email") & "','" & SDR("tel") & "','" & SDR("DOC") & "','" & SDR("lab") & "','" & SDR("inc") & "','" & SDR("crd") & "','" & SDR("canc") & "','" & SDR("BRAN") & "','" & SDR("name1") & "','" & SDR("name2") & "','" & SDR("name3") & "','" & SDR("tel1") & "','" & SDR("tel2") & "','" & SDR("tel3") & "','" & SDR("email1") & "','" & SDR("email2") & "','" & SDR("email3") & "','" & SDR("test") & "','" & SDR("cond") & "','" & SDR("web") & "','" & SDR("result") & "','" & SDR("address") & "','" & SDR("price_name") & "','" & SDR("oprice_name") & "','" & SDR("price_diss") & "','" & SDR("oprice_diss") & "','" & SDR("tah_form") & "','" & SDR("tah_exp") & "','" & SDR("tah_date") & "','" & SDR("emp_cash") & "','" & SDR("fam_cash") & "','" & SDR("HC") & "','" & SDR("out_date") & "')"
                cmd.ExecuteNonQuery()

                scmd1.CommandText = "select * from Lcompany_image where company_code='" & ccode & "'"
                sdr1 = scmd1.ExecuteReader
                While sdr1.Read
                    n11 += 1
                    dr.Close()
                    cmd.CommandText = "INSERT INTO [Lcompany_image] (CODE,company_name,company_code ) values ('" & sdr1("code") & "','" & sdr1("company_name") & "','" & sdr1("company_code") & "')"
                    cmd.ExecuteNonQuery()
                    Dim newMstream As New System.IO.MemoryStream(CType(sdr1.Item("image"), Byte()))
                    Dim ImageFromDB As New Bitmap(newMstream)
                    PictureBox1.Image = ImageFromDB
                    IO.File.Delete(Application.StartupPath & "\images" & n11 & sdr1("CODE"))
                    PictureBox1.Image.Save(Application.StartupPath & "\images" & n11 & sdr1("CODE"), System.Drawing.Imaging.ImageFormat.Jpeg)
                    PictureBox1.Image.Save(Application.StartupPath & "\images\" & n11 & SDR("CODE"), System.Drawing.Imaging.ImageFormat.Jpeg)
                    oer = New IO.FileStream(Application.StartupPath & "\images\" & n11 & SDR("CODE"), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
                    rer = New IO.StreamReader(oer)
                    Dim FileByteArrayr1(oer.Length - 1) As Byte
                    oer.Read(FileByteArrayr1, 0, oer.Length)
                    Dim AAAAA1 As String = ""
                    Dim Sql1 As String = "update  Lcompany_image set image = ? " & AAAAA1 & "  where  code='" & Val(sdr1("CODE")) & "' and company_CODE='" & sdr1("company_code") & "'"
                    cmd.CommandText = Sql1
                    cmd.Parameters.Clear()
                    cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr1
                    cmd.ExecuteNonQuery()
                End While
                sdr1.Close()
            End While
            SDR.Close()
            'sdr1.Close()
            cmd.CommandText = "delete  from ltest_price "
            cmd.ExecuteNonQuery()
            SCMD.CommandText = "select * from ltest_price "
            SDR = SCMD.ExecuteReader
            While SDR.Read
                cmd.CommandText = " INSERT INTO [ltest_price]([TEST_CODE],[TEST_NAME],[tot],[AR],[book_price_code],[book_price_name],[so],[st],p1,p2,p3,p4) VALUES ( '" & SDR("TEST_CODE") & "','" & SDR("TEST_NAME") & "','" & SDR("tot") & "','" & SDR("AR") & "','" & SDR("book_price_code") & "','" & SDR("book_price_name") & "','" & SDR("so") & "','0','" & SDR("p1") & "','" & SDR("p2") & "','" & SDR("p3") & "','" & SDR("p4") & "')"
                cmd.ExecuteNonQuery()
            End While

            SDR.Close()
            'sdr1.Close()
            cmd.CommandText = "delete  from lbook_price "
            cmd.ExecuteNonQuery()
            SCMD.CommandText = "select * from lbook_price "
            SDR = SCMD.ExecuteReader
            While SDR.Read
                cmd.CommandText = " INSERT INTO [lbook_price]([CODE],[NAME],p1,p2,p3,p4) VALUES ( '" & SDR("CODE") & "','" & SDR("NAME") & "','" & SDR("p1") & "','" & SDR("p2") & "','" & SDR("p3") & "','" & SDR("p4") & "')"
                cmd.ExecuteNonQuery()
            End While

            DBS.Tables("scompany").Rows.Clear()
            dr.Close() : cmd.CommandText = "select name from lCOMPANY  group by name"
            adscompany.SelectCommand = cmd
            adscompany.Fill(DBS, "scompany")
            scompany = DBS.Tables("scompany")
            COMPANY_name.DataSource = scompany
            COMPANY_name.DisplayMember = "NAME"
            Dim ass As Integer = 0
            While Not ass = scompany.Rows.Count
                REG_name.Items.Add(scompany.Rows(ass).Item("name"))
                ass = ass + 1
            End While
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try

    End Sub

    Private Sub aaaaaaaa_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles aaaaaaaa.Click
        Dim aaa As String = MsgBox("Â·  —Ìœ  ⁄œÌ· ﬂ· «ﬂÊ«œ «·ÿ»«¡ Õ”» «·«”„ø", MsgBoxStyle.Critical + MsgBoxStyle.YesNo)
        If aaa = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "UPDATE LBILL SET LBILL.company_code = lcompany.code FROM LBILL INNER JOIN lcompany ON LBILL.company_name = lcompany.name  "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LBILL SET LBILL.REG_code = lcompany.code FROM LBILL INNER JOIN lcompany ON LBILL.REG_name = lcompany.name  "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LPATIEN SET LPATIEN.company_code = lcompany.code FROM LPATIEN INNER JOIN lcompany ON LPATIEN.company_name = lcompany.name  "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "UPDATE LPATIEN SET LPATIEN.REG_code = lcompany.code FROM LPATIEN INNER JOIN lcompany ON LPATIEN.REG_name = lcompany.name  "
        cmd.ExecuteNonQuery()
        MsgBox(" „  ⁄„·Ì… «· ⁄œÌ·", MsgBoxStyle.Information)

    End Sub

    Private Sub GlassButton130_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub lwksdjposkp_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles lwksdjposkp.Click
        testnum()
    End Sub
    Public Sub testnum()
        yy = ""
        If CBRAN.Checked = True Then
            yy = yy & "  " & " and  bran='" & bran.Text & "'"
        End If
        dr.Close()
        cmd.CommandText = "update lbill_test set t=0 where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        cmd.ExecuteNonQuery()
        FRC = BILL.Select("qun='1'")
        Dim t As String = 0
        While Not t = FRC.Length
            RC = FRC(t)
            cmd.CommandText = "update lbill_test set t=1 where test_name='" & RC("test_name") & "' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
            cmd.ExecuteNonQuery()
            t = t + 1
        End While
        If FRC.Length <= 0 Then
            cmd.CommandText = "update lbill_test set t=1 where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
            cmd.ExecuteNonQuery()
        End If
        dr.Close() : cmd.CommandText = "SELECT     test_name,count(test_name)as qun FROM  lbill_test    where esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' and t=1 " & yy & " group by test_name"
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì·", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\test up.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("1", " ﬁ—Ì— «Õ’«∆Ì«  «· Õ«·Ì· Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub
    Public Sub login(ByVal pass As String)
        On Error Resume Next
        dr.Close() : cmd.CommandText = "select * from USERS where pass='" & pass & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows Then
            CTOTAL = dr("ctotal")
            EMP_CODE = dr("EMP_CODE")
            USR = dr("name")
            suser = dr("name")
            mluser = dr("luser")
            final = dr("final")
            SV = dr("LSAVE")
            DEL = dr("LDEL")
            prntn1 = dr("prntn")
            ED = dr("LEDIT")
            rpt = dr("LESLRP")
            prnt = dr("LPRNT")
            hs = dr("Lcome")
            lres = dr("lres")
            If lres = 0 Then TabControl1.TabPages.Remove(TabPage6) : TabControl1.TabPages.Remove(TabPage5) : TabControl1.TabPages.Remove(TabPage6) : QQ40.Visible = False
            mng = dr("admin")
            mtp = dr("lmtp")
            ldoc = dr("doc")
            lrcv = dr("rcv")
            pa = dr("pa")
            tv = dr("tv")
            tc = dr("tc")
            dc = dr("dc")
            pah = dr("pah")
            ls = dr("ls")
            lbld1 = dr("lbld")
            If lbld1 = 0 Then LBLD.Dispose()
            lp = dr("lp")
            If lp = 0 Then TabControl1.TabPages.Remove(TabPage12)
            UPDATE_TEST = dr("UPDATE_TEST")
            lmach = dr("lmach")
            lng = dr("lng")
            fcolor = dr("fcolor")
            bcolor = dr("bcolor")
            backcolor1 = dr("backcolor")
            ltblg = dr("ltblg")
            luser = dr("luser")
            lemail = dr("lemail")
            ldelg = dr("ldelg")
            ldis = dr("ldis")
            lref = dr("lref")
            REST_PRNT = dr("REST_PRNT")
            colu(Me, bcolor, fcolor)
            lcult1 = dr("lcult")
            ldref = dr("ldref")
            ldelgat = dr("ldelgat")
            lpromz = dr("lpromz")
            ltestp = dr("ltestp")
            lpnum = dr("lpnum")
            MsgBox(" „  ⁄„·Ì…  €Ì— «·„” Œœ„ »‰Ã«Õ", MsgBoxStyle.Information)
            Me.Text = USR & "   " & SHF & "  " & branch_name.Text
            Me.Enabled = True
        Else
            MsgBox("«·—Ã«¡ ﬂ «»… ﬂ·„… «·”— ’ÕÌÕ…", MsgBoxStyle.Information)
        End If

    End Sub
    Private Sub gla1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gla1.Click
        login(usrpass.Text)
        usrpass.Text = ""
    End Sub

    Private Sub GL3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL3.Click
        dr.Close()
        If IsNumeric(esl_no.Text) = False Then MsgBox("«·—Ã«¡ «Œ Ì«—«·“Ì«—…") : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from lbill WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr = cmd.ExecuteReader
        If dr.HasRows = False Then MsgBox("«·—Ã«¡ «Œ Ì«— «·«Ì’«· «Ê·«") : Exit Sub
        dr.Close()
        ACdr.Close()
        ACcmd.CommandText = "select * from srv "
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        Dim FileNames = TwainLib.ScanImages(esl_no.Text, True, ACdr("scan"))
        PictureBox1.ImageLocation = FileNames(0)
        Dim oer As System.IO.FileStream
        Dim rer As IO.StreamReader
        oer = New IO.FileStream(FileNames(0), IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
        rer = New IO.StreamReader(oer)
        Dim FileByteArrayr(oer.Length - 1) As Byte
        oer.Read(FileByteArrayr, 0, oer.Length)
        dr.Close()
        cmd.CommandText = "select max(code) from lbill_testimage WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr = cmd.ExecuteReader
        dr.Read()
        IMAGE_CODE.Text = nulls(dr(0)) + 1
        dr.Close()
        cmd.CommandText = "insert into lbill_testimage (ESL_NO,CODE,IIMAGE ,bran,yearn,usr,test_code) values ('" & esl_no.Text & "','" & IMAGE_CODE.Text & "','" & IIMAGE.Text & "','" & bran.Text & "','" & YEARN.Text & "','" & USR & "','" & Ntest_CODE.Text & "')"
        cmd.ExecuteNonQuery()
        Dim Sql As String = "update  lbill_testimage set image = ? , no = ? where  ESL_NO='" & Val(esl_no.Text) & "' AND CODE='" & IMAGE_CODE.Text & "' and yearn='" & YEARN.Text & "'"
        cmd.CommandText = Sql
        cmd.Parameters.Clear()
        cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
        cmd.Parameters.Add("@no", System.Data.OleDb.OleDbType.VarChar, 100).Value = oer.Length
        cmd.ExecuteNonQuery()
        dr.Close()
        If PORV <> "" Then
            cmd.CommandText = " update lbill set st=1 where st=0 and ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' and yearn='" & YEARN.Text & "'"
            cmd.ExecuteNonQuery()
        End If
        MsgBox(" „  ⁄„·Ì… «·Õ›Ÿ")
    End Sub

    Private Sub GL2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL2.Click

        Try
            If Ntest_CODE.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— «· Õ·Ì·") : Exit Sub
            OpenFileDialog1.ShowDialog()
            picup.ImageLocation = OpenFileDialog1.FileName
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub GL4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL4.Click
        If ADDCODE.Text = "" Then MsgBox("«·—Ã«¡ ﬂ «»… ﬂÊœ «·“Ì«—…", MsgBoxStyle.Information) : Exit Sub
        ADCODE.Items.Add(ADDCODE.Text)
        ADDCODE.Text = ""
        ADDCODE.Focus()
    End Sub

    Private Sub GlassButton18_Click_3(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL5.Click
        ADCODE.Items.Clear()
    End Sub

    Private Sub ADDCODE_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles ADDCODE.KeyUp
        If e.KeyCode = Keys.Enter Then
            GL4_Click(GL4, e)
        End If
    End Sub

    Private Sub ADDCODE_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ADDCODE.TextChanged

    End Sub

    Private Sub GL6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL6.Click
        dr.Close() : cmd.Connection = CN
        cmd.CommandText = "SELECT LCOMARKET.EMP_CODE, LCOMARKET.EMP_name, lbill.* FROM  lbill INNER JOIN  LCOMARKET ON lbill.COMPANY_code = LCOMARKET.COMPANY_code WHere LCOMARKET.EMP_CODE='" & EMP_CODE & "' AND lbill.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        qwwwww_Click(qwwwww, e)
    End Sub

    Private Sub gl7_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gl7.Click
        Try
            dr.Close() : cmd.CommandText = "SELECT  * FROM  v_company where  code='" & COMPANY_CODE.Text & "'"
            adPVW.SelectCommand = cmd
            adPVW.Fill(DBS, "PVW")
            PVW = DBS.Tables("PVW")
            DBS.Tables("PVW").Clear()
            adPVW.Fill(DBS, "PVW")
            PVW = DBS.Tables("PVW")
            brpd.DataSource = PVW
            Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
            oj.Load(Application.StartupPath & "\companyv.rpt")
            oj.Database.Tables(0).SetDataSource(PVW)
            rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
            rp.Show() : rp.Focus()
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try

    End Sub

    Private Sub gl8_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gl8.Click
        If PORV.Length < 10 Then Exit Sub
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 206 Then Exit Sub
        openonline()
        SDR.Close()
        dr.Close()
        SDR.Close()
        SCMD.CommandText = "select * from users "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "delete  from users where CODE='" & SDR("CODE") & "' "
            cmd.ExecuteNonQuery()
            cmd.CommandText = "INSERT INTO users ([CODE],[NAME],[PASS],[LENTER],[LSAVE],[LEDIT],[LDEL],[LESLRP],[LPRNT],[Lcome],[center],[csave],[cedit],[cdel],[crp],[cbalance],[ctotal],[eenter],[esave],[eedit],[edel],[erp],[esal],[esalsave],[lbld],[ebld],[cbld],[admin],[lres],[lmtp],[doc],[rcv],[pa],[tv],[tc],[dc],[pah],[ls],[lp],[lmach],[email],[lng],[fcolor],[bcolor],[prntn],[REST_PRNT],[UPDATE_TEST],[lemail],[lref],[ldelg],[ldis],[luser],[pack_name],[pack_code],[backcolor],[ltblg],[lcult],[ldref],[ldelgat],[lpromz],[ltestp],[lpnum],[ALI],[shift],[final]) VALUES ('" & SDR("CODE") & "','" & SDR("NAME") & "','" & SDR("PASS") & "','" & SDR("LENTER") & "','" & SDR("LSAVE") & "','" & SDR("LEDIT") & "','" & SDR("LDEL") & "','" & SDR("LESLRP") & "','" & SDR("LPRNT") & "','" & SDR("Lcome") & "','" & SDR("center") & "','" & SDR("csave") & "','" & SDR("cedit") & "','" & SDR("cdel") & "','" & SDR("crp") & "','" & SDR("cbalance") & "','" & SDR("ctotal") & "','" & SDR("eenter") & "','" & SDR("esave") & "','" & SDR("eedit") & "','" & SDR("edel") & "','" & SDR("erp") & "','" & SDR("esal") & "','" & SDR("esalsave") & "','" & SDR("lbld") & "','" & SDR("ebld") & "','" & SDR("cbld") & "','" & SDR("admin") & "','" & SDR("lres") & "','" & SDR("lmtp") & "','" & SDR("doc") & "','" & SDR("rcv") & "','" & SDR("pa") & "','" & SDR("tv") & "','" & SDR("tc") & "','" & SDR("dc") & "','" & SDR("pah") & "','" & SDR("ls") & "','" & SDR("lp") & "','" & SDR("lmach") & "','" & SDR("email") & "','" & SDR("lng") & "','" & SDR("fcolor") & "','" & SDR("bcolor") & "','" & SDR("prntn") & "','" & SDR("REST_PRNT") & "','" & SDR("UPDATE_TEST") & "','" & SDR("lemail") & "','" & SDR("lref") & "','" & SDR("ldelg") & "','" & SDR("ldis") & "','" & SDR("luser") & "','" & SDR("pack_name") & "','" & SDR("pack_code") & "','" & SDR("backcolor") & "','" & SDR("ltblg") & "','" & SDR("lcult") & "','" & SDR("ldref") & "','" & SDR("ldelgat") & "','" & SDR("lpromz") & "','" & SDR("ltestp") & "','" & SDR("lpnum") & "','" & SDR("ALI") & "','" & SDR("shift") & "','" & SDR("final") & "') "
            cmd.ExecuteNonQuery()
        End While

        SDR.Close()
        dr.Close()
        cmd.CommandText = "delete from eemp"
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from eemp"
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "INSERT INTO eemp  ([code],[name],[OBOY],[DOC]) values ('" & SDR("code") & "','" & SDR("name") & "','" & SDR("oboy") & "','" & SDR("doc") & "')"
            cmd.ExecuteNonQuery()
        End While
        MsgBox(" „  ⁄„·Ì…  ÕœÌÀ »Ì«‰«  «·„ÊŸ›Ì‰", MsgBoxStyle.Information)
    End Sub

    Private Sub DOC_NAME_GotFocus1(ByVal sender As Object, ByVal e As System.EventArgs) Handles DOC_NAME.GotFocus
        flng("AR")
        colu(Me, Val(bcolor), Val(fcolor))
        DOC_NAME.BackColor = Color.FromArgb(backcolor1)
        FFIND = "DOC_NAME"
        FFINDT = DOC_NAME.Text
    End Sub

    Private Sub DOC_NAME_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles DOC_NAME.KeyDown
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "select * from users where name='" & DOC_NAME.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            DOC_CODE.Text = dr("code")
        End If
        If e.KeyCode = Keys.F6 Then
            fufind()
        End If
    End Sub

    Private Sub DOC_NAME_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DOC_NAME.TextChanged

    End Sub

    Private Sub emp_name_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles emp_name.KeyDown
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "select * from eemp where name='" & emp_name.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            empcode.Text = dr("code")
        End If
    End Sub

    Private Sub emp_name_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles emp_name.TextChanged

    End Sub

    Private Sub RECONNECTToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        dr.Close()
        ACdr.Close()
        dr1.Close()

        open_sql()
    End Sub

    Private Sub usrpass_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles usrpass.KeyUp
        If e.KeyCode = Keys.Enter Then
            login(usrpass.Text)
            usrpass.Text = ""
        End If
    End Sub

    Private Sub usrpass_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles usrpass.TextChanged

    End Sub

    Private Sub GlassButton18_Click_4(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL9.Click
        Try
            cmdb.DataAdapter = adPVW
            adPVW.Update(DBS, "PVW")
            MsgBox(" „  ⁄„·Ì… «· ⁄œÌ·", MsgBoxStyle.Information)
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub gl10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gl10.Click
        ACdr.Close()
        ACcmd.CommandText = "update test1  INNER JOIN TEST ON test1.TEST_NAME = TEST.TEST_NAME set TEST1.TEST_CODE=1  "
        ACcmd.ExecuteNonQuery()

    End Sub

    Private Sub gt15_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gt15.Click
        Try

            ACdr.Close()
            ACcmd.CommandText = "SELECT max(ResultAfter) FROM TEST_PRICE WHERE QUN=1 "
            ACdr = ACcmd.ExecuteReader
            ACdr.Read()
            ss = nulls(ACdr(0))
            Dim t As Integer = 0
            FRC = BILL.Select("qun='1'")
            While Not t = FRC.Length
                RC = FRC(t)
                RC.BeginEdit()
                RC.Item("rcv_date") = esl_date.Value.AddDays(ss)
                RC.EndEdit()
                t = t + 1
            End While
            rcv_date.Value = esl_date.Value.AddDays(ss)
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub GT16_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Try
            dr.Close()
            cmd.CommandText = "select  * from lpatien where PNAME='" & pname.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then
                PNIK.Text = dr("PNIK")
                pcode.Text = dr("pcode")
                pname.Text = dr("pname")
                ptype.Text = dr("ptype")
                pbrith_date.Value = dr("pbrith_date")
                page.Text = dr("page")
                pphone.Text = nulls(dr("pphone"))
                pmobile.Text = nulls(dr("pmobile"))
                pgover.Text = dr("pgover")
                pcity.Text = dr("pcity")
                pstreet.Text = dr("pstreet")
                pemail.Text = dr("pemail")
                pid.Text = dr("pid")
                BOOK_CODE.Text = dr("book_code")
                BOOK_name.Text = dr("book_name")
                COMPANY_CODE.Text = dr("company_code")
                COMPANY_name.Text = dr("company_name")
                REG_CODE.Text = dr("REG_code")
                REG_name.Text = dr("REG_name")
                pa1 = 1
            End If
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub GL12_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GL12.Click
        yy = ""
        If CBRAN.Checked = True Then yy = " and  lbill.bran='" & bran.Text & "'"
        If cCOMPANY_CODE.CheckState = CheckState.Checked Then yy = yy & "  " & " and lbill.company_code='" & COMPANY_CODE.Text & "'"
        If creg_code.Checked = True Then yy = yy & "  " & " and lbill.REG_name='" & REG_name.Text & "'"
        dr.Close() : cmd.CommandText = "SELECT  lbill_cmt.IIMAGE, lbill.bran, lbill.esl_no, lbill.YEARN, lbill_cmt.no, lbill_cmt.code, lbill.pname,lbill.reg_name, lbill.company_name,lbill.pcode, lbill.ptype, lbill.page, lbill.pid, lbill.esl_time, lbill.reg_code, lbill.crd_per, lbill_cmt.image,  lbill.branch_name,  lbill.ESL_DATE FROM  lbill_cmt INNER JOIN lbill ON lbill_cmt.esl_no = lbill.esl_no AND lbill_cmt.yearn = lbill.YEARN AND lbill_cmt.bran = lbill.bran where lbill.esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' AND  lbill.yearn='" & Val(YEARN.Text) & "'" & yy
        adpv1.SelectCommand = cmd
        DBS.Tables("PV1").Clear()
        adpv1.Fill(DBS, "PV1")
        pv1 = DBS.Tables("PV1")
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\limage.rpt")
        oj.Database.Tables(0).SetDataSource(pv1)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub GL23_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim C1, C2 As String
        C1 = ""
        C2 = 0
        Dim N As String = InputBox("«œŒ· —ﬁ„ «·»«—ﬂÊœ")
        If Val(N) = 0 Then MsgBox("«·—Ã«¡ ﬂ «»… «·»«—ﬂÊœ «·’ÕÌÕ", MsgBoxStyle.Information) : Exit Sub
        dr.Close()
        cmd.CommandText = "SELECT * FROM LPBARCODE WHERE BARCODE='" & N & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            C1 = C1 + Environment.NewLine & dr("PNAME")
            C2 += 1
        End While
        MsgBox("«”„«¡ «·„‘ —ﬂÌ‰ ›Ï «·ﬂ Ì»" & C1, MsgBoxStyle.Information)
        MsgBox("⁄œœ «·„‘ —ﬂÌ‰ " & C2, MsgBoxStyle.Information)
        If C2 = 8 Then MsgBox(" „  ”ÃÌ· ﬂ· «”„«¡ «·„‘ —ﬂÌ‰", MsgBoxStyle.Critical) : Exit Sub
        dr.Close()
        cmd.CommandText = "SELECT * FROM LPBARCODE WHERE BARCODE='" & N & "' AND PCODE='" & pcode.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = True Then MsgBox("Â–« «·„—Ì÷ „”Ã· „‰ ﬁ»·", MsgBoxStyle.Critical) : Exit Sub

    End Sub

    Private Sub PrintedToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PrintedToolStripMenuItem.Click



    End Sub



    Private Sub GB120_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB120.Click
        Try
            PDFM()
            MsgBox("FILE EXPORTED")
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub
    Public Sub PDFM()
        If finals.Checked = True Then
            SourceDirectory = Environment.GetFolderPath(Environment.SpecialFolder.Desktop) & "\" & pname.Text & esl_no.Text & "\"
            IO.Directory.CreateDirectory(SourceDirectory)
            Dim XX As String = ""
            Dim LatestFile As IO.FileInfo = Nothing
            Dim DirInfo As New IO.DirectoryInfo(SourceDirectory)
            TESTS("email")
            prof(esl_no.Text, "email", 1)
            FCULT("email")
            File.Delete(SourceDirectory & pname.Text & ".PDF")
            Using writer As StreamWriter = New StreamWriter(Application.StartupPath & "\PDF.txt")
                writer.WriteLine(SourceDirectory)
                writer.WriteLine(SourceDirectory & pname.Text & ".PDF")
            End Using
            Dim rrr As Process = Process.Start(Application.StartupPath & "\MERGPDF.exe")
            ACdr.Close()
            ACcmd.CommandText = "INSERT INTO EMAIL(NAME) VALUES ('" & SourceDirectory & pname.Text & ".PDF" & "')"
            ACcmd.ExecuteNonQuery()
            LLOG("PDF", esl_no.Text, "  „  ’œÌ— «· ﬁ—Ì— »Ì œÌ «› " & pname.Text, 0, bran.Text)
        Else
            MsgBox("«·—Ã«¡ «·÷€ÿ ⁄·Ï ›«Ì‰«·", MsgBoxStyle.Critical)
        End If
    End Sub


    Private Sub GB_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB.Click

        'chrcv.Checked = True
        doc_admin = 1
        ComboBox5.Text = "all"
        cdoc_name.Checked = True
        f3(9)
        cdoc_name.Checked = False
        'chrcv.Checked = False
    End Sub



    Private Sub GlassButton2_Click_10(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Dim SS As String = ""
        dr.Close()
        dr1.Close()
        cmd.CommandText = "SELECT NAME,CODE,KY FROM LCOMPANY  ORDER BY NAME"
        dr = cmd.ExecuteReader
        While dr.Read
            If dr(0) = SS Then
                cmd1.CommandText = "DELETE FROM LCOMPANY WHERE KY='" & dr(2) & "'"
                cmd1.ExecuteNonQuery()
            End If
            SS = dr(0)
        End While
    End Sub

    Private Sub GlassButton18_Click_5(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles alllllllll.Click

        esl_date.Value = Now.Date
        cesl_date.Checked = True
        If edt = 0 And ChangeFormat(esl_date.Value) = ChangeFormat(Now) Then MsgBox("·« Ì„ﬂ‰  —ÕÌ· «·«Ì—«œ ﬁÏ ‰›” «·ÌÊ„", MsgBoxStyle.Critical) : Exit Sub
        If save_code.Text = "" Or save_code.Text = "0" Then MsgBox("«Œ «— «·Œ“Ì‰…") : Exit Sub
        If save_name.Text = "" Or save_name.Text = "0" Then MsgBox("«Œ «— «·Œ“Ì‰…") : Exit Sub

        Dim NX As Date = ChangeFormat(d1.Value)
        While Not ChangeFormat(NX) = ChangeFormat(d2.Value.AddDays(1))
            Dim edate As Date = NX
            esl_date.Value = NX
            '========================================add revnue
            dr.Close()
            cmd.CommandText = "SELECT * FROM LCASH WHERE NOTSE='  Õ”«» ÌÊ„    " & esl_date.Value.Date & "  ›—⁄ " & save_name.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr.HasRows = True Then MsgBox(" „  —ÕÌ· «·«Ì—«œ „‰ ﬁ»· ", MsgBoxStyle.Critical) : Exit Sub
            dr.Close()
            cmd.CommandText = "SELECT * FROM LCASH WHERE sub_code='1' and date1='" & ChangeFormat(esl_date.Value) & "' and branch_name='" & branch_name.Text & "'"
            dr = cmd.ExecuteReader
            If dr.HasRows = True Then
                Dim n11 As String = MsgBox(" „  —ÕÌ· «·«Ì—«œ „‰ ﬁ»· Â·  —Ìœ «· ÕœÌÀø", MsgBoxStyle.YesNo)
                If n11 = vbNo Then Exit Sub
                dr.Close()
                cmd.CommandText = "delete  FROM LCASH WHERE sub_code='1' and date1='" & ChangeFormat(esl_date.Value) & "' and branch_name='" & branch_name.Text & "'"
                cmd.ExecuteNonQuery()
            End If

            cesl_date.Checked = True
            CBRAN.Checked = True
            dr.Close()
            cmd.CommandText = "select * from lsave where CODE='" & saven & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                save_name.Text = dr("NAME")
            End While
            Dim s2 As Integer = 0
            Dim n As Int16
            dr.Close()
            Dim D As Date = Now
            time1.Text = D.Hour.ToString & " : " & D.Minute.ToString
            date1.Text = D.Date.ToShortDateString
            cash.Text = -1 * Val(REST.Text)
            crd.Text = 0
            dr.Close()
            cmd.CommandText = "select * from lsub where sub_code='1'"
            dr = cmd.ExecuteReader
            dr.Read()
            If dr("flg") = 1 Then flg.Checked = True Else flg.Checked = False
            main_code.Text = dr("main_code")
            main_name.Text = dr("main_name")
            dr.Close()
            cmd.CommandText = "select * from lsub where sub_code='1'"
            dr = cmd.ExecuteReader
            dr.Read()
            sub_name.Text = dr("sub_name")
            tm = 10
            RSD.Text = 0
            FCASH1()
            ACdr.Close()
            ACcmd.CommandText = "update srv set CASH='" & Val(id.Text) & "' "
            ACcmd.ExecuteNonQuery()
            cesl_date.Checked = True
            RP1.Checked = False
            f3(1)
            If flg.Checked = True Then n = 1 Else n = -1
            Dim NN1 As Integer = 0
            Dim NN2 As Integer = 0
            dr.Close()
            dr1.Close()
            While Not NN1 = F31.Rows.Count
                ACdr.Close()
                ACcmd.CommandText = "select * from srv "
                ACdr = ACcmd.ExecuteReader
                ACdr.Read()
                If ACdr("CASH") > 0 Then
                    id.Text = ACdr("CASH")
                    FCASH1()
                End If
                ACdr.Close()
                ACcmd.CommandText = "update srv set CASH='" & Val(id.Text) & "' "
                ACcmd.ExecuteNonQuery()
                dr.Close()
                cmd.CommandText = "insert into lcash ([main_name],[main_code],[sub_code],[sub_name],[flg],[cash],[crd],[time1],[date1],[id],[notse],usr,shift,SAVE_NAME,SAVE_CODE,branch_code,branch_name) values ('" & main_name.Text & " ','" & main_code.Text & "','" & sub_code.Text & "','" & sub_name.Text & "','" & n & "','" & F31.Rows(NN1).Item("eslb") & "','0','" & time1.Text & "','" & ChangeFormat(esl_date.Value) & "','" & id.Text & "',' Õ”«»    " & F31.Rows(NN1).Item("pname") & "','" & F31.Rows(NN1).Item("USR") & "','" & F31.Rows(NN1).Item("SHIFT") & "','" & save_name.Text & "','" & save_code.Text & "','" & branch_code.Text & "','" & branch_name.Text & "')"
                cmd.ExecuteNonQuery()
                NN1 = NN1 + 1
            End While

            If tlabtolab = 1 Then
                LABTO()
                NN1 = 0
                If temp.Rows.Count > 0 Then
                    dr.Close()
                    cmd.CommandText = "select * from lsub where sub_code='100'"
                    dr = cmd.ExecuteReader
                    dr.Read()
                    If dr("flg") = 1 Then flg.Checked = True Else flg.Checked = False
                    main_code.Text = dr("main_code")
                    main_name.Text = dr("main_name")
                    dr.Close()
                    cmd.CommandText = "select * from lsub where sub_code='100'"
                    dr = cmd.ExecuteReader
                    dr.Read()
                    sub_name.Text = dr("sub_name")
                End If
                While Not NN1 = temp.Rows.Count
                    FCASH1()
                    ACdr.Close()
                    ACcmd.CommandText = "update srv set CASH='" & Val(id.Text) & "' "
                    ACcmd.ExecuteNonQuery()
                    dr.Close()
                    cmd.CommandText = "insert into lcash ([main_name],[main_code],[sub_code],[sub_name],[flg],[cash],[crd],[time1],[date1],[id],[notse],usr,shift,SAVE_NAME,SAVE_CODE,branch_code,branch_name) values ('" & main_name.Text & " ','" & main_code.Text & "','" & sub_code.Text & "','" & sub_name.Text & "','-1','" & temp.Rows(NN1).Item("PTOT") & "','0','" & time1.Text & "','" & ChangeFormat(esl_date.Value) & "','" & id.Text & "',' Õ”«»    " & temp.Rows(NN1).Item("pname") & "','" & temp.Rows(NN1).Item("USR") & "','" & temp.Rows(NN1).Item("SHIFT") & "','" & save_name.Text & "','" & save_code.Text & "','" & branch_code.Text & "','" & branch_name.Text & "')"
                    cmd.ExecuteNonQuery()
                    NN1 = NN1 + 1
                End While
                RP1.Checked = True

            End If


            MsgBox("day " & NX.Date & " added")
            '=========================================end revnue

            NX = NX.AddDays(1)
        End While


        RP1.Checked = True
        If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" Else Me.Text = "IT'S SAVED"

    End Sub

    Private Sub GB23_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB23.Click
        databook.Visible = False
        GB22.Visible = False
        GB23.Visible = False
    End Sub

    Private Sub GB22_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB22.Click
        Dim ii As Integer = 0
        While Not ii = BOOK.Rows.Count
            ss = 0
            RC = BOOK.Rows(ii)
            dr.Close() : cmd.CommandText = "sELECT  * from ltest_price WHERE test_code='" & Ntest_CODE.Text & "'  and book_price_code='" & BOOK.Rows(ii).Item("code") & "' "
            dr = cmd.ExecuteReader
            If dr.HasRows Then
                dr.Close()
                cmd.CommandText = "UPDATE Ltest_price SET tot ='" & BOOK.Rows(ii).Item("K") & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "' and book_price_code='" & BOOK.Rows(ii).Item("code") & "'"
                cmd.ExecuteNonQuery()

            Else
                dr.Close()
                cmd.CommandText = "insert into ltest_price (test_code,test_name,[book_price_code],[book_price_name],tot,ar)  values ('" & Ntest_CODE.Text & "','" & Ntest_NAME.Text & "','" & BOOK.Rows(ii).Item("code") & " ','" & BOOK.Rows(ii).Item("NAME") & "','" & BOOK.Rows(ii).Item("K") & "','0')"
                cmd.ExecuteNonQuery()
            End If
mv:
            ss = 0
            ii += 1
        End While

        databook.Visible = False
        GB22.Visible = False
        GB23.Visible = False
    End Sub

    Private Sub GB24_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB24.Click
        UPDATEBILL()
        MsgBox(" „  ⁄„·Ì… «· ⁄œÌ·", MsgBoxStyle.Information)
    End Sub

    Private Sub gb25_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gb25.Click
        Try
            Dim x As String = MsgBox("Â·  —Ìœ Õ›Ÿ «·ÃÂ… «·ÃœÌœÂ ⁄·Ï «·”Ì—›—", MsgBoxStyle.YesNo)
            If x = vbNo Then Exit Sub
            qqq1_Click(qqq1, e)
            fcompany(1)
            dr.Close()
            ACdr.Close()
            dr1.Close()
            CN.Close()
            open_sql()
            dr.Close()
            cmd.CommandText = "insert into Lcompany (code,name,[book_price_code],[book_price_name],[ph],[ch] ,[pp],[cp],[ps],[cs],[pw],[cw],diss,[add1],email,tel,nik,BRAN)  values ('" & COMPANY_CODE.Text & "','" & Trim(COMPANY_name.Text) & "','" & BOOK_CODE.Text & " ','" & BOOK_name.Text & "','100','0' ,'100','0','100','0','100','0','0','0','-','0','0','" & RRVV & "')"
            cmd.ExecuteNonQuery()
            RC = scompany.NewRow
            RC("name") = comp
            scompany.Rows.Add(RC)
            REG_name.Items.Add(comp)
            If lng = "AR" Then Me.Text = " „  ⁄„·Ì… «·Õ›Ÿ »‰Ã«Õ" & " " & COMPANY_name.Text Else Me.Text = "IT'S SAVED" & " " & COMPANY_name.Text
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub GB26_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB26.Click

    End Sub

    Private Sub GlassButton2_Click_11(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gb34.Click
        dr.Close()
        Dim S As String = MsgBox(" Â·  —Ìœ  ⁄œÌ· «·ÿ»Ì» " & doc_namec.Text, MsgBoxStyle.YesNo)
        If S = vbNo Then Exit Sub


        dr.Close()
        Dim NX As Date = ChangeFormat(dd1.Value)
        While Not ChangeFormat(NX) = ChangeFormat(dd2.Value)
            If NX.Year > 2018 Then Exit While
            Dim n As Integer = TextBox8.Text
            While Not n = TextBox12.Text + 1
                cmd.CommandText = "update cgdl set  d" & n & "='" & doc_namec.Text & "',s" & n & "='" & type_name.Text & "',C" & n & "='0' where day='" & ChangeFormat(NX) & "' and eyada_name='" & eyada_name.Text & "'"
                cmd.ExecuteNonQuery()
                n = n + 1
            End While
            NX = NX.AddDays(7)

        End While
        MsgBox(" „ Õ›Ÿ «·ÃœÊ·")
    End Sub

    Private Sub GlassButton15_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton15.Click

    End Sub

    Private Sub eyada_name_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles eyada_name.DropDown

    End Sub

    Private Sub eyada_name_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles eyada_name.KeyDown

    End Sub

    Private Sub eyada_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles eyada_name.SelectedIndexChanged
        If eyada_name.Text.Length > 2 Then
            dr.Close()
            cmd.CommandText = "SELECT *  FROM CEYADA WHERE NAME='" & eyada_name.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read()
                eyada_name.Text = dr("Name")
                eyada_code.Text = dr("CODE")
                branch_code.Text = dr("branch_code")
                branch_name.Text = dr("branch_name")
                DESCRP.Text = dr("descrp")

            End While

        End If
    End Sub

    Private Sub crd_v_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles crd_v.TextChanged

    End Sub

    Private Sub gb35_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gb35.Click
        If eyada_name.Text.Length < 2 Then MsgBox("«·—Ã«¡ ﬂ «»… «”„ «·⁄Ì«œ… ﬁ»· Õ›ŸÂ«") : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from ceyada where  NAME='" & eyada_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            dr.Close()
            cmd.CommandText = "select max(code) from ceyada "
            dr = cmd.ExecuteReader
            dr.Read()
            Dim n As Integer = 0
            eyada_code.Text = 1 + nulls(dr(0))
            If flg.Checked = True Then n = 1 Else n = -1
            eyada_name.Items.Add(eyada_name.Text)
        Else

            dr.Close()
            cmd.CommandText = "DELETE from ceyada where  NAME='" & eyada_name.Text & "'"
            cmd.ExecuteNonQuery()
        End If


        dr.Close() : cmd.CommandText = "insert into ceyada (code,NAME,BRANCH_CODE,BRANCH_NAME,DESCRP)  values ('" & eyada_code.Text & "','" & eyada_name.Text & "','" & branch_code.Text & "','" & branch_name.Text & "','" & DESCRP.Text & "')"
        cmd.ExecuteNonQuery()

    End Sub

    Private Sub GlassButton2_Click_12(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB55.Click
        Dim S As String = MsgBox("Â·  —Ìœ Õ–› «· Œ’’" & type_name.Text, MsgBoxStyle.YesNo)
        If S = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "DELETE from cTYPE where  NAME='" & type_name.Text & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub GB45_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB45.Click
        IPX.Visible = True
        OpenFileDialog1.ShowDialog()
        IPX.ImageLocation = OpenFileDialog1.FileName
    End Sub

    Private Sub SERVF_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles SERVF.KeyUp
        If e.KeyCode = Keys.Enter And SERVF.Text <> "" Then
            dr.Close()
            cmd.CommandText = "SELECT * FROM CSERV WHERE NAME='" & SERVF.Text & "'"
            dr = cmd.ExecuteReader
            If dr.HasRows = False Then
                Dim S As String = MsgBox("Â·  —Ìœ Õ›Ÿ «·Œœ„… " & SERVF.Text, MsgBoxStyle.YesNo)
                If S = vbYes Then
                    Dim SS As Integer = 0
                    dr.Close()
                    cmd.CommandText = "select max(code) from CSERV "
                    dr = cmd.ExecuteReader
                    dr.Read()
                    SS = 1 + nulls(dr(0))
                    dr.Close()
                    cmd.CommandText = "INSERT INTO CSERV (CODE,NAME) VALUES ('" & SS & "','" & SERVF.Text & "')"
                    cmd.ExecuteNonQuery()
                    SERVF.AutoCompleteCustomSource.Add(SERVF.Text)
                End If
            End If
            If SERV.Text = "" Then
                SERV.Text = SERVF.Text
            Else
                SERV.Text = SERV.Text & Environment.NewLine & SERVF.Text
            End If
            SERVF.Text = ""
        End If

    End Sub

    Private Sub SERVF_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SERVF.TextChanged


    End Sub

    Private Sub lnotes_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles lnotes.SelectedIndexChanged

    End Sub

    Private Sub gb60_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gb60.Click
        ComboBox5.Text = "all"
        clabd.Checked = True
        f3(10)
        clabd.Checked = False

    End Sub

    Private Sub GB46_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB46.Click
        If doc_namec.Text.Length < 2 Then MsgBox("«·—Ã«¡ ﬂ «»… «”„ «·⁄Ì«œ… ﬁ»· Õ›ŸÂ«") : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from cdoc where  NAME='" & doc_namec.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            dr.Close()
            cmd.CommandText = "select max(code) from cdoc "
            dr = cmd.ExecuteReader
            dr.Read()
            Dim n As Integer = 0
            doc_codec.Text = 1 + nulls(dr(0))
        Else
            Dim S As String = MsgBox("Â·  —Ìœ  ⁄œÌ· «·ÿ»Ì»" & doc_namec.Text, MsgBoxStyle.YesNo)
            If S = vbNo Then Exit Sub
            dr.Close()
            cmd.CommandText = "DELETE from cdoc where  NAME='" & doc_namec.Text & "'"
            cmd.ExecuteNonQuery()
        End If

        dr.Close()
        cmd.CommandText = "INSERT INTO [cdoc]([NAME],[CODE],[TITLE],[ABOUT],[DEGREE],[TYPE] ,[RES_TYPE] ,[SERV],works,DMOBILE) VALUES ('" & doc_namec.Text & "','" & doc_codec.Text & "','" & TITLE.Text & "','" & ABOUT.Text & "','" & DEGREE.Text & "','" & TYPE.Text & "','" & Val(RES_ATT.Checked) & "','" & SERV.Text & "','" & Val(WORK.CheckState) & "','" & dmobile.Text & "')"
        cmd.ExecuteNonQuery()
        MsgBox(" „  ⁄„·Ì… Õ›Ÿ «·ÿ»Ì»", MsgBoxStyle.Information)

    End Sub

    Private Sub gb36_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub gb36_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gb36.Click
        Dim S As String = MsgBox("Â·  —Ìœ Õ–› «·⁄Ì«œ…" & eyada_name.Text, MsgBoxStyle.YesNo)
        If S = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "DELETE from ceyada where  NAME='" & eyada_name.Text & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub GB54_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB54.Click
        If eyada_name.Text.Length < 2 Then MsgBox("«·—Ã«¡ ﬂ «»… «”„ «·⁄Ì«œ… ﬁ»· Õ›ŸÂ«") : Exit Sub
        dr.Close()
        cmd.CommandText = "select * from cTYPE where  NAME='" & type_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = False Then
            dr.Close()
            cmd.CommandText = "select max(code) from cTYPE "
            dr = cmd.ExecuteReader
            dr.Read()
            Dim n As Integer = 0
            type_code.Text = 1 + nulls(dr(0))
            If flg.Checked = True Then n = 1 Else n = -1
            type_name.Items.Add(type_name.Text)
        Else

            dr.Close()
            cmd.CommandText = "DELETE from cTYPE where  NAME='" & type_name.Text & "'"
            cmd.ExecuteNonQuery()
        End If


        dr.Close() : cmd.CommandText = "insert into cTYPE (code,NAME)  values ('" & type_code.Text & "','" & type_name.Text & "')"
        cmd.ExecuteNonQuery()

    End Sub

    Private Sub type_name_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles type_name.KeyUp
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "SELECT *  FROM CTYPE WHERE NAME='" & type_name.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read()
                type_name.Text = dr("Name")
                type_code.Text = dr("CODE")
            End While
        End If
    End Sub

    Private Sub type_name_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles type_name.SelectedIndexChanged
        If type_name.Text.Length > 2 Then
            dr.Close()
            cmd.CommandText = "SELECT *  FROM CTYPE WHERE NAME='" & type_name.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read()
                type_name.Text = dr("Name")
                type_code.Text = dr("CODE")


            End While

        End If
    End Sub

    Private Sub doc_namec_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles doc_namec.KeyUp
        If e.KeyCode = Keys.Enter Then
            dr.Close()
            cmd.CommandText = "SELECT *  FROM cdoc WHERE NAME='" & doc_namec.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read()
                doc_namec.Text = dr("Name")
                doc_codec.Text = dr("CODE")
                TITLE.Text = dr("TITLE")
                ABOUT.Text = dr("ABOUT")
                DEGREE.Text = dr("DEGREE")
                type_name.Text = dr("TYPE")
                RES_ATT.Checked = dr("RES_TYPE")
                SERV.Text = dr("SERV")
                WORK.CheckState = dr("WORKS")
            End While
        End If
    End Sub

    Private Sub doc_namec_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles doc_namec.SelectedIndexChanged
        If doc_namec.Text.Length > 2 Then
            dr.Close()
            cmd.CommandText = "SELECT *  FROM cdoc WHERE NAME='" & doc_namec.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read()
                TITLE.Text = ""
                ABOUT.Text = ""
                DEGREE.Text = ""
                type_name.Text = ""
                SERV.Text = ""
                dmobile.Text = ""
                doc_namec.Text = dr("Name")
                doc_codec.Text = dr("CODE")
                TITLE.Text = dr("TITLE")
                ABOUT.Text = dr("ABOUT")
                DEGREE.Text = dr("DEGREE")
                type_name.Text = dr("TYPE")
                RES_ATT.Checked = dr("RES_TYPE")
                SERV.Text = dr("SERV")
                WORK.CheckState = dr("WORKS")
                dmobile.Text = nulls(dr("DMOBILE"))
            End While
        End If
    End Sub

    Private Sub GB61_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB61.Click
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 205 Then Exit Sub
        dr.Close()
        cmd.CommandText = "DELETE FROM CGDL WHERE EYADA_CODE='" & eyada_code.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.ExecuteNonQuery()
        Dim NXX As Date = ChangeFormat(dd1.Value)
        While Not ChangeFormat(NXX) = ChangeFormat(dd2.Value)
            Dim edate As Date = NXX
            Dim sse As String = ""
            Select Case NXX.DayOfWeek
                Case DayOfWeek.Friday
                    sse = "«·Ã„⁄…"
                Case DayOfWeek.Saturday
                    sse = "«·”» "
                Case DayOfWeek.Sunday
                    sse = "«·«Õœ"
                Case DayOfWeek.Monday
                    sse = "«·«À‰Ì‰"
                Case DayOfWeek.Tuesday
                    sse = "«·À·«À«¡"
                Case DayOfWeek.Wednesday
                    sse = "«·«—»⁄«¡"
                Case DayOfWeek.Thursday
                    sse = "«·Œ„Ì”"
            End Select
            cmd.CommandText = "insert into cgdl (branch_name,eyada_name,eyada_code,day,dweek) VALUES ('" & branch_name.Text & "','" & eyada_name.Text & "','" & eyada_code.Text & "','" & ChangeFormat(NXX) & "','" & sse & "')"
            cmd.ExecuteNonQuery()
            NXX = NXX.AddDays(1)
        End While
    End Sub

    Private Sub GB50_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GB50.Click
        Dim S As String = MsgBox("Â·  —Ìœ Õ–› «·ÿ»Ì»" & doc_namec.Text, MsgBoxStyle.YesNo)
        If S = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "DELETE from cdoc where  NAME='" & doc_namec.Text & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub labd_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles labd.GotFocus
        flng("AR")
        FFIND = "LABD"
        FFINDT = labd.Text
    End Sub

    Private Sub labd_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles labd.KeyUp
        If e.KeyCode = Keys.F6 Then
            fufind()
        End If
    End Sub

    Private Sub labd_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles labd.TextChanged

    End Sub

    Private Sub gb62_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gb62.Click
        dr.Close()
        Dim S As String = MsgBox(" Â·  —Ìœ «·€«¡ „Ì⁄«œ ÿ»Ì» " & doc_namec.Text, MsgBoxStyle.YesNo)
        If S = vbNo Then Exit Sub
        dr.Close()
        Dim n As Integer = TextBox8.Text
        While Not n = TextBox12.Text + 1
            cmd.CommandText = "update cgdl set  C" & n & "='1' where day='" & ChangeFormat(dd1.Value) & "' and eyada_name='" & eyada_name.Text & "'"
            cmd.ExecuteNonQuery()
            n = n + 1
        End While
        MsgBox(" „ «·€«¡ «·ÃœÊ·")
    End Sub

    Private Sub gb63_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gb63.Click
        yy = ""
        If chdoc.CheckState = CheckState.Checked Then
            yy = " AND (D10='" & doc_namec.Text & "' OR D11='" & doc_namec.Text & "' OR D12='" & doc_namec.Text & "' OR D13='" & doc_namec.Text & "' OR D14='" & doc_namec.Text & "' OR D15='" & doc_namec.Text & "' OR D16='" & doc_namec.Text & "' OR D17='" & doc_namec.Text & "' OR D18='" & doc_namec.Text & "' OR D19='" & doc_namec.Text & "' OR D20='" & doc_namec.Text & "' OR D21='" & doc_namec.Text & "' OR D22='" & doc_namec.Text & "'  )"
        End If
        If CheckBox3.CheckState = CheckState.Checked Then
            yy = yy & " AND  (S10='" & type_name.Text & "' OR S11='" & type_name.Text & "' OR S12='" & type_name.Text & "' OR S13='" & type_name.Text & "' OR S14='" & type_name.Text & "' OR S15='" & type_name.Text & "' OR S16='" & type_name.Text & "' OR S17='" & type_name.Text & "' OR S18='" & type_name.Text & "' OR S19='" & type_name.Text & "' OR S20='" & type_name.Text & "' OR S21='" & type_name.Text & "' OR S22='" & type_name.Text & "'  ) "
        End If
        If gb33.CheckState = CheckState.Checked Then
            yy = yy & " AND EYADA_NAME='" & eyada_name.Text & "'"
        End If
        If CBRAN.CheckState = CheckState.Checked Then
            yy = yy & " AND BRANCH_NAME='" & branch_name.Text & "'"

        End If

        dr.Close() : cmd.CommandText = "SELECT  * from cgdl where day between '" & ChangeFormat(dd1.Value) & "' and '" & ChangeFormat(dd2.Value) & "'" & yy
        adgdl.SelectCommand = cmd
        adgdl.Fill(DBS, "gdl")
        gdl = DBS.Tables("gdl")
        DBS.Tables("gdl").Clear()
        adgdl.Fill(DBS, "gdl")
        gdl = DBS.Tables("gdl")
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\gdl.rpt")
        oj.Database.Tables(0).SetDataSource(gdl)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub gb65_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles gb65.Click
        If ldoc = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, " ﬁ—Ì— ‰”»… «·ÿ»Ì»" & COMPANY_name.Text, 0, bran.Text)
            Exit Sub
        End If
        ComboBox5.Text = "rest"
        'ComboBox5.Text = "ALL"
        f3(0)
        Dim aa As Integer
        While Not aa = F31.Rows.Count
            FRC = F31.Select("pname='" & "»«ﬁÏ  " & F31.Rows(aa).Item("pname") & "' and esl_no='" & F31.Rows(aa).Item("esl_no") & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                F31.Rows(aa).BeginEdit()
                F31.Rows(aa).Item("eslb") = F31.Rows(aa).Item("eslb") + RC("eslb")
                F31.Rows(aa).EndEdit()
                RC.Delete()

            End If
            FRC = F31.Select("pname='" & "»«ﬁÏ  " & F31.Rows(aa).Item("pname") & "' and esl_no='" & F31.Rows(aa).Item("esl_no") & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                F31.Rows(aa).BeginEdit()
                F31.Rows(aa).Item("eslb") = F31.Rows(aa).Item("eslb") + RC("eslb")
                F31.Rows(aa).EndEdit()

                RC.Delete()
            End If

            FRC = F31.Select("pname='" & "»«ﬁÏ  " & F31.Rows(aa).Item("pname") & "' and esl_no='" & F31.Rows(aa).Item("esl_no") & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                F31.Rows(aa).BeginEdit()
                F31.Rows(aa).Item("eslb") = F31.Rows(aa).Item("eslb") + RC("eslb")
                F31.Rows(aa).EndEdit()

                RC.Delete()
            End If

            FRC = F31.Select("pname='" & "»«ﬁÏ  " & F31.Rows(aa).Item("pname") & "' and esl_no='" & F31.Rows(aa).Item("esl_no") & "'")
            If FRC.Length > 0 Then
                RC = FRC(0)
                F31.Rows(aa).BeginEdit()
                F31.Rows(aa).Item("eslb") = F31.Rows(aa).Item("eslb") + RC("eslb")
                F31.Rows(aa).EndEdit()
                RC.Delete()
            End If

            aa = aa + 1
        End While
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument

        oj.Load(Application.StartupPath & "\doc pers.rpt")
        oj.Database.Tables(0).SetDataSource(F31)
        oj.SetParameterValue("1", " ﬁ—Ì— «· ›’Ì·Ï Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        If ls = 0 Then oj.SetParameterValue("5", "0") Else oj.SetParameterValue("5", "1")
        If mng = 1 Or (cesl_date.Checked = True And lp = 1) Then oj.SetParameterValue("118", 1) Else oj.SetParameterValue("118", 0)

        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show()
        rp.Focus()
    End Sub

    Private Sub DDDDDD_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DDDDDD.Click, eeeeeee.Click
        On Error Resume Next
        RP1.CheckState = CheckState.Unchecked
        f3(1)
        RP1.CheckState = CheckState.Checked
        Dim X As Integer = 0
        Dim N As Integer = 1
        While Not X = F31.Rows.Count
            F31.Rows(X).BeginEdit()
            F31.Rows(X).Item("QUN") = 1000000
            F31.Rows(X).EndEdit()
            X = X + 1
        End While
        FRC = F31.Select("ESL_NO<0")
        X = 0
        If FRC.Length > 0 Then

            RC = F31.NewRow
            RC("usr") = "  "
            RC("test") = "«ﬂÊ«œ ”«·»"
            RC("eslb") = 0
            RC("bon") = 0
            RC("esl_no") = 0
            RC("pname") = "«ﬂÊ«œ ”«·»"
            RC("pay") = 0
            RC("rest") = 0
            RC("ptot") = 0
            RC("company_name") = "«ﬂÊ«œ ”«·»"
            RC("QUN") = N

            F31.Rows.Add(RC)
            N = N + 1
            While Not X = FRC.Length
                RC = FRC(X)
                RC.BeginEdit()
                RC("QUN") = N
                RC.EndEdit()
                X = X + 1
            End While
            N = N + 1

            F31.Rows.Add(RC)
        End If

        FRC = F31.Select("NDOC<>'0'")
        X = 0
        If FRC.Length > 0 Then
            N = N + 1
            RC = F31.NewRow
            RC("usr") = "  "
            RC("test") = "ÿ»Ì» ÿ—› «·„⁄„·"
            RC("eslb") = 0
            RC("bon") = 0
            RC("esl_no") = 0
            RC("pname") = "ÿ»Ì» ÿ—› «·„⁄„·"
            RC("pay") = 0
            RC("rest") = 0
            RC("ptot") = 0
            RC("company_name") = "ÿ»Ì» ÿ—› «·„⁄„·"
            RC("QUN") = N
            F31.Rows.Add(RC)
            N = N + 1
            While Not X = FRC.Length
                RC = FRC(X)
                RC.BeginEdit()
                RC("QUN") = N
                RC.EndEdit()
                X = X + 1
            End While

            N = N + 1
            F31.Rows.Add(RC)
        End If

        FRC = F31.Select("BANK<>'0'")
        X = 0
        If FRC.Length > 0 Then
            N = N + 1
            RC = F31.NewRow
            RC("usr") = "  "
            RC("test") = "Õ”«» «·»‰ﬂ"
            RC("eslb") = 0
            RC("bon") = 0
            RC("esl_no") = 0
            RC("pname") = "Õ”«» «·»‰ﬂ"
            RC("pay") = 0
            RC("rest") = 0
            RC("ptot") = 0
            RC("company_name") = "Õ”«» «·»‰ﬂ"
            RC("QUN") = N
            F31.Rows.Add(RC)
            N = N + 1
            While Not X = FRC.Length
                RC = FRC(X)
                RC.BeginEdit()
                RC("QUN") = N
                RC.EndEdit()
                X = X + 1
            End While

            N = N + 1
            F31.Rows.Add(RC)
        End If

        FRC = F31.Select("notes='sample cancelled'")
        X = 0
        If FRC.Length > 0 Then
            N = N + 1
            RC = F31.NewRow
            RC("usr") = "  "
            RC("test") = "sample cancelled"
            RC("eslb") = 0
            RC("bon") = 0
            RC("esl_no") = 0
            RC("pname") = "sample cancelled"
            RC("pay") = 0
            RC("rest") = 0
            RC("ptot") = 0
            RC("company_name") = "sample cancelled"
            RC("QUN") = N
            F31.Rows.Add(RC)
            N = N + 1
            While Not X = FRC.Length
                RC = FRC(X)
                RC.BeginEdit()
                RC("QUN") = N
                RC.EndEdit()
                X = X + 1
            End While
            F31.Rows.Add(RC)
        End If
        N = N + 1
        FRC = F31.Select("BON<>'0' or utc<>'0' or utn<>'0' or ncrd<>'0' ")
        X = 0
        If FRC.Length > 0 Then
            N = N + 1
            RC = F31.NewRow
            RC("usr") = "  "
            RC("test") = "«·‘—ﬂ« "
            RC("eslb") = 0
            RC("bon") = 0
            RC("esl_no") = 0
            RC("pname") = "«·‘—ﬂ« "
            RC("pay") = 0
            RC("rest") = 0
            RC("ptot") = 0
            RC("company_name") = "«·‘—ﬂ« "
            RC("QUN") = N
            F31.Rows.Add(RC)
            N = N + 1
            While Not X = FRC.Length
                RC = FRC(X)
                RC.BeginEdit()
                RC("QUN") = N
                RC.EndEdit()
                X = X + 1
            End While
            N = N + 1
        End If

        N = N + 1
        RC = F31.NewRow
        RC("usr") = "  "
        RC("test") = "«ﬂÊ«œ «·„—÷Ï «·ﬂ«‘"
        RC("eslb") = 0
        RC("bon") = 0
        RC("esl_no") = 0
        RC("pname") = "«ﬂÊ«œ «·„—÷Ï «·ﬂ«‘"
        RC("pay") = 0
        RC("rest") = 0
        RC("ptot") = 0
        RC("company_name") = "«ﬂÊ«œ «·„—÷Ï «·ﬂ«‘"
        RC("QUN") = N
        F31.Rows.Add(RC)


        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\BILL1.rpt")
        oj.Database.Tables(0).SetDataSource(F31)
        oj.SetParameterValue("1", " ﬁ—Ì— «· ›’Ì·Ï Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        If ls = 0 Then oj.SetParameterValue("5", "0") Else oj.SetParameterValue("5", "1")
        If mng = 1 Or (cesl_date.Checked = True And lp = 1) Then oj.SetParameterValue("118", 1) Else oj.SetParameterValue("118", 0)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show()
        rp.Focus()
    End Sub

    Private Sub gb66_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        f3(11)
    End Sub

    Private Sub utc_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles utc.CheckedChanged
        If utc.CheckState = CheckState.Checked Or utn.CheckState = CheckState.Checked Then
            bon.BackColor = Color.Red
            REST.BackColor = Color.Red
        Else
            bon.BackColor = Color.White
            REST.BackColor = Color.White
        End If
    End Sub

    Private Sub utn_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles utn.CheckedChanged
        If utc.CheckState = CheckState.Checked Or utn.CheckState = CheckState.Checked Then
            bon.BackColor = Color.Red
            REST.BackColor = Color.Red
        Else
            bon.BackColor = Color.White
            REST.BackColor = Color.White
        End If
    End Sub

    Private Sub «·ÕÃ“« ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        RRRS.Visible = True
    End Sub

    Private Sub RSAVE_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RSAVE.Click
        dr.Close()
        cmd.CommandText = " INSERT INTO CSRV([PNAME],[PCODE],[REG_NAME],[REG_CODE],[DOC_NAME],[DOC_CODE],[BRANCH_NAME],[BRANCH_CODE],[BRAN],[SERV],[SDATE],[STIME],[USR],[NOTSE],[EYADA],[ST]) VALUES ('" & pname.Text & "','" & pcode.Text & "','" & COMPANY_name.Text & "','" & COMPANY_CODE.Text & "','" & REG_name.Text & "','" & REG_CODE.Text & "','" & branch_name.Text & "','" & branch_code.Text & "','" & bran.Text & "','" & test.Text & "','" & ChangeFormat(esl_date.Value) & "',[STIME],'" & USR & "','" & RNOTES.Text & "','" & ENAME.Text & "')"
    End Sub

    Private Sub RDEL_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RDEL.Click

    End Sub

    Private Sub RDONE_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RDONE.Click

    End Sub

    Private Sub RRRRREPORT_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RRRRREPORT.Click

    End Sub

    Private Sub QQQ10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQQ10.Click
        ACdr.Close()
        ACcmd.CommandText = "UPDATE PATCH_SAVE SET RESLUT='Negative' WHERE RESLUT='negative' "
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = "UPDATE PATCH_SAVE SET RESLUT='Not   Sample' WHERE RESLUT='Not Sample' "
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = "UPDATE PATCH_SAVE SET RESLUT='Not   Sample' WHERE RESLUT IS NULL "
        ACcmd.ExecuteNonQuery()
        ACcmd.CommandText = "UPDATE PATCH_SAVE SET RESLUT='Postive' WHERE RESLUT='Postive' "
        ACcmd.ExecuteNonQuery()
        CODEB.Text = esl_no.Text
        Dim naa As Integer = 0
        While Not naa = ptt.Rows.Count
            RC = ptt.Rows(naa)
            esl_no.Text = nulls(RC("ESL"))
            dr.Close()
            cmd.CommandText = "update LBILL_TEST set  RES='" & RC("RESLUT") & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
            naa = naa + 1

        End While
        dr.Close()

        'Dim naa As Integer = 0
        'While Not naa = ptt.Rows.Count
        '    RC = ptt.Rows(naa)
        '    esl_no.Text = nulls(RC("ESL"))
        '    dr.Close()
        '    cmd.CommandText = "delete from lbill where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        '    cmd.ExecuteNonQuery()
        '    cmd.CommandText = "delete from lbill_ESL where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        '    cmd.ExecuteNonQuery()
        '    cmd.CommandText = "delete from lbill_test  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        '    cmd.ExecuteNonQuery()
        '    cmd.CommandText = "delete from lbill_testsub where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        '    cmd.ExecuteNonQuery()
        '    cmd.CommandText = "delete from LBILL_CULT where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        '    cmd.ExecuteNonQuery()
        '    cmd.CommandText = "delete from LBILL_CULT_DET where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        '    cmd.ExecuteNonQuery()
        '    cmd.CommandText = "delete from lbillemage where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        '    cmd.ExecuteNonQuery()
        '    naa = naa + 1
        'End While
        'dr.Close()
        'cmd.CommandText = "UPDATE LBILL SET QUN=0 WHERE  esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        'cmd.ExecuteNonQuery()
        'Dim naa As Integer = 0
        'While Not naa = ptt.Rows.Count
        '    RC = ptt.Rows(naa)
        '    esl_no.Text = nulls(RC("ESL"))
        '    cmd.CommandText = "UPDATE LBILL SET QUN=9 WHERE  esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' AND ESL_NO='" & esl_no.Text & "' AND BRAN='" & bran.Text & "' AND YEARN='" & YEARN.Text & "'"
        '    cmd.ExecuteNonQuery()
        '    naa = naa + 1
        'End While

    End Sub

    Private Sub GlassButton2_Click_13(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asd1.Click

        f3(12)

    End Sub

    Private Sub GlassButton2_Click_14(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ssssss.Click
        Try
            If Ntest_NAME.Text = "" Then Me.Text = "«·—Ã«¡ ﬂ «»… «”„ «· Õ·Ì·" : Exit Sub
            Dim S As Integer = InputBox("ENTER PASWORD")
            If S <> 205 Then Exit Sub
            dr.Close()
            If RadioButton6.Checked = True Then cmd.CommandText = "update  lbill_test set image1 = NULL , IMAGEN1 = 0,TIMAGEN=0 where  ESL_NO='" & Val(esl_no.Text) & "' AND test_CODE='" & Ntest_CODE.Text & "' and yearn='" & YEARN.Text & "' and bran='" & bran.Text & "'"
            If RadioButton5.Checked = True Then cmd.CommandText = "update  lbill_test set image2 = NULL , IMAGEN2 = 0 where  ESL_NO='" & Val(esl_no.Text) & "' AND test_CODE='" & Ntest_CODE.Text & "' and yearn='" & YEARN.Text & "' and bran='" & bran.Text & "'"
            If RadioButton4.Checked = True Then cmd.CommandText = "update  lbill_test set image3 = NULL , IMAGEN3 = 0 where  ESL_NO='" & Val(esl_no.Text) & "' AND test_CODE='" & Ntest_CODE.Text & "' and yearn='" & YEARN.Text & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
            MsgBox(" „ «·Õ–›")
        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub GlassButton2_Click_15(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles GlassButton2.Click

        Dim n As String = InputBox("enter password", , "0")
        If n <> 5011545 Then Exit Sub
        n = InputBox("enter branch name", , "0")
        dr.Close()
        cmd.CommandText = "update  lbill set branch_name='" & n & "'  where branch_code='" & branch_code.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update  lcash set branch_name='" & n & "'  where branch_code='" & branch_code.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update  branch set name='" & n & "'  where code='" & branch_code.Text & "'"
        cmd.ExecuteNonQuery()

        MsgBox(" „   ⁄œÌ· «·›—⁄ ··ÃÂ«“")
    End Sub

    Private Sub YYYYYYYYY_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles YYYYYYYYY.Click
        If Ntest_NAME.Text = "" Then Me.Text = "«·—Ã«¡ ﬂ «»… «”„ «· Õ·Ì·" : Exit Sub
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 205 Then Exit Sub
        If PORV.Length < 10 Then Exit Sub
        Dim nali As Integer = 0

        If SCN.State = ConnectionState.Closed Then
            Try
                SCN.ConnectionString = PORV
                SCN.Open()
                SCMD.Connection = SCN
                SCMD.CommandText = "select * from branch"
                SDR = SCMD.ExecuteReader
                SDR.Read()
                scmd1.Connection = SCN
                scmd1.CommandText = "select * from branch"
                sdr1 = scmd1.ExecuteReader
                sdr1.Read()
                MsgBox("YOU CONNECTED TO SERVER GIVE ME MINUTS TO UPLOAD DATA")
                SCMD.Connection = SCN
            Catch ex As OleDb.OleDbException
                MsgBox(" ⁄›Ê¬ ÌÊÃœ Œÿ√ ›Ï «·« ’«· »ﬁ«⁄œ… «·»Ì«‰« ", MsgBoxStyle.Critical + MsgBoxStyle.MsgBoxRight)
                Exit Try
            End Try
        End If
        Dim rrr As Process = Process.Start(Application.StartupPath & "\progs.exe")
        If PORV.Length < 10 Then Exit Sub
        'Dim nali As Integer = 0


        If SCN.State = ConnectionState.Closed Then
            Try
                SCN.ConnectionString = PORV
                SCN.Open()
                SCMD.Connection = SCN
                SCMD.CommandText = "select * from branch"
                SDR = SCMD.ExecuteReader
                SDR.Read()
                scmd1.Connection = SCN
                scmd1.CommandText = "select * from branch"
                sdr1 = scmd1.ExecuteReader
                sdr1.Read()
                SCMD.Connection = SCN
            Catch ex As OleDb.OleDbException
                MsgBox(" ⁄›Ê¬ ÌÊÃœ Œÿ√ ›Ï «·« ’«· »ﬁ«⁄œ… «·»Ì«‰« ", MsgBoxStyle.Critical + MsgBoxStyle.MsgBoxRight)
                Exit Try
            End Try
        End If
        SDR.Close()
        sdr1.Close()
        'Dim oer As System.IO.FileStream
        'Dim rer As IO.StreamReader
        dr.Close()

        Dim n As Integer = 0
        Dim n11 As Integer = 0

        '==================================================================dawnload============================
        SDR.Close()
        sdr1.Close()
        dr.Close()
        dr1.Close()
        SCMD.CommandText = "select * from lbill where  " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "INSERT INTO lbill ([esl_date],[esl_no],[pname],[reg_name],[doc_name],[book_code],[book_name],[company_code],[company_name],[doc_code],[pcode],[ptype],[page],[pid],[depn],[reg_code],[esl_time],[crd_per],[crd_v],[cash_per],[cash_v],[bon],[pay],[rest],[tot],[nik],[test],[diss],[USR],[SHIFT],[rcv_date],[rcv],[fastv],[hrcvv],[rcvv],[rcvn],[fastn],[cfast],[chrcv],[totv],[ty],[doc_per],[branch_name],[branch_code],[pemail],[dissn],[notes],[tblg],[sprnt],[pyear],[lab_name],[lab_code],[ptot],[ppay],[prest],[labprice],[labtest],[tnum],[nnik],[qun],[testpro],[rcv_time],[pinc],[pcrd],[pcanc],[YEARN],[ESLBILL],[urgant],[final],[bdel],[bdelusr],[bdeldate],[eslb],[bran],[printtime],[st],[brans],[fnd],[sampl],[sampldate],[samplusr],[restusr],[restdate],[trl],fs,dev) VALUES ('" & SDR("esl_date") & "' , '" & SDR("esl_no") & "' , '" & SDR("pname") & "' , '" & SDR("reg_name") & "' , '" & SDR("doc_name") & "' , '" & SDR("book_code") & "' , '" & SDR("book_name") & "' , '" & SDR("company_code") & "' , '" & SDR("company_name") & "' , '" & SDR("doc_code") & "' , '" & SDR("pcode") & "' , '" & SDR("ptype") & "' , '" & SDR("page") & "' , '" & SDR("pid") & "' , '" & SDR("depn") & "' , '" & SDR("reg_code") & "' , '" & SDR("esl_time") & "' , '" & SDR("crd_per") & "' , '" & SDR("crd_v") & "' , '" & SDR("cash_per") & "' , '" & SDR("cash_v") & "' , '" & SDR("bon") & "' , '" & SDR("pay") & "' , '" & SDR("rest") & "' , '" & SDR("tot") & "' , '" & SDR("nik") & "' , '" & SDR("test") & "' , '" & SDR("diss") & "' , '" & SDR("USR") & "' , '" & SDR("SHIFT") & "' , '" & SDR("rcv_date") & "' , '" & SDR("rcv") & "' , '" & SDR("fastv") & "' , '" & SDR("hrcvv") & "' , '" & SDR("rcvv") & "' , '" & SDR("rcvn") & "' , '" & SDR("fastn") & "' , '" & SDR("cfast") & "' , '" & SDR("chrcv") & "' , '" & SDR("totv") & "' , '" & SDR("ty") & "' , '" & SDR("doc_per") & "' , '" & SDR("branch_name") & "' , '" & SDR("branch_code") & "' , '" & SDR("pemail") & "' , '" & SDR("dissn") & "' , '" & SDR("notes") & "' , '" & SDR("tblg") & "' , '" & SDR("sprnt") & "' , '" & SDR("pyear") & "' , '" & SDR("lab_name") & "' , '" & SDR("lab_code") & "' , '" & SDR("ptot") & "' , '" & SDR("ppay") & "' , '" & SDR("prest") & "' , '" & SDR("labprice") & "' , '" & SDR("labtest") & "' , '" & SDR("tnum") & "' , '" & SDR("nnik") & "' , '" & SDR("qun") & "' , '" & SDR("testpro") & "' , '" & SDR("rcv_time") & "' , '" & SDR("pinc") & "' , '" & SDR("pcrd") & "' , '" & SDR("pcanc") & "' , '" & SDR("YEARN") & "' , '" & SDR("ESLBILL") & "' , '" & SDR("urgant") & "' , '" & SDR("final") & "' , '" & SDR("bdel") & "' , '" & SDR("bdelusr") & "' , '" & SDR("bdeldate") & "' , '" & SDR("eslb") & "' , '" & SDR("bran") & "' , '" & SDR("printtime") & "' , '0' , '" & SDR("brans") & "' , '" & SDR("fnd") & "' , '" & SDR("sampl") & "' , '" & SDR("sampldate") & "' , '" & SDR("samplusr") & "' , '" & SDR("restusr") & "' , '" & SDR("restdate") & "' , '" & SDR("trl") & "', '" & SDR("trl") & "', '" & SDR("dev") & "')"
            cmd.ExecuteNonQuery()
            sdr1.Close()
lm:
            sdr1.Close()
            scmd1.CommandText = "select * from LBILL_CULT_DET where ESL_NO='" & SDR("esl_no") & "'   and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
            sdr1 = scmd1.ExecuteReader
            While sdr1.Read
                cmd.CommandText = "INSERT INTO [LBILL_CULT_DET]([test_name],[test_code],[esl_no],[NOTE],[SPECIMEN],[DIRECT_ FILM],[PUS_CELLS],[RBCs],[OTHERS],[CULTURE_CONDITIONS],[GROWTH_OF],[VAIBLE_COUNT],[COUNT_IS],[epithelial],[num],[YEARN],[bran],[st])VALUES ('" & sdr1("test_name") & "' , '" & sdr1("test_code") & "' , '" & sdr1("esl_no") & "' , '" & sdr1("NOTE") & "' , '" & sdr1("SPECIMEN") & "' , '" & sdr1("DIRECT_ FILM") & "' , '" & sdr1("PUS_CELLS") & "' , '" & sdr1("RBCs") & "' , '" & sdr1("OTHERS") & "' , '" & sdr1("CULTURE_CONDITIONS") & "' , '" & sdr1("GROWTH_OF") & "' , '" & sdr1("VAIBLE_COUNT") & "' , '" & sdr1("COUNT_IS") & "' , '" & sdr1("epithelial") & "' , '" & sdr1("num") & "' , '" & sdr1("YEARN") & "' , '" & sdr1("bran") & "' , '0')"
                cmd.ExecuteNonQuery()
            End While
            sdr1.Close()
            scmd1.CommandText = "select * from LBILL_CULT where ESL_NO='" & SDR("esl_no") & "'  and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
            sdr1 = scmd1.ExecuteReader
            While sdr1.Read
                cmd.CommandText = "INSERT INTO [LBILL_CULT]([test_name],[test_code],[esl_no],[name1],[NAME2],[NAME3],[VIRUS],[VIRUSC],[so],[YEARN],[bran],[st]) VALUES ('" & sdr1("test_name") & "' , '" & sdr1("test_code") & "' , '" & sdr1("esl_no") & "' , '" & sdr1("name1") & "' , '" & sdr1("NAME2") & "' , '" & sdr1("NAME3") & "' , '" & sdr1("VIRUS") & "' , '" & sdr1("VIRUSC") & "' , '" & sdr1("so") & "' , '" & sdr1("YEARN") & "' , '" & sdr1("bran") & "' , '0')"
                cmd.ExecuteNonQuery()
            End While
            sdr1.Close()
            scmd1.CommandText = "select * from lbill_test where ESL_NO='" & SDR("esl_no") & "'    and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
            sdr1 = scmd1.ExecuteReader
            While sdr1.Read
                cmd.CommandText = "INSERT INTO [lbill_test]([qun],[pthn],[ds],[test_name],[res],[test_code],[test_ar],[test_price],[tot1],[ref],[esl_no],[esl_date],[sub],[pname],[pcode],[page],[ptype],[cult],[fres],[rcv_date],[rcv],[note],[NOTEN],[NORB],[NORE],[UNIT],[take],[gr_name],[gr_code],[s],[p],[gname],[GCODE],[t],[TBLG],[tblgtime],[tblgusr],[prntn],[lab],[labprice],[so],[RSO],[comment],[HOMS],[BAR],[dis_n],[uadd],[uadddate],[YEARN],[urem],[uremdate],[tdel],[sres],[TOT2],[prnttime],[pth],[rsv],[rsvp],[QUN1],[id],[bran],[st],[trl],pricep) VALUES ('" & sdr1("qun") & "' , '" & sdr1("pthn") & "' , '" & sdr1("ds") & "' , '" & sdr1("test_name") & "' , '" & sdr1("res") & "' , '" & sdr1("test_code") & "' , '" & sdr1("test_ar") & "' , '" & sdr1("test_price") & "' , '" & sdr1("tot1") & "' , '" & sdr1("ref") & "' , '" & sdr1("esl_no") & "' , '" & sdr1("esl_date") & "' , '" & sdr1("sub") & "' , '" & sdr1("pname") & "' , '" & sdr1("pcode") & "' , '" & sdr1("page") & "' , '" & sdr1("ptype") & "' , '" & sdr1("cult") & "' , '" & sdr1("fres") & "' , '" & sdr1("rcv_date") & "' , '" & sdr1("rcv") & "' , '" & sdr1("note") & "' , '" & sdr1("NOTEN") & "' , '" & sdr1("NORB") & "' , '" & sdr1("NORE") & "' , '" & sdr1("UNIT") & "' , '" & sdr1("take") & "' , '" & sdr1("gr_name") & "' , '" & sdr1("gr_code") & "' , '" & sdr1("s") & "' , '" & sdr1("p") & "' , '" & sdr1("gname") & "' , '" & sdr1("GCODE") & "' , '" & sdr1("t") & "' , '" & sdr1("TBLG") & "' , '" & sdr1("tblgtime") & "' , '" & sdr1("tblgusr") & "' , '" & sdr1("prntn") & "' , '" & sdr1("lab") & "' , '" & sdr1("labprice") & "' , '" & sdr1("so") & "' , '" & sdr1("RSO") & "' , '" & sdr1("comment") & "' , '" & sdr1("HOMS") & "' , '" & sdr1("BAR") & "' , '" & sdr1("dis_n") & "' , '" & sdr1("uadd") & "' , '" & sdr1("uadddate") & "' , '" & sdr1("YEARN") & "' , '" & sdr1("urem") & "' , '" & sdr1("uremdate") & "' , '" & sdr1("tdel") & "' , '" & sdr1("sres") & "' , '" & sdr1("TOT2") & "' , '" & sdr1("prnttime") & "' , '" & sdr1("pth") & "' , '" & sdr1("rsv") & "' , '" & sdr1("rsvp") & "' , '" & sdr1("QUN1") & "' , '" & nulls(sdr1("id")) & "' , '" & sdr1("bran") & "' , '0' , '" & sdr1("trl") & "', '" & sdr1("pricep") & "')"
                cmd.ExecuteNonQuery()
            End While
            sdr1.Close()
            scmd1.CommandText = "select * from lbill_testsub where ESL_NO='" & SDR("esl_no") & "'    and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text.Trim & "'" & ""
            sdr1 = scmd1.ExecuteReader
            While sdr1.Read
                cmd.CommandText = "INSERT INTO [lbill_testsub]([qun],[pthn],[test_name],[res],[res1],[res2],[so],[test_code],[test_ar],[ref],[esl_no],[mtest_code],[mtest_name],[ds],[rcv],[note],[NOTEN],[NORB],[NORE],[q],[absu],[ref1],[p],[unit],[rso],[YEARN],[re1],[re2],[ds1],[pth],[rsv],[rsvp],[rsv1],[QUN1],[RDS],[bran],[st]) VALUES ('" & sdr1("qun") & "' , '" & sdr1("pthn") & "' , '" & sdr1("test_name") & "' , '" & sdr1("res") & "' , '" & sdr1("res1") & "' , '" & sdr1("res2") & "' , '" & sdr1("so") & "' , '" & sdr1("test_code") & "' , '" & sdr1("test_ar") & "' , '" & sdr1("ref") & "' , '" & sdr1("esl_no") & "' , '" & sdr1("mtest_code") & "' , '" & sdr1("mtest_name") & "' , '" & sdr1("ds") & "' , '" & sdr1("rcv") & "' , '" & sdr1("note") & "' , '" & sdr1("NOTEN") & "' , '" & sdr1("NORB") & "' , '" & sdr1("NORE") & "' , '" & sdr1("q") & "' , '" & sdr1("absu") & "' , '" & sdr1("ref1") & "' , '" & sdr1("p") & "' , '" & sdr1("unit") & "' , '" & sdr1("rso") & "' , '" & sdr1("YEARN") & "' , '" & sdr1("re1") & "' , '" & sdr1("re2") & "' , '" & sdr1("ds1") & "' , '" & sdr1("pth") & "' , '" & sdr1("rsv") & "' , '" & sdr1("rsvp") & "' , '" & sdr1("rsv1") & "' , '" & sdr1("QUN1") & "' , '" & sdr1("RDS") & "' , '" & sdr1("bran") & "' , '" & sdr1("st") & "')"
                cmd.ExecuteNonQuery()
            End While

        End While
        dr.Close()
        sdr1.Close()
        SDR.Close()
        dr.Close()
        sdr1.Close()
        SDR.Close()
        dr1.Close()
        cmd1.CommandText = "select * from lcash   "
        dr1 = cmd1.ExecuteReader
        While dr1.Read
            dr.Close()
            SCMD.CommandText = "INSERT INTO [lcash]([main_name],[main_code],[sub_code],[sub_name],[flg],[cash],[crd],[time1],[date1],[id],[notse],[usr],[shift],[SAVE_NAME],[save_code],branch_code,branch_name,st,PRM) VALUES ( '" & dr1("main_name") & "' , '" & dr1("main_code") & "' , '" & dr1("sub_code") & "' , '" & dr1("sub_name") & "' , '" & dr1("flg") & "' , '" & dr1("cash") & "' , '" & dr1("crd") & "' , '" & dr1("time1") & "' , '" & dr1("date1") & "' , '" & dr1("id") & "' , '" & dr1("notse") & "' , '" & dr1("usr") & "' , '" & dr1("shift") & "'  , '" & dr1("SAVE_NAME") & "' , '" & dr1("save_code") & "','" & dr1("branch_code") & "','" & dr1("branch_name") & "','0','" & dr1("PRM") & "')"
            SCMD.ExecuteNonQuery()
        End While
        rrr.Kill()
    End Sub



    Private Sub GlassButton18_Click_6(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles aasasasasas.Click
        If PORV.Length < 10 Then Exit Sub
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 206 Then Exit Sub
        openonline()
        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lSAVE "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lSAVE "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "insert into lSAVE (CODE,NAME,BRAN)  values ('" & SDR("CODE") & "','" & SDR("NAME") & "','" & SDR("BRAN") & "')"
            cmd.ExecuteNonQuery()
        End While

    End Sub

    Private Sub audsdjhcbczx_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles audsdjhcbczx.Click
        If PORV.Length < 10 Then Exit Sub
        sjhfgfuhbf_Click(sjhfgfuhbf, e)
        updateonline_Click(updateonline, e)
        GlassButton18_Click_6(audsdjhcbczx, e)
        DDDDD_Click(DDDDD, e)
        testonline_Click(testonline, e)
        MsgBox("ITS ALL UPDATE")
        End
    End Sub

    Private Sub qqq2000_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qqq2000.Click
        If ldoc = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, " ﬁ—Ì— ‰”»… «·ÿ»Ì»" & COMPANY_name.Text, 0, bran.Text)
            Exit Sub
        End If
        ComboBox5.Text = "rest"
        'ComboBox5.Text = "ALL"
        f3(0)
    End Sub

    Private Sub qqqqqqq_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles qqqqqqq.Click
        If ldoc = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, " ﬁ—Ì— ‰”»… «·ÿ»Ì»" & COMPANY_name.Text, 0, bran.Text)
            Exit Sub
        End If
        f3(13)

    End Sub

    Private Sub ddddsd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ddddsd.Click
        dr.Close()
        ACdr.Close()
        dr1.Close()

        open_sql()
        open_sql()
        MsgBox("YOU ARE CONNECTED", MsgBoxStyle.Information)
    End Sub


    Private Sub QQQWQQW_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQQWQQW.Click


        dr.Close()
        cmd.CommandText = "update lbill set st=1,final=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill_ESL set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill_test  set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill_testsub set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update LBILL_CULT set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update LBILL_CULT_DET set st=1 where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        GlassButton2_Click_5(qq152, e)
        MsgBox("DATA IS  REONLINE", MsgBoxStyle.Information)

    End Sub

    Private Sub djshdjsds_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        chbook()
        MsgBox(" „  €ÌÌ— ﬂ Ì» «·«”⁄«—")

    End Sub
    Public Sub guser()
        Dim resp As String
        Using client As New Net.WebClient
            Dim reqparm As New Specialized.NameValueCollection
            reqparm.Add("name", pname.Text)
            Dim responsebytes = client.UploadValues("http://misr-labs.ahomran.com/api/users", "POST", reqparm)
            Dim responsebody = (New System.Text.UTF8Encoding).GetString(responsebytes)
            resp = responsebody
        End Using
        wuser.Text = resp.Substring(resp.IndexOf("username", 1) + 11, resp.IndexOf("password", 1) - (resp.IndexOf("username", 1) + 14))
        wpass.Text = resp.Substring(resp.IndexOf("password", 1) + 11, resp.IndexOf("status", 1) - (resp.IndexOf("password", 1) + 15))
        Using client As New Net.WebClient
            Dim reqparm As New Specialized.NameValueCollection
            reqparm.Add("username", wuser.Text)
            reqparm.Add("title", esl_no.Text)
            Dim responsebytes = client.UploadValues("http://misr-labs.ahomran.com/api/analyses", "POST", reqparm)
            Dim responsebody = (New System.Text.UTF8Encoding).GetString(responsebytes)
            resp = responsebody
            wid.Text = resp.Substring(resp.IndexOf("data", 1) + 12, resp.IndexOf("title", 1) - (resp.IndexOf("data", 1) + 14))
        End Using
    End Sub
    Public Sub testpost()
        Using client As New Net.WebClient
            Dim reqparm As New Specialized.NameValueCollection
            reqparm.Add("name", "alhamed llah ")
            reqparm.Add("description", "very perecft desc")
            reqparm.Add("price", "2000")
            reqparm.Add("discount", "10")
            reqparm.Add("stoc", "50")
            client.Headers.Add("Authorization", "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIyIiwianRpIjoiMjlmOWY2M2E5MmNhM2U1OTlmMTg1MmFlMzEwNTU2YTZkNWZkZmY0YzhjOTVmZWUxZjM2NzE4M2I2Mzg2YTQ2NTVlZmZkMTJmMzdmZjQwMTIiLCJpYXQiOjE1OTI2MTI4NTAsIm5iZiI6MTU5MjYxMjg1MCwiZXhwIjoxNjI0MTQ4ODUwLCJzdWIiOiIyIiwic2NvcGVzIjpbXX0.sMJDuaqHflv2qc5o_4L5iL5brJy7rFT28zmndVB8emLFELYFXS9lzfU71pORGBNSYfeginDoe1IuIeZSJ1lOMoHMi9sMfTJENTkskqlUr2fwAoQHzClc5jB0NNr4soant1vCf2jiZvNnQOCBMDlXXMXmAueETexEHIhbQV_3nNEmI7iY7BKxjHgt0rZbGTWS2r-4tvEusIYhl3k_Qnxy9sZRrpvgPt-mGdSaJHI8yUyEiW5l0m4AC20pLpXKQUXRrKskf_34l3RbERwCXWHVofqCh5nLEfpvfIdap-bZ-uXnBDc5S8AUhYnPbepOCgz-VOcYjdxFcMdgRpYE8YEzrL4CVMgYGoTnSeHkf1mNZR-wZLPcoGNeaH1ntBBKulds4Am0_NqyGGKjUFSqTe9u718yl6YWLiWp4n4W588VLOP3KSZ03dVC1ZIuOEAVz5l9qSjkeh6MObCDgr8SvRhXfh4Em_H_JuflUBg5xP2sNW6QIVFu8m5DdBSQK9ETOxf3y-XpNJ0WZbq0ZR7hYPSPsVELTUymheQXt_oyTGmXzW2rAwfa5Uh3KkXxx0OZIo2QeFla79KaMbNiqbDlCM0t8r2jbT2TERc8TM-R3cNAGblRNhTvse7hn8qlbZABPfwX9UB1vUs1qO4fSxWjMatzLYoKhHLh6dM5I7323GcMWy4")
            Dim responsebytes = client.UploadValues("http://127.0.0.1:8000/api/products", "POST", reqparm)
            Dim responsebody = (New System.Text.UTF8Encoding).GetString(responsebytes)
            MsgBox(responsebody)
        End Using
      
    End Sub
    Public Sub chbook()
        dr.Close()
        ACdr.Close()
        ACcmd.CommandText = "update test_price set tot1=0"
        ACcmd.ExecuteNonQuery()
        cmd.CommandText = "select * from lbook_price where   name='" & BOOK_name.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            BOOK_CODE.Text = dr("code")
            ACdr.Close()
            ACcmd.CommandText = "SELECT * FROM TEST_PRICE where qun=1"
            ACdr = ACcmd.ExecuteReader
            If ACdr.HasRows = True Then
                TPRICE()
                ACdr.Close()
                ACcmd.CommandText = "SELECT * FROM TEST_PRICE where tot2=1"
                ACdr = ACcmd.ExecuteReader
                While ACdr.Read
                    TextBox3.Text = ACdr("BAR")
                    GRD()
                End While
                TPRICE()
                fprice(1)

            End If
        End If

    End Sub


    Private Sub aaaaaaa_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles aaaaaaa.Click
        Try
            If CEDIT = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG(" ⁄œÌ· ﬁÌ„… «· ÕÊÌ·", esl_no.Text, "  ⁄œÌ· »Ê‰ «Ì’«· " & pname.Text, 0, bran.Text)
                Exit Sub
            End If
            dr.Close()
            Dim XLOG As String = " «·«”„ " & pname.Text & "-" & " «·”‰ " & page.Text & "-" & " «· ·Ì›Ê‰ " & pmobile.Text & "-" & " «·ÿ»Ì» " & REG_name.Text & COMPANY_name.Text & "-" & " «·‘—ﬂ… " & "-" & "«·„œ›Ê⁄ " & PAY.Text & "-" & " «·Œ’„ " & DISS.Text & "-" & qqq5.Text
            LLOG(" ⁄œÌ· “Ì«—…", esl_no.Text, XLOG, 1, bran.Text)
            dr.Close()
            cmd.CommandText = "SELECT sum(tot) FROM lbill_esl  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            PAY.Text = nulls(dr(0))
            dr.Close()
            Dim n As String = MsgBox("Â·  —Ìœ  ⁄œÌ· «·»Ê‰ " & Environment.NewLine, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
            cmd.CommandText = "update lbill set  BON='" & Val(bon.Text) & "' ,rest='" & Val(REST.Text) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
            'MsgBox(" „  ⁄œÌ· ", MsgBoxStyle.Information)
            fesl(0, 0)

        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub sjhfgfuhbf_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles sjhfgfuhbf.Click
        If PORV.Length < 10 Then Exit Sub
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 206 Then Exit Sub
        openonline()


        SDR.Close()
        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from LGTEST  "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from LGTEST "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "INSERT INTO LGTEST ([CODE],[NAME],[AR],[st]) VALUES ('" & SDR("CODE") & "','" & SDR("NAME") & "','" & SDR("AR") & "','0') "
            cmd.ExecuteNonQuery()
        End While
        SDR.Close()
        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from LGr  "
        cmd.ExecuteNonQuery()

        SCMD.CommandText = "select * from LGr "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "INSERT INTO LGr ([CODE],[NAME],[st],gso,color) VALUES ('" & SDR("CODE") & "','" & SDR("NAME") & "','0','" & SDR("gso") & "','" & SDR("color") & "') "
            cmd.ExecuteNonQuery()
        End While
        SDR.Close()
        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from lgroup  "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lgroup "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "INSERT INTO lgroup ([CODE],[NAME],[st],gso,color) VALUES ('" & SDR("CODE") & "','" & SDR("NAME") & "','0','" & SDR("gso") & "','" & SDR("color") & "') "
            cmd.ExecuteNonQuery()
        End While
        SDR.Close()
        dr.Close()
        SDR.Close()
        dr.Close()
        cmd.CommandText = "delete  from lgroup_price  "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lgroup_price "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "INSERT INTO lgroup_price([gname],[gcode],[book_price_code],[book_price_name],[tot],[st]) VALUES ('" & SDR("gname") & "','" & SDR("gcode") & "','" & SDR("book_price_code") & "','" & SDR("book_price_name") & "','" & SDR("tot") & "','0')  "
            cmd.ExecuteNonQuery()
        End While
        SDR.Close()
        dr.Close()
        SDR.Close()
        dr.Close()
        cmd.CommandText = "delete  from lgroup_test "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from lgroup_test "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "INSERT INTO lgroup_test ([gname],[gcode],[test_name],[test_code],[st]) VALUES('" & SDR("gname") & "','" & SDR("gcode") & "','" & SDR("test_name") & "','" & SDR("test_code") & "','" & SDR("st") & "')"
            cmd.ExecuteNonQuery()
        End While
        fprice1(1)
    End Sub

    Private Sub testonline_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles testonline.Click
        If PORV.Length < 10 Then Exit Sub
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 206 Then Exit Sub
        openonline()

        SDR.Close()
        dr.Close()
        SDR.Close()
        SDR.Close()
        sdr1.Close()
        cmd.CommandText = "delete  from ltest_price "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from ltest_price "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = " INSERT INTO [ltest_price]([TEST_CODE],[TEST_NAME],[tot],[AR],[book_price_code],[book_price_name],[so],[st],p1,p2,p3,p4) VALUES ( '" & SDR("TEST_CODE") & "','" & SDR("TEST_NAME") & "','" & SDR("tot") & "','" & SDR("AR") & "','" & SDR("book_price_code") & "','" & SDR("book_price_name") & "','" & SDR("so") & "','0','" & SDR("p1") & "','" & SDR("p2") & "','" & SDR("p3") & "','" & SDR("p4") & "')"
            cmd.ExecuteNonQuery()
        End While
        SDR.Close()
        dr.Close()
        SDR.Close()
        SDR.Close()
        'sdr1.Close()

        fprice1(1)
        MsgBox("ALL DATA IS UPTO DATE THANKS " & USR, MsgBoxStyle.Information)
    End Sub

    Private Sub testreq_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles testreq.Click
        If PORV.Length < 10 Then Exit Sub
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 206 Then Exit Sub
        Dim nali As Integer = 0
        openonline()

        SDR.Close()
        sdr1.Close()
        dr.Close()
        SDR.Close()
        sdr1.Close()
        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from iface "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from iface "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "INSERT INTO iface (Name, EN, AR, FRN, MN, Hide, flg, Size, prg, PACK, sorting) VALUES ('" & SDR("Name") & "','" & SDR("EN") & "','" & SDR("AR") & "','" & SDR("FRN") & "','" & SDR("MN") & "','" & SDR("Hide") & "','" & SDR("flg") & "','" & SDR("Size") & "','" & SDR("prg") & "','" & SDR("PACK") & "','" & SDR("sorting") & "')"
            cmd.ExecuteNonQuery()
        End While

    End Sub

    Private Sub ErrorToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub eeeeer_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles eeeeer.Click
        Dim ss As String = " "
        dr.Close() : cmd.Connection = CN
        cmd.CommandText = "select * from ERLOGE WHere  edate between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' "
        ader.SelectCommand = cmd
        ader.Fill(DBS, "er")
        er = DBS.Tables("er")
        DBS.Tables("er").Clear()
        ader.Fill(DBS, "er")
        er = DBS.Tables("er")
        F31D.DataSource = er
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\error.rpt")
        oj.Database.Tables(0).SetDataSource(DBS.Tables("er"))
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        'rp.Show()
        IO.Directory.CreateDirectory(Application.StartupPath & "\ASIL")
        oj.ExportToDisk(CrystalDecisions.[Shared].ExportFormatType.PortableDocFormat, Application.StartupPath & "\ASIL\error.pdf")
        ACdr.Close()
        ACcmd.CommandText = "delete * from email "
        ACcmd.ExecuteNonQuery()
        ACdr.Close()
        ACcmd.CommandText = "insert into email(name) values ('\ASIL\error.pdf')"
        ACcmd.ExecuteNonQuery()
        semail("asiliteg@gmail.com", branch_name.Text, " report date " & Now, 1, 0)
        MessageBox.Show(" success send  to ", "  Successful?", MessageBoxButtons.OK, MessageBoxIcon.Information)
    End Sub

    Private Sub WWWWWWWW_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles WWWWWWWW.Click
        tquery.Show()
        tquery.TextBox3.DataSource = gen
        tquery.TextBox3.DisplayMember = "name1"
    End Sub

    Private Sub GlassButton4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DDD1.Click
        dr1.Close()
        cmd1.CommandText = "select * from lbill_ESL where  ESL_NO='" & Val(esl_no.Text) & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        dr1 = cmd1.ExecuteReader
        If dr1.HasRows Then
            Dim SAS As Date
            Dim xxaa As String = "«·„»«·€ «· Ï œ›⁄Â« «·„—Ì÷"
            xxaa = xxaa & Environment.NewLine
            While dr1.Read
                If IsDBNull(dr1("SDATE")) = False Then SAS = dr1("SDATE") Else SAS = esl_date.Value
                xxaa = xxaa & Environment.NewLine & SAS.ToString("d-M-yyyy") & " ------>  " & dr1("TOT") & "------>" & dr1("usr")
            End While
            dr1.Close()
            cmd1.CommandText = "select * from lbill where  ESL_NO='" & Val(esl_no.Text) & "' and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            xxaa = xxaa & Environment.NewLine & "user name add" & " ------>  " & dr1("usr")
            MsgBox(xxaa, MsgBoxStyle.Information)
        End If
    End Sub

    Private Sub GlassButton18_Click_7(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ddd2.Click
        creg_code.Checked = True
        ComboBox5.Text = "rest"
        f3(7)
        creg_code.Checked = False


    End Sub

    Private Sub GlassButton4_Click_5(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ddd3.Click
        ComboBox5.Text = "rest"
        cCOMPANY_CODE.Checked = True
        f3(6)
        cCOMPANY_CODE.Checked = False
    End Sub

    Private Sub ddd10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ddd10.Click
        Dim N As String
        N = ""
        If msga = 1 Then
            If lng = "AR" Then N = MsgBox(SAVEAR, MsgBoxStyle.YesNo) Else N = MsgBox(SAVEEN, MsgBoxStyle.YesNo)
            If N = vbNo Then Exit Sub
        End If
        dr.Close()
        cmd.CommandText = "select * from ltype where NAME='" & PNIK.Text & "'"
        dr = cmd.ExecuteReader
        If dr.HasRows = False Then
            dr.Close() : cmd.CommandText = "insert into ltype  (sNAME,name)  values ('" & Trim(PNIK.Text) & "','" & Trim(ptype.Text) & "')"
            cmd.ExecuteNonQuery()
            PNIK.Items.Add(PNIK.Text)
            If msga = 1 Then
                Me.Text = "it's saved"
            End If
            LLOG("Õ›Ÿ ÃœÌœ", 0, "Õ›Ÿ ·ﬁ» ÃœÌœ", 1, bran.Text)
        End If
    End Sub

    Private Sub ddd11_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ddd11.Click
        Dim N As String
        N = ""
        If msga = 1 Then
            If lng = "AR" Then N = MsgBox(DELAR, MsgBoxStyle.YesNo) Else N = MsgBox(DELEN, MsgBoxStyle.YesNo)
            If N = vbNo Then Exit Sub
        End If
        dr.Close()
        cmd.CommandText = "delete  from ltype where NAME='" & PNIK.Text & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub ddd13_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ddd13.Click
        ACdr.Close()
        ACcmd.CommandText = "select * from srv"
        ACdr = ACcmd.ExecuteReader
        ACdr.Read()
        If accnlis.State = ConnectionState.Closed Then
            accnlis.ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & ACdr("spath") & ";Persist Security Info=False"
            accnlis.Open()
        End If

        Dim aa As String
        aa = InputBox("«œŒ· —ﬁ„ «·«Ì’«· ø")
        ACcmdlis.Connection = accnlis
        ACcmdlis.CommandType = CommandType.Text
        ACcmdlis.CommandText = "select * from Results where SampleNo=" & aa
        acdrlis = ACcmdlis.ExecuteReader
        acdrlis.Read()
        dr.Close()
        FRC = testres.Select("test_code='228'")
        If FRC.Length > 0 Then
            LISUPDATE("WBC", "705", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("RBC", "694", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("HGB", "693", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("HCT", "695", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("MCV", "698", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("MCH", "699", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("MCHC", "700", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("PLT", "701", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("LYM%", "711", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("MXD%", "712", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("NEUT%", "708", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("RDW-SD", "697", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("RDW-CV", "696", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("PDW", "704", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("MPV", "702", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("P-LCR", "702", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("MPV", "702", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            LISUPDATE("P-LCR", "703", "LBILL_TESTSUB", " AND MTEST_CODE='228'")
            Dim ntr As Double = acdrlis("NEUT%")
            Dim nWBC As Double = acdrlis("WBC")
            cmd.CommandText = "update LBILL_TESTSUB set res='" & Math.Round(ntr * 0.03, 1) & "'  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='707' AND MTEST_CODE='228'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update LBILL_TESTSUB set res='" & Math.Round(ntr * 0.06, 1) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='709' AND MTEST_CODE='228'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update LBILL_TESTSUB set res='" & ntr - (Math.Round(ntr * 0.03, 1) + Math.Round(ntr * 0.06, 1)) & "'  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='710' AND MTEST_CODE='228'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update LBILL_TESTSUB set res='" & ntr - Math.Round(ntr * 0.03, 1) & "'  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='708' AND MTEST_CODE='228'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update LBILL_TESTSUB set res='0'  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='706' AND MTEST_CODE='228'"
            cmd.ExecuteNonQuery()
            LISIM(1, acdrlis("txtWBC"), 228)
            LISIM(2, acdrlis("txtRBC"), 228)
            LISIM(3, acdrlis("txtPLT"), 228)
            lisa(nWBC, "LBILL_TESTSUB", " AND MTEST_CODE='228' ")
            acdrlis.Close()
            Exit Sub
        End If
        FRC = testres.Select("test_code='375'")
        If FRC.Length > 0 Then
            LISUPDATE("HGB", "375", "LBILL_TEST", "")
            LISUPDATE("RBC", "666", "LBILL_TEST", "")
            LISUPDATE("HCT", "667", "LBILL_TEST", "")
            LISUPDATE("RDW-CV", "668", "LBILL_TEST", "")
            LISUPDATE("RDW-SD", "669", "LBILL_TEST", "")
            LISUPDATE("MCV", "670", "LBILL_TEST", "")
            LISUPDATE("MCH", "671", "LBILL_TEST", "")
            LISUPDATE("MCHC", "672", "LBILL_TEST", "")
            LISIM(1, acdrlis("txtRBC"), 375)

            acdrlis.Close()
        End If
        FRC = testres.Select("test_code='483'")
        If FRC.Length > 0 Then
            LISUPDATE("PLT", "483", "LBILL_TEST", "")
            LISUPDATE("MPV", "673", "LBILL_TESt", "")
            LISUPDATE("P-LCR", "674", "LBILL_TEST", "")
            LISUPDATE("PDW", "675", "LBILL_TEST", "")
            LISIM(1, acdrlis("txtPLT"), 483)
            acdrlis.Close()
        End If
        FRC = testres.Select("test_code='676'")
        If FRC.Length > 0 Then
            LISUPDATE("WBC", "676", "LBILL_TEST", " ")
            LISUPDATE("NEUT%", "679", "LBILL_TEST", "")
            LISUPDATE("LYM%", "682", "LBILL_TEST", "")
            LISUPDATE("MXD%", "683", "LBILL_TEST", "")
            Dim ntr As Double = acdrlis("NEUT%")
            Dim nWBC As Double = acdrlis("WBC")
            cmd.CommandText = "update LBILL_TEST set res='" & Math.Round(ntr * 0.03, 1) & "'  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='678' "
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update LBILL_TEST set res='" & Math.Round(ntr * 0.06, 1) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='680' "
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update LBILL_TEST set res='" & ntr - (Math.Round(ntr * 0.03, 1) + Math.Round(ntr * 0.06, 1)) & "'  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='681'"
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update LBILL_TEST set res='" & ntr - Math.Round(ntr * 0.03, 1) & "'  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='679' "
            cmd.ExecuteNonQuery()
            cmd.CommandText = "update LBILL_TEST set res='0'  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='677'"
            cmd.ExecuteNonQuery()
            lisa(nWBC, "LBILL_TEST", "")
            LISIM(1, acdrlis("txtWBC"), 676)
            dr.Close()
            dr1.Close()
            cmd.CommandText = "select * from  lbill_test   WHERE  ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            dr = cmd.ExecuteReader
            While dr.Read
                dr1.Close()
                cmd1.CommandText = "select * from lnstest where type='" & ptype.Text & "' and ageb<='" & page.Text & "' and  agee>='" & page.Text & "' and  test_name='" & dr("test_name") & "' and year='" & PYEAR.Text & "' "
                dr1 = cmd1.ExecuteReader
                dr1.Read()
                If dr1.HasRows Then
                    Dim S As String = 0
                    If IsDBNull(dr1("ref1")) = False Then
                        S = dr1("ref1")

                    End If
                    dr1.Close()
                    cmd1.CommandText = "UPDATE lbill_test SET  ref1='" & S & "'  WHERE test_name='" & dr("test_name") & "' and  ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
                    cmd1.ExecuteNonQuery()
                End If
            End While
            acdrlis.Close()
        End If
    End Sub
    Public Sub lisa(ByVal nWBC As Double, ByVal tb As String, ByVal tcode As String)
        dr.Close()
        dr1.Close()
        cmd.CommandText = "select * from " & tb & " where  ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        dr = cmd.ExecuteReader
        While dr.Read
            If IsNumeric(dr("res")) = True Then
                cmd1.CommandText = "update " & tb & " set absu='" & dr("res") * nWBC * 10 & "' where   ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & dr("test_code") & "' " & tcode
                cmd1.ExecuteNonQuery()
            End If
        End While
    End Sub
    Public Sub LISIM(ByVal NUMS As Integer, ByVal ST As String, ByVal tcode As Integer)
        t = Now.DayOfYear & Now.Hour & Now.Minute & Now.Second & Now.Millisecond
        Dim bytes() As Byte = Convert.FromBase64String(ST)
        Dim MS As New System.IO.MemoryStream(bytes)
        Dim bmp As Image = Image.FromStream(MS)
        imlis.Image = bmp
        imlis.Image.Save("C:\IM" & t & ".jpg")
        Dim oer As System.IO.FileStream
        Dim rer As IO.StreamReader
        oer = New IO.FileStream("C:\IM" & t & ".jpg", IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
        rer = New IO.StreamReader(oer)
        Dim FileByteArrayr(oer.Length - 1) As Byte
        oer.Read(FileByteArrayr, 0, oer.Length)
        dr.Close()
        dr.Close()
        Dim Sql As String = "update  lbill_test set IM" & NUMS & " = ? , IMN" & NUMS & " = ? where  ESL_NO='" & Val(esl_no.Text) & "' AND test_CODE='" & tcode & "' and yearn='" & YEARN.Text & "' and bran='" & bran.Text & "'"
        cmd.CommandText = Sql
        cmd.Parameters.Clear()
        cmd.Parameters.Add("@IM" & NUMS, System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
        cmd.Parameters.Add("@IMN" & NUMS, System.Data.OleDb.OleDbType.VarChar, 100).Value = oer.Length
        cmd.ExecuteNonQuery()
    End Sub
    Public Sub picf(ByVal sqlt As String)
        t = Now.DayOfYear & Now.Hour & Now.Minute & Now.Second & Now.Millisecond
        picup.Image.Save("C:\IM" & t & ".jpg")
        Dim oer As System.IO.FileStream
        Dim rer As IO.StreamReader
        oer = New IO.FileStream("C:\IM" & t & ".jpg", IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
        rer = New IO.StreamReader(oer)
        Dim FileByteArrayr(oer.Length - 1) As Byte
        oer.Read(FileByteArrayr, 0, oer.Length)
        dr.Close()
        dr.Close()
        Dim Sql As String = sqlt
        cmd.CommandText = Sql
        cmd.Parameters.Clear()
        cmd.Parameters.Add("@IM", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
        cmd.ExecuteNonQuery()
    End Sub
    Public Sub LISUPDATE(ByVal ST1 As String, ByVal ST2 As String, ByVal tb As String, ByVal y As String)
        cmd.CommandText = "update " & tb & " set res='" & acdrlis(ST1) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " AND TEST_CODE='" & ST2 & "'" & y
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub GlassButton4_Click_6(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles aassssdd.Click
        Dim SourceDirectory As String = "d:\image\"
        Dim LatestFile As IO.FileInfo = Nothing
        Dim ss As String = ""
        Dim DirInfo As New IO.DirectoryInfo(SourceDirectory)
        For Each file As IO.FileInfo In DirInfo.GetFiles()
            If LatestFile Is Nothing Then
                LatestFile = file
            ElseIf file.CreationTime > LatestFile.CreationTime Then
                LatestFile = file
                ss = SourceDirectory & file.FullName
            End If
        Next
        MsgBox(ss)

    End Sub

    Private Sub asd124_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asd124.Click
        On Error Resume Next
        Dim SourceDirectory As String = "d:\image\"
        Dim LatestFile As IO.FileInfo = Nothing
        Dim ss As String = ""
        Dim DirInfo As New IO.DirectoryInfo(SourceDirectory)
        For Each file As IO.FileInfo In DirInfo.GetFiles()
            If LatestFile Is Nothing Then
                LatestFile = file
            ElseIf file.CreationTime > LatestFile.CreationTime Then
                LatestFile = file
                ss = file.FullName
            End If
        Next
        gpic.Visible = Not gpic.Visible
        picup.ImageLocation = ss
    End Sub

    Private Sub asd122_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asd122.Click
        gpic.Visible = Not gpic.Visible
    End Sub

    Private Sub asd123_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asd123.Click
        If Ntest_CODE.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— «· Õ·Ì·") : Exit Sub
        If esl_no.Text = "" Then MsgBox("«·—Ã«¡ «Œ Ì«— «·“Ì«—…") : Exit Sub
        If RadioButton6.Checked = True Then picf("update  lbill_test set IMAGE1= ?,TIMAGEN=1, IMAGEN1='" & pictext.Text & "' where  ESL_NO='" & Val(esl_no.Text) & "' AND test_CODE='" & Ntest_CODE.Text & "' and yearn='" & YEARN.Text & "' and bran='" & bran.Text & "'")
        If RadioButton5.Checked = True Then picf("update  lbill_test set IMAGE2= ?,TIMAGEN=1, IMAGEN2='" & pictext.Text & "' where  ESL_NO='" & Val(esl_no.Text) & "' AND test_CODE='" & Ntest_CODE.Text & "' and yearn='" & YEARN.Text & "' and bran='" & bran.Text & "'")
        If RadioButton4.Checked = True Then picf("update  lbill_test set IMAGE3= ?,TIMAGEN=1, IMAGEN3='" & pictext.Text & "' where  ESL_NO='" & Val(esl_no.Text) & "' AND test_CODE='" & Ntest_CODE.Text & "' and yearn='" & YEARN.Text & "' and bran='" & bran.Text & "'")
        MsgBox("SAVE IMAGE >>>>>>" & pictext.Text)
    End Sub

    Private Sub asd125_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asd125.Click
        Dim SourceDirectory As String = "d:\image\"
        Dim LatestFile As IO.FileInfo = Nothing
        Dim ss As String = ""
        Dim DirInfo As New IO.DirectoryInfo(SourceDirectory)
        For Each file As IO.FileInfo In DirInfo.GetFiles()
            If LatestFile Is Nothing Then
                LatestFile = file
            ElseIf file.CreationTime > LatestFile.CreationTime Then
                LatestFile = file
                ss = file.FullName
            End If
        Next
        picup.ImageLocation = ss
    End Sub

    Private Sub FINDToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FINDToolStripMenuItem1.Click

        fufind()

    End Sub
    Public Sub fufind()
        On Error Resume Next
        yy = ""
        If CBRAN.Checked = True Then yy = "AND BRAN='" & bran.Text & "' "
        dr.Close() : cmd.Connection = CN
        If FFIND = UCase("PNAME") Then
            cmd.CommandText = "select * from lbill WHere " & FFIND & " like'%" & FFINDT & "%'  order by esl_date desc"
        Else
            cmd.CommandText = "select * from lbill WHere " & FFIND & " like'%" & FFINDT & "%' and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' " & yy & " order by esl_date desc"
        End If
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()

        If F31.Rows.Count = 1 Then esl_no.Text = F31.Rows(0).Item("esl_no") : fesl(1, 0)
        fnor(3)
        MsgBox(F31.Rows.Count)
    End Sub
    Private Sub pgover_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pgover.SelectedIndexChanged

    End Sub

    Private Sub SendEmailToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SendEmailToolStripMenuItem1.Click
        emlprg = 1
        dr.Close()
        cmd.CommandText = "UPDATE LPATIEN SET PEMAIL='" & pemail.Text & "' WHERE PCODE='" & pcode.Text & "'"
        cmd.ExecuteNonQuery()
        FEMAIL()
    End Sub

    Private Sub FindPatientToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FindPatientToolStripMenuItem.Click

        On Error Resume Next
        pname.Text = pname.Text.Replace("Ï", "%")
        pname.Text = pname.Text.Replace("Ì", "%")
        pname.Text = pname.Text.Replace("√", "%")
        pname.Text = pname.Text.Replace("«", "%")
        pname.Text = pname.Text.Replace("Â", "%")
        pname.Text = pname.Text.Replace("·¬", "%")
        pname.Text = pname.Text.Replace("…", "%")
        pname.Text = pname.Text.Replace(" ", "%")
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandText = "select * from lbill where pname like'%" & pname.Text & "%'  order by esl_date desc"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì—" & pname.Text, 0, bran.Text)
        If F31.Rows.Count = 1 Then esl_no.Text = F31.Rows(0).Item("esl_no") : fesl(1, 0)
        fnor(3)

    End Sub

    Private Sub GlassButton4_Click_7(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asd23.Click
        If lmach = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, " ﬁ—Ì— «·ÃÂ«“", 0, bran.Text)
            Exit Sub
        End If
        Dim m As Integer = 0
        dr.Close()
        cmd.CommandText = "select max(code) from  lmachine "
        dr = cmd.ExecuteReader
        dr.Read()
        m = nulls(dr(0)) + 1
        dr.Close()
        cmd.CommandText = "insert into lmachine (code,name)  values ('" & m & " ','" & Trim(mach_name.Text) & "')"
        cmd.ExecuteNonQuery()
        mach_code.Text = m
        dr.Close()
        cmd.CommandText = " SELECT * FROM lmachine_test WHERE NAME='" & LAB.Text & "'"
        dr = cmd.ExecuteReader
        dr.Read()
        If dr.HasRows = True Then
            Dim X As String = ""
            X = MsgBox("Â·  —Ìœ «· ⁄œÌ·ø", MsgBoxStyle.YesNo)
            If X = vbNo Then Exit Sub
            dr.Close()
            cmd.CommandText = " DELETE FROM lmachine_test WHERE NAME='" & mach_name.Text & "'"
            cmd.ExecuteNonQuery()
        End If
        ACdr.Close()
        ACcmd.CommandText = "SELECT * FROM TEST_PRICE WHERE qun>0 "
        ACdr = ACcmd.ExecuteReader
        If ACdr.HasRows = False Then Me.Text = "«·—Ã«¡ «Œ Ì«—  Õ·Ì· Ê«Õœ ⁄·Ï «·«ﬁ·" : Exit Sub
        dr.Close()
        While ACdr.Read
            cmd.CommandText = "INSERT INTO [lmachine_test]([test_code],[test_name],NAME,CODE) VALUES ('" & ACdr("test_code") & "' ,'" & ACdr("test_name") & "' ,'" & mach_name.Text & "' ,'" & mach_code.Text & "' )"
            cmd.ExecuteNonQuery()
        End While
        LLOG("⁄—÷", 0, " ﬁ—Ì—  Õ«·Ì· «·ÃÂ«“", 1, bran.Text)
        mach_name.Items.Add(mach_name.Text)
    End Sub

    Private Sub asd24_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asd24.Click
        If mach_name.Text = "" Then Me.Text = "«Œ «— «·„Ã„Ê⁄…" : Exit Sub
        Dim N As String
        N = MsgBox("Â·  —Ìœ Õ–›ø" & " " & mach_name.Text, MsgBoxStyle.YesNo)
        If N = vbNo Then Exit Sub
        dr.Close()
        dr.Close()
        cmd.CommandText = "delete from lmachine  WHERE  NAME='" & mach_name.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from lmachine_test  WHERE  NAME='" & mach_name.Text & "'"
        cmd.ExecuteNonQuery()
        dr1.Close()
        LLOG("Õ–›", 0, "«·„Ã„Ê⁄… " & mach_name.Text, 1, bran.Text)
        group_name.Items.Remove(mach_name.Text)
        If lng = "AR" Then MsgBox(DELAR) Else MsgBox(DELEN)

    End Sub

    Private Sub asd25_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asd25.Click

    End Sub

    Private Sub SDAY_MouseDown(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles SDAY.MouseDown

    End Sub

    Private Sub DateTimePicker1_ValueChanged_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SDAY.ValueChanged
        dr.Close()
        cmd.CommandText = "select * from lbill WHere  esl_date ='" & ChangeFormat(SDAY.Value) & "'ORDER BY ESL_NO DESC "
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()
        If lng = "AR" Then F31D.Columns("company_name").HeaderText = "ref doc" Else F31D.Columns("company_name").HeaderText = "ref doc"
    End Sub

    Private Sub GlassButton7_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs)
        ACdr.Close()
        ACcmd.CommandText = "select * from test"
        ACdr = ACcmd.ExecuteReader
        While ACdr.Read
            Ntest_NAME.Text = ACdr("test_name")
            price1.Text = ACdr("price")
            shrt.Text = ACdr("test_name")
            dr.Close() : cmd.CommandText = "select MAx(test_code),MAX(SO) from LTEST "
            dr = cmd.ExecuteReader
            dr.Read()
            Ntest_CODE.Text = 1 + nulls(dr(0))
            dr1.Close()
            cmd1.CommandText = "select * from lbook_price where code='2'"
            dr1 = cmd1.ExecuteReader
            dr1.Read()
            dr.Close() : cmd.CommandText = "insert into LTEST (ResultAfter,test_code,test_name,Gcode,Gname,CULT,[KID_TYPE],short,gr_name,gr_code,lab,sub)  values ('" & ResultAfter.Text & "','" & Ntest_CODE.Text & "','" & Trim(Ntest_NAME.Text) & "','" & gro_code.Text & "','" & smain.Text & "','" & Val(cult.CheckState) & "','" & KID_TYPE.Text & "','" & Trim(shrt.Text) & " ','" & GRNAME.Text & "','" & gr_code.Text & "','" & Val(lab2.CheckState) & "','" & Val(sub2.CheckState) & "')"
            cmd.ExecuteNonQuery()
            dr.Close() : cmd.CommandText = "insert into ltest_price (test_code,test_name,[book_price_code],[book_price_name],tot,ar)  values ('" & Ntest_CODE.Text & "','" & Trim(Ntest_NAME.Text) & "','1','ﬂ Ì» «”⁄«— «·„⁄„·','" & Val(price1.Text) & "','')"
            cmd.ExecuteNonQuery()
            If scan1 = 10 Then
                dr.Close() : cmd.CommandText = "insert into ltest_price (test_code,test_name,[book_price_code],[book_price_name],tot,ar)  values ('" & Ntest_CODE.Text & "','" & Trim(Ntest_NAME.Text) & "','2','" & dr1("name") & "','" & Val(prc2.Text) & "','')"
                cmd.ExecuteNonQuery()
            End If
        End While



    End Sub

    Private Sub apass_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles apass.Click
        testpost()

    End Sub

    Private Sub ASD131_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ASD131.Click
        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandText = "select * from lbill where WEB=0 AND REST=0 AND WUSER<>'0' "
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31

        Dim x As Integer = 0
        While Not x = F31.Rows.Count
            RC = F31.Rows(x)
            YEARN.Text = RC("YEARN")
            bran.Text = RC("bran")
            esl_no.Text = RC("esl_no")
            x = x + 1
        End While

        PDFM()
        FileSystem.Rename(SourceDirectory & REG_name.Text & "  " & pname.Text & ".PDF", SourceDirectory & wid.Text & ".PDF")
        Using client As New Net.WebClient
            Dim reqparm As New Specialized.NameValueCollection
            Dim responsebytes = client.UploadFile("http://misr-labs.ahomran.com/api/analyses/add-file", "POST", SourceDirectory & wid.Text & ".PDF")
            Dim responsebody = (New System.Text.UTF8Encoding).GetString(responsebytes)
        End Using

    End Sub

    Private Sub NDOC_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles NDOC.GotFocus
        flng("AR")
        FFIND = "NDOC"
        FFINDT = NDOC.Text
    End Sub

    Private Sub NDOC_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles NDOC.KeyUp
        If e.KeyCode = Keys.F6 Then
            fufind()
        End If
    End Sub

    Private Sub TextBox13_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NDOC.TextChanged

    End Sub

    Private Sub BANK_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BANK.TextChanged
        FUND()
    End Sub

    Private Sub CCNDOC_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CCNDOC.Click
        ComboBox5.Text = "all"
        CNDOC.Checked = True
        f3(14)
        CNDOC.Checked = False
    End Sub

    Private Sub TODAYToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TODAYToolStripMenuItem.Click
        dr.Close()
        cmd.CommandText = "select * from lbill WHere  esl_date ='" & ChangeFormat(Now) & "'ORDER BY ESL_NO DESC "
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()
        If lng = "AR" Then F31D.Columns("company_name").HeaderText = "ref doc" Else F31D.Columns("company_name").HeaderText = "ref doc"

    End Sub

    Private Sub BANKB_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Try
            If CEDIT = 0 Then
                If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
                LLOG(" ⁄œÌ· ﬁÌ„… «· ÕÊÌ·", esl_no.Text, "  ⁄œÌ· »Ê‰ «Ì’«· " & pname.Text, 0, bran.Text)
                Exit Sub
            End If
            dr.Close()
            Dim XLOG As String = " «·«”„ " & pname.Text & "-" & " «·”‰ " & page.Text & "-" & " «· ·Ì›Ê‰ " & pmobile.Text & "-" & " «·ÿ»Ì» " & REG_name.Text & COMPANY_name.Text & "-" & " «·‘—ﬂ… " & "-" & "«·„œ›Ê⁄ " & PAY.Text & "-" & " «·Œ’„ " & DISS.Text & "-" & qqq5.Text

            LLOG(" ⁄œÌ· “Ì«—…", esl_no.Text, XLOG, 1, bran.Text)

            dr.Close()
            cmd.CommandText = "SELECT sum(tot) FROM lbill_esl  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            PAY.Text = nulls(dr(0))
            dr.Close()
            Dim n As String = MsgBox("Â·  —Ìœ  ⁄œÌ· „»·€ «·»‰ﬂ ø " & Environment.NewLine, MsgBoxStyle.YesNo)
            If n = vbNo Then Exit Sub
            cmd.CommandText = "update lbill set  BANK='" & Val(BANK.Text) & "' ,rest='" & Val(REST.Text) & "' where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            cmd.ExecuteNonQuery()
            'MsgBox(" „  ⁄œÌ· ", MsgBoxStyle.Information)
            fesl(0, 0)

        Catch ex As Exception
            Dim st1 As String = sender.ToString.Replace("'", "-")
            Dim st As String = ex.Message
            st = st.Replace("'", "-")
            dr.Close()
            cmd.CommandText = "INSERT INTO [ERLOGE] ([EMSG],[ENUM],[ESENDER],[ETIME],[EDATE],[LNAME],[LBRANCH],[LBRAN]) VALUES ('" & st & "','" & st & "','" & st1 & "','" & ChangeFormatall(Now) & "','" & ChangeFormat(Now) & "','" & branch_name.Text & "','" & branch_name.Text & "','" & bran.Text & "')"
            cmd.ExecuteNonQuery()
            MsgBox(st) : If ex.Message = "Load report failed." Then End
        End Try
    End Sub

    Private Sub msgx_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles msgx.Click

    End Sub

    Private Sub GlassButton4_Click_8(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles nnq1.Click
        ptha()

    End Sub

    Private Sub nnq2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles nnq2.Click
        testg()
    End Sub

    Private Sub NNQ4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ4.Click
        TESTREVN()
    End Sub

    Private Sub NNQ3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ3.Click
        TESTREVNG()
    End Sub

    Private Sub NUMBERToolStripMenuItem2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

    Private Sub NQQ6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NQQ6.Click
        dayrevng()
    End Sub

    Private Sub NNQ5_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ5.Click

    End Sub

    Private Sub nnq7_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles nnq7.Click
        ftblg()
    End Sub

    Private Sub nnq8_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles nnq8.Click
        dr1.Close()
        cmd1.CommandText = "update lbill set tblg=1"
        cmd1.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "select esl_no from v_lab where tblg=0   group by esl_no"
        dr = cmd.ExecuteReader
        dr1.Close()
        While dr.Read
            cmd1.CommandText = "update lbill set tblg=0 where esl_no='" & dr("esl_no") & "'"
            cmd1.ExecuteNonQuery()
        End While
        dr.Close() : cmd.CommandText = "SELECT COMPANY_NAME FROM LBILL WHERE TBLG=0 group by COMPANY_NAME"
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 15
    End Sub

    Private Sub nnq10_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles nnq10.Click
        dr.Close()
        dr.Close() : cmd.CommandText = "select * FROM srh "
        ada.SelectCommand = cmd
        ada.Fill(DBS, "a")
        a = DBS.Tables("a")
        DBS.Tables("a").Clear()
        ada.Fill(DBS, "a")
        a = DBS.Tables("a")
        ACdr.Close() : ACcmd.CommandText = "select sr,name,srh,sno,code,ky FROM company order by sr"
        adcomp.SelectCommand = ACcmd
        adcomp.Fill(DBS, "comp")
        comp = DBS.Tables("comp")
        DBS.Tables("comp").Clear()
        adcomp.Fill(DBS, "comp")
        Dim M As Integer
        Dim YY As String = ""
        M = 0

        a.Rows.Clear()
        Dim ii As Integer = 0
        Dim ss As Integer = 0
        Dim i As Integer = 0
        Dim aa As Int16 = 0
        Dim o As Integer
        While Not i = BILL.Rows.Count
            ss = 0
            ii = 0
            aa = 0
            o = 0

            While Not ii = comp.Rows.Count
                If comp.Rows(ii).Item("srh") = 1 Then
                    ss = 0
                    dr.Close()
                    dr.Close() : cmd.CommandText = "sELECT  sum(test_price) from v_lab WHERE test_name='" & BILL.Rows(i).Item("test_name") & "'  and company_code='" & comp.Rows(ii).Item("code") & "'and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' "
                    dr = cmd.ExecuteReader
                    dr.Read()
                    ss = ss + nulls(dr(0))
                    '===================================================================
mk:
                    dr.Close()
                    If aa = 0 Then
                        RC = a.NewRow
                        RC("h1") = comp.Rows(ii).Item("name")
                        RC("hn1") = ss
                        RC("hn2") = 0
                        RC("hn3") = 0
                        RC("hn4") = 0
                        RC("hn5") = 0
                        RC("hn6") = 0
                        RC("hn7") = 0
                        RC("hn8") = 0
                        RC("hn9") = 0
                        RC("name") = BILL.Rows(i).Item("test_name")
                        RC("code") = BILL.Rows(i).Item("test_code")
                        a.Rows.Add(RC)
                        o = o + ss
                        aa += 1
                    ElseIf aa < 9 Then
                        RC = a.Rows(a.Rows.Count - 1)
                        RC.BeginEdit()
                        Dim z As Integer = aa + 1
                        RC("h" & z) = comp.Rows(ii).Item("name")
                        RC("hn" & z) = ss
                        RC.EndEdit()
                        o = ss + o
                        aa += 1
                    End If

                End If
                ii += 1
            End While
mv:
            ss = 0
            i += 1
        End While

        dr.Close()
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        ii = 0
        i = 0
        While Not ii = comp.Rows.Count
            If comp.Rows(ii).Item("srh") = 1 Then
                i += 1
            End If
            ii += 1
        End While

        If i <= 4 Then
            oj.Load(Application.StartupPath & "\stoc1.rpt")
        Else
            oj.Load(Application.StartupPath & "\stoc.rpt")
        End If
        oj.SetDataSource(a)
        oj.SetParameterValue("d1", d1.Value)
        oj.SetParameterValue("d2", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.CrystalReportViewer1.Refresh()
        rp.Show()
        Exit Sub

    End Sub

    Private Sub nnq11_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles nnq11.Click
        dr.Close() : cmd.CommandText = "select * FROM srh "
        ada.SelectCommand = cmd
        ada.Fill(DBS, "a")
        a = DBS.Tables("a")
        DBS.Tables("a").Clear()
        ada.Fill(DBS, "a")
        a = DBS.Tables("a")
        ACdr.Close() : ACcmd.CommandText = "select sr,name,srh,sno,code,ky FROM company order by sr"
        adcomp.SelectCommand = ACcmd
        adcomp.Fill(DBS, "comp")
        comp = DBS.Tables("comp")
        DBS.Tables("comp").Clear()
        adcomp.Fill(DBS, "comp")
        Dim M As Integer
        Dim YY As String = ""
        M = 0

        a.Rows.Clear()
        Dim ii As Integer = 0
        Dim ss As Integer = 0
        Dim i As Integer = 0
        Dim aa As Int16 = 0
        Dim o As Integer
        While Not i = BILL.Rows.Count
            ss = 0
            ii = 0
            aa = 0
            o = 0

            While Not ii = comp.Rows.Count
                If comp.Rows(ii).Item("srh") = 1 Then
                    ss = 0
                    dr.Close()
                    dr.Close() : cmd.CommandText = "sELECT  count(test_price) from v_lab WHERE test_name='" & BILL.Rows(i).Item("test_name") & "'  and company_code='" & comp.Rows(ii).Item("code") & "'and esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' "
                    dr = cmd.ExecuteReader
                    dr.Read()
                    ss = ss + nulls(dr(0))
                    '===================================================================
mk:
                    dr.Close()
                    If aa = 0 Then
                        RC = a.NewRow
                        RC("h1") = comp.Rows(ii).Item("name")
                        RC("hn1") = ss
                        RC("hn2") = 0
                        RC("hn3") = 0
                        RC("hn4") = 0
                        RC("hn5") = 0
                        RC("hn6") = 0
                        RC("hn7") = 0
                        RC("hn8") = 0
                        RC("hn9") = 0
                        RC("name") = BILL.Rows(i).Item("test_name")
                        RC("code") = BILL.Rows(i).Item("test_code")
                        a.Rows.Add(RC)
                        o = o + ss
                        aa += 1
                    ElseIf aa < 9 Then
                        RC = a.Rows(a.Rows.Count - 1)
                        RC.BeginEdit()
                        Dim z As Integer = aa + 1
                        RC("h" & z) = comp.Rows(ii).Item("name")
                        RC("hn" & z) = ss
                        RC.EndEdit()
                        o = ss + o
                        aa += 1
                    End If

                End If
                ii += 1
            End While

mv:
            ss = 0
            i += 1
        End While

        dr.Close()
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        ii = 0
        i = 0
        While Not ii = comp.Rows.Count
            If comp.Rows(ii).Item("srh") = 1 Then
                i += 1
            End If
            ii += 1
        End While

        If i <= 4 Then
            oj.Load(Application.StartupPath & "\stoc1.rpt")
        Else
            oj.Load(Application.StartupPath & "\stoc.rpt")
        End If
        oj.SetDataSource(a)
        oj.SetParameterValue("d1", d1.Value)
        oj.SetParameterValue("d2", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.CrystalReportViewer1.Refresh()
        rp.Show()
        Exit Sub
    End Sub


    Private Sub nnq12_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles nnq12.Click
        If pa = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— »Ì«‰«  «·„—÷Ï", 0, bran.Text)
            Exit Sub
        End If
        RP1.Checked = True
        ComboBox5.Text = "all"
        f3(5)
        'RP1.Checked = True
        ComboBox5.Text = "rest"

    End Sub

    Private Sub NNQ13_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ13.Click
        FTAKE()
    End Sub

    Private Sub NNQ15_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ15.Click
        FRCV()
    End Sub

    Private Sub NQQ19_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NQQ19.Click
        If lrcv = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «· ”·Ì„", 0, bran.Text)
            Exit Sub
        End If
        Dim w As String = ""
        If nyes.Checked = True Then w = " and take=1"
        If nno.Checked = True Then w = " and take=0"

        dr.Close() : cmd.Connection = CN
        dr.Close() : cmd.CommandType = CommandType.Text
        dr.Close() : cmd.CommandText = "SELECT     * FROM  lLABtest    where ESL_DATE between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'  " & w
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «· ”·Ì„", 1, bran.Text)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\test TK.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)

        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj

        rp.Show() : rp.Focus()
    End Sub

    Private Sub NQQ17_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NQQ17.Click
        If lrcv = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— «” ·«„ «·‰ ÌÃ…", 0, bran.Text)
            Exit Sub
        End If
        Dim w As String = ""
        If nyes.Checked = True Then w = " and rcv=1"
        If nno.Checked = True Then w = " and rcv=0"

        dr.Close() : cmd.CommandText = "SELECT     * FROM  lLABtest    where ESL_DATE between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'  " & w
        adtemp.SelectCommand = cmd
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        DBS.Tables("temp").Clear()
        adtemp.Fill(DBS, "temp")
        temp = DBS.Tables("temp")
        brpd.DataSource = temp
        tm = 4
        Dim v As Integer = 0
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\lab.rpt")
        oj.Database.Tables(0).SetDataSource(temp)
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj

        rp.Show() : rp.Focus()
    End Sub

    Private Sub NNQ20_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ20.Click
        FRCV()
        If esl_no.Text = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·«Ì’«·" : Exit Sub
        Dim ss As String = ""
        dr.Close() : cmd.CommandText = "SELECT  * from vtest where ESL_NO='" & esl_no.Text & "' "
        adesl.SelectCommand = cmd
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        DBS.Tables("esl").Clear()
        adesl.Fill(DBS, "esl")
        esl = DBS.Tables("esl")
        brpd.DataSource = esl
        dr.Close()
        cmd.CommandText = "SELECT  sum(KID_N) as KID_N , kid_type from vtest where ESL_NO='" & esl_no.Text & "' group by  kid_type "
        dr = cmd.ExecuteReader
        While dr.Read
            ss = ss & "     " & dr("kid_type") & "(  " & dr("kid_n") & "  ) "
        End While
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\test.rpt")
        oj.Database.Tables(0).SetDataSource(esl)
        oj.SetParameterValue("na", ss)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()

    End Sub
    Public Sub FDELV()

        Dim XLOG As String = " «·«”„ " & pname.Text & "-" & " «·”‰ " & page.Text & "-" & " «· ·Ì›Ê‰ " & pmobile.Text & "-" & " «·ÿ»Ì» " & REG_name.Text & COMPANY_name.Text & "-" & " «·‘—ﬂ… " & "-" & "«·„œ›Ê⁄ " & PAY.Text & "-" & " «·Œ’„ " & DISS.Text & "-" & qqq5.Text


        If DEL = 0 Then
            If lng = "AR" Then MsgBox(PERMAR) Else MsgBox(PERMEN)
            LLOG("Õ–› Õ–› “Ì«—…", esl_no.Text, XLOG, 0, bran.Text)
            Exit Sub
        End If

        If esl_no.Text = "" Then
            If lng = "AR" Then MsgBox(chkar & " —ﬁ„ «·«Ì’«·", MsgBoxStyle.Exclamation) Else MsgBox(chken & " code ", MsgBoxStyle.Exclamation)
            Exit Sub
        End If
        If finals.Checked = True And edt = 0 Then
            MsgBox("·« Ì„ﬂ‰ Õ–› ›Ï Â–« «·«Ì’«·")
            If mng = 1 Then
                Dim nnm As Integer = InputBox("enter password")
                If nnm = 5011545 Then GoTo mms
            End If
            Exit Sub
        End If
mms:
        If DELT = 1 Then
            If edt = 1 And mng = 1 Then
                dr.Close()
                cmd.CommandText = "select * from lbill where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & " and bdel=0"
                dr = cmd.ExecuteReader
                dr.Read()
                If dr.HasRows = True Then
                    Dim x As String
                    dr.Close()
                    If finals.Checked = True And edt = 0 And DEL = 0 Then
                        MsgBox("·« Ì„ﬂ‰ Õ–› ›Ï Â–« «·«Ì’«·")
                        Exit Sub
                    End If
                    x = MsgBox("Â·  —Ìœ  Õ–› «·«Ì’«· ‰Â«∆Ì« ø", MsgBoxStyle.YesNo)
                    If x = vbNo Then Exit Sub
                    dr.Close()

                    cmd.CommandText = "INSERT INTO lbillDEL (dev,[esl_date],[esl_no],[pname],[reg_name],[doc_name],[book_code],[book_name],[company_code],[company_name],[doc_code],[pcode],[ptype],[page],[pid],[depn],[reg_code],[esl_time],[crd_per],[crd_v],[cash_per],[cash_v],[bon],[pay],[rest],[tot],[nik],[test],[diss],[USR],[SHIFT],[rcv_date],[rcv],[fastv],[hrcvv],[rcvv],[rcvn],[fastn],[cfast],[chrcv],[totv],[ty],[doc_per],[branch_name],[branch_code],[pemail],[dissn],[notes],[tblg],[sprnt],[pyear],[lab_name],[lab_code],[ptot],[ppay],[prest],[labprice],[labtest],[tnum],[nnik],[qun],[testpro],[rcv_time],[pinc],[pcrd],[pcanc],[YEARN],[ESLBILL],[urgant],[final],[bdel],[bdelusr],[bdeldate],[eslb],[bran],[printtime],[brans],[sampl],[sampldate],[samplusr],[restusr],[restdate],[trl],[st],[fnd],[pmobile],[ucash],[utc],[utn],[FS],[labd],[wuser],[wpass],[COMS],[wid],[NCRD],[BANK],[NDOC],[WEB]) SELECT dev,[esl_date],esl_no,[pname],[reg_name],[doc_name],[book_code],[book_name],[company_code],[company_name],[doc_code],[pcode],[ptype],[page],[pid],[depn],[reg_code],[esl_time],[crd_per],[crd_v],[cash_per],[cash_v],[bon],[pay],[rest],[tot],[nik],[test],[diss],[USR],[SHIFT],[rcv_date],[rcv],[fastv],[hrcvv],[rcvv],[rcvn],[fastn],[cfast],[chrcv],[totv],[ty],[doc_per],[branch_name],[branch_code],[pemail],[dissn],[notes],[tblg],[sprnt],[pyear],[lab_name],[lab_code],[ptot],[ppay],[prest],[labprice],[labtest],[tnum],[nnik],[qun],[testpro],[rcv_time],[pinc],[pcrd],[pcanc],[YEARN],[ESLBILL],[urgant],[final],[bdel],[bdelusr],[bdeldate],[eslb],[bran],[printtime],[brans],[sampl],[sampldate],[samplusr],[restusr],[restdate],[trl],[st],[fnd],[pmobile],[ucash],[utc],[utn],[FS],[labd],[wuser],[wpass],[COMS],[wid],[NCRD],[BANK],[NDOC],[WEB] FROM lbill where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "INSERT INTO lbill_ESLDEL  ([esl_no],[bill],[yearn],[sdate],[rest],[billrest],[TOT],[qun],[bran],[trl],[st],[id],[usr],[SHIFT])  SELECT  esl_no,[bill],[yearn],[sdate],[rest],[billrest],[TOT],[qun],[bran],[trl],[st],[id],[usr],[SHIFT] FROM lbill_ESL where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "INSERT INTO lbill_testDEL ([qun],[pthn],[ds],[test_name],[res],[test_code],[test_ar],[test_price],[tot1],[ref],[esl_no],[esl_date],[sub],[pname],[pcode],[page],[ptype],[cult],[fres],[rcv_date],[rcv],[note],[NOTEN],[NORB],[NORE],[UNIT],[take],[gr_name],[gr_code],[s],[p],[gname],[GCODE],[t],[TBLG],[tblgtime],[tblgusr],[prntn],[lab],[labprice],[so],[RSO],[comment],[HOMS],[BAR],[dis_n],[uadd],[uadddate],[YEARN],[urem],[uremdate],[tdel],[sres],[TOT2],[prnttime],[pth],[rsv],[rsvp],[QUN1],[bran],[trl],[st],[id],[final],[notesg],[notesp],[usr],[pricep],[tSQ],[tSQ1],[dsn],[IMAGE],[IMGN],[IMGNO],[IMAGEN1],[IMAGE1],[IMAGEN3],[IMAGE3],[IMAGE2],[IMAGE4],[IMAGEN5],[IMAGE5],[timagen],[IMAGEN2],[IMAGEN4]) SELECT [qun],[pthn],[ds],[test_name],[res],[test_code],[test_ar],[test_price],[tot1],[ref],esl_no,[esl_date],[sub],[pname],[pcode],[page],[ptype],[cult],[fres],[rcv_date],[rcv],[note],[NOTEN],[NORB],[NORE],[UNIT],[take],[gr_name],[gr_code],[s],[p],[gname],[GCODE],[t],[TBLG],[tblgtime],[tblgusr],[prntn],[lab],[labprice],[so],[RSO],[comment],[HOMS],[BAR],[dis_n],[uadd],[uadddate],[YEARN],[urem],[uremdate],[tdel],[sres],[TOT2],[prnttime],[pth],[rsv],[rsvp],[QUN1],[bran],[trl],[st],[id],[final],[notesg],[notesp],[usr],[pricep],[tSQ],[tSQ1],[dsn],[IMAGE],[IMGN],[IMGNO],[IMAGEN1],[IMAGE1],[IMAGEN3],[IMAGE3],[IMAGE2],[IMAGE4],[IMAGEN5],[IMAGE5],[timagen],[IMAGEN2],[IMAGEN4] FROM lbill_test  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "INSERT INTO lbill_testsubDEL ([qun],[pthn],[test_name],[res],[res1],[res2],[so],[test_code],[test_ar],[esl_no],[mtest_code],[mtest_name],[ds],[rcv],[note],[NOTEN],[NORB],[NORE],[q],[absu],[ref1],[p],[unit],[rso],[YEARN],[re1],[re2],[ds1],[pth],[rsvp],[rsv1],[QUN1],[RDS],[bran],[st],[ref],[rsv],[usr],[dsn]) SELECT [qun],[pthn],[test_name],[res],[res1],[res2],[so],[test_code],[test_ar],esl_no,[mtest_code],[mtest_name],[ds],[rcv],[note],[NOTEN],[NORB],[NORE],[q],[absu],[ref1],[p],[unit],[rso],[YEARN],[re1],[re2],[ds1],[pth],[rsvp],[rsv1],[QUN1],[RDS],[bran],[st],[ref],[rsv],[usr],[dsn] FROM lbill_testsub where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "INSERT INTO LBILL_CULTDEL ([test_name],[test_code],[esl_no],[name1],[NAME2],[NAME3],[VIRUS],[VIRUSC],[so],[YEARN],[bran],[trl],[st])  SELECT [test_name],[test_code],esl_no,[name1],[NAME2],[NAME3],[VIRUS],[VIRUSC],[so],[YEARN],[bran],[trl],[st] FROM LBILL_CULT where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "INSERT INTO LBILL_CULT_DETDEL ([test_name],[test_code],[esl_no],[NOTE],[SPECIMEN],[DIRECT_ FILM],[PUS_CELLS],[RBCs],[OTHERS],[CULTURE_CONDITIONS],[GROWTH_OF],[VAIBLE_COUNT],[COUNT_IS],[epithelial],[num],[YEARN],[bran],[trl],[st],[usr]) SELECT [test_name],[test_code],esl_no,[NOTE],[SPECIMEN],[DIRECT_ FILM],[PUS_CELLS],[RBCs],[OTHERS],[CULTURE_CONDITIONS],[GROWTH_OF],[VAIBLE_COUNT],[COUNT_IS],[epithelial],[num],[YEARN],[bran],[trl],[st],[usr] FROM LBILL_CULT_DET where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "INSERT INTO lbillemageDEL  ([esl_no],[bran],[yearn],[image])  SELECT esl_no,[bran],[yearn],[image] FROM lbillemage where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "INSERT INTO lbillImageDEL  ([image],[no],[esl_no],[yearn],[code],[IIMAGE],[bran],[st],[usr])  SELECT  [image],[no],esl_no,[yearn],[code],[IIMAGE],[bran],[st],[usr] FROM lbillImage where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()

                    cmd.CommandText = "delete from lbill where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "delete from lbill_ESL where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "delete from lbill_test  where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "delete from lbill_testsub where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "delete from LBILL_CULT where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "delete from LBILL_CULT_DET where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "delete from lbillemage where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    cmd.CommandText = "DELETE FROM lbillImage where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
                    cmd.ExecuteNonQuery()
                    LLOG("“Ì«—… Õ–›", esl_no.Text, XLOG, 1, bran.Text)
                    FNEWV()
                Else
                    Me.Text = "Â–« «·«Ì’«· €Ì— „”Ã·"

                End If
            End If
        End If
        If PORV <> "" Then
            dr.Close()
            cmd.CommandText = "insert into ldel (esl_no,type) values ('" & esl_no.Text & "','esl')"
            cmd.ExecuteNonQuery()
        End If
        MsgBox(" „ «·Õ–›")
    End Sub
    Private Sub Õ–›‰Â«∆ÏToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Õ–›‰Â«∆ÏToolStripMenuItem1.Click
        FDELV()

    End Sub

    Private Sub ÿ»«⁄…«·‰ ÌÃ…ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ÿ»«⁄…«·‰ ÌÃ…ToolStripMenuItem.Click
        FPRINTV()
    End Sub

    Private Sub PrintJopToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub


    Private Sub NNQ30_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ30.Click
        Dim n As String
        If lng = "AR" Then n = MsgBox(EDITAR, MsgBoxStyle.YesNo) Else n = MsgBox(EDITEN, MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close()
        Dim RES As String = InputBox("«œŒ· «·‰ ÌÃ… «·À«» …")
        cmd.CommandText = "UPDATE LTEST SET RES ='" & Trim(RES) & "' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
        fprice1(1)
        LLOG(" ⁄œÌ·", 0, " ⁄œÌ· «· Õ·Ì· " & test.Text, 1, bran.Text)
    End Sub

    Private Sub  ﬁ—Ì— ›’Ì·ÌToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles  ﬁ—Ì— ›’Ì·ÌToolStripMenuItem.Click
        f3(1)
    End Sub

    Private Sub NQQ31_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NQQ31.Click
        incomet(0)
    End Sub

    Private Sub NQQ32_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NQQ32.Click
        incomet(1)
    End Sub

    Private Sub NQQ34_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NQQ34.Click
        incomet(3)
    End Sub

    Private Sub NQQ33_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NQQ33.Click
        incomet(2)
    End Sub

    Private Sub QQN35_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles QQN35.Click
        teste(0)
    End Sub

    Private Sub NQQ36_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NQQ36.Click
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 205 Then Exit Sub
        Dim n As Integer = InputBox("enter old code")
        Dim n1 As Integer = InputBox("enter new code")
        dr.Close()
        cmd.CommandText = "update  lbill set esl_no='" & n1 & "' where ESL_NO='" & n & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill_test set esl_no='" & n1 & "'  where ESL_NO='" & n & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill_ESL set esl_no='" & n1 & "'  where ESL_NO='" & n & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbill_testsub set esl_no='" & n1 & "' where ESL_NO='" & n & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update LBILL_CULT set esl_no='" & n1 & "' where ESL_NO='" & n & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update LBILL_CULT_DET set esl_no='" & n1 & "' where ESL_NO='" & n & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update lbillemage set esl_no='" & n1 & "' where ESL_NO='" & n & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        cmd.ExecuteNonQuery()


    End Sub

    Private Sub ToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ToolStripMenuItem1.Click
        NBAR()
    End Sub

    Private Sub ToolStripMenuItem4_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ToolStripMenuItem4.Click
        cmdptt.Connection = ACcn
        cmdptt.CommandText = "select * from zzz "
        adptt.SelectCommand = cmdptt
        'ptt.Clear()
        adptt.Fill(DBS, "ptt")
        ptt = DBS.Tables("ptt")
        'brpd.Dispose()
        brpd.DataSource = ptt
        brpd.Columns(0).HeaderText = "NAME"
        brpd.Columns(1).HeaderText = "AGE"
        brpd.Columns(2).HeaderText = "TYPE"
        TabControl2.SelectTab(0)
        GroupBox10.Visible = True
    End Sub

    Private Sub  ﬁ—Ì—«·„ÿ·Ê»«” ·«„ÂToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles  ﬁ—Ì—«·„ÿ·Ê»«” ·«„ÂToolStripMenuItem.Click
        PROMIS()
    End Sub

    Private Sub NNQ37_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ37.Click
        'yy1()
        'If YYN = "" Then Me.Text = "«·—Ã«¡ «Œ Ì«— «·»Ì«‰" : Exit Sub
        dr.Close() : cmd.CommandText = "SELECT company_name as company_name ,count(esl_no) as esl_no from lbill GROUP BY company_name ORDER BY esl_no desc"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "f31")
        F31 = DBS.Tables("f31")
        DBS.Tables("f31").Clear()
        adesl.Fill(DBS, "f31")
        F31 = DBS.Tables("f31")
        brpd.DataSource = esl
        Dim v As Integer = 0
        While Not v = brpd.Columns.Count
            brpd.Columns(v).Visible = False
            v = v + 1
        End While
        brpd.Columns("x").Visible = True
        brpd.Columns("name").Visible = True
        TabControl2.SelectTab(0)
        tm = 20
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\f31.rpt")
        MsgBox(F31.Rows.Count)
        oj.Database.Tables(0).SetDataSource(F31)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub FACEBOOKToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FACEBOOKToolStripMenuItem1.Click
        Process.Start("https://www.facebook.com/futuretechnology.System")
    End Sub


    Private Sub YOUTUBEToolStripMenuItem1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles YOUTUBEToolStripMenuItem1.Click
        Process.Start("https://www.youtube.com/user/ASILITEG")

    End Sub

    Private Sub EMAILToolStripMenuItem_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles EMAILToolStripMenuItem.Click
        GroupBox4.Visible = True
    End Sub

    Private Sub NNQ38_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ38.Click
        emlprg = 1
        dr.Close()
        ACdr.Close()
        ACcmd.CommandText = "delete * from email "
        ACcmd.ExecuteNonQuery()
        EXPENS.Checked = True
        RP1.Checked = True
        cesl_date.Checked = True
        f3(4)
        cesl_date.Checked = True
        EXPENS.Checked = False
        Dim rrr As Process = Process.Start(Application.StartupPath & "\bar.exe")
        semail(bremail, pname.Text, "print report date " & esl_date.Value, 1, 0)
        rrr.Kill()
        If emlprg = 1 Then MessageBox.Show(" success send  to ", "  Successful?", MessageBoxButtons.OK, MessageBoxIcon.Information)

    End Sub
    Private Sub NQQ_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NQQ.Click
        Dim n As String
        n = MsgBox("Â·  —Ìœ  ⁄œÌ· »Ì«‰«  «· Õ·Ì· ", MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "UPDATE LTEST SET LCK ='1' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub NNQ41_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ41.Click
        Dim n As String
        n = MsgBox("Â·  —Ìœ  ⁄œÌ· »Ì«‰«  «· Õ·Ì· ", MsgBoxStyle.YesNo)
        If n = vbNo Then Exit Sub
        dr.Close()
        cmd.CommandText = "UPDATE LTEST SET LCK ='0' WHERE TEST_CODE='" & Ntest_CODE.Text & "'"
        cmd.ExecuteNonQuery()
    End Sub

    Private Sub OptionsToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles OptionsToolStripMenuItem.Click
        FSAVEV()
    End Sub

    Private Sub VISRPTToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles VISRPTToolStripMenuItem.Click
        rptp.Visible = True
    End Sub

    Private Sub LabToLabToDayToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles LabToLabToDayToolStripMenuItem.Click
        cesl_date.Checked = True
        esl_date.Value = Now
        LABTO()
        cesl_date.Checked = False
    End Sub

    Private Sub NNQ35_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ35.Click
        If CBRAN.Checked = True Then yy = "AND BRAN='" & bran.Text & "' "
        dr.Close() : cmd.Connection = CN
        cmd.CommandText = "select * from lbillDEL WHere  esl_date between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' " & yy & " order by esl_date desc"
        adF31.SelectCommand = cmd
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        DBS.Tables("F31").Clear()
        adF31.Fill(DBS, "F31")
        F31 = DBS.Tables("F31")
        F31D.DataSource = F31
        tm = 4
        F31DTG()

        MsgBox(F31.Rows.Count)
        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\BILL.rpt")
        oj.Database.Tables(0).SetDataSource(F31)
        oj.SetParameterValue("1", " ﬁ—Ì— «· ›’Ì·Ï Œ·«· › —… „‰ ")
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        If ls = 0 Then oj.SetParameterValue("5", "0") Else oj.SetParameterValue("5", "1")
        If mng = 1 Or (cesl_date.Checked = True And lp = 1) Then oj.SetParameterValue("118", 1) Else oj.SetParameterValue("118", 0)

        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show() : rp.Focus()
    End Sub

    Private Sub NNQ36_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NNQ36.Click
        SSSS = InputBox("«·—Ã«¡ «œŒ«· «·—ﬁ„ «·„—«œ «⁄«œ Â „‰ «·Õ–›")
        dr1.Close()
        cmd1.CommandText = "select * from lbillDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr1 = cmd1.ExecuteReader
        If dr1.HasRows = False Then MsgBox("Â–« «·—ﬁ„ €Ì— „Õ–Ê›") : Exit Sub
        Dim SS As Integer = InputBox("«·—Ã«¡ «œŒ«· «·—ﬁ„ «·ÃœÌœ")
        dr1.Close()
        cmd1.CommandText = "select * from lbill where ESL_NO='" & SS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        dr1 = cmd1.ExecuteReader
        If dr1.HasRows = True Then MsgBox("Â–« «·—ﬁ„ „”Ã· »«·›⁄·") : Exit Sub
        dr.Close()

        cmd.CommandText = "INSERT INTO lbill ([esl_date],[esl_no],[pname],[reg_name],[doc_name],[book_code],[book_name],[company_code],[company_name],[doc_code],[pcode],[ptype],[page],[pid],[depn],[reg_code],[esl_time],[crd_per],[crd_v],[cash_per],[cash_v],[bon],[pay],[rest],[tot],[nik],[test],[diss],[USR],[SHIFT],[rcv_date],[rcv],[fastv],[hrcvv],[rcvv],[rcvn],[fastn],[cfast],[chrcv],[totv],[ty],[doc_per],[branch_name],[branch_code],[pemail],[dissn],[notes],[tblg],[sprnt],[pyear],[lab_name],[lab_code],[ptot],[ppay],[prest],[labprice],[labtest],[tnum],[nnik],[qun],[testpro],[rcv_time],[pinc],[pcrd],[pcanc],[YEARN],[ESLBILL],[urgant],[final],[bdel],[bdelusr],[bdeldate],[eslb],[bran],[printtime],[brans],[sampl],[sampldate],[samplusr],[restusr],[restdate],[trl],[st],[fnd],[pmobile],[ucash],[utc],[utn],[FS],[labd],[wuser],[wpass],[COMS],[wid],[NCRD],[BANK],[NDOC],[WEB]) SELECT [esl_date]," & SS & ",[pname],[reg_name],[doc_name],[book_code],[book_name],[company_code],[company_name],[doc_code],[pcode],[ptype],[page],[pid],[depn],[reg_code],[esl_time],[crd_per],[crd_v],[cash_per],[cash_v],[bon],[pay],[rest],[tot],[nik],[test],[diss],[USR],[SHIFT],[rcv_date],[rcv],[fastv],[hrcvv],[rcvv],[rcvn],[fastn],[cfast],[chrcv],[totv],[ty],[doc_per],[branch_name],[branch_code],[pemail],[dissn],[notes],[tblg],[sprnt],[pyear],[lab_name],[lab_code],[ptot],[ppay],[prest],[labprice],[labtest],[tnum],[nnik],[qun],[testpro],[rcv_time],[pinc],[pcrd],[pcanc],[YEARN],[ESLBILL],[urgant],[final],[bdel],[bdelusr],[bdeldate],[eslb],[bran],[printtime],[brans],[sampl],[sampldate],[samplusr],[restusr],[restdate],[trl],[st],[fnd],[pmobile],[ucash],[utc],[utn],[FS],[labd],[wuser],[wpass],[COMS],[wid],[NCRD],[BANK],[NDOC],[WEB] FROM lbillDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "INSERT INTO lbill_ESL  ([esl_no],[bill],[yearn],[sdate],[rest],[billrest],[TOT],[qun],[bran],[trl],[st],[id],[usr],[SHIFT])  SELECT  " & SS & ",[bill],[yearn],[sdate],[rest],[billrest],[TOT],[qun],[bran],[trl],[st],[id],[usr],[SHIFT] FROM lbill_ESLDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "INSERT INTO lbill_test ([qun],[pthn],[ds],[test_name],[res],[test_code],[test_ar],[test_price],[tot1],[ref],[esl_no],[esl_date],[sub],[pname],[pcode],[page],[ptype],[cult],[fres],[rcv_date],[rcv],[note],[NOTEN],[NORB],[NORE],[UNIT],[take],[gr_name],[gr_code],[s],[p],[gname],[GCODE],[t],[TBLG],[tblgtime],[tblgusr],[prntn],[lab],[labprice],[so],[RSO],[comment],[HOMS],[BAR],[dis_n],[uadd],[uadddate],[YEARN],[urem],[uremdate],[tdel],[sres],[TOT2],[prnttime],[pth],[rsv],[rsvp],[QUN1],[bran],[trl],[st],[id],[final],[notesg],[notesp],[usr],[pricep],[tSQ],[tSQ1],[dsn],[IMAGE],[IMGN],[IMGNO],[IMAGEN1],[IMAGE1],[IMAGEN3],[IMAGE3],[IMAGE2],[IMAGE4],[IMAGEN5],[IMAGE5],[timagen],[IMAGEN2],[IMAGEN4]) SELECT [qun],[pthn],[ds],[test_name],[res],[test_code],[test_ar],[test_price],[tot1],[ref]," & SS & ",[esl_date],[sub],[pname],[pcode],[page],[ptype],[cult],[fres],[rcv_date],[rcv],[note],[NOTEN],[NORB],[NORE],[UNIT],[take],[gr_name],[gr_code],[s],[p],[gname],[GCODE],[t],[TBLG],[tblgtime],[tblgusr],[prntn],[lab],[labprice],[so],[RSO],[comment],[HOMS],[BAR],[dis_n],[uadd],[uadddate],[YEARN],[urem],[uremdate],[tdel],[sres],[TOT2],[prnttime],[pth],[rsv],[rsvp],[QUN1],[bran],[trl],[st],[id],[final],[notesg],[notesp],[usr],[pricep],[tSQ],[tSQ1],[dsn],[IMAGE],[IMGN],[IMGNO],[IMAGEN1],[IMAGE1],[IMAGEN3],[IMAGE3],[IMAGE2],[IMAGE4],[IMAGEN5],[IMAGE5],[timagen],[IMAGEN2],[IMAGEN4] FROM lbill_testDEL  where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "INSERT INTO lbill_testsub ([qun],[pthn],[test_name],[res],[res1],[res2],[so],[test_code],[test_ar],[esl_no],[mtest_code],[mtest_name],[ds],[rcv],[note],[NOTEN],[NORB],[NORE],[q],[absu],[ref1],[p],[unit],[rso],[YEARN],[re1],[re2],[ds1],[pth],[rsvp],[rsv1],[QUN1],[RDS],[bran],[st],[ref],[rsv],[usr],[dsn]) SELECT [qun],[pthn],[test_name],[res],[res1],[res2],[so],[test_code],[test_ar]," & SS & ",[mtest_code],[mtest_name],[ds],[rcv],[note],[NOTEN],[NORB],[NORE],[q],[absu],[ref1],[p],[unit],[rso],[YEARN],[re1],[re2],[ds1],[pth],[rsvp],[rsv1],[QUN1],[RDS],[bran],[st],[ref],[rsv],[usr],[dsn] FROM lbill_testsubDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "INSERT INTO LBILL_CULT ([test_name],[test_code],[esl_no],[name1],[NAME2],[NAME3],[VIRUS],[VIRUSC],[so],[YEARN],[bran],[trl],[st])  SELECT [test_name],[test_code]," & SS & ",[name1],[NAME2],[NAME3],[VIRUS],[VIRUSC],[so],[YEARN],[bran],[trl],[st] FROM LBILL_CULTDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "INSERT INTO LBILL_CULT_DET ([test_name],[test_code],[esl_no],[NOTE],[SPECIMEN],[DIRECT_ FILM],[PUS_CELLS],[RBCs],[OTHERS],[CULTURE_CONDITIONS],[GROWTH_OF],[VAIBLE_COUNT],[COUNT_IS],[epithelial],[num],[YEARN],[bran],[trl],[st],[usr]) SELECT [test_name],[test_code]," & SS & ",[NOTE],[SPECIMEN],[DIRECT_ FILM],[PUS_CELLS],[RBCs],[OTHERS],[CULTURE_CONDITIONS],[GROWTH_OF],[VAIBLE_COUNT],[COUNT_IS],[epithelial],[num],[YEARN],[bran],[trl],[st],[usr] FROM LBILL_CULT_DETDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "INSERT INTO lbillemage  ([esl_no],[bran],[yearn],[image])  SELECT " & SS & ",[bran],[yearn],[image] FROM lbillemageDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "INSERT INTO lbillImage  ([image],[no],[esl_no],[yearn],[code],[IIMAGE],[bran],[st],[usr])  SELECT  [image],[no]," & SS & ",[yearn],[code],[IIMAGE],[bran],[st],[usr] FROM lbillImageDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from lbillDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from lbill_ESLDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from lbill_testDEL  where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from lbill_testsubDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from LBILL_CULTDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from LBILL_CULT_DETDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from lbillemageDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        cmd.CommandText = "DELETE FROM lbillImageDEL where ESL_NO='" & SSSS & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'" & ""
        cmd.ExecuteNonQuery()
        MsgBox(" „ «” ⁄«œ… «·„—Ì÷ ", MsgBoxStyle.Information)
    End Sub

    Private Sub asasa1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asasa1.Click

    End Sub

    Private Sub asddddd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles asddddd.Click

        dr.Close()
        cmd.CommandText = "delete from amanrp "
        cmd.ExecuteNonQuery()
        cmd.CommandText = "insert into amanrp  select * from aman where test like'%Blood Gases%'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "update  amanrp set test ='Blood Gases',tot=225  "
        cmd.ExecuteNonQuery()
        dr.Close()
        cmd.CommandText = "update  aman set test = replace(test, 'Blood Gases', ''),tot=tot-225  where test like'%Blood Gases%'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "delete from aman where tot=0"
        cmd.ExecuteNonQuery()
        MsgBox("ok")
        '' '' '' '' ''Dim ao As String = "Iím an IT manager with 10 years of experience and professionalism with IT systems and solutions. I have a solid experience in implementing technology solutions to facilitate improved operations and efficiency. In those years I was designing support strategies and creating comprehensive technical solutions to drive business success. I also developed a lab management system software while I was working in Techno labs where many labs are using it till today. I helped many companies by analyses, budgeting, providing essential consultative support"
        '' '' '' '' ''ao = ao & Environment.NewLine & "With a Bachelor of Commerce, Certificate in Software Engineering, and Master in human development, I led teams through installations and development cycles of IT systems and programs, I am sure to exceed your expectations for this role.I look forward to discussing the position, and my qualifications, in further detail. Thank you for your consideration."
        '' '' '' '' ''ao = ao & Environment.NewLine & "Please find my attached CV file."
        '' '' '' '' ''ao = ao & Environment.NewLine & "Best regards,"
        '' '' '' '' ''ACdr.Close()
        '' '' '' '' ''ACcmd.CommandText = "select name1 from qq"
        '' '' '' '' ''ACdr = ACcmd.ExecuteReader
        '' '' '' '' ''While ACdr.Read
        '' '' '' '' ''    myemail(ACdr(0), "IT Manager - Ali Hassan Ali Hassan", ao, 1, 0)
        '' '' '' '' ''End While
        '' '' '' '' ''MsgBox("ok")





    End Sub

    Private Sub ASDDDDDDD_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ASDDDDDDD.Click
        dr.Close()
        dr1.Close()
        cmd.CommandText = "SELECT  MAX(KY) AS KY,COUNT(test_name) AS A, esl_no, test_name FROM lbill_test where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'  GROUP BY esl_no, test_name HAVING(COUNT(test_name) > 1)"
        dr = cmd.ExecuteReader
        While dr.Read
            cmd1.CommandText = "DELETE FROM lbill_test WHERE KY=" & dr("KY")
            cmd1.ExecuteNonQuery()
        End While

        dr.Close()
        dr1.Close()
        cmd.CommandText = "SELECT  MAX(KY) AS KY,COUNT(test_name) AS A, esl_no, test_name FROM lbill_testSUB where ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' GROUP BY esl_no, test_name HAVING(COUNT(test_name) > 1)"
        dr = cmd.ExecuteReader
        While dr.Read
            cmd1.CommandText = "DELETE FROM lbill_testSUB WHERE KY=" & dr("KY")
            cmd1.ExecuteNonQuery()
        End While
    End Sub

    Private Sub JHJDJASLADDSD_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles JHJDJASLADDSD.Click
        PATHO.tar.Text = lrr.Text
        PATHO.ShowDialog()

    End Sub

    Private Sub —Ê‘ …ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles —Ê‘ …ToolStripMenuItem.Click
        DELETEIMAGE("lbillimage", 1)

    End Sub
    Public Sub DELETEIMAGE(ByVal TB1 As String, ByVal STB As Integer)
        DELPICL.Items.Clear()
        dr.Close()
        If STB = 3 Then
            cmd.CommandText = "SELECT * FROM " & TB1 & "  WHERE esl_date='" & ChangeFormat(esl_date.Value) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        Else
            cmd.CommandText = "SELECT * FROM " & TB1 & "  WHERE ESL_NO='" & Val(esl_no.Text) & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            DELPICL.Items.Add(dr("CODE"))
        End While
        DELPIC.Visible = True
        TB = TB1
        stb1 = STB
    End Sub
    Private Sub DELPRICRE_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DELPRICRE.Click
        DELETEIMAGE(TB, stb1)

    End Sub

    Private Sub DELPICOK_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DELPICOK.Click
        Dim x As String = MsgBox("Â·  —Ìœ  Õ–› «·«Ì’«· ‰Â«∆Ì« ø", MsgBoxStyle.YesNo)
        If x = vbNo Then Exit Sub
        dr.Close()
        If stb1 = 3 Then
            cmd.CommandText = "delete FROM " & TB & "  WHERE yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND code='" & DELPICL.Text & "'"
        Else
            cmd.CommandText = "delete FROM " & TB & "  WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND code='" & DELPICL.Text & "'"
        End If
        cmd.ExecuteNonQuery()
        DELPICL.Items.Clear()
        dr.Close()
        If stb1 = 3 Then
            cmd.CommandText = "SELECT * FROM " & TB & "  WHERE yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        Else
            cmd.CommandText = "SELECT * FROM " & TB & "  WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            DELPICL.Items.Add(dr("CODE"))
        End While
    End Sub

    Private Sub DELPICL_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DELPICL.SelectedIndexChanged
        dr.Close()
        If stb1 = 3 Then
            cmd.CommandText = "SELECT * FROM " & TB & " WHERE yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND code='" & DELPICL.Text & "'"
        Else
            cmd.CommandText = "SELECT * FROM " & TB & " WHERE ESL_NO='" & esl_no.Text & "' " & " and " & "yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "' AND code='" & DELPICL.Text & "'"
        End If
        dr = cmd.ExecuteReader
        dr.Read()
        Dim newMstream As New System.IO.MemoryStream(CType(dr.Item("image"), Byte()))
        Dim ImageFromDB As New Bitmap(newMstream)
        DELPICS.Image = ImageFromDB
    End Sub

    Private Sub Õ–›’Ê—…ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Õ–›’Ê—…ToolStripMenuItem.Click

    End Sub

    Private Sub  ÕÊÌ·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles  ÕÊÌ·ToolStripMenuItem.Click
        DELETEIMAGE("lbill_cmt", 1)
    End Sub

    Private Sub »ÿ«ﬁ…ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles »ÿ«ﬁ…ToolStripMenuItem.Click
        DELETEIMAGE("lbill_cid", 1)
    End Sub

    Private Sub LOGSHEETToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles LOGSHEETToolStripMenuItem.Click
        DELETEIMAGE("llogsheet", 3)
    End Sub

    Private Sub AASD12_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles AASD12.Click
        Me.Text = "you are logeoff"
        Me.Enabled = False

    End Sub

    Private Sub LOGOFFONToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles LOGOFFONToolStripMenuItem.Click
        If Me.Enabled = True Then
            Me.Enabled = False
        Else
            INPU.TextBox1.Text = Nothing
            INPU.ShowDialog()
            login(INPUTX)

        End If
    End Sub

    Private Sub logsheetfolder_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles logsheetfolder.Click

        ACdr.Close()

        FolderBrowserDialog2.ShowDialog()

        Dim SourceDirectory As String = FolderBrowserDialog2.SelectedPath
        Dim LatestFile As IO.FileInfo = Nothing
        Dim ss As String = ""
        Dim DirInfo As New IO.DirectoryInfo(SourceDirectory)
        For Each file As IO.FileInfo In DirInfo.GetFiles()
            dr.Close()
            imlis.ImageLocation = file.FullName
            'MsgBox(file.FullName)
            Dim oer As System.IO.FileStream
            Dim rer As IO.StreamReader
            oer = New IO.FileStream(file.FullName, IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)
            rer = New IO.StreamReader(oer)
            Dim FileByteArrayr(oer.Length - 1) As Byte
            oer.Read(FileByteArrayr, 0, oer.Length)
            dr.Close()
            cmd.CommandText = "select max(code) from llogsheet WHERE  yearn='" & Val(YEARN.Text) & "' and bran='" & bran.Text & "'"
            dr = cmd.ExecuteReader
            dr.Read()
            IMAGE_CODE.Text = nulls(dr(0)) + 1
            dr.Close()
            cmd.CommandText = "insert into llogsheet (CODE,IIMAGE ,bran,yearn,esl_date,usr) values ('" & IMAGE_CODE.Text & "','" & IIMAGE.Text & "','" & bran.Text & "','" & YEARN.Text & "','" & ChangeFormat(esl_date.Value) & "','" & USR & "')"
            cmd.ExecuteNonQuery()
            Dim Sql As String = "update  llogsheet set image = ? , no = ? where   CODE='" & IMAGE_CODE.Text & "' and yearn='" & YEARN.Text & "' and bran='" & bran.Text & "'"
            cmd.CommandText = Sql
            cmd.Parameters.Clear()
            cmd.Parameters.Add("@image", System.Data.OleDb.OleDbType.Binary, oer.Length).Value = FileByteArrayr
            cmd.Parameters.Add("@no", System.Data.OleDb.OleDbType.VarChar, 100).Value = oer.Length
            cmd.ExecuteNonQuery()


        Next
        picup.ImageLocation = ss


    End Sub

    Private Sub bcommentsave_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles bcommentsave.Click
        dr.Close()
        If typec = 1 Then
            If pname.Text.Length < 5 Then
                MsgBox("«·—Ã«¡ ﬂ «»… «”„ «·„—Ì÷")
                Exit Sub
            End If

            If pmobile.Text.Length < 5 Then
                MsgBox("«·—Ã«¡ ﬂ «»… —ﬁ„ «·„Ê»Ì·")
                Exit Sub
            End If
        End If
        If comment11.Text.Length < 5 Then
            MsgBox("«·—Ã«¡ ﬂ «»… «·ﬂÊ„‰ ")
            Exit Sub
        End If
        If typec = 2 And COMPANY_name.Text.Length < 5 Then
            MsgBox("«·—Ã«¡ ﬂ «»… «”„ «·ÃÂ…")
            Exit Sub
        End If
        Dim lonamme, locode As String
        If typec = 1 Then lonamme = pname.Text Else lonamme = COMPANY_name.Text
        If typec = 1 Then locode = pcode.Text Else locode = COMPANY_CODE.Text

        cmd.CommandText = "delete lblock where pname='" & lonamme & "'"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "INSERT INTO [dbo].[lblock]([pname],[pcode],[comment],[type],[pmobile]) VALUES ('" & lonamme & "','" & locode & "','" & bcomment.Text & "','" & typec & "','" & pmobile.Text & "')"
        cmd.ExecuteNonQuery()
        GroupBox11.Visible = False

    End Sub

    Private Sub DLEBLOCK_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles DLEBLOCK.Click
        dr.Close()
        If typec = 1 Then
            If pname.Text.Length < 5 Then
                MsgBox("«·—Ã«¡ ﬂ «»… «”„ «·„—Ì÷")
                Exit Sub
            End If

            If pmobile.Text.Length < 5 Then
                MsgBox("«·—Ã«¡ ﬂ «»… —ﬁ„ «·„Ê»Ì·")
                Exit Sub
            End If
        End If

        If typec = 2 And COMPANY_name.Text.Length < 5 Then
            MsgBox("«·—Ã«¡ ﬂ «»… «”„ «·ÃÂ…")
            Exit Sub
        End If
        Dim lonamme, locode As String
        If typec = 1 Then lonamme = pname.Text Else lonamme = COMPANY_name.Text
        If typec = 1 Then locode = pcode.Text Else locode = COMPANY_CODE.Text

        cmd.CommandText = "delete lblock where pname='" & lonamme & "'"
        cmd.ExecuteNonQuery()
        GroupBox11.Visible = False

    End Sub

    Private Sub ONLINEBLOCK_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ONLINEBLOCK.Click
        If PORV.Length < 10 Then Exit Sub
        Dim S As Integer = InputBox("ENTER PASWORD")
        If S <> 206 Then Exit Sub
        openonline()


        SDR.Close()
        dr.Close()
        SDR.Close()
        cmd.CommandText = "delete  from LBLOCK  "
        cmd.ExecuteNonQuery()
        SCMD.CommandText = "select * from LBLOCK "
        SDR = SCMD.ExecuteReader
        While SDR.Read
            cmd.CommandText = "INSERT INTO LBLOCK ([pname],[pcode],[comment],[type],[pmobile]) VALUES ('" & SDR("PNAME") & "','" & SDR("PCODE") & "','" & SDR("COMMENT") & "','" & SDR("TYPE") & "','" & SDR("pmobile") & "')"
            cmd.ExecuteNonQuery()
        End While
    End Sub

    Private Sub bmxlolo_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles bmxlolo.Click
        If lmach = 0 Then Exit Sub

        dr.Close()
        dr1.Close()
        cmd.CommandText = "delete from lbn"
        cmd.ExecuteNonQuery()
        cmd.CommandText = "select sum (cash),branch_name from lcash where  flg=1 AND  date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' group by branch_name order by branch_name"
        dr = cmd.ExecuteReader
        While dr.Read
            cmd1.CommandText = "insert into lbn (sdate,in1,ot1) values ('" & dr(1) & "','" & nulls(dr(0)) & "','0')"
            cmd1.ExecuteNonQuery()
        End While
        dr.Close()
        cmd.CommandText = "select sum (cash),branch_name from lcash where  flg=-1 AND date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' group by branch_name order by branch_name"
        dr = cmd.ExecuteReader
        While dr.Read
            dr1.Close()
            cmd1.CommandText = "select * from lbn where sdate='" & dr(1) & "'"
            dr1 = cmd1.ExecuteReader()
            If dr1.HasRows = True Then
                dr1.Close()
                cmd1.CommandText = "update  lbn  set ot1='" & nulls(dr(0)) & "' where sdate='" & dr(1) & "'"
                cmd1.ExecuteNonQuery()
            Else
                dr1.Close()
                cmd1.CommandText = "insert into lbn (sdate,ot1,in1) values ('" & ChangeFormat(dr(1)) & "','" & nulls(dr(0)) & "','0')"
                cmd1.ExecuteNonQuery()
            End If

        End While

        dr.Close() : cmd.CommandText = "select * from lbn "
        adlbn.SelectCommand = cmd
        adlbn.Fill(DBS, "lbn")
        lbn = DBS.Tables("lbn")
        DBS.Tables("lbn").Clear()
        adlbn.Fill(DBS, "lbn")
        lbn = DBS.Tables("lbn")
        brpd.DataSource = ""
        brpd.DataSource = lbn

        Dim oj As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        oj.Load(Application.StartupPath & "\lbnnew.rpt")
        oj.Database.Tables(0).SetDataSource(lbn)
        oj.SetParameterValue("2", d1.Value)
        oj.SetParameterValue("3", d2.Value)
        rp.Close() : rp.CrystalReportViewer1.ReportSource = oj
        rp.Show()
        rp.Focus()
    End Sub

    Private Sub rss1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles rss1.Click
        If PORV.Length < 10 Then Exit Sub
        Dim nali As Integer = 0

        If SCN.State = ConnectionState.Closed Then
            Try
                SCN.ConnectionString = PORV
                SCN.Open()
                SCMD.Connection = SCN
                SCMD.CommandText = "select * from branch"
                SDR = SCMD.ExecuteReader
                SDR.Read()
                scmd1.Connection = SCN
                scmd1.CommandText = "select * from branch"
                sdr1 = scmd1.ExecuteReader
                sdr1.Read()
                MsgBox("YOU CONNECTED TO SERVER GIVE ME MINUTS TO UPLOAD DATA")
                SCMD.Connection = SCN
            Catch ex As OleDb.OleDbException
                MsgBox(" ⁄›Ê¬ ÌÊÃœ Œÿ√ ›Ï «·« ’«· »ﬁ«⁄œ… «·»Ì«‰« ", MsgBoxStyle.Critical + MsgBoxStyle.MsgBoxRight)
                Exit Try
            End Try
        End If

        Dim nsd As Integer = 0
        dr.Close()
        sdr1.Close()
        SDR.Close()
        dr1.Close()
        SCMD.CommandText = "delete  from lcash where date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "' and BRANCH_NAME='" & branch_name.Text & "'"
        SCMD.ExecuteNonQuery()
        dr1.Close()
        cmd1.CommandText = "SELECT *  from lcash where date1 between '" & ChangeFormat(d1.Value) & "' and '" & ChangeFormat(d2.Value) & "'"
        dr1 = cmd1.ExecuteReader
        dr.Close()
        sdr1.Close()
        SDR.Close()

        While dr1.Read
            SCMD.CommandText = "INSERT INTO [lcash]([main_name],[main_code],[sub_code],[sub_name],[flg],[cash],[crd],[time1],[date1],[id],[notse],[usr],[shift],[SAVE_NAME],[save_code],branch_code,branch_name,st,PRM) VALUES ( '" & dr1("main_name") & "' , '" & dr1("main_code") & "' , '" & dr1("sub_code") & "' , '" & dr1("sub_name") & "' , '" & dr1("flg") & "' , '" & dr1("cash") & "' , '" & dr1("crd") & "' , '" & dr1("time1") & "' , '" & dr1("date1") & "' , '" & dr1("id") & "' , '" & dr1("notse") & "' , '" & dr1("usr") & "' , '" & dr1("shift") & "'  , '" & dr1("SAVE_NAME") & "' , '" & dr1("save_code") & "','" & dr1("branch_code") & "','" & dr1("branch_name") & "','0','" & dr1("PRM") & "')"
            SCMD.ExecuteNonQuery()
        End While

        dr.Close()
        cmd.CommandText = "update lcash set st=0 where st=1 "
        cmd.ExecuteNonQuery()



    End Sub

    Private Sub d2_ValueChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles d2.ValueChanged

    End Sub

    Private Sub d1_ValueChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles d1.ValueChanged

    End Sub

    Private Sub pname_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pname.SelectedIndexChanged

    End Sub

    Private Sub brestcash_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles brestcash.Click
        RESTF(2)
    End Sub

    Private Sub brestbank_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles brestbank.Click
        RESTF(1)
    End Sub

    Private Sub MMMMMMM_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MMMMMMM.Click
        'chrcv.Checked = True
        ComboBox5.Text = "all"
        ch.Checked = True
        f3(9)
        ch.Checked = False
        'chrcv.Checked = False
    End Sub

    Private Sub  ﬁ—Ì—”Õ»«·⁄Ì‰…„‰«·„‰“·ToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles  ﬁ—Ì—”Õ»«·⁄Ì‰…„‰«·„‰“·ToolStripMenuItem.Click
        LLOG("⁄—÷", 0, "⁄—÷  ﬁ—Ì— ”Õ» «·⁄Ì‰… „‰ «·„‰“·", 0, bran.Text)
        doc_admin = 0
        ComboBox5.Text = "all"
        cdoc_name.Checked = True
        f3(9)
        cdoc_name.Checked = False
    End Sub

    Private Sub brestcancel_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles brestcancel.Click
        grest.Visible = False

    End Sub

    Private Sub dev_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles dev.TextChanged
        SUMT()
    End Sub

    Private Sub fffffffffffffff_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles fffffffffffffff.Click
        FPESL("eslbill")
    End Sub
End Class
